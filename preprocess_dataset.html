<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Preprocess kinase-substrate datasets – katlas-raw</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-000f0825b9c55ed21d14970d810c14a9.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="Preprocess kinase-substrate datasets – katlas-raw">
<meta property="og:description" content="Raw code to generate figures in the paper of KATLAS">
<meta property="og:site_name" content="katlas-raw">
<meta name="twitter:title" content="Preprocess kinase-substrate datasets – katlas-raw">
<meta name="twitter:description" content="Raw code to generate figures in the paper of KATLAS">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">katlas-raw</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./preprocess_dataset.html">Preprocess kinase-substrate datasets</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">katlas-raw</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preprocess_dataset.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Preprocess kinase-substrate datasets</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda_fig1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exploratory data analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./site_promiscuity_fig1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Site promiscuity</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pssm_hierarchical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hierarchical clustering of PSSM</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_PSSM_example.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">05_PSSM_example.html</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modi_group.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modi group</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./scale_pspa.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PSPA scaled data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./background.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Background frequencies</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./specificity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Specificity comparison</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sty_composition.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">STY composition</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./plot_cddm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Plot heatmap and logo of CDDM</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./plot_pspa_figure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PSPA figures</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13_CDDM_umap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CDDM umap</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./get_aa_relationship.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Get AA relationship</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pspa_cddm_heatmap_compare.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Heatmap/ST/JSD/cosine comparison</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pssms_split_test_all.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Get kinase-specific PSSMs</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pssms_split_test_no_psp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Get kinase-specific PSSMs</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pssms_split_test_psp_02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Get kinase-specific PSSMs</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./scoring_compare_all.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Scoring evaluation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./scoring_compare_psp_02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Scoring evaluation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reactome_path_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Reactome pathway for each PSSM</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reactome_path_plot_pspa.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Plot reactome pathways: PSPA</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reactome_path_plot_cddm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Plot reactome pathways: CDDM</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./motif_clustering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Kmeans motifs</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./motif_plot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Motif plot</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./22_motif_web_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">22_motif_web_data.html</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./23_motif_kinase_similarity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cosine similarity with PSPA</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">kinase_domain</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kinase_domain/kd_01_get_all_kd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Get all kinase domain sequences</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kinase_domain/kd_02_pseudo_alignment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Alignment</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kinase_domain/kd_03_feature_extract.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Extract KD features</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kinase_domain/kd_04_prepare_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prepare data for training</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kinase_domain/kd_05_pspa_training_model_comparison_all.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DL training: Model comparison on T5 feature</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kinase_domain/kd_06a_pspa_training_feature_comparison_cnn_group.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DL training: Feature comparison on CNN model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kinase_domain/kd_06b_pspa_training_feature_comparison_cnn_subfamily.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DL training: Feature comparison on CNN model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kinase_domain/kd_06c_pspa_training_feature_comparison_mlp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DL training: Feature comparison on MLP model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kinase_domain/kd_07a_cddm_training_subfamily.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DL training</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kinase_domain/kd_07b_pspa_training_subfamily.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DL training</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kinase_domain/kd_08a_similarity_relationship.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">KD similarity &amp; PSSM similarity</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kinase_domain/kd_08b_similarity_relationship_cddm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">KD similarity &amp; PSSM similarity</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kinase_domain/kd_09a_predict_pspa.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Predict</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kinase_domain/kd_09b_predict_cddm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Predict</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kinase_domain/kd_10_plot_umap_known_unk.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Plot UMAP of known &amp; unknown KD</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kinase_domain/kd_11_plot_pspa_kd_t5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">kd_11_plot_pspa_kd_t5.html</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kinase_domain/kd_12_compare_pred_psp_known.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Comopare the two</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#motif" id="toc-motif" class="nav-link active" data-scroll-target="#motif">Motif</a></li>
  <li><a href="#review-of-database" id="toc-review-of-database" class="nav-link" data-scroll-target="#review-of-database">Review of database</a></li>
  <li><a href="#set-up" id="toc-set-up" class="nav-link" data-scroll-target="#set-up">Set up</a></li>
  <li><a href="#sugiyama-dataset" id="toc-sugiyama-dataset" class="nav-link" data-scroll-target="#sugiyama-dataset">Sugiyama dataset</a>
  <ul class="collapse">
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a></li>
  <li><a href="#kinase-mapping" id="toc-kinase-mapping" class="nav-link" data-scroll-target="#kinase-mapping">Kinase mapping</a></li>
  <li><a href="#substrate-mapping" id="toc-substrate-mapping" class="nav-link" data-scroll-target="#substrate-mapping">Substrate mapping</a></li>
  <li><a href="#validate-site" id="toc-validate-site" class="nav-link" data-scroll-target="#validate-site">Validate site</a></li>
  <li><a href="#save" id="toc-save" class="nav-link" data-scroll-target="#save">Save</a></li>
  </ul></li>
  <li><a href="#phosphositeplus-psp" id="toc-phosphositeplus-psp" class="nav-link" data-scroll-target="#phosphositeplus-psp">PhosphoSitePlus (PSP)</a>
  <ul class="collapse">
  <li><a href="#data-1" id="toc-data-1" class="nav-link" data-scroll-target="#data-1">Data</a></li>
  <li><a href="#substrate-mapping-1" id="toc-substrate-mapping-1" class="nav-link" data-scroll-target="#substrate-mapping-1">Substrate mapping</a></li>
  <li><a href="#kinase-mapping-1" id="toc-kinase-mapping-1" class="nav-link" data-scroll-target="#kinase-mapping-1">Kinase mapping</a></li>
  <li><a href="#check-if-kinase-uniprot-belongs-to-kinase-class" id="toc-check-if-kinase-uniprot-belongs-to-kinase-class" class="nav-link" data-scroll-target="#check-if-kinase-uniprot-belongs-to-kinase-class">Check if kinase-uniprot belongs to kinase class</a></li>
  <li><a href="#validate-site-1" id="toc-validate-site-1" class="nav-link" data-scroll-target="#validate-site-1">Validate site</a></li>
  <li><a href="#save-1" id="toc-save-1" class="nav-link" data-scroll-target="#save-1">Save</a></li>
  </ul></li>
  <li><a href="#kinet-espd-iptmnet" id="toc-kinet-espd-iptmnet" class="nav-link" data-scroll-target="#kinet-espd-iptmnet">KiNET (ESPD + iPTMNet)</a>
  <ul class="collapse">
  <li><a href="#data-2" id="toc-data-2" class="nav-link" data-scroll-target="#data-2">Data</a></li>
  <li><a href="#kinase-mapping-2" id="toc-kinase-mapping-2" class="nav-link" data-scroll-target="#kinase-mapping-2">Kinase mapping</a></li>
  <li><a href="#substrate-mapping-2" id="toc-substrate-mapping-2" class="nav-link" data-scroll-target="#substrate-mapping-2">Substrate mapping</a></li>
  <li><a href="#validate-site-2" id="toc-validate-site-2" class="nav-link" data-scroll-target="#validate-site-2">Validate site</a></li>
  <li><a href="#save-2" id="toc-save-2" class="nav-link" data-scroll-target="#save-2">Save</a></li>
  </ul></li>
  <li><a href="#phospho.elm" id="toc-phospho.elm" class="nav-link" data-scroll-target="#phospho.elm">Phospho.ELM</a>
  <ul class="collapse">
  <li><a href="#data-3" id="toc-data-3" class="nav-link" data-scroll-target="#data-3">Data</a></li>
  <li><a href="#kinase-mapping-3" id="toc-kinase-mapping-3" class="nav-link" data-scroll-target="#kinase-mapping-3">Kinase mapping</a></li>
  <li><a href="#substrate-mapping-3" id="toc-substrate-mapping-3" class="nav-link" data-scroll-target="#substrate-mapping-3">Substrate mapping</a></li>
  <li><a href="#validate-site-3" id="toc-validate-site-3" class="nav-link" data-scroll-target="#validate-site-3">Validate site</a></li>
  <li><a href="#save-3" id="toc-save-3" class="nav-link" data-scroll-target="#save-3">Save</a></li>
  </ul></li>
  <li><a href="#signor" id="toc-signor" class="nav-link" data-scroll-target="#signor">Signor</a>
  <ul class="collapse">
  <li><a href="#data-4" id="toc-data-4" class="nav-link" data-scroll-target="#data-4">Data</a></li>
  <li><a href="#kinase-mapping-4" id="toc-kinase-mapping-4" class="nav-link" data-scroll-target="#kinase-mapping-4">Kinase mapping</a></li>
  <li><a href="#substrate-mapping-4" id="toc-substrate-mapping-4" class="nav-link" data-scroll-target="#substrate-mapping-4">Substrate mapping</a></li>
  <li><a href="#validate-site-4" id="toc-validate-site-4" class="nav-link" data-scroll-target="#validate-site-4">Validate site</a></li>
  <li><a href="#save-4" id="toc-save-4" class="nav-link" data-scroll-target="#save-4">Save</a></li>
  </ul></li>
  <li><a href="#gps-6.0" id="toc-gps-6.0" class="nav-link" data-scroll-target="#gps-6.0">GPS 6.0</a>
  <ul class="collapse">
  <li><a href="#data-5" id="toc-data-5" class="nav-link" data-scroll-target="#data-5">Data</a></li>
  <li><a href="#kinase-mapping-5" id="toc-kinase-mapping-5" class="nav-link" data-scroll-target="#kinase-mapping-5">Kinase mapping</a></li>
  <li><a href="#substrate-mapping-5" id="toc-substrate-mapping-5" class="nav-link" data-scroll-target="#substrate-mapping-5">Substrate mapping</a></li>
  <li><a href="#validate-site-5" id="toc-validate-site-5" class="nav-link" data-scroll-target="#validate-site-5">Validate site</a></li>
  <li><a href="#save-5" id="toc-save-5" class="nav-link" data-scroll-target="#save-5">Save</a></li>
  </ul></li>
  <li><a href="#other-datasets" id="toc-other-datasets" class="nav-link" data-scroll-target="#other-datasets">Other datasets</a>
  <ul class="collapse">
  <li><a href="#douglass" id="toc-douglass" class="nav-link" data-scroll-target="#douglass">Douglass</a></li>
  <li><a href="#regphos-2.0" id="toc-regphos-2.0" class="nav-link" data-scroll-target="#regphos-2.0">RegPhos 2.0</a></li>
  <li><a href="#phosida" id="toc-phosida" class="nav-link" data-scroll-target="#phosida">Phosida</a></li>
  <li><a href="#phosphonetwork" id="toc-phosphonetwork" class="nav-link" data-scroll-target="#phosphonetwork">PhosphoNetwork</a></li>
  <li><a href="#biogrid" id="toc-biogrid" class="nav-link" data-scroll-target="#biogrid">BioGRID</a></li>
  </ul></li>
  <li><a href="#combine-all" id="toc-combine-all" class="nav-link" data-scroll-target="#combine-all">Combine all</a></li>
  <li><a href="#human-phosphoproteome" id="toc-human-phosphoproteome" class="nav-link" data-scroll-target="#human-phosphoproteome">Human phosphoproteome</a>
  <ul class="collapse">
  <li><a href="#data-6" id="toc-data-6" class="nav-link" data-scroll-target="#data-6">Data</a></li>
  <li><a href="#substrate-mapping-6" id="toc-substrate-mapping-6" class="nav-link" data-scroll-target="#substrate-mapping-6">Substrate mapping</a></li>
  <li><a href="#validate-site-6" id="toc-validate-site-6" class="nav-link" data-scroll-target="#validate-site-6">Validate site</a></li>
  <li><a href="#remove-duplicates" id="toc-remove-duplicates" class="nav-link" data-scroll-target="#remove-duplicates">Remove duplicates</a></li>
  <li><a href="#save-6" id="toc-save-6" class="nav-link" data-scroll-target="#save-6">Save</a></li>
  </ul></li>
  <li><a href="#phosphorylate-sequence" id="toc-phosphorylate-sequence" class="nav-link" data-scroll-target="#phosphorylate-sequence">Phosphorylate sequence</a>
  <ul class="collapse">
  <li><a href="#combine-human-phosphoproteome-and-ks-dataset-site-info" id="toc-combine-human-phosphoproteome-and-ks-dataset-site-info" class="nav-link" data-scroll-target="#combine-human-phosphoproteome-and-ks-dataset-site-info">Combine human phosphoproteome and KS dataset site info</a></li>
  <li><a href="#phosphorylate-sequence-1" id="toc-phosphorylate-sequence-1" class="nav-link" data-scroll-target="#phosphorylate-sequence-1">Phosphorylate sequence</a></li>
  <li><a href="#map-to-df" id="toc-map-to-df" class="nav-link" data-scroll-target="#map-to-df">Map to df</a></li>
  </ul></li>
  <li><a href="#extract-site-sequence" id="toc-extract-site-sequence" class="nav-link" data-scroll-target="#extract-site-sequence">Extract site sequence</a></li>
  <li><a href="#add-kinase-info" id="toc-add-kinase-info" class="nav-link" data-scroll-target="#add-kinase-info">Add kinase info</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/sky1ove/katlas-raw/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div><div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="preprocess_dataset.html.md"><i class="bi bi-file-code"></i>CommonMark</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Preprocess kinase-substrate datasets</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<section id="motif" class="level2">
<h2 class="anchored" data-anchor-id="motif">Motif</h2>
<p>Poll [Sugiyama &amp; Douglass]: https://biosignaling.biomedcentral.com/articles/10.1186/s12964-023-01436-2</p>
<p>Poll web motif: https://esbl.nhlbi.nih.gov/Databases/Kinase_Logos/KinaseTree.html; https://esbl.nhlbi.nih.gov/Databases/Kinase_Logos/GeneSymbol.html</p>
<p>Sugiyama: https://pmc.ncbi.nlm.nih.gov/articles/PMC6642169/</p>
<p>Douglass: https://journals.physiology.org/doi/full/10.1152/ajpcell.00166.2012</p>
<p>RegPhos: Supplementary Table S4: motifs grouped by kinase family</p>
<p>PhosphoNetwork, logos of 300 motifs: https://pmc.ncbi.nlm.nih.gov/articles/PMC3658267/; web app: https://phosphonetworks.org/</p>
<p>GPS: https://gps.biocuckoo.cn/links.php#l1</p>
</section>
<section id="review-of-database" class="level2">
<h2 class="anchored" data-anchor-id="review-of-database">Review of database</h2>
<p>Wilson, AACR cancer research: https://aacrjournals.org/cancerres/article/78/1/15/625062/New-Perspectives-Opportunities-and-Challenges-in</p>
<p>GPS 6.0, List of database: https://gps.biocuckoo.cn/links.php</p>
<p>paper: https://academic.oup.com/nar/article/51/W1/W243/7157529</p>
<p>phospho.ELM links: http://phospho.elm.eu.org/links.html</p>
<p>GPS, https://gps.biocuckoo.cn/links.php#l1</p>
</section>
<section id="set-up" class="level2">
<h2 class="anchored" data-anchor-id="set-up">Set up</h2>
<div id="cf1fd43e" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> katlas.data <span class="im">import</span> <span class="op">*</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="1da757de" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> map_substrate(idmapping_fname, ori_df, sub_col,remove_nonhuman<span class="op">=</span><span class="va">True</span>):</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Map uniprot id with uniprot info"</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    substrate_id <span class="op">=</span> pd.read_excel(idmapping_fname)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    substrate_id <span class="op">=</span> substrate_id.drop_duplicates(<span class="st">'From'</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    substrate_id <span class="op">=</span> substrate_id[[<span class="st">'From'</span>, <span class="st">'Entry'</span>, <span class="st">'Gene Names'</span>, <span class="st">'Sequence'</span>,<span class="st">'Organism'</span>]]</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    ori_df <span class="op">=</span> ori_df.copy()</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># prevent name conflict</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> sub_col <span class="op">==</span> <span class="st">'substrate_uniprot'</span>:</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>        sub_col <span class="op">=</span> <span class="st">'substrate_uniprot_tmp'</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>        ori_df <span class="op">=</span> ori_df.rename(columns<span class="op">=</span>{<span class="st">'substrate_uniprot'</span>:<span class="st">'substrate_uniprot_tmp'</span>})</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    substrate_id.columns <span class="op">=</span> [sub_col, <span class="st">'substrate_uniprot'</span>, <span class="st">'substrate_genes'</span>, <span class="st">'substrate_sequence'</span>,<span class="st">'substrate_species'</span>]</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'Shape before processing'</span>, ori_df.shape)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    ori_df <span class="op">=</span> ori_df.merge(substrate_id, on<span class="op">=</span>sub_col)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'Species counts:'</span>,ori_df.substrate_species.value_counts())</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> remove_nonhuman:</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'Removing non-human substrates'</span>)</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>        ori_df <span class="op">=</span> ori_df[ori_df.substrate_species<span class="op">==</span><span class="st">'Homo sapiens (Human)'</span>]</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    ori_df <span class="op">=</span> ori_df.drop(columns<span class="op">=</span>[sub_col])  <span class="co"># Drop temp column after merging</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    ori_df <span class="op">=</span> ori_df.dropna(subset<span class="op">=</span>[<span class="st">'substrate_sequence'</span>])</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'Shape after processing'</span>, ori_df.shape)</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ori_df.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="a52c47ed" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># kinase_uniprot=pd.read_excel('raw/uniprot_human_keyword_kinase.xlsx',engine="openpyxl")</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>kinase_uniprot <span class="op">=</span> Data.get_kinase_uniprot()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="fcf47d68-847f-4e4e-bc06-197734bbe6d3" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>kinase_uniprot.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Entry</th>
<th data-quarto-table-cell-role="th">Entry Name</th>
<th data-quarto-table-cell-role="th">Protein names</th>
<th data-quarto-table-cell-role="th">Gene Names</th>
<th data-quarto-table-cell-role="th">uniprot_keyword_kinase</th>
<th data-quarto-table-cell-role="th">on_tree</th>
<th data-quarto-table-cell-role="th">Organism</th>
<th data-quarto-table-cell-role="th">Keywords</th>
<th data-quarto-table-cell-role="th">Sequence</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>A2RU49</td>
<td>HYKK_HUMAN</td>
<td>Hydroxylysine kinase (5-hydroxy-L-lysine kinas...</td>
<td>HYKK AGPHD1</td>
<td>1</td>
<td>0</td>
<td>Homo sapiens (Human)</td>
<td>Alternative splicing;Cytoplasm;Kinase;Proteomi...</td>
<td>MSSGNYQQSEALSKPTFSEEQASALVESVFGLKVSKVRPLPSYDDQ...</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>A4D2B8</td>
<td>PM2P1_HUMAN</td>
<td>Putative postmeiotic segregation increased 2-l...</td>
<td>PMS2P1 PMS2L1 PMS2L13 PMS2L6 PMS2L8 PMS3 PMS8 ...</td>
<td>1</td>
<td>0</td>
<td>Homo sapiens (Human)</td>
<td>Alternative splicing;Kinase;Reference proteome...</td>
<td>MVTMCGGHRPENFLHQVLTEFGEELAGEGKSEVGGGAPRSYLQVAS...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>O00141</td>
<td>SGK1_HUMAN</td>
<td>Serine/threonine-protein kinase Sgk1 (EC 2.7.1...</td>
<td>SGK1 SGK</td>
<td>1</td>
<td>1</td>
<td>Homo sapiens (Human)</td>
<td>3D-structure;Alternative promoter usage;Altern...</td>
<td>MTVKTEAAKGTLTYSRMRGMVAILIAFMKQRRMGLNDFIQKIANNS...</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>O00142</td>
<td>KITM_HUMAN</td>
<td>Thymidine kinase 2, mitochondrial (EC 2.7.1.21...</td>
<td>TK2</td>
<td>1</td>
<td>0</td>
<td>Homo sapiens (Human)</td>
<td>Alternative splicing;ATP-binding;Direct protei...</td>
<td>MLLWPLRGWAARALRCFGPGSRGSPASGPGPRRVQRRAWPPDKEQE...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>O00238</td>
<td>BMR1B_HUMAN</td>
<td>Bone morphogenetic protein receptor type-1B (B...</td>
<td>BMPR1B</td>
<td>1</td>
<td>1</td>
<td>Homo sapiens (Human)</td>
<td>3D-structure;Alternative splicing;ATP-binding;...</td>
<td>MLLRSAGKLNVGTKKEDGESTAPTPRPKVLRCKCHHHCPEDSVNNI...</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="sugiyama-dataset" class="level2">
<h2 class="anchored" data-anchor-id="sugiyama-dataset">Sugiyama dataset</h2>
<section id="data" class="level3">
<h3 class="anchored" data-anchor-id="data">Data</h3>
<p>Go to https://www.nature.com/articles/s41598-019-46385-4#Sec21, download table S2.</p>
<p>Modify the header (2 lines to 1 line) so that it can be read by pandas.</p>
<div id="34530580" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'raw/Large_scale_S2.csv'</span>).iloc[:,:<span class="op">-</span><span class="dv">2</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="67b1bd90" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>df.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Type</th>
<th data-quarto-table-cell-role="th">Kinase</th>
<th data-quarto-table-cell-role="th">Substrate_uniprot</th>
<th data-quarto-table-cell-role="th">Position</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>TK</td>
<td>ABL1</td>
<td>1433B_HUMAN</td>
<td>S212</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>TK</td>
<td>ABL1</td>
<td>1433B_HUMAN</td>
<td>Y151</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>TK</td>
<td>ABL1</td>
<td>1433B_HUMAN</td>
<td>Y21</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>TK</td>
<td>ABL1</td>
<td>1433B_HUMAN</td>
<td>Y50</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>TK</td>
<td>ABL1</td>
<td>1433E_HUMAN</td>
<td>Y152</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="8fe5cf4b" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>df.shape</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>(198536, 4)</code></pre>
</div>
</div>
</section>
<section id="kinase-mapping" class="level3">
<h3 class="anchored" data-anchor-id="kinase-mapping">Kinase mapping</h3>
<div id="b0ed580a" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pd.DataFrame(df.Kinase.unique())[0].str.split('/').str[0].to_csv('raw/sugiyama_kinase_name.csv')</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Map each kinase name with uniprot ID</p>
<div id="e1526cab" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>kinase_id <span class="op">=</span> pd.read_csv(<span class="st">'raw/LS_info2.csv'</span>).iloc[:,:<span class="dv">3</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="a3292792" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.merge(kinase_id)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="ccc44638" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Type</th>
<th data-quarto-table-cell-role="th">Kinase</th>
<th data-quarto-table-cell-role="th">Substrate_uniprot</th>
<th data-quarto-table-cell-role="th">Position</th>
<th data-quarto-table-cell-role="th">kinase_uniprot</th>
<th data-quarto-table-cell-role="th">kinase_paper</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>TK</td>
<td>ABL1</td>
<td>1433B_HUMAN</td>
<td>S212</td>
<td>P00519</td>
<td>ABL1</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>TK</td>
<td>ABL1</td>
<td>1433B_HUMAN</td>
<td>Y151</td>
<td>P00519</td>
<td>ABL1</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>TK</td>
<td>ABL1</td>
<td>1433B_HUMAN</td>
<td>Y21</td>
<td>P00519</td>
<td>ABL1</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>TK</td>
<td>ABL1</td>
<td>1433B_HUMAN</td>
<td>Y50</td>
<td>P00519</td>
<td>ABL1</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>TK</td>
<td>ABL1</td>
<td>1433E_HUMAN</td>
<td>Y152</td>
<td>P00519</td>
<td>ABL1</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">198531</th>
<td>LK</td>
<td>SPHK2</td>
<td>TICN3_HUMAN</td>
<td>T118</td>
<td>Q9NRA0</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">198532</th>
<td>LK</td>
<td>SPHK2</td>
<td>TPM4_HUMAN</td>
<td>T241</td>
<td>Q9NRA0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">198533</th>
<td>LK</td>
<td>SPHK2</td>
<td>ULK3_HUMAN</td>
<td>S305</td>
<td>Q9NRA0</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">198534</th>
<td>LK</td>
<td>SPHK2</td>
<td>ZRAB2_HUMAN</td>
<td>S165</td>
<td>Q9NRA0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">198535</th>
<td>LK</td>
<td>SPHK2</td>
<td>ZRAB2_HUMAN</td>
<td>S181</td>
<td>Q9NRA0</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>198536 rows × 6 columns</p>
</div>
</div>
</div>
</section>
<section id="substrate-mapping" class="level3">
<h3 class="anchored" data-anchor-id="substrate-mapping">Substrate mapping</h3>
<div id="a966a2b7" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pd.DataFrame(df.Substrate_uniprot.unique()).to_csv('raw/sugiyama_uniprot_id.csv')</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>ID mapping of <code>Substrate_uniprot</code> to uniprot ID in https://www.uniprot.org/id-mapping</p>
<p>3,753 IDs were mapped to 3,753 results</p>
<p>375 ID were not mapped</p>
<div id="b8eab6fd" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> map_substrate(<span class="st">'raw/idmapping_2025_03_02.xlsx'</span>,df,<span class="st">'Substrate_uniprot'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/sky1ove/miniconda3/lib/python3.13/site-packages/logomaker/../openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Shape before processing (198536, 6)
Species counts: substrate_species
Homo sapiens (Human)    187129
Name: count, dtype: int64
Removing non-human substrates
Shape after processing (187129, 9)</code></pre>
</div>
</div>
<div id="5efb9c15" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lipid kinase</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>df[df.Type<span class="op">==</span><span class="st">'LK'</span>].Kinase.unique()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>array(['PIK3C3', 'PIK3CB/PIK3R1', 'PIK3CD/PIK3R1', 'PIK3CG/PIK3R5',
       'PIK3CG', 'PIK4CA', 'PIP4K2B', 'PIP5K1C', 'SPHK1', 'SPHK2'],
      dtype=object)</code></pre>
</div>
</div>
<div id="3451d291" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>df.isna().<span class="bu">sum</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>Type                      0
Kinase                    0
Position                  0
kinase_uniprot        16591
kinase_paper          18891
substrate_uniprot         0
substrate_genes          11
substrate_sequence        0
substrate_species         0
dtype: int64</code></pre>
</div>
</div>
<div id="80c3810c" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>df.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Type</th>
<th data-quarto-table-cell-role="th">Kinase</th>
<th data-quarto-table-cell-role="th">Position</th>
<th data-quarto-table-cell-role="th">kinase_uniprot</th>
<th data-quarto-table-cell-role="th">kinase_paper</th>
<th data-quarto-table-cell-role="th">substrate_uniprot</th>
<th data-quarto-table-cell-role="th">substrate_genes</th>
<th data-quarto-table-cell-role="th">substrate_sequence</th>
<th data-quarto-table-cell-role="th">substrate_species</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>TK</td>
<td>ABL1</td>
<td>S212</td>
<td>P00519</td>
<td>ABL1</td>
<td>P31946</td>
<td>YWHAB</td>
<td>MTMDKSELVQKAKLAEQAERYDDMAAAMKAVTEQGHELSNEERNLL...</td>
<td>Homo sapiens (Human)</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>TK</td>
<td>ABL1</td>
<td>Y151</td>
<td>P00519</td>
<td>ABL1</td>
<td>P31946</td>
<td>YWHAB</td>
<td>MTMDKSELVQKAKLAEQAERYDDMAAAMKAVTEQGHELSNEERNLL...</td>
<td>Homo sapiens (Human)</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>TK</td>
<td>ABL1</td>
<td>Y21</td>
<td>P00519</td>
<td>ABL1</td>
<td>P31946</td>
<td>YWHAB</td>
<td>MTMDKSELVQKAKLAEQAERYDDMAAAMKAVTEQGHELSNEERNLL...</td>
<td>Homo sapiens (Human)</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>TK</td>
<td>ABL1</td>
<td>Y50</td>
<td>P00519</td>
<td>ABL1</td>
<td>P31946</td>
<td>YWHAB</td>
<td>MTMDKSELVQKAKLAEQAERYDDMAAAMKAVTEQGHELSNEERNLL...</td>
<td>Homo sapiens (Human)</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>TK</td>
<td>ABL1</td>
<td>Y152</td>
<td>P00519</td>
<td>ABL1</td>
<td>P62258</td>
<td>YWHAE</td>
<td>MDDREDLVYQAKLAEQAERYDEMVESMKKVAGMDVELTVEERNLLS...</td>
<td>Homo sapiens (Human)</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="877dd787" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.rename(columns <span class="op">=</span> {<span class="st">'Position'</span>:<span class="st">'site'</span>})</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="fcb44618" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>df.shape</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>(187129, 9)</code></pre>
</div>
</div>
</section>
<section id="validate-site" class="level3">
<h3 class="anchored" data-anchor-id="validate-site">Validate site</h3>
<div id="df182bdd" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'site_match'</span>] <span class="op">=</span>validate_site_df(df,<span class="st">'site'</span>,<span class="st">'substrate_sequence'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="51720a5f" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>df.site_match.value_counts()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>site_match
1    184948
0      2181
Name: count, dtype: int64</code></pre>
</div>
</div>
<div id="8a5f6324" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>df[df.site_match<span class="op">==</span><span class="dv">1</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="513a855c" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>df.shape</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>(184948, 10)</code></pre>
</div>
</div>
</section>
<section id="save" class="level3">
<h3 class="anchored" data-anchor-id="save">Save</h3>
<div id="73145f45" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'source'</span>]<span class="op">=</span><span class="st">'Sugiyama'</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cb1b7303" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># df.to_excel('raw/sugiyama.xlsx',index=False)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="phosphositeplus-psp" class="level2">
<h2 class="anchored" data-anchor-id="phosphositeplus-psp">PhosphoSitePlus (PSP)</h2>
<section id="data-1" class="level3">
<h3 class="anchored" data-anchor-id="data-1">Data</h3>
<p>PSP paper: https://academic.oup.com/nar/article/43/D1/D512/2439467</p>
<p>Go to https://www.phosphosite.org/staticDownloads, download <code>Kinase_Substrate_Dataset.txt</code></p>
<div id="3a56e98c" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="b63d89b9" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>psp <span class="op">=</span> pd.read_csv(<span class="st">'raw/Kinase_Substrate_Dataset_final.csv'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="d478c044" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>psp.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">GENE</th>
<th data-quarto-table-cell-role="th">Kinase</th>
<th data-quarto-table-cell-role="th">KIN_ACC_ID</th>
<th data-quarto-table-cell-role="th">KIN_ORGANISM</th>
<th data-quarto-table-cell-role="th">SUBSTRATE</th>
<th data-quarto-table-cell-role="th">SUB_GENE_ID</th>
<th data-quarto-table-cell-role="th">SUB_ACC_ID</th>
<th data-quarto-table-cell-role="th">SUB_GENE</th>
<th data-quarto-table-cell-role="th">SUB_ORGANISM</th>
<th data-quarto-table-cell-role="th">SUB_MOD_RSD</th>
<th data-quarto-table-cell-role="th">SITE_GRP_ID</th>
<th data-quarto-table-cell-role="th">substrate</th>
<th data-quarto-table-cell-role="th">DOMAIN</th>
<th data-quarto-table-cell-role="th">IN_VIVO_RXN</th>
<th data-quarto-table-cell-role="th">IN_VITRO_RXN</th>
<th data-quarto-table-cell-role="th">CST_CAT#</th>
<th data-quarto-table-cell-role="th">kinase_uniprot</th>
<th data-quarto-table-cell-role="th">kinase_paper</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>Dyrk2</td>
<td>DYRK2</td>
<td>Q5U4C9</td>
<td>mouse</td>
<td>NDEL1</td>
<td>83431.0</td>
<td>Q9ERR1</td>
<td>Ndel1</td>
<td>mouse</td>
<td>S336</td>
<td>1869686801</td>
<td>LGSsRPSsAPGMLPL</td>
<td>NaN</td>
<td></td>
<td>X</td>
<td>NaN</td>
<td>Q92630</td>
<td>DYRK2</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>DYRK2</td>
<td>DYRK2</td>
<td>Q92630</td>
<td>human</td>
<td>GLI2</td>
<td>14633.0</td>
<td>Q0VGT2</td>
<td>Gli2</td>
<td>mouse</td>
<td>S385</td>
<td>3339001</td>
<td>AEGLRPAsPLGLTQE</td>
<td>NaN</td>
<td></td>
<td>X</td>
<td>NaN</td>
<td>Q92630</td>
<td>DYRK2</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>DYRK2</td>
<td>DYRK2</td>
<td>Q92630</td>
<td>human</td>
<td>SIAH2</td>
<td>6478.0</td>
<td>O43255</td>
<td>SIAH2</td>
<td>human</td>
<td>S68</td>
<td>5393502</td>
<td>GGGAGPVsPQHHELT</td>
<td>NaN</td>
<td>X</td>
<td></td>
<td>NaN</td>
<td>Q92630</td>
<td>DYRK2</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>DYRK2</td>
<td>DYRK2</td>
<td>Q92630</td>
<td>human</td>
<td>CARHSP1</td>
<td>23589.0</td>
<td>Q9Y2V2</td>
<td>CARHSP1</td>
<td>human</td>
<td>S41</td>
<td>455702</td>
<td>LRGNVVPsPLPtRRt</td>
<td>NaN</td>
<td></td>
<td>X</td>
<td>NaN</td>
<td>Q92630</td>
<td>DYRK2</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>DYRK2</td>
<td>DYRK2</td>
<td>Q92630</td>
<td>human</td>
<td>Doublecortin iso2</td>
<td>1641.0</td>
<td>O43602-2</td>
<td>DCX</td>
<td>human</td>
<td>S306</td>
<td>454122</td>
<td>GPMRRSKsPADSANG</td>
<td>NaN</td>
<td>X</td>
<td></td>
<td>NaN</td>
<td>Q92630</td>
<td>DYRK2</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="a43ee58b" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>psp <span class="op">=</span>psp[psp.KIN_ORGANISM<span class="op">==</span><span class="st">'human'</span>].reset_index(drop<span class="op">=</span><span class="va">True</span>) </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>psp <span class="op">=</span>psp[psp.SUB_ORGANISM<span class="op">==</span><span class="st">'human'</span>].reset_index(drop<span class="op">=</span><span class="va">True</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="4101d735" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>psp.shape</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>(14081, 18)</code></pre>
</div>
</div>
<div id="b1d064f9" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>psp <span class="op">=</span> psp[[<span class="st">'KIN_ACC_ID'</span>,<span class="st">'kinase_paper'</span>,<span class="st">'GENE'</span>,<span class="st">'SUB_ACC_ID'</span>,<span class="st">'SUB_GENE'</span>,<span class="st">'SUB_MOD_RSD'</span>,<span class="st">'substrate'</span>]]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="a2f87806" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>psp.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">KIN_ACC_ID</th>
<th data-quarto-table-cell-role="th">kinase_paper</th>
<th data-quarto-table-cell-role="th">GENE</th>
<th data-quarto-table-cell-role="th">SUB_ACC_ID</th>
<th data-quarto-table-cell-role="th">SUB_GENE</th>
<th data-quarto-table-cell-role="th">SUB_MOD_RSD</th>
<th data-quarto-table-cell-role="th">substrate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>Q92630</td>
<td>DYRK2</td>
<td>DYRK2</td>
<td>O43255</td>
<td>SIAH2</td>
<td>S68</td>
<td>GGGAGPVsPQHHELT</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>Q92630</td>
<td>DYRK2</td>
<td>DYRK2</td>
<td>Q9Y2V2</td>
<td>CARHSP1</td>
<td>S41</td>
<td>LRGNVVPsPLPtRRt</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>Q92630</td>
<td>DYRK2</td>
<td>DYRK2</td>
<td>O43602-2</td>
<td>DCX</td>
<td>S306</td>
<td>GPMRRSKsPADSANG</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>Q92630</td>
<td>DYRK2</td>
<td>DYRK2</td>
<td>P30304</td>
<td>CDC25A</td>
<td>S283</td>
<td>PErsQEEsPPGSTKr</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>Q92630</td>
<td>DYRK2</td>
<td>DYRK2</td>
<td>O43255</td>
<td>SIAH2</td>
<td>T119</td>
<td>PTCRGALtPSIRNLA</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="substrate-mapping-1" class="level3">
<h3 class="anchored" data-anchor-id="substrate-mapping-1">Substrate mapping</h3>
<div id="5ca3d318" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># psp.SUB_ACC_ID.drop_duplicates().to_csv('raw/psp_substrate_id.csv')</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>4,441 IDs were mapped to 4,446 results</p>
<p>19 ID were not mapped: NP_001184222 NP_001100737 AAA40678 HSBO22 NP_776683 NP_579829 P18433-2 NP_001076191 NP_001099740 NP_001005762 NP_001178533 XP_008773743 NP_001104263 ABR15760 AAB24204 AAB24205 BAA34185.2 NP_001103022 AAC50053</p>
<p>IDs with multiple results: P62991, P62988</p>
<div id="ebc32caf" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>psp <span class="op">=</span> map_substrate(<span class="st">'raw/idmapping_2025_03_02_psp.xlsx'</span>,psp,<span class="st">'SUB_ACC_ID'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/sky1ove/miniconda3/lib/python3.13/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Shape before processing (14081, 7)
Species counts: substrate_species
Homo sapiens (Human)    14069
Name: count, dtype: int64
Removing non-human substrates
Shape after processing (14069, 10)</code></pre>
</div>
</div>
<div id="4d0aea2c" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>psp.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">KIN_ACC_ID</th>
<th data-quarto-table-cell-role="th">kinase_paper</th>
<th data-quarto-table-cell-role="th">GENE</th>
<th data-quarto-table-cell-role="th">SUB_GENE</th>
<th data-quarto-table-cell-role="th">SUB_MOD_RSD</th>
<th data-quarto-table-cell-role="th">substrate</th>
<th data-quarto-table-cell-role="th">substrate_uniprot</th>
<th data-quarto-table-cell-role="th">substrate_genes</th>
<th data-quarto-table-cell-role="th">substrate_sequence</th>
<th data-quarto-table-cell-role="th">substrate_species</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>Q92630</td>
<td>DYRK2</td>
<td>DYRK2</td>
<td>SIAH2</td>
<td>S68</td>
<td>GGGAGPVsPQHHELT</td>
<td>O43255</td>
<td>SIAH2</td>
<td>MSRPSSTGPSANKPCSKQPPPQPQHTPSPAAPPAAATISAAGPGSS...</td>
<td>Homo sapiens (Human)</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>Q92630</td>
<td>DYRK2</td>
<td>DYRK2</td>
<td>CARHSP1</td>
<td>S41</td>
<td>LRGNVVPsPLPtRRt</td>
<td>Q9Y2V2</td>
<td>CARHSP1</td>
<td>MSSEPPPPPQPPTHQASVGLLDTPRSRERSPSPLRGNVVPSPLPTR...</td>
<td>Homo sapiens (Human)</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>Q92630</td>
<td>DYRK2</td>
<td>DYRK2</td>
<td>DCX</td>
<td>S306</td>
<td>GPMRRSKsPADSANG</td>
<td>O43602</td>
<td>DCX DBCN LISX</td>
<td>MELDFGHFDERDKTSRNMRGSRMNGLPSPTHSAHCSFYRTRTLQAL...</td>
<td>Homo sapiens (Human)</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>Q92630</td>
<td>DYRK2</td>
<td>DYRK2</td>
<td>CDC25A</td>
<td>S283</td>
<td>PErsQEEsPPGSTKr</td>
<td>P30304</td>
<td>CDC25A</td>
<td>MELGPEPPHRRRLLFACSPPPASQPVVKALFGASAAGGLSPVTNLT...</td>
<td>Homo sapiens (Human)</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>Q92630</td>
<td>DYRK2</td>
<td>DYRK2</td>
<td>SIAH2</td>
<td>T119</td>
<td>PTCRGALtPSIRNLA</td>
<td>O43255</td>
<td>SIAH2</td>
<td>MSRPSSTGPSANKPCSKQPPPQPQHTPSPAAPPAAATISAAGPGSS...</td>
<td>Homo sapiens (Human)</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="a4a920db" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>psp.shape</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>(14069, 10)</code></pre>
</div>
</div>
</section>
<section id="kinase-mapping-1" class="level3">
<h3 class="anchored" data-anchor-id="kinase-mapping-1">Kinase mapping</h3>
<div id="d68c46b7" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># psp.KIN_ACC_ID.drop_duplicates().to_csv('raw/psp_kin_id.csv')</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Mapp KIN_ACC_ID to uniprot id</p>
<p>440 IDs were mapped to 440 results</p>
<p>1 ID was not mapped:</p>
<p>AAA58698</p>
<div id="f039fe87" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>kinase_id <span class="op">=</span> pd.read_excel(<span class="st">'raw/idmapping_2025_03_02_psp_kinase.xlsx'</span>)[[<span class="st">'From'</span>,<span class="st">'Entry'</span>,<span class="st">'Gene Names'</span>]]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/sky1ove/miniconda3/lib/python3.13/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")</code></pre>
</div>
</div>
<div id="314a55df" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>kinase_id.columns <span class="op">=</span> [<span class="st">'KIN_ACC_ID'</span>,<span class="st">'kinase_uniprot'</span>,<span class="st">'kinase_genes'</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="594ff52c" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>kinase_id[kinase_id.KIN_ACC_ID<span class="op">==</span><span class="st">"A9UF07"</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">KIN_ACC_ID</th>
<th data-quarto-table-cell-role="th">kinase_uniprot</th>
<th data-quarto-table-cell-role="th">kinase_genes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">124</th>
<td>A9UF07</td>
<td>A9UF07</td>
<td>BCR/ABL fusion</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="5ab83ddf" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>psp[<span class="st">'KIN_ACC_ID'</span>] <span class="op">=</span> psp[<span class="st">'KIN_ACC_ID'</span>].replace(<span class="st">'A9UF07'</span>,<span class="st">'P00519'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="9a31bc7f" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>psp <span class="op">=</span> psp.merge(kinase_id)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="356d66ad" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>psp <span class="op">=</span> psp.rename(columns<span class="op">=</span>{<span class="st">'SUB_MOD_RSD'</span>:<span class="st">'site'</span>})</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="f366c161" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>psp <span class="op">=</span> psp[[<span class="st">'kinase_uniprot'</span>,<span class="st">'kinase_genes'</span>,<span class="st">'kinase_paper'</span>,<span class="st">'substrate_uniprot'</span>,<span class="st">'substrate_genes'</span>,<span class="st">'site'</span>,<span class="st">'substrate_sequence'</span>,<span class="st">'substrate'</span>,<span class="st">'substrate_species'</span>]]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="982e4ee1" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>psp.isna().<span class="bu">sum</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>kinase_uniprot          0
kinase_genes            0
kinase_paper          134
substrate_uniprot       0
substrate_genes         0
site                    0
substrate_sequence      0
substrate               0
substrate_species       0
dtype: int64</code></pre>
</div>
</div>
<div id="0374bbe0" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>psp <span class="op">=</span> psp.dropna(subset<span class="op">=</span><span class="st">'substrate_sequence'</span>).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="check-if-kinase-uniprot-belongs-to-kinase-class" class="level3">
<h3 class="anchored" data-anchor-id="check-if-kinase-uniprot-belongs-to-kinase-class">Check if kinase-uniprot belongs to kinase class</h3>
<p>Not mapped:</p>
<div id="a345f95e-d9a5-4f61-b5a2-673aee5c9b49" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> katlas.data <span class="im">import</span> <span class="op">*</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="b5dff04e-63fd-44c6-96c1-9db91df4439f" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>kinase_uniprot<span class="op">=</span>Data.get_kinase_uniprot()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="676c8ba4" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>psp[<span class="op">~</span>psp.kinase_uniprot.isin(kinase_uniprot.Entry)].kinase_genes.value_counts()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>kinase_genes
CSNK2B CK2N G5A                13
PRKAG2                          9
PRKAB1 AMPK                     9
GTF2F1 RAP74                    4
BLVRA BLVR BVR                  3
TGM2                            2
RET/PTC2                        2
PHKA1 PHKA                      1
HSPA5 GRP78                     1
ENPP3 PDNP3                     1
PIK3R1 GRB1                     1
CERT1 CERT COL4A3BP STARD11     1
JMJD6 KIAA0585 PSR PTDSR        1
Name: count, dtype: int64</code></pre>
</div>
</div>
<p>CSNK2B belongs to CK2, PRKAB1, PRKAG2 belongs to AMPK subunit; as their count is not many, we can simply ignore them</p>
<div id="fc390156" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>psp <span class="op">=</span> psp[psp.kinase_uniprot.isin(kinase_uniprot.Entry)].copy()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="9dc0dd21" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>psp.shape</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>(14016, 9)</code></pre>
</div>
</div>
</section>
<section id="validate-site-1" class="level3">
<h3 class="anchored" data-anchor-id="validate-site-1">Validate site</h3>
<div id="33bfc876-6ed8-4d2c-8aa6-56cd586507d3" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> katlas.utils <span class="im">import</span> <span class="op">*</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Check if it match with substrate sequence</p>
<div id="fd5d8fe3" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>psp[<span class="st">'site_seq'</span>]<span class="op">=</span>extract_site_seq(psp,seq_col<span class="op">=</span><span class="st">'substrate_sequence'</span>,site_col<span class="op">=</span><span class="st">'site'</span>,n<span class="op">=</span><span class="dv">7</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|███████████████████████████████████████████████████████████████████████| 14016/14016 [00:00&lt;00:00, 26427.27it/s]</code></pre>
</div>
</div>
<div id="61e9786a" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>(psp[<span class="st">'site_seq'</span>]<span class="op">==</span>psp[<span class="st">'substrate'</span>].<span class="bu">str</span>.upper()).value_counts()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>True     13156
False      860
Name: count, dtype: int64</code></pre>
</div>
</div>
<div id="3f80d930" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>unmatch <span class="op">=</span> psp[<span class="op">~</span>(psp[<span class="st">'site_seq'</span>]<span class="op">==</span>psp[<span class="st">'substrate'</span>].<span class="bu">str</span>.upper())]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cf056f7c" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>unmatch.kinase_genes.value_counts().head(<span class="dv">10</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>kinase_genes
PRKACA PKACA                                  40
MAPK1 ERK2 PRKM1 PRKM2                        40
SRC SRC1                                      39
CDK1 CDC2 CDC28A CDKN1 P34CDC2                38
GSK3B                                         37
MAPK3 ERK1 PRKM3                              35
AURKB AIK2 AIM1 AIRK2 ARK2 STK1 STK12 STK5    33
PRKCA PKCA PRKACA                             33
PRKCB PKCB PRKCB1                             25
CDK5 CDKN5 PSSALRE                            25
Name: count, dtype: int64</code></pre>
</div>
</div>
<p>We’ll drop the rows with unmatch substrate sequence</p>
<div id="4c6b5d17" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>psp <span class="op">=</span> psp[psp[<span class="st">'site_seq'</span>]<span class="op">==</span>psp[<span class="st">'substrate'</span>].<span class="bu">str</span>.upper()]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Drop sites with center aa not in S,T or Y</p>
<div id="ad03e676" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>psp[<span class="st">'site_seq'</span>].<span class="bu">str</span>[<span class="dv">7</span>].value_counts()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>site_seq
S    8303
T    2812
Y    2029
H       6
K       4
R       2
Name: count, dtype: int64</code></pre>
</div>
</div>
<div id="0be19c77" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>psp <span class="op">=</span> psp[psp[<span class="st">'site_seq'</span>].<span class="bu">str</span>[<span class="dv">7</span>].<span class="bu">str</span>.upper().isin(<span class="bu">list</span>(<span class="st">'STY'</span>))]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Drop site with unmatched residue and position</p>
<div id="2dc74bdc" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>psp[<span class="st">'site_match'</span>] <span class="op">=</span>validate_site_df(psp,<span class="st">'site'</span>,<span class="st">'substrate_sequence'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="60951766" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>psp[<span class="st">'site_match'</span>].value_counts()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>site_match
1    13144
Name: count, dtype: int64</code></pre>
</div>
</div>
<div id="f39a5630" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>psp.shape</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>(13144, 11)</code></pre>
</div>
</div>
</section>
<section id="save-1" class="level3">
<h3 class="anchored" data-anchor-id="save-1">Save</h3>
<div id="bcd43ca7" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>psp[<span class="st">'source'</span>]<span class="op">=</span><span class="st">'PSP'</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="61760e56" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>psp.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">kinase_uniprot</th>
<th data-quarto-table-cell-role="th">kinase_genes</th>
<th data-quarto-table-cell-role="th">kinase_paper</th>
<th data-quarto-table-cell-role="th">substrate_uniprot</th>
<th data-quarto-table-cell-role="th">substrate_genes</th>
<th data-quarto-table-cell-role="th">site</th>
<th data-quarto-table-cell-role="th">substrate_sequence</th>
<th data-quarto-table-cell-role="th">substrate</th>
<th data-quarto-table-cell-role="th">substrate_species</th>
<th data-quarto-table-cell-role="th">site_seq</th>
<th data-quarto-table-cell-role="th">site_match</th>
<th data-quarto-table-cell-role="th">source</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>Q92630</td>
<td>DYRK2</td>
<td>DYRK2</td>
<td>O43255</td>
<td>SIAH2</td>
<td>S68</td>
<td>MSRPSSTGPSANKPCSKQPPPQPQHTPSPAAPPAAATISAAGPGSS...</td>
<td>GGGAGPVsPQHHELT</td>
<td>Homo sapiens (Human)</td>
<td>GGGAGPVSPQHHELT</td>
<td>1</td>
<td>PSP</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>Q92630</td>
<td>DYRK2</td>
<td>DYRK2</td>
<td>Q9Y2V2</td>
<td>CARHSP1</td>
<td>S41</td>
<td>MSSEPPPPPQPPTHQASVGLLDTPRSRERSPSPLRGNVVPSPLPTR...</td>
<td>LRGNVVPsPLPtRRt</td>
<td>Homo sapiens (Human)</td>
<td>LRGNVVPSPLPTRRT</td>
<td>1</td>
<td>PSP</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">3</th>
<td>Q92630</td>
<td>DYRK2</td>
<td>DYRK2</td>
<td>P30304</td>
<td>CDC25A</td>
<td>S283</td>
<td>MELGPEPPHRRRLLFACSPPPASQPVVKALFGASAAGGLSPVTNLT...</td>
<td>PErsQEEsPPGSTKr</td>
<td>Homo sapiens (Human)</td>
<td>PERSQEESPPGSTKR</td>
<td>1</td>
<td>PSP</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">4</th>
<td>Q92630</td>
<td>DYRK2</td>
<td>DYRK2</td>
<td>O43255</td>
<td>SIAH2</td>
<td>T119</td>
<td>MSRPSSTGPSANKPCSKQPPPQPQHTPSPAAPPAAATISAAGPGSS...</td>
<td>PTCRGALtPSIRNLA</td>
<td>Homo sapiens (Human)</td>
<td>PTCRGALTPSIRNLA</td>
<td>1</td>
<td>PSP</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">5</th>
<td>Q92630</td>
<td>DYRK2</td>
<td>DYRK2</td>
<td>O75449</td>
<td>KATNA1</td>
<td>S42</td>
<td>MSLLMISENVKLAREYALLGNYDSAMVYYQGVLDQMNKYLYSVKDT...</td>
<td>QMNKYLYsVkDTYLQ</td>
<td>Homo sapiens (Human)</td>
<td>QMNKYLYSVKDTYLQ</td>
<td>1</td>
<td>PSP</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cb042821" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># psp.to_excel('raw/psp_human.xlsx',index=False)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="kinet-espd-iptmnet" class="level2">
<h2 class="anchored" data-anchor-id="kinet-espd-iptmnet">KiNET (ESPD + iPTMNet)</h2>
<blockquote class="blockquote">
<p>an integration of PSP, iPTMNet, EPSD</p>
</blockquote>
<section id="data-2" class="level3">
<h3 class="anchored" data-anchor-id="data-2">Data</h3>
<p>KiNET paper: https://www.nature.com/articles/s41540-024-00442-5</p>
<p>KiNET web: https://kinet.kinametrix.com/</p>
<p>iPTMnet paper: https://pmc.ncbi.nlm.nih.gov/articles/PMC5753337/;</p>
<p>iPTMnet web: https://research.bioinformatics.udel.edu/iptmnet/ ; can’t directly download through Download</p>
<p>EPSD paper: https://academic.oup.com/bib/article/22/1/298/5686325?login=false</p>
<p>EPSD web: https://epsd.biocuckoo.cn/Download.php</p>
<p>Go to https://kinet.kinametrix.com/, and click Download the full KiNet interaction dataset</p>
<div id="f8d10415" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'raw/ksi_source_full_dataset.csv'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="fbaa40ae" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.dropna(subset<span class="op">=</span><span class="st">'Kinase'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="ea20e0ef" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Source Database'</span>].value_counts()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>Source Database
PhosphoSitePlus    13135
EPSD               10442
iPTMNet             3846
Name: count, dtype: int64</code></pre>
</div>
</div>
<p>As we already included PSP, we will drop it</p>
<div id="fb990f7a" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df[df[<span class="st">'Source Database'</span>]<span class="op">!=</span><span class="st">'PhosphoSitePlus'</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="1591ee59" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>df.shape</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>(14288, 8)</code></pre>
</div>
</div>
</section>
<section id="kinase-mapping-2" class="level3">
<h3 class="anchored" data-anchor-id="kinase-mapping-2">Kinase mapping</h3>
<div id="f95346f9" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>df.Kinase.isin(kinase_uniprot.Entry).value_counts()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>Kinase
True     14283
False        5
Name: count, dtype: int64</code></pre>
</div>
</div>
<div id="5e4b455b" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df[df.Kinase.isin(kinase_uniprot.Entry)]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="substrate-mapping-2" class="level3">
<h3 class="anchored" data-anchor-id="substrate-mapping-2">Substrate mapping</h3>
<div id="82dfa5c7" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># df.Substrate.drop_duplicates().to_csv('raw/KiNet_substrate_id.csv')</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Map the id to uniprot seq</p>
<div id="8c016085" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> map_substrate(<span class="st">'raw/idmapping_2025_03_02_KiNET_substrate.xlsx'</span>,df,<span class="st">'Substrate'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/sky1ove/miniconda3/lib/python3.13/site-packages/logomaker/../openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Shape before processing (14283, 8)
Species counts: substrate_species
Homo sapiens (Human)    14283
Name: count, dtype: int64
Removing non-human substrates
Shape after processing (14283, 11)</code></pre>
</div>
</div>
<div id="c30905ed" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># substrate_id = pd.read_excel('raw/idmapping_2025_03_02_KiNET_substrate.xlsx')[['From','Entry','Gene Names','Sequence']]</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="co"># substrate_id.columns = ['Substrate','substrate_uniprot','substrate_genes','substrate_sequence']</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a><span class="co"># df = df.merge(substrate_id)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="e64926ff" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df[[<span class="st">'Kinase'</span>,<span class="st">'Kinase Name'</span>,<span class="st">'substrate_uniprot'</span>,<span class="st">'substrate_genes'</span>,<span class="st">'Site'</span>,<span class="st">'Source Database'</span>,<span class="st">'Evidence'</span>,<span class="st">'substrate_sequence'</span>]]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="a30acab5" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>df.columns</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>Index(['Kinase', 'Kinase Name', 'substrate_uniprot', 'substrate_genes', 'Site',
       'Source Database', 'Evidence', 'substrate_sequence'],
      dtype='object')</code></pre>
</div>
</div>
<div id="3f56309b" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>df.columns <span class="op">=</span> [<span class="st">'kinase_uniprot'</span>, <span class="st">'Kinase Name'</span>, <span class="st">'substrate_uniprot'</span>, <span class="st">'substrate_genes'</span>, <span class="st">'site'</span>,</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>       <span class="st">'source'</span>, <span class="st">'evidence'</span>, <span class="st">'substrate_sequence'</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="e1196d58" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>df.shape</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>(14283, 8)</code></pre>
</div>
</div>
</section>
<section id="validate-site-2" class="level3">
<h3 class="anchored" data-anchor-id="validate-site-2">Validate site</h3>
<p>We drop site with site residue info unmatch with its site position info in the protein sequence</p>
<div id="bae6e355" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'site_match'</span>] <span class="op">=</span>validate_site_df(df,<span class="st">'site'</span>,<span class="st">'substrate_sequence'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="8a7484b0" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb109"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>df.site_match.value_counts()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>site_match
1    13786
0      497
Name: count, dtype: int64</code></pre>
</div>
</div>
<div id="e6890415" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb111"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>df[df.site_match<span class="op">==</span><span class="dv">0</span>].source.value_counts()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>source
iPTMNet    368
EPSD       129
Name: count, dtype: int64</code></pre>
</div>
</div>
<div id="e81d4b0c" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>df[df.site_match<span class="op">==</span><span class="dv">1</span>].source.value_counts()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>source
EPSD       10308
iPTMNet     3478
Name: count, dtype: int64</code></pre>
</div>
</div>
<div id="3c36c079" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>df[df.site_match<span class="op">==</span><span class="dv">1</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="0d5e95f4" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb116"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>df.shape</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>(13786, 9)</code></pre>
</div>
</div>
</section>
<section id="save-2" class="level3">
<h3 class="anchored" data-anchor-id="save-2">Save</h3>
<div id="5a0a0e57" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb118"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>df.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">kinase_uniprot</th>
<th data-quarto-table-cell-role="th">Kinase Name</th>
<th data-quarto-table-cell-role="th">substrate_uniprot</th>
<th data-quarto-table-cell-role="th">substrate_genes</th>
<th data-quarto-table-cell-role="th">site</th>
<th data-quarto-table-cell-role="th">source</th>
<th data-quarto-table-cell-role="th">evidence</th>
<th data-quarto-table-cell-role="th">substrate_sequence</th>
<th data-quarto-table-cell-role="th">site_match</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>O00141</td>
<td>SGK1</td>
<td>O00213</td>
<td>APBB1 FE65 RIR</td>
<td>S610</td>
<td>EPSD</td>
<td>Unspecified experimental method</td>
<td>MSVPSSLSQSAINANSHGGPALSLPLPLHAAHNQLLNAKLQATAVG...</td>
<td>1</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>O00141</td>
<td>SGK1</td>
<td>O14920</td>
<td>IKBKB IKKB</td>
<td>S181</td>
<td>EPSD</td>
<td>Unspecified experimental method</td>
<td>MSWSPSLTTQTCGAWEMKERLGTGGFGNVIRWHNQETGEQIAIKQC...</td>
<td>1</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>O00141</td>
<td>SGK1</td>
<td>O15111</td>
<td>CHUK IKKA TCF16</td>
<td>S180</td>
<td>EPSD</td>
<td>Unspecified experimental method</td>
<td>MERPPGLRPGAGGPWEMRERLGTGGFGNVCLYQHRELDLKIAIKSC...</td>
<td>1</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>O00141</td>
<td>SGK1</td>
<td>O43524</td>
<td>FOXO3 FKHRL1 FOXO3A</td>
<td>T32</td>
<td>EPSD</td>
<td>Unspecified experimental method</td>
<td>MAEAPASPAPLSPLEVELDPEFEPQSRPRSCTWPLQRPELQASPAK...</td>
<td>1</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>O00141</td>
<td>SGK1</td>
<td>O43524</td>
<td>FOXO3 FKHRL1 FOXO3A</td>
<td>T32</td>
<td>iPTMNet</td>
<td>Text mining</td>
<td>MAEAPASPAPLSPLEVELDPEFEPQSRPRSCTWPLQRPELQASPAK...</td>
<td>1</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="9d330616" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb119"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># df.to_excel('raw/KiNet.xlsx',index=False)</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="co"># df[df['source'] =='EPSD'].to_excel('raw/EPSD.xlsx',index=False)</span></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a><span class="co"># df[df['source'] =='iPTMNet'].to_excel('raw/iPTMNet.xlsx',index=False)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="phospho.elm" class="level2">
<h2 class="anchored" data-anchor-id="phospho.elm">Phospho.ELM</h2>
<section id="data-3" class="level3">
<h3 class="anchored" data-anchor-id="data-3">Data</h3>
<p>paper: https://pmc.ncbi.nlm.nih.gov/articles/PMC3013696/</p>
<p>Go to http://phospho.elm.eu.org/dataset.html, fill info–&gt;accept, then download the dataset</p>
<p>Open dump in excel, filter human and non-blank from kinases</p>
<div id="a1b8e886" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb120"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>elm<span class="op">=</span>pd.read_csv(<span class="st">'raw/phosphoELM.csv'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="a7f0c1c6" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>elm.shape</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>(3599, 6)</code></pre>
</div>
</div>
<div id="bfe2cc44" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb123"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>elm.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">substrate_uniprot</th>
<th data-quarto-table-cell-role="th">position</th>
<th data-quarto-table-cell-role="th">acceptor</th>
<th data-quarto-table-cell-role="th">kinase</th>
<th data-quarto-table-cell-role="th">LTP_HTP</th>
<th data-quarto-table-cell-role="th">species</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>O14543</td>
<td>204</td>
<td>Y</td>
<td>Lck</td>
<td>LTP</td>
<td>Homo sapiens</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>O14543</td>
<td>221</td>
<td>Y</td>
<td>Lck</td>
<td>LTP</td>
<td>Homo sapiens</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>O14746</td>
<td>824</td>
<td>S</td>
<td>PKB_group</td>
<td>LTP</td>
<td>Homo sapiens</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>O14746</td>
<td>227</td>
<td>S</td>
<td>PKB_group</td>
<td>LTP</td>
<td>Homo sapiens</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>O14746</td>
<td>707</td>
<td>Y</td>
<td>SRC</td>
<td>LTP</td>
<td>Homo sapiens</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="ff135ed6" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb124"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>elm.kinase <span class="op">=</span> elm.kinase.<span class="bu">str</span>.upper()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="kinase-mapping-3" class="level3">
<h3 class="anchored" data-anchor-id="kinase-mapping-3">Kinase mapping</h3>
<div id="1af959c1" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb125"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># kinase_id = pd.read_excel('raw/uniprot_human_keyword_kinase.xlsx')</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>kinase_id <span class="op">=</span> Data.get_kinase_uniprot()</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>kinase_id[<span class="st">'Gene Names'</span>] <span class="op">=</span> kinase_id[<span class="st">'Gene Names'</span>].<span class="bu">str</span>.split(<span class="st">' '</span>)</span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>kinase_id <span class="op">=</span> kinase_id.explode(<span class="st">'Gene Names'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="60a855ee" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb126"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>gene2uniprot <span class="op">=</span> kinase_id.set_index(<span class="st">'Gene Names'</span>)[<span class="st">'Entry'</span>].to_dict()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="b35725e1" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb127"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>dup_name <span class="op">=</span> <span class="bu">set</span>(kinase_id[kinase_id[<span class="st">'Gene Names'</span>].duplicated(keep<span class="op">=</span><span class="va">False</span>)][<span class="st">'Gene Names'</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="4aeaa34f" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb128"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>dup_name.remove(<span class="st">'PAK1'</span>)</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>dup_name.remove(<span class="st">'PASK'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="fd9a9675" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb129"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>gene2uniprot[<span class="st">'PAK1'</span>] <span class="op">=</span> <span class="st">'Q13153'</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>gene2uniprot[<span class="st">'PASK'</span>]<span class="op">=</span><span class="st">'Q96RG2'</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="2ed0c06a" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb130"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>elm <span class="op">=</span> elm[<span class="op">~</span>elm.kinase.isin(dup_name)].copy()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="38c10b85" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb131"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>elm[<span class="op">~</span>elm.kinase.isin(gene2uniprot.keys())].kinase.unique()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>array(['PKB_GROUP', 'IKK_GROUP', 'AURORA B', 'PDK-1', 'PKC_THETA',
       'SGK_GROUP', 'IKK_BETA', 'CDK_GROUP', 'CAM-KII_ALPHA', 'PKC_GROUP',
       'PKC_ALPHA', 'CK2_GROUP', 'CK2_ALPHA', 'GSK-3_GROUP',
       'GSK-3_ALPHA', 'GSK-3_BETA', 'PKA_GROUP', 'RSK_GROUP', 'PKB_BETA',
       'MAPK_GROUP', 'PAK_GROUP', 'DNA-PK', 'JNK_GROUP', 'CK1_GROUP',
       'AURORA A', 'P70S6KB', 'PKG/CGK_GROUP', 'PKC_DELTA', 'PDGFR_BETA',
       'CAM-KII_GROUP', 'GRK-2', 'GRK-5', 'GRK_GROUP', 'CK1_ALPHA',
       'PKC_EPSILON', 'ROCK_GROUP', 'PKG1/CGK-I', 'PDGFR_GROUP',
       'P70S6K_GROUP', 'P70S6K', 'PHK_GROUP', 'PKC_BETA', 'DMPK_GROUP',
       'CK1_DELTA', 'CK2_BETA', 'RSK-3', 'RSK-2', 'CAM-KIV', 'RSK-1',
       'IKK_ALPHA', 'CK1_EPSILON', 'MAP2K_GROUP', 'PIM-1', 'EG3 KINASE',
       'GRK-4', 'PKC_ZETA', 'PDKC', 'AMPK_GROUP', 'FGFR_GROUP',
       'JAK_GROUP', 'MAP3K_GROUP', 'RSK-5', 'IKK_EPSILON', 'CAM-KI_GROUP',
       'SRC_GROUP', 'PKA_ALPHA', 'PKC_ETA', 'PDK-2', 'GRK-6',
       'TITIN KINASE', 'CAM-KI_ALPHA', 'GRK-1', 'PDGFR_ALPHA', 'CCDPK',
       'MARK_GROUP', 'P38_GROUP', 'GRK-3', 'DAPK_GROUP', 'MRCKA',
       'PKG2/CGK-II', 'PKC_GAMMA', 'PKC_IOTA', 'CAM-KK_ALPHA'],
      dtype=object)</code></pre>
</div>
</div>
<p>map them to genes</p>
<div id="ebf75c38" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb133"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>ids <span class="op">=</span> pd.read_csv(<span class="st">'raw/elm_kinase_id.csv'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="a129cb1b" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb134"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>ids <span class="op">=</span> ids.set_index(<span class="st">'kinase'</span>)[<span class="st">'kinase_gene'</span>].to_dict()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="af7e36be" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb135"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>elm[<span class="st">'kinase_genes'</span>] <span class="op">=</span> elm.kinase.<span class="bu">map</span>(ids).fillna(elm.kinase)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="5e63bec1" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb136"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co"># for kinase group, we only consider the first two items</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>elm[<span class="st">'kinase_genes'</span>] <span class="op">=</span> elm.kinase_genes.<span class="bu">str</span>.split(<span class="st">' '</span>).<span class="bu">str</span>[:<span class="dv">2</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="2adf65c6" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb137"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>elm <span class="op">=</span> elm.explode(<span class="st">'kinase_genes'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="d7671a2e" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb138"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>elm[elm.kinase_genes.isin(dup_name)].kinase_genes.unique()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>array(['PRKACA'], dtype=object)</code></pre>
</div>
</div>
<div id="a9df6812" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb140"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>dup_name.remove(<span class="st">'PRKACA'</span>)</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>gene2uniprot[<span class="st">'PRKACA'</span>]<span class="op">=</span> <span class="st">'P17612'</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="5e69f3a2" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb141"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>elm[elm.kinase_genes.isin(dup_name)]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">substrate_uniprot</th>
<th data-quarto-table-cell-role="th">position</th>
<th data-quarto-table-cell-role="th">acceptor</th>
<th data-quarto-table-cell-role="th">kinase</th>
<th data-quarto-table-cell-role="th">LTP_HTP</th>
<th data-quarto-table-cell-role="th">species</th>
<th data-quarto-table-cell-role="th">kinase_genes</th>
</tr>
</thead>
<tbody>
</tbody>
</table>

</div>
</div>
</div>
<p>unmapped:</p>
<div id="e5bf9399" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb142"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>elm[elm.kinase_genes.<span class="bu">map</span>(gene2uniprot).isna()].kinase_genes.unique()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>array(['PHKA1', 'PHKA2', 'CSNK2B', 'CDPK1', 'CDPK2'], dtype=object)</code></pre>
</div>
</div>
<div id="7c836736" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb144"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>elm[<span class="st">'kinase_uniprot'</span>] <span class="op">=</span> elm.kinase_genes.<span class="bu">map</span>(gene2uniprot)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="659a513f" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb145"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>elm <span class="op">=</span> elm.dropna(subset<span class="op">=</span><span class="st">'kinase_uniprot'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="substrate-mapping-3" class="level3">
<h3 class="anchored" data-anchor-id="substrate-mapping-3">Substrate mapping</h3>
<div id="1d0e1202" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb146"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># elm.substrate_uniprot.drop_duplicates().to_csv('raw/elm_substrate_id.csv')</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>916 IDs were mapped to 919 results</p>
<p>10 ID were not mapped: ENSP00000328213 ENSP00000343690 ENSP00000352232 ENSP00000347528 ENSP00000357298 ENSP00000248996 ENSP00000357225 ENSP00000261937 ENSP00000248419 ENSP00000267569</p>
<p>Found two of the unmapped are kinases:</p>
<div id="d08e0b7d" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb147"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>ensp <span class="op">=</span> {<span class="st">'ENSP00000328213'</span>:<span class="st">'P06239'</span>,<span class="st">'ENSP00000261937'</span>:<span class="st">'P35916'</span>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="dc8fd6b4" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb148"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>elm.substrate_uniprot <span class="op">=</span> elm.substrate_uniprot.<span class="bu">map</span>(ensp).fillna(elm.substrate_uniprot)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="6df0d58a" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb149"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>elm <span class="op">=</span> map_substrate(<span class="st">'raw/idmapping_2025_03_12_elm.xlsx'</span>,elm,<span class="st">'substrate_uniprot'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Shape before processing (4699, 8)
Species counts: substrate_species
Homo sapiens (Human)    4675
Name: count, dtype: int64
Removing non-human substrates
Shape after processing (4675, 11)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/sky1ove/miniconda3/lib/python3.13/site-packages/logomaker/../openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")</code></pre>
</div>
</div>
<div id="bd31af9a" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb152"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>elm.shape</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>(4675, 11)</code></pre>
</div>
</div>
</section>
<section id="validate-site-3" class="level3">
<h3 class="anchored" data-anchor-id="validate-site-3">Validate site</h3>
<div id="f304a604" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb154"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>elm.acceptor.value_counts()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>acceptor
S    3018
T     908
Y     749
Name: count, dtype: int64</code></pre>
</div>
</div>
<div id="4a700415" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb156"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>elm[<span class="st">'site'</span>]<span class="op">=</span>elm[<span class="st">'acceptor'</span>]<span class="op">+</span>elm[<span class="st">'position'</span>].astype(<span class="bu">str</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="b8235a46" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb157"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>elm[<span class="st">'site_match'</span>] <span class="op">=</span>validate_site_df(elm,<span class="st">'site'</span>,<span class="st">'substrate_sequence'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="134ef585" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb158"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>elm.site_match.value_counts()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>site_match
1    4519
0     156
Name: count, dtype: int64</code></pre>
</div>
</div>
<div id="a497478d" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb160"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>elm <span class="op">=</span> elm[elm.site_match<span class="op">==</span><span class="dv">1</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="f208c1a8" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb161"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>elm.shape</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>(4519, 13)</code></pre>
</div>
</div>
</section>
<section id="save-3" class="level3">
<h3 class="anchored" data-anchor-id="save-3">Save</h3>
<div id="ff2e10cd" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb163"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>elm.columns</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>Index(['position', 'acceptor', 'kinase', 'LTP_HTP', 'species', 'kinase_genes',
       'kinase_uniprot', 'substrate_uniprot', 'substrate_genes',
       'substrate_sequence', 'substrate_species', 'site', 'site_match'],
      dtype='object')</code></pre>
</div>
</div>
<div id="1d428f8d" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb165"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>col <span class="op">=</span> [<span class="st">'kinase'</span>,<span class="st">'kinase_uniprot'</span>, <span class="st">'kinase_genes'</span>,</span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>       <span class="st">'substrate_uniprot'</span>, <span class="st">'substrate_genes'</span>,<span class="st">'site'</span>,<span class="st">'LTP_HTP'</span>, <span class="st">'species'</span>, </span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a>       <span class="st">'substrate_sequence'</span>,]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="6cdca5f7" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb166"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>elm <span class="op">=</span> elm[col]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="691934b4" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb167"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>elm[<span class="st">'source'</span>]<span class="op">=</span><span class="st">'ELM'</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="06e40d4d" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb168"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="co"># elm.to_excel('raw/ELM.xlsx',index=False)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="signor" class="level2">
<h2 class="anchored" data-anchor-id="signor">Signor</h2>
<section id="data-4" class="level3">
<h3 class="anchored" data-anchor-id="data-4">Data</h3>
<p>paper: https://academic.oup.com/nar/article/51/D1/D631/6761728</p>
<p>web: https://signor.uniroma2.it/</p>
<p>Go to web link, Downloads –&gt; Latest Release download (Jan 2025)</p>
<p>Open in excel, filter mechanism to be phosphorylation</p>
<div id="7b834861-627d-411d-8f8c-a7c9d7be4d8b" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb169"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> katlas.data <span class="im">import</span> <span class="op">*</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="092960a7" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb170"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>sig <span class="op">=</span> pd.read_excel(<span class="st">'raw/signor_phosphorylation.xlsx'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="fa1c0a79" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb171"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>sig.shape</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>(12973, 27)</code></pre>
</div>
</div>
</section>
<section id="kinase-mapping-4" class="level3">
<h3 class="anchored" data-anchor-id="kinase-mapping-4">Kinase mapping</h3>
<p>TYPEA column contains complex proteins, we need to filter out the kinase name</p>
<div id="c3e7af0a" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb173"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>comp <span class="op">=</span> sig[sig.TYPEA<span class="op">==</span><span class="st">'complex'</span>].copy()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="80efeb9a" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb174"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="co"># comp.ENTITYA.drop_duplicates().to_csv('raw/sig_complex.csv')</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="6e4a6415" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb175"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>comp_id <span class="op">=</span> pd.read_csv(<span class="st">'raw/sig_complex_label.csv'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="eee2be5f" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb176"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>comp_id <span class="op">=</span> comp_id.set_index(<span class="st">'ENTITYA'</span>)[<span class="st">'kinase_gene'</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="d03d5cc1" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb177"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>comp[<span class="st">'kinase_gene'</span>] <span class="op">=</span> comp.ENTITYA.<span class="bu">map</span>(comp_id)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="1748658c" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb178"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>comp <span class="op">=</span> comp.dropna(subset<span class="op">=</span><span class="st">'kinase_gene'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="10e6ba3a" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb179"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>comp.shape</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>(742, 28)</code></pre>
</div>
</div>
<p>Fusion proteins</p>
<div id="8c175285" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb181"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>fus_id <span class="op">=</span> {<span class="st">'BCR-ABL'</span>:<span class="st">'ABL1'</span>,<span class="st">'EML4-ALK'</span>:<span class="st">'ALK'</span>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="a7e35324" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb182"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>fus <span class="op">=</span> sig[sig.TYPEA<span class="op">==</span><span class="st">'fusion protein'</span>].copy()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="e4964b1c" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb183"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>fus[<span class="st">'kinase_gene'</span>] <span class="op">=</span> fus.ENTITYA.<span class="bu">map</span>(fus_id)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>For Protein family, we’ll make it apply to first two family members</p>
<div id="d8843f36" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb184"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>fam <span class="op">=</span> sig[sig.TYPEA<span class="op">==</span><span class="st">'proteinfamily'</span>].copy()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="e4e46d40" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb185"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fam.ENTITYA.drop_duplicates().to_csv('raw/sig_fam.csv')</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="a6458795" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb186"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>fam_id <span class="op">=</span> pd.read_csv(<span class="st">'raw/sig_fam_label.csv'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="ebc87af8" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb187"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>fam_id.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ENTITYA</th>
<th data-quarto-table-cell-role="th">kinase_gene</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>ERK1/2</td>
<td>MAPK3 MAPK1</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>AKT</td>
<td>AKT1 AKT2 AKT3</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>RPS6K</td>
<td>RPS6KB1 RPS6KB2</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>p38</td>
<td>MAPK14 MAPK11 MAPK12 MAPK13</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>JNK</td>
<td>MAPK8 MAPK9 MAPK10</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="c0f98349" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb188"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>fam_id <span class="op">=</span> fam_id.set_index(<span class="st">'ENTITYA'</span>)[<span class="st">'kinase_gene'</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="569a0e31" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb189"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a>fam[<span class="st">'kinase_gene'</span>] <span class="op">=</span> fam.ENTITYA.<span class="bu">map</span>(fam_id)</span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a>fam <span class="op">=</span> fam.dropna(subset<span class="op">=</span><span class="st">'kinase_gene'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="adedbdcc" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb190"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>fam[<span class="st">'kinase_gene'</span>] <span class="op">=</span> fam.kinase_gene.<span class="bu">str</span>.split(<span class="st">' '</span>).<span class="bu">str</span>[:<span class="dv">2</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="7d617a6f" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb191"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a>fam <span class="op">=</span> fam.explode(<span class="st">'kinase_gene'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Protein:</p>
<div id="59a67f05" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb192"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>pro <span class="op">=</span> sig[sig.TYPEA<span class="op">==</span><span class="st">'protein'</span>].copy()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>for consistency:</p>
<div id="93924b10" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb193"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a>pro[<span class="st">'kinase_gene'</span>] <span class="op">=</span> pro[<span class="st">'ENTITYA'</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>combine:</p>
<div id="e41d375c" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb194"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.concat([pro,comp,fus,fam])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Mapping:</p>
<div id="b1b8e23d" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb195"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="co"># kinase_id = pd.read_excel('raw/uniprot_human_keyword_kinase.xlsx')</span></span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>kinase_id <span class="op">=</span>Data.get_kinase_uniprot()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="60de6401" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb196"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>kinase_id[<span class="st">'Gene Names'</span>] <span class="op">=</span> kinase_id[<span class="st">'Gene Names'</span>].<span class="bu">str</span>.split(<span class="st">' '</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="59460859" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb197"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a>kinase_id <span class="op">=</span> kinase_id.explode(<span class="st">'Gene Names'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Some kinases share same gene names:</p>
<div id="13fcfca2" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb198"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="co"># kinase_id[kinase_id['Gene Names'].duplicated(keep=False)].sort_values('Gene Names').head()</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We’ll drop them to prevent confusion.</p>
<div id="9b391a21" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb199"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a>dup_name <span class="op">=</span> <span class="bu">set</span>(kinase_id[kinase_id[<span class="st">'Gene Names'</span>].duplicated(keep<span class="op">=</span><span class="va">False</span>)][<span class="st">'Gene Names'</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="0f873e1f" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb200"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a>df.kinase_gene.isin(dup_name).<span class="bu">sum</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>np.int64(674)</code></pre>
</div>
</div>
<div id="88cf0a39" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb202"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df[<span class="op">~</span>df.kinase_gene.isin(dup_name)].copy()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="7cf842d6" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb203"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>gene2uniprot <span class="op">=</span> kinase_id.set_index(<span class="st">'Gene Names'</span>)[<span class="st">'Entry'</span>].to_dict()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="4b787370" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb204"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a>df.shape</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>(13013, 28)</code></pre>
</div>
</div>
<p>unmapped:</p>
<div id="465eda2e" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb206"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a>df[df.kinase_gene.<span class="bu">str</span>.upper().<span class="bu">map</span>(gene2uniprot).isna()].kinase_gene.unique()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>array(['HRAS', 'IL4R', 'CSNK2B', 'TLR4', 'IL6R', 'THAP12', 'PRKAR2A',
       'RHOA', 'AREG', 'RET/PTC2', 'PCSK7', 'CCNC', 'TGM2', 'SLC12A1',
       'RALA', 'IL6ST', 'CRK', 'SMAD9', 'PLCG1', 'ELOC', 'PPP2CA', 'CCR5',
       'GHR', 'CAD', 'SMO', 'FRS2', 'LEPR', 'BLVRA', 'TAB1', 'PRKAB1',
       'PIAS4', 'IFNAR1', 'HSP90AA1', 'PTPRJ', 'PRKAG2', 'CSN1S1',
       'GTF2F1', 'VASP', 'KRAS', 'SLC12A3', 'PRPF4B', 'CDKN2A', 'IL1R1',
       'PRKAR2B', 'IL15RA', 'KRT1', 'SMAD1', 'GTF2H1', 'CCR2', 'IL5RA',
       'PLCG2', 'SLC12A2', 'GTF2H2', 'TMIGD2', 'IKBKG', 'BORA', 'MNAT1',
       'PHKA1', 'BGLF4', 'RIN1', 'DLG1', 'CDK5RAP2', 'CCR1', 'IL10RA',
       'SMAD5', 'CCN4'], dtype=object)</code></pre>
</div>
</div>
<div id="56d1c906" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb208"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'kinase_uniprot'</span>] <span class="op">=</span> df.kinase_gene.<span class="bu">str</span>.upper().<span class="bu">map</span>(gene2uniprot)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="830830a9" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb209"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.dropna(subset<span class="op">=</span><span class="st">'kinase_uniprot'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="substrate-mapping-4" class="level3">
<h3 class="anchored" data-anchor-id="substrate-mapping-4">Substrate mapping</h3>
<div id="8bdded95" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb210"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.dropna(subset<span class="op">=</span><span class="st">'IDB'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We can’t trace the specific whole protein sequence based on SIGNOR ID, so we filter them out</p>
<div id="4a5a9707" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb211"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df[<span class="op">~</span>df.IDB.<span class="bu">str</span>.contains(<span class="st">'SIGNOR'</span>)]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="d3824a7b" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb212"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="co"># df.IDB.drop_duplicates().to_csv('raw/sig_substrate_id.csv')</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>2,298 IDs were mapped to 2,298 results</p>
<p>1 ID was not mapped: CHEBI:15721</p>
<p>Sequences are all from human</p>
<div id="5c227222" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb213"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> map_substrate(<span class="st">'raw/idmapping_2025_03_12_signor.xlsx'</span>,df,<span class="st">'IDB'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/sky1ove/miniconda3/lib/python3.13/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Shape before processing (12354, 29)
Species counts: substrate_species
Homo sapiens (Human)    12353
Name: count, dtype: int64
Removing non-human substrates
Shape after processing (12353, 32)</code></pre>
</div>
</div>
<div id="70bfaba4" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb216"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a>df.shape</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>(12353, 32)</code></pre>
</div>
</div>
</section>
<section id="validate-site-4" class="level3">
<h3 class="anchored" data-anchor-id="validate-site-4">Validate site</h3>
<div id="4d663a68" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb218"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a>df.RESIDUE <span class="op">=</span> df.RESIDUE.<span class="bu">str</span>.split(<span class="st">';'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="6673a8e5" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb219"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.explode(<span class="st">'RESIDUE'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="2bf73a33" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb220"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'acceptor'</span>] <span class="op">=</span> df[<span class="st">'RESIDUE'</span>].<span class="bu">str</span>[:<span class="dv">3</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="ef274c95" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb221"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a>df.acceptor <span class="op">=</span> df.acceptor.<span class="bu">map</span>({<span class="st">'Ser'</span>:<span class="st">'S'</span>,<span class="st">'Thr'</span>:<span class="st">'T'</span>,<span class="st">'Tyr'</span>:<span class="st">'Y'</span>})</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="be3b5e2e" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb222"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'position'</span>] <span class="op">=</span> df[<span class="st">'RESIDUE'</span>].<span class="bu">str</span>[<span class="dv">3</span>:]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cb09c2aa" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb223"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'site'</span>]<span class="op">=</span>df[<span class="st">'acceptor'</span>]<span class="op">+</span>df[<span class="st">'position'</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="3d6afb60" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb224"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.dropna(subset<span class="op">=</span><span class="st">'site'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="f7422e54-928b-42d6-b77a-6a151382586d" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb225"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> katlas.utils <span class="im">import</span> <span class="op">*</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="84adac4a" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb226"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'site_match'</span>] <span class="op">=</span>validate_site_df(df,<span class="st">'site'</span>,<span class="st">'substrate_sequence'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="e9742c57" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb227"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a>df.site_match.value_counts()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>site_match
1    11212
0      118
Name: count, dtype: int64</code></pre>
</div>
</div>
<div id="2ab322fb" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb229"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df[df.site_match<span class="op">==</span><span class="dv">1</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="521d1b2f" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb230"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a>df.shape</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>(11212, 36)</code></pre>
</div>
</div>
</section>
<section id="save-4" class="level3">
<h3 class="anchored" data-anchor-id="save-4">Save</h3>
<div id="ed5e3436" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb232"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a>df.columns</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>Index(['ENTITYA', 'TYPEA', 'IDA', 'DATABASEA', 'ENTITYB', 'TYPEB', 'DATABASEB',
       'EFFECT', 'MECHANISM', 'RESIDUE', 'SEQUENCE', 'TAX_ID', 'CELL_DATA',
       'TISSUE_DATA', 'MODULATOR_COMPLEX', 'TARGET_COMPLEX', 'MODIFICATIONA',
       'MODASEQ', 'MODIFICATIONB', 'MODBSEQ', 'PMID', 'DIRECT', 'NOTES',
       'ANNOTATOR', 'SENTENCE', 'SIGNOR_ID', 'kinase_gene', 'kinase_uniprot',
       'substrate_uniprot', 'substrate_genes', 'substrate_sequence',
       'substrate_species', 'acceptor', 'position', 'site', 'site_match'],
      dtype='object')</code></pre>
</div>
</div>
<div id="cda59a2c" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb234"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a>col <span class="op">=</span> [<span class="st">'kinase_uniprot'</span>, <span class="st">'kinase_gene'</span>, <span class="st">'ENTITYA'</span>, <span class="st">'TYPEA'</span>, </span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true" tabindex="-1"></a>       <span class="st">'substrate_uniprot'</span>, <span class="st">'substrate_genes'</span>,<span class="st">'site'</span>, <span class="st">'substrate_sequence'</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="e1346e99" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb235"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df[col].copy()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="94ad0b86" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb236"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a>df.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">kinase_uniprot</th>
<th data-quarto-table-cell-role="th">kinase_gene</th>
<th data-quarto-table-cell-role="th">ENTITYA</th>
<th data-quarto-table-cell-role="th">TYPEA</th>
<th data-quarto-table-cell-role="th">substrate_uniprot</th>
<th data-quarto-table-cell-role="th">substrate_genes</th>
<th data-quarto-table-cell-role="th">site</th>
<th data-quarto-table-cell-role="th">substrate_sequence</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>P68400</td>
<td>CSNK2A1</td>
<td>CSNK2A1</td>
<td>protein</td>
<td>P05455</td>
<td>SSB</td>
<td>S366</td>
<td>MAENGDNEKMAALEAKICHQIEYYFGDFNLPRDKFLKEQIKLDEGW...</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>P28482</td>
<td>MAPK1</td>
<td>MAPK1</td>
<td>protein</td>
<td>P43354</td>
<td>NR4A2 NOT NURR1 TINUR</td>
<td>S126</td>
<td>MPCVQAQYGSSPQGASPASQSYSYHSSGEYSSDFLTPEFVKFSMDL...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>P11362</td>
<td>FGFR1</td>
<td>FGFR1</td>
<td>protein</td>
<td>P56945</td>
<td>BCAR1 CAS CASS1 CRKAS</td>
<td>Y128</td>
<td>MNHLNVLAKALYDNVAESPDELSFRKGDIMTVLEQDTQGLDGWWLC...</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>P27361</td>
<td>MAPK3</td>
<td>MAPK3</td>
<td>protein</td>
<td>P41182</td>
<td>BCL6 BCL5 LAZ3 ZBTB27 ZNF51</td>
<td>S343</td>
<td>MASPADSCIQFTRHASDVLLNLNRLRSRDILTDVVIVVSREQFRAH...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>Q16539</td>
<td>MAPK14</td>
<td>MAPK14</td>
<td>protein</td>
<td>Q02078</td>
<td>MEF2A MEF2</td>
<td>S408</td>
<td>MGRKKIQITRIMDERNRQVTFTKRKFGLMKKAYELSVLCDCEIALI...</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="46b29033" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb237"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a>df.shape</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>(11212, 8)</code></pre>
</div>
</div>
<div id="bbd76a41" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb239"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'source'</span>]<span class="op">=</span><span class="st">"SIGNOR"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cc275de8" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb240"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="co"># df.to_excel('raw/signor.xlsx',index=False)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="gps-6.0" class="level2">
<h2 class="anchored" data-anchor-id="gps-6.0">GPS 6.0</h2>
<section id="data-5" class="level3">
<h3 class="anchored" data-anchor-id="data-5">Data</h3>
<p>paper: https://academic.oup.com/nar/article/51/W1/W243/7157529#409532969</p>
<p>web: https://gps.biocuckoo.cn/index.php</p>
<p>Go to paper link, download supplementary data - zip file, get Table S5</p>
<div id="85b87eed" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb241"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="d42274ab" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb242"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a>gps <span class="op">=</span> pd.read_csv(<span class="st">'raw/GPS6_tableS5.csv'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="1085ffc6" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb243"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a>gps <span class="op">=</span> gps[gps.source<span class="op">!=</span><span class="st">"PhosphositePlus"</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="36a6736b" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb244"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a>gps <span class="op">=</span> gps[gps.species<span class="op">==</span><span class="st">"Homo sapiens"</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="f66c8e87" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb245"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a>gps.shape</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>(6087, 6)</code></pre>
</div>
</div>
<div id="e2ee0a9e" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb247"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a>gps <span class="op">=</span> gps[<span class="op">~</span>gps.gene.<span class="bu">str</span>.contains(<span class="st">'family'</span>)]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="kinase-mapping-5" class="level3">
<h3 class="anchored" data-anchor-id="kinase-mapping-5">Kinase mapping</h3>
<div id="405ffa36-5673-4222-b13a-afa825390ff7" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb248"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> katlas.data <span class="im">import</span> <span class="op">*</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="352aa956" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb249"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="co"># kinase_id = pd.read_excel('raw/uniprot_human_keyword_kinase.xlsx')</span></span>
<span id="cb249-2"><a href="#cb249-2" aria-hidden="true" tabindex="-1"></a>kinase_id <span class="op">=</span> Data.get_kinase_uniprot()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="1d96d9e9" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb250"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a>kinase_id[<span class="st">'Gene Names'</span>] <span class="op">=</span> kinase_id[<span class="st">'Gene Names'</span>].<span class="bu">str</span>.split(<span class="st">' '</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cc897f30" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb251"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a>kinase_id <span class="op">=</span> kinase_id.explode(<span class="st">'Gene Names'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Some kinases share same gene names:</p>
<div id="6f91b5e1" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb252"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a>kinase_id[kinase_id[<span class="st">'Gene Names'</span>].duplicated(keep<span class="op">=</span><span class="va">False</span>)].sort_values(<span class="st">'Gene Names'</span>).head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Entry</th>
<th data-quarto-table-cell-role="th">Entry Name</th>
<th data-quarto-table-cell-role="th">Protein names</th>
<th data-quarto-table-cell-role="th">Gene Names</th>
<th data-quarto-table-cell-role="th">uniprot_keyword_kinase</th>
<th data-quarto-table-cell-role="th">on_tree</th>
<th data-quarto-table-cell-role="th">Organism</th>
<th data-quarto-table-cell-role="th">Keywords</th>
<th data-quarto-table-cell-role="th">Sequence</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">586</th>
<td>Q9UIJ7</td>
<td>KAD3_HUMAN</td>
<td>GTP:AMP phosphotransferase AK3, mitochondrial ...</td>
<td>AK3</td>
<td>1</td>
<td>0</td>
<td>Homo sapiens (Human)</td>
<td>3D-structure;Acetylation;Alternative splicing;...</td>
<td>MGASARLLRAVIMGAPGSGKGTVSSRITTHFELKHLSSGDLLRDNM...</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">152</th>
<td>P27144</td>
<td>KAD4_HUMAN</td>
<td>Adenylate kinase 4, mitochondrial (EC 2.7.4.4)...</td>
<td>AK3</td>
<td>1</td>
<td>0</td>
<td>Homo sapiens (Human)</td>
<td>3D-structure;Acetylation;ATP-binding;GTP-bindi...</td>
<td>MASKLLRAVILGPPGSGKGTVCQRIAQNFGLQHLSSGHFLRENIKA...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">586</th>
<td>Q9UIJ7</td>
<td>KAD3_HUMAN</td>
<td>GTP:AMP phosphotransferase AK3, mitochondrial ...</td>
<td>AK3L1</td>
<td>1</td>
<td>0</td>
<td>Homo sapiens (Human)</td>
<td>3D-structure;Acetylation;Alternative splicing;...</td>
<td>MGASARLLRAVIMGAPGSGKGTVSSRITTHFELKHLSSGDLLRDNM...</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">152</th>
<td>P27144</td>
<td>KAD4_HUMAN</td>
<td>Adenylate kinase 4, mitochondrial (EC 2.7.4.4)...</td>
<td>AK3L1</td>
<td>1</td>
<td>0</td>
<td>Homo sapiens (Human)</td>
<td>3D-structure;Acetylation;ATP-binding;GTP-bindi...</td>
<td>MASKLLRAVILGPPGSGKGTVCQRIAQNFGLQHLSSGHFLRENIKA...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">609</th>
<td>Q9Y3D8</td>
<td>KAD6_HUMAN</td>
<td>Adenylate kinase isoenzyme 6 (AK6) (EC 2.7.4.3...</td>
<td>AK6</td>
<td>1</td>
<td>0</td>
<td>Homo sapiens (Human)</td>
<td>3D-structure;Alternative splicing;ATP-binding;...</td>
<td>MLLPNILLTGTPGVGKTTLGKELASKSGLKYINVGDLAREEQLYDG...</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>We’ll drop them to prevent confusion.</p>
<div id="59e2fb50" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb253"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a>dup_name <span class="op">=</span> <span class="bu">set</span>(kinase_id[kinase_id[<span class="st">'Gene Names'</span>].duplicated(keep<span class="op">=</span><span class="va">False</span>)][<span class="st">'Gene Names'</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="a34114de" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb254"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a>gps.gene.isin(dup_name).<span class="bu">sum</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>np.int64(76)</code></pre>
</div>
</div>
<div id="90a1d095" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb256"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a>gps.shape</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>(4260, 6)</code></pre>
</div>
</div>
<div id="a7aad368" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb258"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a>gps <span class="op">=</span> gps[<span class="op">~</span>gps.gene.isin(dup_name)].copy()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="8c84b92b" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb259"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a>gene2uniprot <span class="op">=</span> kinase_id.set_index(<span class="st">'Gene Names'</span>)[<span class="st">'Entry'</span>].to_dict()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="083352cf" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb260"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a>gps.shape</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>(4184, 6)</code></pre>
</div>
</div>
<p>unmapped:</p>
<div id="bcc6861c" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb262"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a>gps[gps.gene.<span class="bu">str</span>.upper().<span class="bu">map</span>(gene2uniprot).isna()].gene.unique()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>array(['DMPK1', 'MRCKa', 'YPKA', 'PKACb', 'PKCt', 'PKCh', 'PKCi', 'PKCz',
       'PKG1', 'PKG2', 'PRKG1 Isoform Alpha', 'p70S6K', 'p70S6Kb',
       'CCDPK', 'AMPKa1', 'PKD3', 'CK1d', 'CK1e', 'CK1g1', 'CSNK2B',
       'p38b', 'p38d', 'p38g', 'AurB', 'AurC', 'TP53RK ', 'STLK3',
       'PAK3 Isoform 2', 'TAO1', 'ACK'], dtype=object)</code></pre>
</div>
</div>
<div id="0143c582" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb264"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a>gps[<span class="st">'kinase_uniprot'</span>] <span class="op">=</span> gps.gene.<span class="bu">str</span>.upper().<span class="bu">map</span>(gene2uniprot)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="2b50553c" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb265"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a>gps <span class="op">=</span> gps.dropna(subset<span class="op">=</span><span class="st">'kinase_uniprot'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="substrate-mapping-5" class="level3">
<h3 class="anchored" data-anchor-id="substrate-mapping-5">Substrate mapping</h3>
<div id="7d0f3510" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb266"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gps.uniprot.drop_duplicates().to_csv('raw/GPS_substrate_id.csv')</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>1,203 IDs were mapped to 1,208 results</p>
<p>1,202 active entries and 1 obsolete entry are found</p>
<div id="0d8c2feb" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb267"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a>gps.shape</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>(3750, 7)</code></pre>
</div>
</div>
<div id="c5e40a7b" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb269"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a>gps <span class="op">=</span> map_substrate(<span class="st">'raw/idmapping_2025_03_12_GPS.xlsx'</span>,gps,<span class="st">'uniprot'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Shape before processing (3750, 7)
Species counts: substrate_species
Homo sapiens (Human)                                                                 3614
Rattus norvegicus (Rat)                                                                30
Mus musculus (Mouse)                                                                   19
Pongo abelii (Sumatran orangutan) (Pongo pygmaeus abelii)                              10
Pan troglodytes (Chimpanzee)                                                            6
Sus scrofa (Pig)                                                                        6
Bos taurus (Bovine)                                                                     5
Oryctolagus cuniculus (Rabbit)                                                          4
Macaca fascicularis (Crab-eating macaque) (Cynomolgus monkey)                           4
Mesocricetus auratus (Golden hamster)                                                   4
Tupaia belangeri (Common tree shrew) (Tupaia glis belangeri)                            2
Canis lupus familiaris (Dog) (Canis familiaris)                                         2
Phodopus roborovskii (Roborovski's desert hamster) (Cricetulus roborovskii)             2
Macaca mulatta (Rhesus macaque)                                                         2
Xenopus tropicalis (Western clawed frog) (Silurana tropicalis)                          2
Hylobates lar (Lar gibbon) (White-handed gibbon)                                        1
Cricetulus griseus (Chinese hamster) (Cricetulus barabensis griseus)                    1
Xenopus laevis (African clawed frog)                                                    1
Galeopterus variegatus (Malayan flying lemur) (Cynocephalus variegatus)                 1
Nannospalax galili (Northern Israeli blind subterranean mole rat) (Spalax galili)       1
Spermophilus citellus (European suslik) (Citellus citellus)                             1
Marmota monax (Woodchuck)                                                               1
Pan paniscus (Pygmy chimpanzee) (Bonobo)                                                1
Danio rerio (Zebrafish) (Brachydanio rerio)                                             1
Hepatitis delta virus genotype II (isolate 7/18/83) (HDV)                               1
Human T-cell leukemia virus 1 (strain Japan ATK-1 subtype A) (HTLV-1)                   1
Macaca fuscata fuscata (Japanese macaque)                                               1
Human T-cell leukemia virus 1 (isolate Caribbea HS-35 subtype A) (HTLV-1)               1
Human T-cell leukemia virus 1 (isolate Melanesia mel5 subtype C) (HTLV-1)               1
Ovis aries (Sheep)                                                                      1
Human immunodeficiency virus type 1 group M subtype B (isolate NY5) (HIV-1)             1
Human immunodeficiency virus type 2 subtype A (isolate BEN) (HIV-2)                     1
Human immunodeficiency virus type 1 group M subtype B (isolate YU-2) (HIV-1)            1
Human immunodeficiency virus type 1 group M subtype B (isolate WMJ22) (HIV-1)           1
Cavia porcellus (Guinea pig)                                                            1
Human immunodeficiency virus type 1 group M subtype A (isolate MAL) (HIV-1)             1
Human immunodeficiency virus type 1 group M subtype F2 (isolate MP257) (HIV-1)          1
Human immunodeficiency virus type 1 group M subtype B (isolate LW123) (HIV-1)           1
Human immunodeficiency virus type 1 group M subtype B (isolate JRCSF) (HIV-1)           1
Human immunodeficiency virus type 1 group M subtype B (isolate JH32) (HIV-1)            1
Human immunodeficiency virus type 1 group M subtype B (isolate HXB2) (HIV-1)            1
Human immunodeficiency virus type 1 group M subtype C (isolate ETH2220) (HIV-1)         1
Human immunodeficiency virus type 1 group M subtype D (isolate ELI) (HIV-1)             1
Human immunodeficiency virus type 1 group M subtype B (isolate CDC-451) (HIV-1)         1
Human immunodeficiency virus type 1 group O (isolate ANT70) (HIV-1)                     1
Human immunodeficiency virus type 1 group M subtype A (isolate U455) (HIV-1)            1
Human immunodeficiency virus type 2 subtype A (isolate KR) (HIV-2)                      1
Phodopus campbelli (Campbell's dwarf Russian hamster)                                   1
Human immunodeficiency virus type 2 subtype A (isolate ROD) (HIV-2)                     1
Human immunodeficiency virus type 1 group O (isolate MVP5180) (HIV-1)                   1
Felis catus (Cat) (Felis silvestris catus)                                              1
Name: count, dtype: int64
Removing non-human substrates
Shape after processing (3614, 10)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/sky1ove/miniconda3/lib/python3.13/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")</code></pre>
</div>
</div>
<div id="777c2a13" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb272"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a>gps.shape</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>(3614, 10)</code></pre>
</div>
</div>
</section>
<section id="validate-site-5" class="level3">
<h3 class="anchored" data-anchor-id="validate-site-5">Validate site</h3>
<div id="be180972-4f39-49da-b170-6b2cb129d388" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb274"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> katlas.utils <span class="im">import</span> <span class="op">*</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="ba26cfd9" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb275"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a>gps[<span class="st">'site'</span>]<span class="op">=</span>gps[<span class="st">'code'</span>] <span class="op">+</span> gps[<span class="st">'position'</span>].astype(<span class="bu">int</span>).astype(<span class="bu">str</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="df0a3a9d" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb276"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a>gps[<span class="st">'site_match'</span>] <span class="op">=</span>validate_site_df(gps,<span class="st">'site'</span>,<span class="st">'substrate_sequence'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="4412cc60" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb277"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a>gps[<span class="st">'site_match'</span>].value_counts()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>site_match
1    3435
0     179
Name: count, dtype: int64</code></pre>
</div>
</div>
<div id="997fcf53" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb279"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb279-1"><a href="#cb279-1" aria-hidden="true" tabindex="-1"></a>gps<span class="op">=</span>gps[gps.site_match<span class="op">==</span><span class="dv">1</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="2d10c1c0" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb280"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a>gps.shape</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>(3435, 12)</code></pre>
</div>
</div>
</section>
<section id="save-5" class="level3">
<h3 class="anchored" data-anchor-id="save-5">Save</h3>
<div id="98e1ff63" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb282"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a>gps.columns</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>Index(['position', 'code', 'gene', 'species', 'source', 'kinase_uniprot',
       'substrate_uniprot', 'substrate_genes', 'substrate_sequence',
       'substrate_species', 'site', 'site_match'],
      dtype='object')</code></pre>
</div>
</div>
<div id="01e44982" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb284"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a>gps <span class="op">=</span> gps.rename(columns<span class="op">=</span>{<span class="st">'source'</span>:<span class="st">'GPS_source'</span>})</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="685a50cb" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb285"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb285-1"><a href="#cb285-1" aria-hidden="true" tabindex="-1"></a>gps[<span class="st">'source'</span>]<span class="op">=</span><span class="st">'GPS6'</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="442b0e70" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb286"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a>col <span class="op">=</span> [<span class="st">'kinase_uniprot'</span>,<span class="st">'gene'</span>, </span>
<span id="cb286-2"><a href="#cb286-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-3"><a href="#cb286-3" aria-hidden="true" tabindex="-1"></a>       <span class="st">'substrate_uniprot'</span>, <span class="st">'substrate_genes'</span>, <span class="st">'site'</span>,<span class="st">'substrate_sequence'</span>, <span class="st">'GPS_source'</span>,<span class="st">'source'</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="e2f4a4ff" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb287"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a>gps <span class="op">=</span> gps[col].copy()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="dd3e465c" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb288"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true" tabindex="-1"></a>gps.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">kinase_uniprot</th>
<th data-quarto-table-cell-role="th">gene</th>
<th data-quarto-table-cell-role="th">substrate_uniprot</th>
<th data-quarto-table-cell-role="th">substrate_genes</th>
<th data-quarto-table-cell-role="th">site</th>
<th data-quarto-table-cell-role="th">substrate_sequence</th>
<th data-quarto-table-cell-role="th">GPS_source</th>
<th data-quarto-table-cell-role="th">source</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>P31749</td>
<td>AKT1</td>
<td>Q9Y261</td>
<td>FOXA2 HNF3B TCF3B</td>
<td>T156</td>
<td>MLGAVKMEGHEPSDWSSYYAEPEGYSSVSNMNAGLGMNGMNTYMSM...</td>
<td>14500912</td>
<td>GPS6</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>P31749</td>
<td>AKT1</td>
<td>P49760</td>
<td>CLK2</td>
<td>T127</td>
<td>MPHPRRYHSSERGSRGSYREHYRSRKHKRRRSRSWSSSSDRTRRRR...</td>
<td>UniProt</td>
<td>GPS6</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>P31749</td>
<td>AKT1</td>
<td>P49815</td>
<td>TSC2 TSC4</td>
<td>T1462</td>
<td>MAKPTSKDSGLKEKFKILLGLGTPRPNPRSAEGKQTEFIITAEILR...</td>
<td>12150915;15342917;12172553;UniProt</td>
<td>GPS6</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>P31749</td>
<td>AKT1</td>
<td>P46527</td>
<td>CDKN1B KIP1 p27</td>
<td>T187</td>
<td>MSNVRVSNGSPSLERMDARQAEHPKPSACRNLFGPVDHEELTRDLE...</td>
<td>12042314;9192873;9399644;9311993;9388487;17254...</td>
<td>GPS6</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>P31749</td>
<td>AKT1</td>
<td>O15111</td>
<td>CHUK IKKA TCF16</td>
<td>T23</td>
<td>MERPPGLRPGAGGPWEMRERLGTGGFGNVCLYQHRELDLKIAIKSC...</td>
<td>10485710;UniProt</td>
<td>GPS6</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="eaf90d38" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb289"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gps.to_excel('raw/GPS6.xlsx',index=False)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="other-datasets" class="level2">
<h2 class="anchored" data-anchor-id="other-datasets">Other datasets</h2>
<section id="douglass" class="level3">
<h3 class="anchored" data-anchor-id="douglass">Douglass</h3>
<p>Paper: https://journals.physiology.org/doi/full/10.1152/ajpcell.00166.2012</p>
<p>Data is not available to download, but available upon request to authors</p>
</section>
<section id="regphos-2.0" class="level3">
<h3 class="anchored" data-anchor-id="regphos-2.0">RegPhos 2.0</h3>
<p>Paper: https://academic.oup.com/database/article/doi/10.1093/database/bau034/2634150</p>
<p>Go to the paper link, scroll down to Supplementary data, download the zip file, docx file, table S4 is motif</p>
</section>
<section id="phosida" class="level3">
<h3 class="anchored" data-anchor-id="phosida">Phosida</h3>
<p>http://www.phosida.com/ is not accessible</p>
<p>Phosida paper: https://pmc.ncbi.nlm.nih.gov/articles/PMC2258193/</p>
</section>
<section id="phosphonetwork" class="level3">
<h3 class="anchored" data-anchor-id="phosphonetwork">PhosphoNetwork</h3>
<p>2013 bioinformatics: https://pmc.ncbi.nlm.nih.gov/articles/PMC3866559/#btt627-T1</p>
<p>2013 Mol Syst Biol.: https://pmc.ncbi.nlm.nih.gov/articles/PMC3658267/</p>
<p>web app: https://www.phosphonetworks.org/</p>
<p>The web app provides kinase-substrate pairs, but does not provides specific info of phosphorylation site.</p>
<p>It provides logo and pssm though in Download –&gt; Motif Matrix, which can be used to compare the PSSM result</p>
</section>
<section id="biogrid" class="level3">
<h3 class="anchored" data-anchor-id="biogrid">BioGRID</h3>
<p>Go to : https://downloads.thebiogrid.org/BioGRID, Current-Release–&gt;BIOGRID-PTMS-4.4.242.ptm.zip</p>
<p>There are two files in after extraction, however, they don’t contain kinase-substrate relationship.</p>
</section>
</section>
<section id="combine-all" class="level2">
<h2 class="anchored" data-anchor-id="combine-all">Combine all</h2>
<div id="527c0335" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb290"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb290-2"><a href="#cb290-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cf931bfc" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb291"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb291-1"><a href="#cb291-1" aria-hidden="true" tabindex="-1"></a>paths <span class="op">=</span> [</span>
<span id="cb291-2"><a href="#cb291-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'raw/GPS6.xlsx'</span>,</span>
<span id="cb291-3"><a href="#cb291-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'raw/signor.xlsx'</span>,</span>
<span id="cb291-4"><a href="#cb291-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'raw/ELM.xlsx'</span>,</span>
<span id="cb291-5"><a href="#cb291-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'raw/iPTMNet.xlsx'</span>,<span class="st">'raw/EPSD.xlsx'</span>,<span class="co"># 'raw/KiNet.xlsx',</span></span>
<span id="cb291-6"><a href="#cb291-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'raw/psp_human.xlsx'</span>,</span>
<span id="cb291-7"><a href="#cb291-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'raw/sugiyama.xlsx'</span></span>
<span id="cb291-8"><a href="#cb291-8" aria-hidden="true" tabindex="-1"></a>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="59aa01a3" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb292"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a>dfs <span class="op">=</span> [pd.read_excel(path) <span class="cf">for</span> path <span class="kw">in</span> paths]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="86f1b2a4-ce9d-4444-8388-e5d8680a60a5" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb293"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true" tabindex="-1"></a>[<span class="bu">print</span>(df.source.value_counts()) <span class="cf">for</span> df <span class="kw">in</span> dfs]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>source
GPS6    3435
Name: count, dtype: int64
source
SIGNOR    11212
Name: count, dtype: int64
source
ELM    4519
Name: count, dtype: int64
source
iPTMNet    3478
Name: count, dtype: int64
source
EPSD    10308
Name: count, dtype: int64
source
PSP    13144
Name: count, dtype: int64
source
Sugiyama    184948
Name: count, dtype: int64</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>[None, None, None, None, None, None, None]</code></pre>
</div>
</div>
<p>For each df, we need to drop duplicates of kinase(uniprot)-substrate(uniprot)-site</p>
<div id="fa779448" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb296"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_key(df):</span>
<span id="cb296-2"><a href="#cb296-2" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df.copy()</span>
<span id="cb296-3"><a href="#cb296-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'original shape:'</span>,df.shape)</span>
<span id="cb296-4"><a href="#cb296-4" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">'kin_sub_site'</span>]<span class="op">=</span>df[<span class="st">'kinase_uniprot'</span>]<span class="op">+</span><span class="st">'_'</span><span class="op">+</span>df[<span class="st">'substrate_uniprot'</span>]<span class="op">+</span><span class="st">'_'</span><span class="op">+</span>df[<span class="st">'site'</span>]</span>
<span id="cb296-5"><a href="#cb296-5" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df.drop_duplicates(subset<span class="op">=</span><span class="st">'kin_sub_site'</span>)</span>
<span id="cb296-6"><a href="#cb296-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'after removing duplicates'</span>,df.shape)</span>
<span id="cb296-7"><a href="#cb296-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="4622868e" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb297"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a>dfs<span class="op">=</span>[get_key(df) <span class="cf">for</span> df <span class="kw">in</span> dfs]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>original shape: (3435, 8)
after removing duplicates (3326, 9)
original shape: (11212, 9)
after removing duplicates (9320, 10)
original shape: (4519, 10)
after removing duplicates (3807, 11)
original shape: (3478, 9)
after removing duplicates (3478, 10)
original shape: (10308, 9)
after removing duplicates (10308, 10)
original shape: (13144, 13)
after removing duplicates (13091, 14)
original shape: (184948, 11)
after removing duplicates (168342, 12)</code></pre>
</div>
</div>
<div id="131363a6" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb299"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> path,df <span class="kw">in</span> <span class="bu">zip</span>(paths,dfs):</span>
<span id="cb299-2"><a href="#cb299-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(Path(path).stem, df.shape)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>GPS6 (3326, 9)
signor (9320, 10)
ELM (3807, 11)
iPTMNet (3478, 10)
EPSD (10308, 10)
psp_human (13091, 14)
sugiyama (168342, 12)</code></pre>
</div>
</div>
<div id="8ee19354" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb301"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a>common_cols <span class="op">=</span> [<span class="st">'kinase_uniprot'</span>,<span class="st">'substrate_uniprot'</span>,<span class="st">'site'</span>,<span class="st">'kin_sub_site'</span>,<span class="st">'source'</span>,<span class="st">'substrate_genes'</span>,<span class="st">'substrate_sequence'</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="67a91592" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb302"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true" tabindex="-1"></a>df_all <span class="op">=</span> pd.concat(dfs,ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb302-2"><a href="#cb302-2" aria-hidden="true" tabindex="-1"></a>df_all <span class="op">=</span> df_all[common_cols].copy()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="70754b75-ec0d-4470-9848-f0886dcb11e8" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb303"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a>df_all.source.value_counts()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>source
Sugiyama    168342
PSP          13091
EPSD         10308
SIGNOR        9320
ELM           3807
iPTMNet       3478
GPS6          3326
Name: count, dtype: int64</code></pre>
</div>
</div>
<div id="4e053283" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb305"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a><span class="co"># df_all.to_parquet('raw/combine_source.parquet')</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="f2e1e369" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb306"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb306-1"><a href="#cb306-1" aria-hidden="true" tabindex="-1"></a>df_grouped <span class="op">=</span> df_all.groupby(<span class="st">"kin_sub_site"</span>).agg({</span>
<span id="cb306-2"><a href="#cb306-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"kinase_uniprot"</span>: <span class="st">"first"</span>,</span>
<span id="cb306-3"><a href="#cb306-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"substrate_uniprot"</span>: <span class="st">"first"</span>,</span>
<span id="cb306-4"><a href="#cb306-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"site"</span>: <span class="st">"first"</span>,</span>
<span id="cb306-5"><a href="#cb306-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"source"</span>: <span class="st">'|'</span>.join,  <span class="co"># Concatenate sources with '|'</span></span>
<span id="cb306-6"><a href="#cb306-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"substrate_genes"</span>: <span class="st">"first"</span>,</span>
<span id="cb306-7"><a href="#cb306-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"substrate_sequence"</span>: <span class="st">"first"</span></span>
<span id="cb306-8"><a href="#cb306-8" aria-hidden="true" tabindex="-1"></a>}).reset_index()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="207197e1" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb307"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a>df_grouped.shape</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>(187066, 7)</code></pre>
</div>
</div>
<div id="da95d1f1" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb309"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true" tabindex="-1"></a>df_grouped.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">kin_sub_site</th>
<th data-quarto-table-cell-role="th">kinase_uniprot</th>
<th data-quarto-table-cell-role="th">substrate_uniprot</th>
<th data-quarto-table-cell-role="th">site</th>
<th data-quarto-table-cell-role="th">source</th>
<th data-quarto-table-cell-role="th">substrate_genes</th>
<th data-quarto-table-cell-role="th">substrate_sequence</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>O00141_A4FU28_S140</td>
<td>O00141</td>
<td>A4FU28</td>
<td>S140</td>
<td>Sugiyama</td>
<td>CTAGE9</td>
<td>MEEPGATPQPYLGLVLEELGRVVAALPESMRPDENPYGFPSELVVC...</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>O00141_O00141_S252</td>
<td>O00141</td>
<td>O00141</td>
<td>S252</td>
<td>Sugiyama</td>
<td>SGK1 SGK</td>
<td>MTVKTEAAKGTLTYSRMRGMVAILIAFMKQRRMGLNDFIQKIANNS...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>O00141_O00141_S255</td>
<td>O00141</td>
<td>O00141</td>
<td>S255</td>
<td>Sugiyama</td>
<td>SGK1 SGK</td>
<td>MTVKTEAAKGTLTYSRMRGMVAILIAFMKQRRMGLNDFIQKIANNS...</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>O00141_O00141_S397</td>
<td>O00141</td>
<td>O00141</td>
<td>S397</td>
<td>Sugiyama</td>
<td>SGK1 SGK</td>
<td>MTVKTEAAKGTLTYSRMRGMVAILIAFMKQRRMGLNDFIQKIANNS...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>O00141_O00141_S404</td>
<td>O00141</td>
<td>O00141</td>
<td>S404</td>
<td>Sugiyama</td>
<td>SGK1 SGK</td>
<td>MTVKTEAAKGTLTYSRMRGMVAILIAFMKQRRMGLNDFIQKIANNS...</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cef6a89c" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb310"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb310-1"><a href="#cb310-1" aria-hidden="true" tabindex="-1"></a><span class="co"># df_grouped.to_parquet('raw/combine_source_grouped.parquet')</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="human-phosphoproteome" class="level2">
<h2 class="anchored" data-anchor-id="human-phosphoproteome">Human phosphoproteome</h2>
<div id="25db8691" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb311"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb311-1"><a href="#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> katlas.core <span class="im">import</span> <span class="op">*</span></span>
<span id="cb311-2"><a href="#cb311-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="data-6" class="level3">
<h3 class="anchored" data-anchor-id="data-6">Data</h3>
<div id="39987af8" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb312"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb312-1"><a href="#cb312-1" aria-hidden="true" tabindex="-1"></a>human <span class="op">=</span> Data.get_combine_site_psp_ochoa()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="08e6c589" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb313"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a>human.shape</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>(121419, 8)</code></pre>
</div>
</div>
</section>
<section id="substrate-mapping-6" class="level3">
<h3 class="anchored" data-anchor-id="substrate-mapping-6">Substrate mapping</h3>
<div id="8968d294" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb315"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb315-1"><a href="#cb315-1" aria-hidden="true" tabindex="-1"></a><span class="co"># human.uniprot.drop_duplicates().to_csv('raw/human_phosphoproteome_uniprot.csv')</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>11,243 IDs were mapped to 11,241 results</p>
<p>5 ID were not mapped: AAA58698 P18433-2 AAC50053 AAA60149 NP_001184222</p>
<p>11,242 active entries and 1 obsolete entry are found</p>
<div id="497c036f" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb316"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb316-1"><a href="#cb316-1" aria-hidden="true" tabindex="-1"></a>human <span class="op">=</span> map_substrate(<span class="st">'raw/idmapping_2025_03_20_human_phosphoproteome.xlsx'</span>,human,<span class="st">'uniprot'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/sky1ove/miniconda3/lib/python3.13/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Shape before processing (121419, 8)
Species counts: substrate_species
Homo sapiens (Human)    121332
Name: count, dtype: int64
Removing non-human substrates
Shape after processing (121332, 11)</code></pre>
</div>
</div>
</section>
<section id="validate-site-6" class="level3">
<h3 class="anchored" data-anchor-id="validate-site-6">Validate site</h3>
<div id="b5b5e421" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb319"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb319-1"><a href="#cb319-1" aria-hidden="true" tabindex="-1"></a>human.columns</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>Index(['gene', 'site', 'site_seq', 'source', 'AM_pathogenicity', 'CDDM_upper',
       'CDDM_max_score', 'substrate_uniprot', 'substrate_genes',
       'substrate_sequence', 'substrate_species'],
      dtype='object')</code></pre>
</div>
</div>
<div id="d1492770" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb321"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb321-1"><a href="#cb321-1" aria-hidden="true" tabindex="-1"></a>human[<span class="st">'site_match'</span>] <span class="op">=</span>validate_site_df(human,<span class="st">'site'</span>,<span class="st">'substrate_sequence'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="21a05dfa" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb322"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb322-1"><a href="#cb322-1" aria-hidden="true" tabindex="-1"></a>human[<span class="st">'site_match'</span>].value_counts()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>site_match
1    120084
0      1248
Name: count, dtype: int64</code></pre>
</div>
</div>
<div id="96f2b23d" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb324"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb324-1"><a href="#cb324-1" aria-hidden="true" tabindex="-1"></a>human<span class="op">=</span>human[human.site_match<span class="op">==</span><span class="dv">1</span>].copy()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="7df09d76" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb325"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb325-1"><a href="#cb325-1" aria-hidden="true" tabindex="-1"></a>human.shape</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>(120084, 12)</code></pre>
</div>
</div>
</section>
<section id="remove-duplicates" class="level3">
<h3 class="anchored" data-anchor-id="remove-duplicates">Remove duplicates</h3>
<div id="0e984bab" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb327"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb327-1"><a href="#cb327-1" aria-hidden="true" tabindex="-1"></a>human[<span class="st">'sub_site'</span>] <span class="op">=</span> human[<span class="st">'substrate_uniprot'</span>]<span class="op">+</span><span class="st">'_'</span><span class="op">+</span>human[<span class="st">'site'</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="d2a37ec1" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb328"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb328-1"><a href="#cb328-1" aria-hidden="true" tabindex="-1"></a>human <span class="op">=</span> human.drop_duplicates(subset<span class="op">=</span><span class="st">'sub_site'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="89dc15d7" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb329"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb329-1"><a href="#cb329-1" aria-hidden="true" tabindex="-1"></a>human.shape</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>(119955, 13)</code></pre>
</div>
</div>
</section>
<section id="save-6" class="level3">
<h3 class="anchored" data-anchor-id="save-6">Save</h3>
<div id="d4ccad3d" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb331"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb331-1"><a href="#cb331-1" aria-hidden="true" tabindex="-1"></a>human.columns</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>Index(['gene', 'site', 'site_seq', 'source', 'AM_pathogenicity', 'CDDM_upper',
       'CDDM_max_score', 'substrate_uniprot', 'substrate_genes',
       'substrate_sequence', 'substrate_species', 'site_match', 'sub_site'],
      dtype='object')</code></pre>
</div>
</div>
<div id="eca8fb2e" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb333"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb333-1"><a href="#cb333-1" aria-hidden="true" tabindex="-1"></a>cols <span class="op">=</span> [<span class="st">'substrate_uniprot'</span>, <span class="st">'substrate_genes'</span>,</span>
<span id="cb333-2"><a href="#cb333-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-3"><a href="#cb333-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">'site'</span>, <span class="st">'source'</span>, <span class="st">'AM_pathogenicity'</span>, </span>
<span id="cb333-4"><a href="#cb333-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-5"><a href="#cb333-5" aria-hidden="true" tabindex="-1"></a>       <span class="st">'substrate_sequence'</span>, <span class="st">'substrate_species'</span>, <span class="st">'sub_site'</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="29763e3c" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb334"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb334-1"><a href="#cb334-1" aria-hidden="true" tabindex="-1"></a>human <span class="op">=</span> human[cols]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="a8a5a54d" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb335"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb335-1"><a href="#cb335-1" aria-hidden="true" tabindex="-1"></a><span class="co"># human.to_parquet('raw/human_phosphoproteome.parquet')</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="phosphorylate-sequence" class="level2">
<h2 class="anchored" data-anchor-id="phosphorylate-sequence">Phosphorylate sequence</h2>
<section id="combine-human-phosphoproteome-and-ks-dataset-site-info" class="level3">
<h3 class="anchored" data-anchor-id="combine-human-phosphoproteome-and-ks-dataset-site-info">Combine human phosphoproteome and KS dataset site info</h3>
<div id="b7775d06" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb336"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb336-1"><a href="#cb336-1" aria-hidden="true" tabindex="-1"></a>human <span class="op">=</span> pd.read_parquet(<span class="st">'raw/human_phosphoproteome.parquet'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="7b58050a" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb337"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb337-1"><a href="#cb337-1" aria-hidden="true" tabindex="-1"></a>cols <span class="op">=</span> [<span class="st">'substrate_uniprot'</span>,<span class="st">'site'</span>,<span class="st">'substrate_sequence'</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="a71007ee" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb338"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb338-1"><a href="#cb338-1" aria-hidden="true" tabindex="-1"></a>df_grouped <span class="op">=</span> pd.read_parquet(<span class="st">'raw/combine_source_grouped.parquet'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="ebe33488" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb339"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb339-1"><a href="#cb339-1" aria-hidden="true" tabindex="-1"></a>human <span class="op">=</span> human[cols]</span>
<span id="cb339-2"><a href="#cb339-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-3"><a href="#cb339-3" aria-hidden="true" tabindex="-1"></a>df_grouped <span class="op">=</span> df_grouped[cols]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="33a114fb" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb340"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb340-1"><a href="#cb340-1" aria-hidden="true" tabindex="-1"></a>comb <span class="op">=</span> pd.concat([human,df_grouped])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="1cb85e35" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb341"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb341-1"><a href="#cb341-1" aria-hidden="true" tabindex="-1"></a>comb[<span class="st">'sub_site'</span>] <span class="op">=</span> comb[<span class="st">'substrate_uniprot'</span>]<span class="op">+</span><span class="st">'_'</span><span class="op">+</span>comb[<span class="st">'site'</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="403c7252" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb342"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb342-1"><a href="#cb342-1" aria-hidden="true" tabindex="-1"></a>comb <span class="op">=</span> comb.drop_duplicates(<span class="st">'sub_site'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="phosphorylate-sequence-1" class="level3">
<h3 class="anchored" data-anchor-id="phosphorylate-sequence-1">Phosphorylate sequence</h3>
<div id="16f2b057" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb343"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb343-1"><a href="#cb343-1" aria-hidden="true" tabindex="-1"></a>seq <span class="op">=</span> phosphorylate_seq_df(comb)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="a89faaa3" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb344"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb344-1"><a href="#cb344-1" aria-hidden="true" tabindex="-1"></a>seq.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">substrate_uniprot</th>
<th data-quarto-table-cell-role="th">site</th>
<th data-quarto-table-cell-role="th">substrate_sequence</th>
<th data-quarto-table-cell-role="th">phosphoseq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>A0A024R4G9</td>
<td>[S20]</td>
<td>MTVLEAVLEIQAITGSRLLSMVPGPARPPGSCWDPTQCTRTWLLSH...</td>
<td>MTVLEAVLEIQAITGSRLLsMVPGPARPPGSCWDPTQCTRTWLLSH...</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>A0A075B6Q4</td>
<td>[S24, S35, S57, S68, S71, S72]</td>
<td>MDIQKSENEDDSEWEDVDDEKGDSNDDYDSAGLLSDEDCMSVPGKT...</td>
<td>MDIQKSENEDDSEWEDVDDEKGDsNDDYDSAGLLsDEDCMSVPGKT...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>A0A075B6T3</td>
<td>[S24, S26]</td>
<td>XLKRAYRGLEEVQWCLEQLLTSPSPS</td>
<td>XLKRAYRGLEEVQWCLEQLLTSPsPs</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>A0A075B759</td>
<td>[T68]</td>
<td>MVNSVVFFEITRDGKPLGRISIKLFADKIPKTAENFRALSTGEKGF...</td>
<td>MVNSVVFFEITRDGKPLGRISIKLFADKIPKTAENFRALSTGEKGF...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>A0A087WTJ2</td>
<td>[T8, Y14, Y213, T215, S221, S421, S424]</td>
<td>MGGRKMATDEENVYGLEENAQSRQESTRRLILVGRTGAGKSATGNS...</td>
<td>MGGRKMAtDEENVyGLEENAQSRQESTRRLILVGRTGAGKSATGNS...</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="d4200eae" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb345"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb345-1"><a href="#cb345-1" aria-hidden="true" tabindex="-1"></a><span class="co"># seq.to_csv('raw/phosphoseq_map.csv',index=False)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="map-to-df" class="level3">
<h3 class="anchored" data-anchor-id="map-to-df">Map to df</h3>
<div id="fa53aa50" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb346"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb346-1"><a href="#cb346-1" aria-hidden="true" tabindex="-1"></a>human <span class="op">=</span> pd.read_parquet(<span class="st">'raw/human_phosphoproteome.parquet'</span>)</span>
<span id="cb346-2"><a href="#cb346-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-3"><a href="#cb346-3" aria-hidden="true" tabindex="-1"></a>df_grouped <span class="op">=</span> pd.read_parquet(<span class="st">'raw/combine_source_grouped.parquet'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="b7f2d1b2" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb347"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb347-1"><a href="#cb347-1" aria-hidden="true" tabindex="-1"></a>seq_map <span class="op">=</span> seq.set_index(<span class="st">'substrate_uniprot'</span>)[<span class="st">'phosphoseq'</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="e04c62ac" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb348"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb348-1"><a href="#cb348-1" aria-hidden="true" tabindex="-1"></a>human[<span class="st">'substrate_phosphoseq'</span>] <span class="op">=</span> human.substrate_uniprot.<span class="bu">map</span>(seq_map)</span>
<span id="cb348-2"><a href="#cb348-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb348-3"><a href="#cb348-3" aria-hidden="true" tabindex="-1"></a>df_grouped[<span class="st">'substrate_phosphoseq'</span>] <span class="op">=</span> df_grouped.substrate_uniprot.<span class="bu">map</span>(seq_map)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="f3b8eead" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb349"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb349-1"><a href="#cb349-1" aria-hidden="true" tabindex="-1"></a>human[<span class="st">'substrate_phosphoseq'</span>].isna().<span class="bu">sum</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>np.int64(0)</code></pre>
</div>
</div>
<div id="2b8ad5c9" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb351"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb351-1"><a href="#cb351-1" aria-hidden="true" tabindex="-1"></a>df_grouped[<span class="st">'substrate_phosphoseq'</span>].isna().<span class="bu">sum</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>np.int64(0)</code></pre>
</div>
</div>
<div id="f6d4755e" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb353"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb353-1"><a href="#cb353-1" aria-hidden="true" tabindex="-1"></a><span class="co"># human.to_parquet('raw/human_phosphoproteome.parquet')</span></span>
<span id="cb353-2"><a href="#cb353-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb353-3"><a href="#cb353-3" aria-hidden="true" tabindex="-1"></a><span class="co"># df_grouped.to_parquet('raw/combine_source_grouped.parquet')</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="extract-site-sequence" class="level2">
<h2 class="anchored" data-anchor-id="extract-site-sequence">Extract site sequence</h2>
<div id="868a2df9" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb354"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb354-1"><a href="#cb354-1" aria-hidden="true" tabindex="-1"></a>human[<span class="st">'position'</span>] <span class="op">=</span> human[<span class="st">'site'</span>].<span class="bu">str</span>[<span class="dv">1</span>:].astype(<span class="bu">int</span>)</span>
<span id="cb354-2"><a href="#cb354-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-3"><a href="#cb354-3" aria-hidden="true" tabindex="-1"></a>df_grouped[<span class="st">'position'</span>]<span class="op">=</span>df_grouped[<span class="st">'site'</span>].<span class="bu">str</span>[<span class="dv">1</span>:].astype(<span class="bu">int</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="bb22a219-d50d-4430-8443-fb1d3a9afc3e" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb355"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb355-1"><a href="#cb355-1" aria-hidden="true" tabindex="-1"></a>extract_site_seq?</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">Signature:</span>
extract_site_seq(
    df: pandas.core.frame.DataFrame,
    seq_col: str,
    site_col: str,
    n=<span class="ansi-green-fg">7</span>,
)
<span class="ansi-red-fg">Docstring:</span> Extract -n to +n site sequence from protein sequence
<span class="ansi-red-fg">File:</span>      /mnt/f/git/kkatlas/katlas/katlas/utils.py
<span class="ansi-red-fg">Type:</span>      function</pre>
</div>
</div>
</div>
<div id="ad3cf8e2" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb356"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb356-1"><a href="#cb356-1" aria-hidden="true" tabindex="-1"></a>human[<span class="st">'site_seq'</span>] <span class="op">=</span> extract_site_seq(human,</span>
<span id="cb356-2"><a href="#cb356-2" aria-hidden="true" tabindex="-1"></a>                                  seq_col<span class="op">=</span><span class="st">'substrate_phosphoseq'</span>,</span>
<span id="cb356-3"><a href="#cb356-3" aria-hidden="true" tabindex="-1"></a>                                  site_col<span class="op">=</span><span class="st">'site'</span>,n<span class="op">=</span><span class="dv">20</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|█████████████████████████████████████████████████████████████████████| 119955/119955 [00:04&lt;00:00, 25764.66it/s]</code></pre>
</div>
</div>
<div id="57b22038" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb358"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb358-1"><a href="#cb358-1" aria-hidden="true" tabindex="-1"></a>df_grouped[<span class="st">'site_seq'</span>] <span class="op">=</span> extract_site_seq(df_grouped,</span>
<span id="cb358-2"><a href="#cb358-2" aria-hidden="true" tabindex="-1"></a>                                  seq_col<span class="op">=</span><span class="st">'substrate_phosphoseq'</span>,</span>
<span id="cb358-3"><a href="#cb358-3" aria-hidden="true" tabindex="-1"></a>                                  site_col<span class="op">=</span><span class="st">'site'</span>,n<span class="op">=</span><span class="dv">20</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|█████████████████████████████████████████████████████████████████████| 187066/187066 [00:07&lt;00:00, 25809.29it/s]</code></pre>
</div>
</div>
<div id="81bed9ae" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb360"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb360-1"><a href="#cb360-1" aria-hidden="true" tabindex="-1"></a>df_grouped[<span class="st">'sub_site'</span>] <span class="op">=</span> df_grouped[<span class="st">'substrate_uniprot'</span>]<span class="op">+</span><span class="st">'_'</span><span class="op">+</span> df_grouped[<span class="st">'site'</span>]</span>
<span id="cb360-2"><a href="#cb360-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb360-3"><a href="#cb360-3" aria-hidden="true" tabindex="-1"></a>human[<span class="st">'sub_site'</span>] <span class="op">=</span> human[<span class="st">'substrate_uniprot'</span>]<span class="op">+</span><span class="st">'_'</span><span class="op">+</span> human[<span class="st">'site'</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="948c7194" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb361"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb361-1"><a href="#cb361-1" aria-hidden="true" tabindex="-1"></a><span class="co"># human.to_parquet('raw/human_phosphoproteome.parquet')</span></span>
<span id="cb361-2"><a href="#cb361-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb361-3"><a href="#cb361-3" aria-hidden="true" tabindex="-1"></a><span class="co"># df_grouped.to_parquet('raw/combine_source_grouped.parquet')</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="add-kinase-info" class="level2">
<h2 class="anchored" data-anchor-id="add-kinase-info">Add kinase info</h2>
<div id="df45c2c2-d635-454b-9369-0e2447189d71" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb362"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb362-1"><a href="#cb362-1" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>df_grouped.copy()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="4e008096-ac49-4faf-b3f0-3b33d3a36ff5" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb363"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb363-1"><a href="#cb363-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove pseudokinase duplicates by UniProt ID, keep only one entry per kinase</span></span>
<span id="cb363-2"><a href="#cb363-2" aria-hidden="true" tabindex="-1"></a>info <span class="op">=</span> Data.get_kinase_info().sort_values(<span class="st">'kinase'</span>).drop_duplicates(<span class="st">'uniprot'</span>)</span>
<span id="cb363-3"><a href="#cb363-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-4"><a href="#cb363-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Pre-extract UniProt ID without isoform for matching</span></span>
<span id="cb363-5"><a href="#cb363-5" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'uniprot_clean'</span>] <span class="op">=</span> df[<span class="st">'kinase_uniprot'</span>].<span class="bu">str</span>.split(<span class="st">'-'</span>).<span class="bu">str</span>[<span class="dv">0</span>]</span>
<span id="cb363-6"><a href="#cb363-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-7"><a href="#cb363-7" aria-hidden="true" tabindex="-1"></a>info_indexed <span class="op">=</span> info.set_index(<span class="st">'uniprot'</span>)</span>
<span id="cb363-8"><a href="#cb363-8" aria-hidden="true" tabindex="-1"></a>group_map <span class="op">=</span> info_indexed[<span class="st">'group'</span>]</span>
<span id="cb363-9"><a href="#cb363-9" aria-hidden="true" tabindex="-1"></a>family_map <span class="op">=</span> info_indexed[<span class="st">'family'</span>]</span>
<span id="cb363-10"><a href="#cb363-10" aria-hidden="true" tabindex="-1"></a>pspa_small_map <span class="op">=</span> info_indexed[<span class="st">'pspa_category_small'</span>]</span>
<span id="cb363-11"><a href="#cb363-11" aria-hidden="true" tabindex="-1"></a>pspa_big_map <span class="op">=</span> info_indexed[<span class="st">'pspa_category_big'</span>]</span>
<span id="cb363-12"><a href="#cb363-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-13"><a href="#cb363-13" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'kinase_on_tree'</span>] <span class="op">=</span> df[<span class="st">'uniprot_clean'</span>].isin(info[<span class="st">'uniprot'</span>]).astype(<span class="bu">int</span>)</span>
<span id="cb363-14"><a href="#cb363-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-15"><a href="#cb363-15" aria-hidden="true" tabindex="-1"></a>kinase_gene_map <span class="op">=</span> Data.get_kinase_uniprot().set_index(<span class="st">'Entry'</span>)[<span class="st">'Gene Names'</span>]</span>
<span id="cb363-16"><a href="#cb363-16" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'kinase_genes'</span>] <span class="op">=</span> df[<span class="st">'uniprot_clean'</span>].<span class="bu">map</span>(kinase_gene_map)</span>
<span id="cb363-17"><a href="#cb363-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-18"><a href="#cb363-18" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'kinase_group'</span>] <span class="op">=</span> df[<span class="st">'uniprot_clean'</span>].<span class="bu">map</span>(group_map)</span>
<span id="cb363-19"><a href="#cb363-19" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'kinase_family'</span>] <span class="op">=</span> df[<span class="st">'uniprot_clean'</span>].<span class="bu">map</span>(family_map)</span>
<span id="cb363-20"><a href="#cb363-20" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'kinase_pspa_big'</span>] <span class="op">=</span> df[<span class="st">'uniprot_clean'</span>].<span class="bu">map</span>(pspa_big_map)</span>
<span id="cb363-21"><a href="#cb363-21" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'kinase_pspa_small'</span>] <span class="op">=</span> df[<span class="st">'uniprot_clean'</span>].<span class="bu">map</span>(pspa_small_map)</span>
<span id="cb363-22"><a href="#cb363-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-23"><a href="#cb363-23" aria-hidden="true" tabindex="-1"></a>df.drop(columns<span class="op">=</span><span class="st">'uniprot_clean'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The above code has been added into <code>Data</code> class when loading the ks dataset</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/sky1ove\.github\.io\/katlas-raw");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/sky1ove/katlas-raw/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>