[
  {
    "objectID": "plot_cddm.html",
    "href": "plot_cddm.html",
    "title": "Plot heatmap and logo of CDDM",
    "section": "",
    "text": "import pandas as pd\nimport numpy as np\nfrom katlas.data import *\nfrom katlas.pssm import *\nfrom katlas.utils import *\nfrom katlas.plot import *\nfrom katlas.feature import *\nfrom matplotlib import pyplot as plt\nimport seaborn as sns\nimport math\n\nfrom sklearn.cluster import KMeans\nfrom pathlib import Path\nfrom tqdm import tqdm\n\n\ndf = Data.get_ks_dataset()\n\nCPU times: user 737 ms, sys: 289 ms, total: 1.03 s\nWall time: 6.98 s\n\n\n\ndf.head()\n\n\n\n\n\n\n\n\nkin_sub_site\nkinase_uniprot\nsubstrate_uniprot\nsite\nsource\nsubstrate_genes\nsubstrate_phosphoseq\nposition\nsite_seq\nsub_site\n...\nkinase_on_tree\nkinase_genes\nkinase_protein\nkinase_group\nkinase_family\nkinase_subfamily\nkinase_pspa_big\nkinase_pspa_small\nkinase_coral_ID\nnum_kin\n\n\n\n\n0\nO00141_A4FU28_S140\nO00141\nA4FU28\nS140\nSugiyama\nCTAGE9\nMEEPGATPQPYLGLVLEELGRVVAALPESMRPDENPYGFPSELVVC...\n140\nAAAEEARSLEATCEKLSRsNsELEDEILCLEKDLKEEKSKH\nA4FU28_S140\n...\n1\nSGK1 SGK\nSGK1\nAGC\nSGK\nSGK\nBasophilic\nAkt/rock\nSGK1\n22\n\n\n1\nO00141_O00141_S252\nO00141\nO00141\nS252\nSugiyama\nSGK1 SGK\nMTVKTEAAKGTLTYSRMRGMVAILIAFMKQRRMGLNDFIQKIANNS...\n252\nSQGHIVLTDFGLCKENIEHNsTtstFCGtPEyLAPEVLHKQ\nO00141_S252\n...\n1\nSGK1 SGK\nSGK1\nAGC\nSGK\nSGK\nBasophilic\nAkt/rock\nSGK1\n1\n\n\n2\nO00141_O00141_S255\nO00141\nO00141\nS255\nSugiyama\nSGK1 SGK\nMTVKTEAAKGTLTYSRMRGMVAILIAFMKQRRMGLNDFIQKIANNS...\n255\nHIVLTDFGLCKENIEHNsTtstFCGtPEyLAPEVLHKQPYD\nO00141_S255\n...\n1\nSGK1 SGK\nSGK1\nAGC\nSGK\nSGK\nBasophilic\nAkt/rock\nSGK1\n1\n\n\n3\nO00141_O00141_S397\nO00141\nO00141\nS397\nSugiyama\nSGK1 SGK\nMTVKTEAAKGTLTYSRMRGMVAILIAFMKQRRMGLNDFIQKIANNS...\n397\nsGPNDLRHFDPEFTEEPVPNsIGKsPDsVLVTAsVKEAAEA\nO00141_S397\n...\n1\nSGK1 SGK\nSGK1\nAGC\nSGK\nSGK\nBasophilic\nAkt/rock\nSGK1\n1\n\n\n4\nO00141_O00141_S404\nO00141\nO00141\nS404\nSugiyama\nSGK1 SGK\nMTVKTEAAKGTLTYSRMRGMVAILIAFMKQRRMGLNDFIQKIANNS...\n404\nHFDPEFTEEPVPNsIGKsPDsVLVTAsVKEAAEAFLGFsYA\nO00141_S404\n...\n1\nSGK1 SGK\nSGK1\nAGC\nSGK\nSGK\nBasophilic\nAkt/rock\nSGK1\n1\n\n\n\n\n5 rows × 21 columns\n\n\n\n\ndf.shape\n\n(187066, 21)",
    "crumbs": [
      "Plot heatmap and logo of CDDM"
    ]
  },
  {
    "objectID": "plot_cddm.html#setup",
    "href": "plot_cddm.html#setup",
    "title": "Plot heatmap and logo of CDDM",
    "section": "",
    "text": "import pandas as pd\nimport numpy as np\nfrom katlas.data import *\nfrom katlas.pssm import *\nfrom katlas.utils import *\nfrom katlas.plot import *\nfrom katlas.feature import *\nfrom matplotlib import pyplot as plt\nimport seaborn as sns\nimport math\n\nfrom sklearn.cluster import KMeans\nfrom pathlib import Path\nfrom tqdm import tqdm\n\n\ndf = Data.get_ks_dataset()\n\nCPU times: user 737 ms, sys: 289 ms, total: 1.03 s\nWall time: 6.98 s\n\n\n\ndf.head()\n\n\n\n\n\n\n\n\nkin_sub_site\nkinase_uniprot\nsubstrate_uniprot\nsite\nsource\nsubstrate_genes\nsubstrate_phosphoseq\nposition\nsite_seq\nsub_site\n...\nkinase_on_tree\nkinase_genes\nkinase_protein\nkinase_group\nkinase_family\nkinase_subfamily\nkinase_pspa_big\nkinase_pspa_small\nkinase_coral_ID\nnum_kin\n\n\n\n\n0\nO00141_A4FU28_S140\nO00141\nA4FU28\nS140\nSugiyama\nCTAGE9\nMEEPGATPQPYLGLVLEELGRVVAALPESMRPDENPYGFPSELVVC...\n140\nAAAEEARSLEATCEKLSRsNsELEDEILCLEKDLKEEKSKH\nA4FU28_S140\n...\n1\nSGK1 SGK\nSGK1\nAGC\nSGK\nSGK\nBasophilic\nAkt/rock\nSGK1\n22\n\n\n1\nO00141_O00141_S252\nO00141\nO00141\nS252\nSugiyama\nSGK1 SGK\nMTVKTEAAKGTLTYSRMRGMVAILIAFMKQRRMGLNDFIQKIANNS...\n252\nSQGHIVLTDFGLCKENIEHNsTtstFCGtPEyLAPEVLHKQ\nO00141_S252\n...\n1\nSGK1 SGK\nSGK1\nAGC\nSGK\nSGK\nBasophilic\nAkt/rock\nSGK1\n1\n\n\n2\nO00141_O00141_S255\nO00141\nO00141\nS255\nSugiyama\nSGK1 SGK\nMTVKTEAAKGTLTYSRMRGMVAILIAFMKQRRMGLNDFIQKIANNS...\n255\nHIVLTDFGLCKENIEHNsTtstFCGtPEyLAPEVLHKQPYD\nO00141_S255\n...\n1\nSGK1 SGK\nSGK1\nAGC\nSGK\nSGK\nBasophilic\nAkt/rock\nSGK1\n1\n\n\n3\nO00141_O00141_S397\nO00141\nO00141\nS397\nSugiyama\nSGK1 SGK\nMTVKTEAAKGTLTYSRMRGMVAILIAFMKQRRMGLNDFIQKIANNS...\n397\nsGPNDLRHFDPEFTEEPVPNsIGKsPDsVLVTAsVKEAAEA\nO00141_S397\n...\n1\nSGK1 SGK\nSGK1\nAGC\nSGK\nSGK\nBasophilic\nAkt/rock\nSGK1\n1\n\n\n4\nO00141_O00141_S404\nO00141\nO00141\nS404\nSugiyama\nSGK1 SGK\nMTVKTEAAKGTLTYSRMRGMVAILIAFMKQRRMGLNDFIQKIANNS...\n404\nHFDPEFTEEPVPNsIGKsPDsVLVTAsVKEAAEAFLGFsYA\nO00141_S404\n...\n1\nSGK1 SGK\nSGK1\nAGC\nSGK\nSGK\nBasophilic\nAkt/rock\nSGK1\n1\n\n\n\n\n5 rows × 21 columns\n\n\n\n\ndf.shape\n\n(187066, 21)",
    "crumbs": [
      "Plot heatmap and logo of CDDM"
    ]
  },
  {
    "objectID": "plot_cddm.html#logo-heatmap",
    "href": "plot_cddm.html#logo-heatmap",
    "title": "Plot heatmap and logo of CDDM",
    "section": "logo heatmap",
    "text": "logo heatmap\n\ndf['kinase_uniprot_gene'] = df['kinase_uniprot']+'_'+df['kinase_genes'].str.split(' ').str[0]\n\ncnt = df.kinase_uniprot_gene.value_counts()\n\n\n# cnt = df.kinase_coral_ID.value_counts()\n\n\ndef convert_source(x):\n    if x == \"Sugiyama\":\n        return x\n    elif 'Sugiyama' in x and '|' in x:\n        return 'Both'\n    elif 'Sugiyama' not in x:\n        return 'Non-Sugiyama'\n\n\ndf['source_combine'] = df.source.apply(convert_source)\n\n\ndef plot_hist_num_kin(df_k):\n    \"Plot histogram of num kin grouped by source_combine.\"\n    g = sns.displot(\n        df_k,\n        x=\"num_kin\",\n        col=\"source_combine\",\n        bins=100,\n        col_wrap=1,\n        height=2.0,\n        aspect=4,\n        facet_kws={'sharex': False, 'sharey': False}\n    )\n    \n    g.set_axis_labels(\"Number of Kinases per Site\", \"Count\")\n    \n    # Customize titles\n    for ax, source in zip(g.axes.flatten(), g.col_names):\n        count = df_k[df_k['source_combine'] == source].shape[0]\n        ax.set_title(f\"{source} (n={count:,})\")\n    \n    g.figure.suptitle(\"Histogram of # Kinases per Substrate Site\")\n    \n    # Adjust layout to make room for suptitle\n    plt.tight_layout()\n\n\ndef plot_cnt_cddm(df_k):\n    \"Plot source combine counts via bar graph.\"\n    source_cnt = df_k.source_combine.value_counts()\n    plot_cnt(source_cnt)\n    plt.title('# Substrate Sites per Source',pad=20)\n\n\n# plot_cnt_cddm(df_k)\n\n\ndef plot_cnt_acceptor(df_k):\n    \"Plot site type via bar graph.\"\n    acceptor_cnt = df_k.acceptor.value_counts()\n    plot_cnt(acceptor_cnt)\n    plt.title('# Substrate Sites per Phospho-Acceptor Type',pad=20)\n\n\n# plot_cnt_acceptor(df_k)\n\n\n# set_sns()\n\n\n# onehot = onehot_encode(df_k.site_seq)\n\n\ndef filter_range_columns(df,low=-10,high=10):\n    positions = df.columns.str[:-1].astype(int)\n    mask = (positions &gt;= low) & (positions &lt;= high)\n    return df.loc[:,mask]\n\n\n# positions = onehot.columns.str[:-1].astype(int)\n# mask = (positions &gt;= -10) & (positions &lt;= 10)\n\n# onehot = onehot.loc[:,mask]\n\n# df_k['cluster'] = kmeans(onehot,n=10,seed=42)\n\n# pssms = get_cluster_pssms(df_k,'cluster',valid_thr=0.5)\n\n# kmeans_cnt = df_k.cluster.value_counts()\n\n\n# plot_logos(pssms,kmeans_cnt)\n\n\ndef get_onehot_add_cluster(df_k,n=10):\n    df_k = df_k.copy()\n    onehot = onehot_encode(df_k.site_seq)\n    onehot_10 = filter_range_columns(onehot)\n    df_k['Cluster'] = kmeans(onehot_10,n=n,seed=42)\n    df_k = df_k.reset_index(drop=True)\n    return df_k,onehot_10\n\n\n# df_k,onehot_10 = get_onehot_add_cluster(df_k,n=10)\n\n\ndef get_kmeans_logos(df_k,cnt_thr=10):\n    pssms = get_cluster_pssms(df_k,'Cluster',valid_thr=0) # remove valid thr\n    kmeans_cnt = df_k['Cluster'].value_counts()\n\n    # filter cluster with &gt;=10 counts\n    valid_clusters = kmeans_cnt[kmeans_cnt &gt;= cnt_thr].index\n    filtered_pssms = pssms.loc[valid_clusters]\n    \n    if not filtered_pssms.empty: plot_logos(filtered_pssms,kmeans_cnt)\n\n\n# df_k,onehot_10 = get_onehot_add_cluster(df_k,n=10)\n# get_kmeans_logos(df_k)\n\n\ndef plot_onehot(onehot_10,hue):\n    plot_cluster(onehot_10,'pca',seed=42,complexity=30,hue=hue,legend=True,s=8)\n    plt.title(f'PCA of One-Hot Encoded\\n Substrate Site Sequences (n={len(onehot_10):,})')\n\n\n# df_k,onehot_10 = get_onehot_add_cluster(df_k,n=10)\n# plot_onehot(onehot_10,df_k['Cluster'])\n# get_kmeans_logos(df_k)\n\n\n# plot_cluster(onehot_10,'pca',seed=42,complexity=30,hue=df_k.cluster,legend=True,s=8)\n# plt.title('PCA of One-Hot Encoded Sequences (-10 to +10')\n\n\n# plot_logo_heatmap(pssm_df,title=f'{k} (n={len(df_k):,})',figsize=(17,10))\n\n\n# for site_type in ['S','T','Y']:\n#     df_sty = df[df.kinase_uniprot_gene.upper()==site_type].copy()\n#     pssm_sty = get_prob(df_sty,'site_seq')\n#     plot_logo_heatmap(pssm_sty,title=f'{site_type} sites (n={len(df_sty):,})',figsize=(17,10))\n#     save_show()\n\n\n# pssm_LO = get_pssm_LO(pssm_sty,'S')\n\n\n# plot_logo_raw(pssm_LO,ytitle=\"Log-Odds Score (bits)\")\n\n\n# plot_logo_heatmap_enrich(pssm_LO)\n\n\n# import logomaker\n\n\n# for site_type in ['S','T','Y']:\n#     df_sty = df_k[df_k.acceptor.str.upper()==site_type].copy()\n#     pssm_sty = get_prob(df_sty,'site_seq')\n#     plot_logo_heatmap(pssm_sty,title=f'{site_type} sites (n={len(df_sty):,})',figsize=(17,10))\n#     save_show()\n#     break",
    "crumbs": [
      "Plot heatmap and logo of CDDM"
    ]
  },
  {
    "objectID": "plot_cddm.html#iterate",
    "href": "plot_cddm.html#iterate",
    "title": "Plot heatmap and logo of CDDM",
    "section": "Iterate",
    "text": "Iterate\n\ndf['acceptor']=df.site.str[0]\n\n\nSHOW=False\n\n\nfilter_cnt = cnt[cnt&gt;=40]\n\n\nlist(filter_cnt.index).index('O43353_RIPK2')\n\n301\n\n\n\nfor k in filter_cnt.index[235:]: break\n\n\nk\n\n'P41743_PRKCI'\n\n\n\ndef prepare_path(path):\n    \"\"\"Ensure the parent directory exists and return the full file path.\"\"\"\n    full_path = Path(path).expanduser()\n    full_path.parent.mkdir(parents=True, exist_ok=True)\n    return full_path\n\n\ndef save_show(path=None, # image path, e.g., img.svg, if not None, will save, else plt.show()\n              show_only=False,\n             ):\n    \"Show plot or save path\"\n    if show_only: plt.show()\n    elif path is not None: \n        plt.savefig(path,\n            bbox_inches='tight',\n            pad_inches=0.05,\n            transparent=True,\n            )  \n    else: plt.show()\n    plt.close()\n\n\nimport matplotlib as mpl\n\nimport matplotlib as mpl\n\nmpl.rcParams['svg.fonttype'] = 'none'     # keep text as &lt;text&gt;, not paths\nmpl.rcParams['svg.image_inline'] = True   # embed images inline (set False to link)\nmpl.rcParams['svg.hashsalt'] = ''         # avoid random IDs in defs\nmpl.rcParams['path.simplify'] = True\nmpl.rcParams['path.simplify_threshold'] = 0.01\n\n\nimport gc\n\n\nfilter_cnt = cnt[cnt&gt;=40]\nfor i,k in enumerate(filter_cnt.index[235:]): \n# for k in ['P00519_ABL1']:\n    df_k = df[df.kinase_uniprot_gene==k].copy()\n    # df_k = df_k[df_k.num_kin&gt;10]\n    \n\n    # Freq PSSM\n    pssm_df = get_prob(df_k,'site_seq')\n    plot_logo_heatmap(pssm_df,title=f'{k} (n={len(df_k):,})',figsize=(17,10))\n    path1=prepare_path(f'fig/cddm/{k}/pssm_freq.svg')\n    save_show(path1,show_only=SHOW)\n\n    # Log odds PSSM\n    pssm_LO = get_pssm_LO(pssm_df,'STY')\n    plot_logo_heatmap_LO(pssm_LO,title=f'{k} (n={len(df_k):,})',figsize=(17,10))\n    path2=prepare_path(f'fig/cddm/{k}/pssm_LO.svg')\n    save_show(path2,show_only=SHOW)\n    \n\n    # plot S, T and Y motif\n    sty_cnt =df_k.acceptor.value_counts()\n    acceptors = sty_cnt[(sty_cnt/len(df_k) &gt; 0.08) & (sty_cnt&gt;=10)].index # Skip this site_type if it has less than 8% or less than 10 count\n    for site_type in acceptors:\n        df_sty = df_k[df_k.acceptor.str.upper()==site_type].copy()\n\n        # freq map\n        pssm_sty = get_prob(df_sty,'site_seq')\n        plot_logo_heatmap(pssm_sty,title=f'{k}: {site_type} sites (n={len(df_sty):,})',figsize=(17,10))\n        path_3=prepare_path(f'fig/cddm/{k}/pssm_freq_{site_type}.svg')\n        save_show(path_3,show_only=SHOW)\n\n        # for log-odds\n        pssm_LO = get_pssm_LO(pssm_sty,site_type)\n        plot_logo_heatmap_LO(pssm_LO,acceptor=site_type,title=f'{k}: {site_type} sites (n={len(df_sty):,})',figsize=(17,10))\n        path_4=prepare_path(f'fig/cddm/{k}/pssm_LO_{site_type}.svg')\n        save_show(path_4,show_only=SHOW)\n\n    \n    path5=prepare_path(f'fig/cddm/{k}/bar_acceptor.svg')\n    plot_cnt_acceptor(df_k)\n    save_show(path5,show_only=SHOW)\n\n    \n    # count of source\n    path6=prepare_path(f'fig/cddm/{k}/bar_source.svg')\n    plot_cnt_cddm(df_k)\n    save_show(path6,show_only=SHOW)\n\n    # histogram of num kin\n    path7=prepare_path(f'fig/cddm/{k}/hist_num_kin.svg')\n    plot_hist_num_kin(df_k)\n    save_show(path7,show_only=SHOW)\n\n\n    \n    # onehot of sequences\n    # filter out noise acceptor for stratification\n    df_k = df_k[df_k.acceptor.isin(acceptors)]\n    df_k,onehot_10 = get_onehot_add_cluster(df_k,n=10)\n    \n    path8=prepare_path(f'fig/cddm/{k}/pca_onehot.svg')\n    plot_onehot(onehot_10,df_k.Cluster)\n    save_show(path8,show_only=SHOW)\n\n    path9=prepare_path(f'fig/cddm/{k}/motif_kmeans.svg')\n    get_kmeans_logos(df_k)\n    save_show(path9,show_only=SHOW)\n\n    path00=prepare_path(f'fig/cddm/{k}/df_k.parquet')\n    \n    df_k.to_parquet(path00)\n\n    plt.close()\n    if i % 10 == 0:\n        gc.collect()\n    \n    # break\n\n100%|██████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 73.75it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 146.48it/s]\n100%|██████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 92.02it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 144.13it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 106.27it/s]\n100%|██████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 84.45it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 116.55it/s]\n100%|██████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 56.13it/s]\n100%|██████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 83.22it/s]\n100%|██████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 80.70it/s]\n100%|██████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 82.79it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 218.11it/s]\n100%|██████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 76.83it/s]\n100%|██████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 95.90it/s]\n100%|██████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 70.55it/s]\n100%|██████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 67.97it/s]\n100%|██████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 77.00it/s]\n100%|██████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 98.59it/s]\n100%|██████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 90.30it/s]\n100%|██████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 92.44it/s]\n100%|██████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 70.34it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 116.14it/s]\n100%|██████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 70.21it/s]\n100%|██████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 77.78it/s]\n100%|██████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 87.13it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 151.65it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 111.28it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 220.84it/s]\n100%|██████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 76.75it/s]\n100%|██████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 72.21it/s]\n100%|██████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 72.33it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 123.73it/s]\n100%|██████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 93.41it/s]\n100%|██████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 71.76it/s]\n100%|██████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 78.07it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 129.75it/s]\n100%|██████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 79.42it/s]\n100%|██████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 76.79it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 129.33it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 128.24it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 132.44it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 109.60it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 133.85it/s]\n100%|██████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 84.67it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 102.86it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 124.24it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 224.12it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 145.26it/s]\n100%|██████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 90.85it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 210.07it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 162.78it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 111.04it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 133.06it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 162.31it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 232.12it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 182.80it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 228.90it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 345.97it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 138.72it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 134.44it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 162.07it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 220.88it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 297.18it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 217.93it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 330.48it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 330.39it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 227.04it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 593.80it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 205.43it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 237.42it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 235.05it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 328.17it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 606.48it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 332.83it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 330.93it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 234.44it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 226.36it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 632.95it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 609.24it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 641.18it/s]\n100%|██████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 168445.94it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 609.52it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 649.26it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 662.40it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 651.09it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 487.47it/s]\n100%|██████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 143640.55it/s]\n100%|██████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 103819.41it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 576.35it/s]\n100%|███████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 41651.48it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 576.70it/s]\n100%|██████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 130257.89it/s]\n100%|██████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 133576.56it/s]\n100%|██████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 107271.20it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 326.52it/s]\n100%|███████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 79588.31it/s]\n100%|██████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 132731.14it/s]\n100%|██████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 144134.16it/s]\n100%|██████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 104077.02it/s]\n100%|███████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 93414.34it/s]\n\n\n\ngenes = set(df_k.substrate_genes.str.split(' ').str[0])\n\n\npath_ref = pd.read_excel('raw/idmapping_kinase_info_2025_05_27.xlsx')\n\n\nk\n\n'P00519_ABL1'\n\n\n\npath_ref['uniprot_gene'] = path_ref.uniprot+'_'+path_ref['Gene Names (primary)']\n\n\nidx_path = path_ref[path_ref.uniprot_gene==k].Reactome.str.split(';').iloc[0]\n\n\npath_df_raw\n\n\n\n\n\n\n\n\nstId\ndbId\nname\nllp\ninDisease\nspecies.dbId\nspecies.taxId\nspecies.name\nentities.resource\nentities.total\nentities.found\nentities.ratio\nentities.pValue\nentities.fdr\nentities.exp\nreactions.resource\nreactions.total\nreactions.found\nreactions.ratio\n\n\n\n\n0\nR-HSA-72649\n72649\nTranslation initiation complex formation\nTrue\nFalse\n48887\n9606\nHomo sapiens\nTOTAL\n62\n39\n0.003861\n1.110223e-16\n4.884981e-15\n[]\nTOTAL\n2\n2\n0.000129\n\n\n1\nR-HSA-72695\n72695\nFormation of the ternary complex, and subseque...\nTrue\nFalse\n48887\n9606\nHomo sapiens\nTOTAL\n54\n33\n0.003362\n1.110223e-16\n4.884981e-15\n[]\nTOTAL\n3\n3\n0.000193\n\n\n2\nR-HSA-72702\n72702\nRibosomal scanning and start codon recognition\nTrue\nFalse\n48887\n9606\nHomo sapiens\nTOTAL\n64\n39\n0.003985\n1.110223e-16\n4.884981e-15\n[]\nTOTAL\n2\n2\n0.000129\n\n\n3\nR-HSA-72662\n72662\nActivation of the mRNA upon binding of the cap...\nTrue\nFalse\n48887\n9606\nHomo sapiens\nTOTAL\n66\n39\n0.004110\n1.110223e-16\n4.884981e-15\n[]\nTOTAL\n6\n6\n0.000386\n\n\n4\nR-HSA-72706\n72706\nGTP hydrolysis and joining of the 60S ribosoma...\nTrue\nFalse\n48887\n9606\nHomo sapiens\nTOTAL\n120\n66\n0.007472\n1.110223e-16\n4.884981e-15\n[]\nTOTAL\n3\n3\n0.000193\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\n1754\nR-HSA-198933\n198933\nImmunoregulatory interactions between a Lympho...\nTrue\nFalse\n48887\n9606\nHomo sapiens\nTOTAL\n249\n1\n0.015504\n1.000000e+00\n1.000000e+00\n[]\nTOTAL\n44\n1\n0.002829\n\n\n1755\nR-HSA-373076\n373076\nClass A/1 (Rhodopsin-like receptors)\nTrue\nFalse\n48887\n9606\nHomo sapiens\nTOTAL\n415\n2\n0.025841\n1.000000e+00\n1.000000e+00\n[]\nTOTAL\n187\n3\n0.012023\n\n\n1756\nR-HSA-425407\n425407\nSLC-mediated transmembrane transport\nFalse\nFalse\n48887\n9606\nHomo sapiens\nTOTAL\n424\n2\n0.026401\n1.000000e+00\n1.000000e+00\n[]\nTOTAL\n200\n2\n0.012858\n\n\n1757\nR-HSA-500792\n500792\nGPCR ligand binding\nFalse\nFalse\n48887\n9606\nHomo sapiens\nTOTAL\n610\n4\n0.037983\n1.000000e+00\n1.000000e+00\n[]\nTOTAL\n219\n4\n0.014080\n\n\n1758\nR-HSA-9709957\n9709957\nSensory Perception\nFalse\nFalse\n48887\n9606\nHomo sapiens\nTOTAL\n1258\n10\n0.078331\n1.000000e+00\n1.000000e+00\n[]\nTOTAL\n138\n2\n0.008872\n\n\n\n\n1759 rows × 19 columns\n\n\n\n\nref_paths = path_df_raw[path_df_raw.stId.isin(idx_path)]\n\n\nref_paths.name\n\n80      RUNX1 regulates transcription of genes involve...\n129                  RHO GTPases Activate WASPs and WAVEs\n157     Recruitment and ATM-mediated phosphorylation o...\n306     MLL4 and MLL3 complexes regulate expression of...\n423     Factors involved in megakaryocyte development ...\n424                      Cyclin D associated events in G1\n473     Turbulent (oscillatory, disturbed) flow shear ...\n485     Regulation of actin dynamics for phagocytic cu...\n526             HDR through Single Strand Annealing (SSA)\n629                          FCGR3A-mediated phagocytosis\n662                    Role of ABL in ROBO-SLIT signaling\n922                                            Myogenesis\n1193           RUNX2 regulates osteoblast differentiation\nName: name, dtype: object\n\n\n\nidx_path\n\n['R-HSA-2029482',\n 'R-HSA-428890',\n 'R-HSA-525793',\n 'R-HSA-5663213',\n 'R-HSA-5685938',\n 'R-HSA-5693565',\n 'R-HSA-69231',\n 'R-HSA-8939236',\n 'R-HSA-8940973',\n 'R-HSA-9664422',\n 'R-HSA-983231',\n 'R-HSA-9841922',\n 'R-HSA-9860927',\n '']\n\n\n\npath_df = get_reactome(genes)\n\n\npath_df\n\n\n\n\n\n\n\n\nname\nfdr\n-log10_fdr\n\n\n\n\n0\nTranslation initiation complex formation\n4.884981e-15\n14.311\n\n\n1\nFormation of the ternary complex, and subseque...\n4.884981e-15\n14.311\n\n\n2\nRibosomal scanning and start codon recognition\n4.884981e-15\n14.311\n\n\n3\nActivation of the mRNA upon binding of the cap...\n4.884981e-15\n14.311\n\n\n4\nGTP hydrolysis and joining of the 60S ribosoma...\n4.884981e-15\n14.311\n\n\n...\n...\n...\n...\n\n\n1754\nImmunoregulatory interactions between a Lympho...\n1.000000e+00\n0.000\n\n\n1755\nClass A/1 (Rhodopsin-like receptors)\n1.000000e+00\n0.000\n\n\n1756\nSLC-mediated transmembrane transport\n1.000000e+00\n0.000\n\n\n1757\nGPCR ligand binding\n1.000000e+00\n0.000\n\n\n1758\nSensory Perception\n1.000000e+00\n-0.000\n\n\n\n\n1759 rows × 3 columns\n\n\n\n\nref_paths.name.shape\n\n(13,)\n\n\n\nplot_path(path_df,top_n=50,path_list=ref_paths.name)\n\n\n\n\n\n\n\n\n\npath_df_raw[path_df_raw.stId.isin(idx_path)]\n\n\ndef get_reactome(gene_list,\n                 col='entities.fdr', # column of p value or fdr (e.g., entities.pValue)\n                 ref_list=None, # list of reactome idx\n                ):\n    \"Reactome pathway analysis for a given gene set; returns formated output in dataframe with additional -log10(p)\"\n    out = get_reactome_raw(gene_list).copy()\n    col_rename = col.split('.')[1]\n    out = out[['stId','name',col]].rename(columns={col:col_rename,'stId':'ID'})\n    out['significant']=(out[col_rename]&lt;=0.05).astype(int)\n    out[f'-log10({col_rename})'] = -np.log10(out[col_rename]).round(3)\n    out[f'rank']=out[col_rename].rank().astype(int)\n    if ref_list: out['in_ref']=out.ID.isin(ref_list).astype(int)\n    \n    return out\n\n\nout = get_reactome(genes,ref_list=idx_path)\n\n\nout[out.in_ref==1]\n\n\n\n\n\n\n\n\nID\nname\nfdr\nsignificant\n-log10(fdr)\nrank\nin_ref\n\n\n\n\n80\nR-HSA-8939236\nRUNX1 regulates transcription of genes involve...\n1.253766e-08\n1\n7.902\n81\n1\n\n\n129\nR-HSA-5663213\nRHO GTPases Activate WASPs and WAVEs\n3.404711e-06\n1\n5.468\n130\n1\n\n\n157\nR-HSA-5693565\nRecruitment and ATM-mediated phosphorylation o...\n1.482829e-05\n1\n4.829\n156\n1\n\n\n306\nR-HSA-9841922\nMLL4 and MLL3 complexes regulate expression of...\n6.713774e-04\n1\n3.173\n304\n1\n\n\n423\nR-HSA-983231\nFactors involved in megakaryocyte development ...\n4.163072e-03\n1\n2.381\n424\n1\n\n\n424\nR-HSA-69231\nCyclin D associated events in G1\n4.191536e-03\n1\n2.378\n426\n1\n\n\n473\nR-HSA-9860927\nTurbulent (oscillatory, disturbed) flow shear ...\n7.981719e-03\n1\n2.098\n474\n1\n\n\n485\nR-HSA-2029482\nRegulation of actin dynamics for phagocytic cu...\n9.889877e-03\n1\n2.005\n486\n1\n\n\n526\nR-HSA-5685938\nHDR through Single Strand Annealing (SSA)\n1.734879e-02\n1\n1.761\n527\n1\n\n\n629\nR-HSA-9664422\nFCGR3A-mediated phagocytosis\n4.756334e-02\n1\n1.323\n630\n1\n\n\n662\nR-HSA-428890\nRole of ABL in ROBO-SLIT signaling\n6.281753e-02\n0\n1.202\n663\n1\n\n\n922\nR-HSA-525793\nMyogenesis\n1.742057e-01\n0\n0.759\n923\n1\n\n\n1193\nR-HSA-8940973\nRUNX2 regulates osteoblast differentiation\n4.049378e-01\n0\n0.393\n1194\n1\n\n\n\n\n\n\n\n\nout.fdr.rank()\n\n0         22.0\n1         22.0\n2         22.0\n3         22.0\n4         22.0\n         ...  \n1754    1755.0\n1755    1756.0\n1756    1757.0\n1757    1758.0\n1758    1759.0\nName: fdr, Length: 1759, dtype: float64\n\n\n\ndef plot_path(df,col='-log10(fdr)', top_n=10,max_label_length=80):\n    \"Plot the bar graph of pathways from get_reactome function.\"\n    \n    # Extract the data and reverse it\n    data = df.head(top_n).set_index('name')[col].iloc[::-1]\n    \n    # Truncate labels if they are too long\n    truncated_labels = [label[:max_label_length] + '...' if len(label) &gt; max_label_length else label for label in data.index]\n    data.index = truncated_labels\n\n    # Calculate the required width: base width + additional width for the longest label\n    base_width = 2\n    max_label_length = max(data.index, key=len)\n    additional_width = len(max_label_length) * 0.1  # Adjust scaling factor as needed\n    \n    figsize = (base_width + additional_width, 3*top_n/10)  # Adjust height as necessary\n\n    data.plot.barh(figsize=figsize)\n    plt.ylabel('')\n    plt.xlabel(col)\n    plt.tight_layout()\n\n\nimport matplotlib.pyplot as plt\n\ndef plot_path(df, col='-log10(fdr)', top_n=10, max_label_length=80, path_list=None):\n    \"\"\"\n    Plot the bar graph of pathways from get_reactome function.\n    Highlights pathways in path_list with a different color (dark red).\n    \"\"\"\n    # Extract and reverse data\n    data = df.head(top_n).set_index('name')[col].iloc[::-1]\n\n    # Save original full names to match against path_list\n    full_names = data.index.tolist()\n    \n    # Truncate labels if too long\n    truncated_labels = [label[:max_label_length] + '...' if len(label) &gt; max_label_length else label for label in full_names]\n    data.index = truncated_labels\n\n    # Determine colors\n    if path_list is not None:\n        path_set = set(path_list)\n        colors = ['darkred' if name in path_set else 'darkblue' for name in full_names]\n    else:\n        colors = 'darkblue'\n\n    # Calculate dynamic figure width\n    base_width = 2\n    max_label = max(data.index, key=len)\n    additional_width = len(max_label) * 0.1\n    figsize = (base_width + additional_width, 3 * top_n / 10)\n\n    # Plot\n    ax = data.plot.barh(figsize=figsize, color=colors)\n    plt.ylabel('')\n    plt.xlabel(col)\n    plt.tight_layout()\n    return ax\n\n\npath_fdr = path_df_raw[path_df_raw['entities.fdr']&lt;0.05]\n\n\npath_fdr\n\n\n\n\n\n\n\n\nstId\ndbId\nname\nllp\ninDisease\nspecies.dbId\nspecies.taxId\nspecies.name\nentities.resource\nentities.total\nentities.found\nentities.ratio\nentities.pValue\nentities.fdr\nentities.exp\nreactions.resource\nreactions.total\nreactions.found\nreactions.ratio\n\n\n\n\n0\nR-HSA-72649\n72649\nTranslation initiation complex formation\nTrue\nFalse\n48887\n9606\nHomo sapiens\nTOTAL\n62\n39\n0.003861\n1.110223e-16\n4.884981e-15\n[]\nTOTAL\n2\n2\n0.000129\n\n\n1\nR-HSA-72695\n72695\nFormation of the ternary complex, and subseque...\nTrue\nFalse\n48887\n9606\nHomo sapiens\nTOTAL\n54\n33\n0.003362\n1.110223e-16\n4.884981e-15\n[]\nTOTAL\n3\n3\n0.000193\n\n\n2\nR-HSA-72702\n72702\nRibosomal scanning and start codon recognition\nTrue\nFalse\n48887\n9606\nHomo sapiens\nTOTAL\n64\n39\n0.003985\n1.110223e-16\n4.884981e-15\n[]\nTOTAL\n2\n2\n0.000129\n\n\n3\nR-HSA-72662\n72662\nActivation of the mRNA upon binding of the cap...\nTrue\nFalse\n48887\n9606\nHomo sapiens\nTOTAL\n66\n39\n0.004110\n1.110223e-16\n4.884981e-15\n[]\nTOTAL\n6\n6\n0.000386\n\n\n4\nR-HSA-72706\n72706\nGTP hydrolysis and joining of the 60S ribosoma...\nTrue\nFalse\n48887\n9606\nHomo sapiens\nTOTAL\n120\n66\n0.007472\n1.110223e-16\n4.884981e-15\n[]\nTOTAL\n3\n3\n0.000193\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\n631\nR-HSA-8866427\n8866427\nVLDLR internalisation and degradation\nTrue\nFalse\n48887\n9606\nHomo sapiens\nTOTAL\n16\n4\n0.000996\n2.450345e-02\n4.900690e-02\n[]\nTOTAL\n4\n4\n0.000257\n\n\n632\nR-HSA-8984722\n8984722\nInterleukin-35 Signalling\nTrue\nFalse\n48887\n9606\nHomo sapiens\nTOTAL\n16\n4\n0.000996\n2.450345e-02\n4.900690e-02\n[]\nTOTAL\n26\n25\n0.001672\n\n\n633\nR-HSA-1679131\n1679131\nTrafficking and processing of endosomal TLR\nTrue\nFalse\n48887\n9606\nHomo sapiens\nTOTAL\n16\n4\n0.000996\n2.450345e-02\n4.900690e-02\n[]\nTOTAL\n7\n4\n0.000450\n\n\n634\nR-HSA-879415\n879415\nAdvanced glycosylation endproduct receptor sig...\nTrue\nFalse\n48887\n9606\nHomo sapiens\nTOTAL\n16\n4\n0.000996\n2.450345e-02\n4.900690e-02\n[]\nTOTAL\n4\n2\n0.000257\n\n\n635\nR-HSA-2173789\n2173789\nTGF-beta receptor signaling activates SMADs\nTrue\nFalse\n48887\n9606\nHomo sapiens\nTOTAL\n51\n8\n0.003176\n2.483726e-02\n4.967452e-02\n[]\nTOTAL\n44\n26\n0.002829\n\n\n\n\n636 rows × 19 columns\n\n\n\n\nplot_path??\n\n\nSignature: plot_path(react_out, top_n=10, max_label_length=80)\nSource:   \ndef plot_path(react_out, top_n=10,max_label_length=80):\n    \"Plot the bar graph of pathways from get_reactome function.\"\n    \n    # Extract the data and reverse it\n    data = react_out.head(top_n).set_index('name')['-log10_pValue'].iloc[::-1]\n    \n    # Truncate labels if they are too long\n    truncated_labels = [label[:max_label_length] + '...' if len(label) &gt; max_label_length else label for label in data.index]\n    data.index = truncated_labels\n    # Calculate the required width: base width + additional width for the longest label\n    base_width = 2\n    max_label_length = max(data.index, key=len)\n    additional_width = len(max_label_length) * 0.1  # Adjust scaling factor as needed\n    \n    figsize = (base_width + additional_width, 3*top_n/10)  # Adjust height as necessary\n    data.plot.barh(figsize=figsize)\n    plt.ylabel('')\n    plt.xlabel('-log10(p)')\n    plt.tight_layout()\nFile:      ~/katlas/katlas/utils.py\nType:      function\n\n\n\n\npath_fdr.loc[path_fdr['entities.ratio'].sort_values(ascending=False).index]\n\n\n\n\n\n\n\n\nstId\ndbId\nname\nllp\ninDisease\nspecies.dbId\nspecies.taxId\nspecies.name\nentities.resource\nentities.total\nentities.found\nentities.ratio\nentities.pValue\nentities.fdr\nentities.exp\nreactions.resource\nreactions.total\nreactions.found\nreactions.ratio\n\n\n\n\n180\nR-HSA-162582\n162582\nSignal Transduction\nFalse\nFalse\n48887\n9606\nHomo sapiens\nTOTAL\n3049\n267\n0.189851\n3.562203e-06\n3.562203e-05\n[]\nTOTAL\n2584\n1258\n0.166131\n\n\n48\nR-HSA-1643685\n1643685\nDisease\nFalse\nTrue\n48887\n9606\nHomo sapiens\nTOTAL\n2851\n299\n0.177522\n1.554312e-15\n6.061818e-14\n[]\nTOTAL\n2011\n716\n0.129292\n\n\n94\nR-HSA-168256\n168256\nImmune System\nFalse\nFalse\n48887\n9606\nHomo sapiens\nTOTAL\n2664\n256\n0.165878\n2.664359e-09\n5.328718e-08\n[]\nTOTAL\n1733\n791\n0.111418\n\n\n32\nR-HSA-392499\n392499\nMetabolism of proteins\nFalse\nFalse\n48887\n9606\nHomo sapiens\nTOTAL\n2417\n268\n0.150498\n1.110223e-16\n4.884981e-15\n[]\nTOTAL\n909\n428\n0.058442\n\n\n188\nR-HSA-74160\n74160\nGene expression (Transcription)\nFalse\nFalse\n48887\n9606\nHomo sapiens\nTOTAL\n1990\n186\n0.123910\n4.133596e-06\n3.895872e-05\n[]\nTOTAL\n1140\n486\n0.073293\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\n443\nR-HSA-9818025\n9818025\nNFE2L2 regulating TCA cycle genes\nTrue\nFalse\n48887\n9606\nHomo sapiens\nTOTAL\n7\n4\n0.000436\n1.440323e-03\n5.761294e-03\n[]\nTOTAL\n4\n4\n0.000257\n\n\n474\nR-HSA-9649913\n9649913\nRAS GTPase cycle mutants\nFalse\nTrue\n48887\n9606\nHomo sapiens\nTOTAL\n4\n3\n0.000249\n2.704293e-03\n8.112878e-03\n[]\nTOTAL\n2\n2\n0.000129\n\n\n475\nR-HSA-9753510\n9753510\nSignaling by RAS GAP mutants\nTrue\nTrue\n48887\n9606\nHomo sapiens\nTOTAL\n4\n3\n0.000249\n2.704293e-03\n8.112878e-03\n[]\nTOTAL\n1\n1\n0.000064\n\n\n476\nR-HSA-9753512\n9753512\nSignaling by RAS GTPase mutants\nTrue\nTrue\n48887\n9606\nHomo sapiens\nTOTAL\n4\n3\n0.000249\n2.704293e-03\n8.112878e-03\n[]\nTOTAL\n1\n1\n0.000064\n\n\n610\nR-HSA-9636667\n9636667\nManipulation of host energy metabolism\nTrue\nTrue\n48887\n9606\nHomo sapiens\nTOTAL\n3\n2\n0.000187\n1.804436e-02\n4.155485e-02\n[]\nTOTAL\n2\n2\n0.000129\n\n\n\n\n636 rows × 19 columns\n\n\n\n\npath_df = get_reactome(genes)\n\n\nplot_path??\n\n\nSignature: plot_path(react_out, top_n=10, max_label_length=80)\nSource:   \ndef plot_path(react_out, top_n=10,max_label_length=80):\n    \"Plot the bar graph of pathways from get_reactome function.\"\n    \n    # Extract the data and reverse it\n    data = react_out.head(top_n).set_index('name')['-log10_pValue'].iloc[::-1]\n    \n    # Truncate labels if they are too long\n    truncated_labels = [label[:max_label_length] + '...' if len(label) &gt; max_label_length else label for label in data.index]\n    data.index = truncated_labels\n    # Calculate the required width: base width + additional width for the longest label\n    base_width = 2\n    max_label_length = max(data.index, key=len)\n    additional_width = len(max_label_length) * 0.1  # Adjust scaling factor as needed\n    \n    figsize = (base_width + additional_width, 3*top_n/10)  # Adjust height as necessary\n    data.plot.barh(figsize=figsize)\n    plt.ylabel('')\n    plt.xlabel('-log10(p)')\n    plt.tight_layout()\nFile:      ~/katlas/katlas/utils.py\nType:      function\n\n\n\n\npath_df\n\n\n\n\n\n\n\n\nname\npValue\n-log10_pValue\n\n\n\n\n0\nTranslation initiation complex formation\n1.110223e-16\n15.955\n\n\n1\nFormation of the ternary complex, and subseque...\n1.110223e-16\n15.955\n\n\n2\nRibosomal scanning and start codon recognition\n1.110223e-16\n15.955\n\n\n3\nActivation of the mRNA upon binding of the cap...\n1.110223e-16\n15.955\n\n\n4\nGTP hydrolysis and joining of the 60S ribosoma...\n1.110223e-16\n15.955\n\n\n...\n...\n...\n...\n\n\n1754\nImmunoregulatory interactions between a Lympho...\n1.000000e+00\n0.000\n\n\n1755\nClass A/1 (Rhodopsin-like receptors)\n1.000000e+00\n0.000\n\n\n1756\nSLC-mediated transmembrane transport\n1.000000e+00\n0.000\n\n\n1757\nGPCR ligand binding\n1.000000e+00\n0.000\n\n\n1758\nSensory Perception\n1.000000e+00\n-0.000\n\n\n\n\n1759 rows × 3 columns\n\n\n\n\nplot_path(path_df,100)\nplt.title('AKT1')\n\nText(0.5, 1.0, 'AKT1')\n\n\n\n\n\n\n\n\n\n\ngenes\n\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nfrom katlas.core import *\nfrom katlas.plot import *\n\nfrom scipy.stats import spearmanr, pearsonr\n\nimport os\nfrom PIL import Image\nfrom tqdm import tqdm\n\n\ndef plot_count(df_k,title):\n    # Get value counts\n    source_counts = df_k.source.replace({'pplus':'PP','large_scale':'LS'}).value_counts()\n    plt.figure(figsize=(7,1))\n\n    source_counts.plot(kind='barh', stacked=True, color=['darkred', 'darkblue'])\n    # Annotate with the actual values\n    for index, value in enumerate(source_counts):\n        plt.text(value, index, str(value),fontsize=10,rotation=-90, va='center')\n\n    plt.xlabel('Count')\n    plt.title(title)\n\n\nsns.set(rc={\"figure.dpi\":200, 'savefig.dpi':200})\nsns.set_context('notebook')\nsns.set_style(\"ticks\")",
    "crumbs": [
      "Plot heatmap and logo of CDDM"
    ]
  },
  {
    "objectID": "plot_cddm.html#load-data",
    "href": "plot_cddm.html#load-data",
    "title": "Plot heatmap and logo of CDDM",
    "section": "Load data",
    "text": "Load data\n\ndf = Data.get_ks_dataset()\ndf['SUB'] = df.substrate.str.upper()\n\n\ninfo = Data.get_kinase_info().query('pseudo==\"0\"')\n\n\n# It only contains kinase on the tree\ncnt = df.kinase_paper.value_counts()\n\n\nST = info[info.group!=\"TK\"].kinase\n\n\ndf[df.kinase_paper.isin(ST)].kinase_paper.value_counts()[10:20]\n\nNEK6     950\nPLK1     943\nCK2A1    919\nP38D     907\nDYRK2    907\nHGK      902\nTTBK1    896\nMST3     890\nMST1     884\nIKKE     880\nName: kinase_paper, dtype: int64\n\n\n\ncnt = cnt[cnt&gt;100]",
    "crumbs": [
      "Plot heatmap and logo of CDDM"
    ]
  },
  {
    "objectID": "plot_cddm.html#generate-example-figures",
    "href": "plot_cddm.html#generate-example-figures",
    "title": "Plot heatmap and logo of CDDM",
    "section": "Generate example figures",
    "text": "Generate example figures\n\ndef plot_heatmap2(matrix, title, figsize=(6,10), label_size=20):\n    plt.figure(figsize=figsize)\n    sns.heatmap(matrix, cmap='binary', annot=False,cbar=False)\n    plt.title(title,fontsize=label_size)\n        # Set the font size for the tick labels\n    plt.xticks(fontsize=label_size)\n    plt.yticks(fontsize=label_size)\n    plt.xlabel('')\n    plt.ylabel('')\n\n\nkinase_list = ['SRC','ABL1','ERK2','PKACA']\n\n\nsns.set(rc={\"figure.dpi\":200, 'savefig.dpi':200})\nsns.set_context('notebook')\nsns.set_style(\"ticks\")\n\nfor k in kinase_list:\n    df_k = df.query(f'kinase==\"{k}\"')\n    df_k = df_k.drop_duplicates(subset='SUB').reset_index()\n\n    paper,full = get_freq(df_k)\n\n    plot_heatmap2(full.drop(columns=[0]),f'{k}',figsize=(6,10))\n    plt.show()\n    plt.close()\n        \n    break\n\n    # if you want to generate and save all of figures, uncomment below\n    # plt.savefig(f'fig/{k}.png',bbox_inches='tight', pad_inches=0.3)\n    # plt.close()",
    "crumbs": [
      "Plot heatmap and logo of CDDM"
    ]
  },
  {
    "objectID": "plot_cddm.html#generate-all-figures",
    "href": "plot_cddm.html#generate-all-figures",
    "title": "Plot heatmap and logo of CDDM",
    "section": "Generate all figures",
    "text": "Generate all figures\nUncomment plt.savefig to save figures\n\nsns.set(rc={\"figure.dpi\":200, 'savefig.dpi':200})\nsns.set_context('notebook')\nsns.set_style(\"ticks\")\n\nfor k in tqdm(cnt.index,total=len(cnt)):\n    \n    df_k = df.query(f'kinase==\"{k}\"')\n    \n    plot_count(df_k,k)\n    # plt.savefig(f'fig/count/{k}.png',bbox_inches='tight', pad_inches=0.1)\n    plt.show() # if visualize in jupyter notebook, uncheck the savefig\n    plt.close()\n    \n    \n    df_k = df_k.drop_duplicates(subset='SUB').reset_index()\n    \n    paper,full = get_freq(df_k)\n\n    get_logo2(full, k)\n    # plt.savefig(f'fig/logo/{k}.png',bbox_inches='tight', pad_inches=0.3)\n    plt.show()\n    plt.close()\n\n    plot_heatmap(full.drop(columns=[0]),f'{k} (n={len(df_k)})',figsize=(7.5,10))\n    # plt.savefig(f'fig/heatmap/{k}.png',bbox_inches='tight', pad_inches=0)\n    plt.show()\n    plt.close()\n    # break\n    break\n\n  0%|          | 0/289 [00:00&lt;?, ?it/s]\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n  0%|          | 0/289 [00:02&lt;?, ?it/s]",
    "crumbs": [
      "Plot heatmap and logo of CDDM"
    ]
  },
  {
    "objectID": "plot_cddm.html#combine-figures-for-pdf",
    "href": "plot_cddm.html#combine-figures-for-pdf",
    "title": "Plot heatmap and logo of CDDM",
    "section": "Combine figures for pdf",
    "text": "Combine figures for pdf\n\ndef combine_images_vertically(image_paths, output_path):\n    images = [Image.open(image_path).convert('RGBA') for image_path in image_paths]\n    \n    total_width = max(image.width for image in images)\n    total_height = sum(image.height for image in images)\n\n    combined_image = Image.new('RGBA', (total_width, total_height))\n\n    y_offset = 0\n    for image in images:\n        combined_image.paste(image, (0, y_offset), image)\n        y_offset += image.height\n\n    combined_image.save(output_path)\n\nUncomment below to run\n\n# folders = [\"fig/count\", \"fig/logo\", \"fig/heatmap\"]\n# for k in tqdm(cnt.index,total=len(cnt)):\n#     filename = f\"{k}.png\"\n#     image_paths = [os.path.join(folder, filename) for folder in folders]\n#     output_path = f\"fig/combine/{k}.png\"\n    \n#     combine_images_vertically(image_paths, output_path)\n#     # break",
    "crumbs": [
      "Plot heatmap and logo of CDDM"
    ]
  },
  {
    "objectID": "plot_cddm.html#get-pssm-data-of-cddm",
    "href": "plot_cddm.html#get-pssm-data-of-cddm",
    "title": "Plot heatmap and logo of CDDM",
    "section": "Get PSSM data of CDDM",
    "text": "Get PSSM data of CDDM\n\nfor i,k in enumerate(cnt.index):\n    \n    df_k = df.query(f'kinase==\"{k}\"')\n    df_k = df_k.drop_duplicates(subset='SUB').reset_index()\n    \n    paper,full = get_freq(df_k)\n\n    melt = full.drop(columns = [0]).reset_index().melt(id_vars=['aa'], value_name=k, var_name='Position')\n    melt['substrate']=melt['Position'].astype(str)+ melt['aa']\n\n    position_0 = full[0][['s','t','y']].reset_index().rename(columns={0:k})\n    position_0['substrate'] = '0'+position_0['aa']\n\n    if i ==0:\n        first = pd.concat([melt,position_0])[['substrate',k]].set_index('substrate')\n    else:\n        k = pd.concat([melt,position_0])[['substrate',k]].set_index('substrate')\n        data = pd.concat([first,k],axis=1)\n        first = data.copy()\n    \n    # break\n\n\ndata = data.T\n\ndata.index = data.index.rename('kinase')\n\nTo save\n\n# data.to_csv('supp/CDDM.csv')\n\n# data.to_parquet('ks_main.parquet')",
    "crumbs": [
      "Plot heatmap and logo of CDDM"
    ]
  },
  {
    "objectID": "plot_cddm.html#get-specialized-cddm-data-for-all-capital-substrates",
    "href": "plot_cddm.html#get-specialized-cddm-data-for-all-capital-substrates",
    "title": "Plot heatmap and logo of CDDM",
    "section": "Get specialized CDDM data for all-capital substrates",
    "text": "Get specialized CDDM data for all-capital substrates\n\ncombine s,t,y to S,T,Y\n\n\n# List of suffixes\nsuffixes = ['S', 'T', 'Y']\n\nfor suffix in suffixes:\n    for i in range(-7, 8):  # looping from -7 to 7\n        if i == 0:  # Skip 0\n            continue\n        \n        upper_col = f\"{i}{suffix}\"  # e.g., -7S\n        lower_col = f\"{i}{suffix.lower()}\"  # e.g., -7s\n        data[upper_col] = data[upper_col] + data[lower_col]\n        data.drop(lower_col, axis=1,inplace=True)  # Drop the lowercase column after combining\n\n\ndata.columns[data.columns.str.contains('S')]\n\nIndex(['-7S', '-6S', '-5S', '-4S', '-3S', '-2S', '-1S', '1S', '2S', '3S', '4S',\n       '5S', '6S', '7S'],\n      dtype='object', name='substrate')\n\n\n\n# make sure the \"s\" in positions other than 0 is deleted from the columns\ndata.columns[data.columns.str.contains('s')]\n\nIndex(['0s'], dtype='object', name='substrate')\n\n\n\n# Make sure very position's sum is 1\ndata.loc[:,data.columns.str.contains('-7')].sum(1).sort_values()\n\nkinase\nDDR2      1.0\nNEK11     1.0\nMSK1      1.0\nTEK       1.0\nNIM1      1.0\n         ... \nCAMK2G    1.0\nPKG2      1.0\nMELK      1.0\nNEK1      1.0\nTLK2      1.0\nLength: 289, dtype: float64\n\n\n\ndata = data.rename(columns={'0s':'0S','0t':'0T','0y':'0Y'})\n\n\ndata.index = data.index.rename('kinase')\n\nTo save\n\n# data.to_parquet('ks_main_upper.parquet')\n# data.to_csv('supp/CDDM_upper.csv')",
    "crumbs": [
      "Plot heatmap and logo of CDDM"
    ]
  },
  {
    "objectID": "plot_cddm.html#plot-other-kinases-mutated-lipid-kinase-isoforms",
    "href": "plot_cddm.html#plot-other-kinases-mutated-lipid-kinase-isoforms",
    "title": "Plot heatmap and logo of CDDM",
    "section": "Plot other kinases (mutated, lipid kinase, isoforms)",
    "text": "Plot other kinases (mutated, lipid kinase, isoforms)\n\nkinases not on kinome tree\n\n\ncnt_other = df.query('on_tree==0').kinase.value_counts()\n\ncnt_other = cnt_other[cnt_other&gt;100]\n\n\nothers = cnt_other.index.tolist()+['LYN','ABL1','RET','FGFR3','PDGFRA','ALK',\n                          'EGFR','KIT','MET','PKCB','BRAF','PKG1'] # BRAF is less than 100\n\nUncheck savefig to save figures\n\nfor k in tqdm(others,total=len(others)):\n    df_k = df.query(f'kinase==\"{k}\"')\n    \n    plot_count(df_k,k)\n    # plt.savefig(f'fig_others/count/{k.replace(\"/\", \"_\")}.png',bbox_inches='tight', pad_inches=0.1)\n    plt.show() # if visualize in jupyter notebook, uncheck the savefig\n    plt.close()\n    \n    df_k = df_k.drop_duplicates(subset='SUB').reset_index()\n    \n    paper,full = get_freq(df_k)\n    \n    get_logo2(full,k)\n    # plt.savefig(f'fig_others/logo/{k.replace(\"/\", \"_\")}.png',bbox_inches='tight', pad_inches=0.3)\n    plt.show()\n    plt.close()\n    \n    plot_heatmap(full.drop(columns=[0]),f'{k} (n={len(df_k)})',figsize=(7.5,10))\n    # plt.savefig(f'fig_others/heatmap/{k.replace(\"/\", \"_\")}.png',bbox_inches='tight', pad_inches=0)\n    plt.show()\n    plt.close()\n    \n    break\n\n  0%|          | 0/36 [00:00&lt;?, ?it/s]\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n  0%|          | 0/36 [00:01&lt;?, ?it/s]",
    "crumbs": [
      "Plot heatmap and logo of CDDM"
    ]
  },
  {
    "objectID": "plot_cddm.html#combine-the-figures-for-pdf",
    "href": "plot_cddm.html#combine-the-figures-for-pdf",
    "title": "Plot heatmap and logo of CDDM",
    "section": "Combine the figures for pdf",
    "text": "Combine the figures for pdf\nUncomment below to run\n\n# folders = [\"fig_others/count\", \"fig_others/logo\", \"fig_others/heatmap\"]\n# for k in tqdm(others,total = len(others)):\n#     k = k.replace(\"/\", \"_\")\n    \n#     filename = f\"{k}.png\"\n    \n#     image_paths = [os.path.join(folder, filename) for folder in folders]\n    \n#     output_path = f\"fig_others/combine/{k}.png\"\n    \n#     combine_images_vertically(image_paths, output_path)\n#     # break",
    "crumbs": [
      "Plot heatmap and logo of CDDM"
    ]
  },
  {
    "objectID": "plot_cddm.html#get-the-pssms-of-other-kinases",
    "href": "plot_cddm.html#get-the-pssms-of-other-kinases",
    "title": "Plot heatmap and logo of CDDM",
    "section": "Get the PSSMs of other kinases",
    "text": "Get the PSSMs of other kinases\n\nfor i,k in enumerate(others):\n    df_k = df.query(f'kinase==\"{k}\"')\n    df_k = df_k.drop_duplicates(subset='SUB').reset_index()\n    \n    paper,full = get_freq(df_k)\n    \n    melt = full.drop(columns = [0]).reset_index().melt(id_vars=['aa'], value_name=k, var_name='Position')\n    melt['substrate']=melt['Position'].astype(str)+ melt['aa']\n\n    position_0 = full[0][['s','t','y']].reset_index().rename(columns={0:k})\n    position_0['substrate'] = '0'+position_0['aa']\n\n    if i ==0:\n        first = pd.concat([melt,position_0])[['substrate',k]].set_index('substrate')\n    else:\n        k = pd.concat([melt,position_0])[['substrate',k]].set_index('substrate')\n        data = pd.concat([first,k],axis=1)\n        first = data.copy()\n\n\ndata = data.T\n\ndata.index = data.index.rename('kinase')\n\nTo save:\n\n# data.to_csv('supp/CDDM_others.csv')\n\n# data.to_parquet('ks_others.parquet')",
    "crumbs": [
      "Plot heatmap and logo of CDDM"
    ]
  },
  {
    "objectID": "sty_composition.html",
    "href": "sty_composition.html",
    "title": "STY composition",
    "section": "",
    "text": "from katlas.core import *\nimport pandas as pd\n\n\nref = pd.read_parquet('out/CDDM_pssms_LO_eval.parquet')\n\n\nref2 =preprocess_ref(ref)\n\n\ninfo = Data.get_kinase_info().sort_values('kinase').drop_duplicates('uniprot')\n\n\ninfo['kinase_id'] = info['uniprot']+'_' + info['gene']\n\n\n# some are not in the kinome info\nref2[~ref2.index.isin(info.kinase_id)]\n\n\n\n\n\n\n\n\n-20A\n-20C\n-20D\n-20E\n-20F\n-20G\n-20H\n-20I\n-20K\n-20L\n...\n20Q\n20R\n20S\n20T\n20V\n20W\n20Y\n20s\n20t\n20y\n\n\nindex\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nP07948-2_LYN\n-0.201025\n-0.563368\n-0.074525\n-0.276853\n0.451878\n0.212021\n-0.306423\n0.321053\n0.383523\n-0.119475\n...\n-0.457078\n-0.198480\n-0.486640\n0.043253\n-0.611027\n0.248941\n-0.522681\n-0.603284\n-0.501659\n0.703503\n\n\nP05771-2_PRKCB\n-0.378789\n-0.105544\n-0.414208\n-0.766561\n0.469130\n-0.148789\n1.248263\n1.264304\n-1.293812\n-0.955833\n...\n-1.575331\n-0.418613\n-0.064964\n0.312925\n0.395611\n0.787799\n-1.955805\n0.418784\n-0.654678\n0.035912\n\n\nQ13976-2_PRKG1\n0.377940\n-20.551687\n0.272132\n0.693775\n-1.166458\n-0.992964\n-0.676831\n-0.271748\n-0.022510\n-0.591422\n...\n0.315217\n0.056898\n0.258544\n-0.059560\n-0.228413\n0.678348\n-1.480295\n0.379722\n-1.179166\n1.511422\n\n\nQ9NRA0_SPHK2\n1.165531\n-20.551687\n-0.220384\n0.123256\n-1.658974\n-0.807408\n1.830652\n0.498770\n-0.836954\n-0.083938\n...\n-1.138814\n0.240296\n-0.365413\n0.749442\n0.317555\n0.224317\n-0.934327\n0.118335\n-0.633198\n0.057392\n\n\nP48736_PIK3CG\n0.428566\n-20.551687\n0.000830\n0.666398\n-1.115832\n0.057662\n-0.626205\n-0.543050\n0.513543\n-22.986938\n...\n1.268002\n-22.498627\n0.555977\n-21.767089\n0.694625\n-19.707253\n0.665134\n-1.282202\n-0.033737\n-19.874178\n\n\n\n\n5 rows × 943 columns\n\n\n\n\nhue = hue.merge(info,left_on='index',right_on='uniprot')\n\n\nhue.set_index('kinase_id')['group']\n\nkinase_id\nP12931_SRC         TK\nP29320_EPHA3       TK\nP07332_FES         TK\nQ16288_NTRK3       TK\nQ9UM73_ALK         TK\n                ...  \nQ15746_MYLK      CAMK\nQ01973_ROR1        TK\nO14976_GAK      Other\nP15056_BRAF       TKL\nQ6P0Q8_MAST2      AGC\nName: group, Length: 330, dtype: object\n\n\n\nref2\n\n\n\n\n\n\n\n\n-20A\n-20C\n-20D\n-20E\n-20F\n-20G\n-20H\n-20I\n-20K\n-20L\n...\n20Q\n20R\n20S\n20T\n20V\n20W\n20Y\n20s\n20t\n20y\n\n\nindex\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nP12931_SRC\n-0.303165\n-0.374748\n0.053554\n-0.168660\n0.079632\n0.214991\n-0.291338\n0.351244\n0.244339\n0.005575\n...\n-0.228598\n0.025968\n-0.328084\n0.112171\n-0.368079\n-0.025931\n-0.102114\n-0.546950\n0.073484\n1.274269\n\n\nP29320_EPHA3\n-0.184360\n-0.772408\n0.041784\n-0.335815\n0.038333\n0.361651\n-0.112498\n0.240746\n0.271984\n-0.137271\n...\n-0.387529\n-0.047099\n-0.814426\n-0.006232\n-0.171474\n-0.194322\n-0.031039\n-0.527715\n-0.113239\n0.754229\n\n\nP07332_FES\n-0.047304\n-0.668876\n0.095709\n-0.338939\n0.048756\n0.238490\n-0.102075\n0.353049\n0.371674\n0.065796\n...\n-0.164643\n-0.071350\n-0.644998\n0.017345\n-0.382362\n-0.170745\n-0.106998\n-0.402258\n-0.220906\n1.121760\n\n\nQ16288_NTRK3\n0.004691\n0.150181\n-0.006480\n-0.157199\n0.057431\n0.143462\n-0.424928\n0.496946\n0.519908\n-0.051274\n...\n-0.577591\n-0.125417\n-0.978218\n-0.241875\n-0.606648\n-0.214459\n-0.247573\n-0.779873\n-0.071975\n0.803039\n\n\nQ9UM73_ALK\n-0.027114\n0.139216\n-0.115000\n-0.300995\n0.428488\n0.150419\n-0.326997\n0.286672\n0.400256\n-0.126111\n...\n-0.431957\n0.125002\n-0.813833\n-0.317107\n-0.515009\n-0.224103\n-0.198324\n-0.467588\n-0.148733\n0.849979\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\nQ15746_MYLK\n0.247994\n-20.551687\n-0.957350\n1.123256\n2.247916\n-0.222446\n-21.072348\n0.498770\n-0.251992\n-0.498976\n...\n0.147490\n-1.280754\n-0.079108\n-21.767089\n-22.421369\n-19.707253\n0.351976\n0.404639\n0.653105\n-19.874178\n\n\nQ01973_ROR1\n-1.458959\n-20.551687\n-22.445312\n0.416303\n-0.196003\n0.655563\n-21.072348\n-0.623221\n-22.739954\n-0.620966\n...\n-22.070383\n-1.093127\n2.108518\n-21.767089\n-1.015868\n-19.707253\n-20.865897\n1.914194\n-20.564768\n1.531322\n\n\nO14976_GAK\n1.165531\n-20.551687\n-0.039812\n-0.544169\n-0.156474\n-0.304908\n-21.072348\n-0.583692\n-22.739954\n-0.581438\n...\n-22.070383\n-1.171130\n-0.969484\n0.560409\n-0.093871\n-19.707253\n-20.865897\n0.514264\n0.762730\n-19.874178\n\n\nP15056_BRAF\n-0.497433\n-20.551687\n0.882185\n0.377829\n-21.561975\n-0.382911\n0.255150\n-21.989192\n-1.412456\n0.340559\n...\n-0.664883\n0.491835\n0.693481\n1.223374\n0.569094\n1.698247\n-20.865897\n0.592266\n-20.564768\n-19.874178\n\n\nQ6P0Q8_MAST2\n0.050054\n-20.551687\n-0.155289\n0.662282\n-0.271951\n0.579615\n3.025030\n-21.989192\n-1.449931\n-0.696915\n...\n-22.070383\n2.037269\n-0.931010\n1.183845\n1.751958\n3.243681\n-20.865897\n-0.447262\n-20.564768\n-19.874178\n\n\n\n\n335 rows × 943 columns\n\n\n\n\npssms=pd.read_parquet('out/CDDM_pssms.parquet')\n\n\npssms =preprocess_ref(pssms)\n\n\npssms = pssms[['0s','0t','0y']]\n\n\npssms_info = pssms.merge(hue,left_on='index',right_on='kinase_id')\n\n\npssms_info.columns\n\nIndex(['0s', '0t', '0y', 'index', 'kinase', 'ID_coral', 'uniprot', 'gene',\n       'modi_group', 'group', 'family', 'subfamily_coral', 'subfamily',\n       'in_pspa_st', 'in_pspa_tyr', 'in_pspa', 'in_cddm', 'kd_ID',\n       'active_D1_D2', 'active_kd_ID', 'pspa_ID', 'pseudo',\n       'pspa_category_small', 'pspa_category_big', 'cddm_big', 'cddm_small',\n       'length', 'human_uniprot_sequence', 'kinasecom_domain', 'nucleus',\n       'cytosol', 'cytoskeleton', 'plasma membrane', 'mitochondrion',\n       'Golgi apparatus', 'endoplasmic reticulum', 'vesicle', 'centrosome',\n       'aggresome', 'main_location', 'kinase_id'],\n      dtype='object')\n\n\n\nplot_bar(pssms_info,'0s','subfamily',figsize=(30,4))\n\n\n\n\n\n\n\n\n\nplot_bar(pssms_info,'0y','subfamily',figsize=(30,4))\n\n\n\n\n\n\n\n\n\nplot_bar(pssms_info,'0t','subfamily',figsize=(30,4))",
    "crumbs": [
      "STY composition"
    ]
  },
  {
    "objectID": "plot_pspa_figure.html",
    "href": "plot_pspa_figure.html",
    "title": "PSPA figures",
    "section": "",
    "text": "from katlas.data import *\nfrom katlas.utils import *\nfrom katlas.pssm import *\nfrom katlas.plot import *\nfrom tqdm import tqdm\nimport numpy as np\n\n\npspa= Data.get_pspa_all_norm()\n\n⬇️ Downloading katlas_dataset.zip ...\n\n\nDownloading...\nFrom (original): https://drive.google.com/uc?id=17wIl0DbdoHV036Z3xgaT_0H3LlM_W47l\nFrom (redirected): https://drive.google.com/uc?id=17wIl0DbdoHV036Z3xgaT_0H3LlM_W47l&confirm=t&uuid=92b66229-0f35-4442-b590-c54c406e4795\nTo: /home/sky1ove/git/katlas-raw/nbs/katlas_datasets.zip\n100%|███████████████████████████████████████████████████████████████████████████████████████████| 209M/209M [00:05&lt;00:00, 37.6MB/s]\n\n\n📂 Extracting to /tmp/katlas_dataset ...\n🧹 Removing zip file: katlas_datasets.zip\n✅ Done! Extracted dataset is at: /tmp/katlas_dataset\n\n\n\npspa.head()\n\n\n\n\n\n\n\n\n-5P\n-5G\n-5A\n-5C\n-5S\n-5T\n-5V\n-5I\n-5L\n-5M\n...\n5H\n5K\n5R\n5Q\n5N\n5D\n5E\n5s\n5t\n5y\n\n\nkinase\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nAAK1\n0.0720\n0.0245\n0.0284\n0.0456\n0.0425\n0.0425\n0.0951\n0.1554\n0.0993\n0.0864\n...\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\n\n\nACVR2A\n0.0415\n0.0481\n0.0584\n0.0489\n0.0578\n0.0578\n0.0598\n0.0625\n0.0596\n0.0521\n...\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\n\n\nACVR2B\n0.0533\n0.0517\n0.0566\n0.0772\n0.0533\n0.0533\n0.0543\n0.0442\n0.0471\n0.0516\n...\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\n\n\nAKT1\n0.0603\n0.0594\n0.0552\n0.0605\n0.0516\n0.0516\n0.0427\n0.0435\n0.0464\n0.0505\n...\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\n\n\nAKT2\n0.0602\n0.0617\n0.0643\n0.0582\n0.0534\n0.0534\n0.0433\n0.0418\n0.0493\n0.0513\n...\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\n\n\n\n\n5 rows × 236 columns\n\n\n\nIf using uniprot+gene name, change the index following the commented code:\n\n# info = Data.get_kinase_info()\n\n# info = info[info.pseudo=='0'].copy()\n\n# info['uniprot_gene'] = info['uniprot'] + '_' + info['gene']\n\n# id_map = info[['kinase','uniprot_gene']].drop_duplicates().set_index('kinase')['uniprot_gene']\n\n# parts = pspa.index.str.split('_')\n# first = parts.str[0].map(id_map)\n# second = parts.str.get(1)\n\n# new_index = first + np.where(second.notna(), '_' + second, '')\n\n# pspa.index=new_index\n\n\npspa.index.duplicated().sum()\n\nnp.int64(0)\n\n\n\nSHOW=False\n\n\ndef plot_logo_pspa(row,title='Motif',figsize=(5,2)):\n    pssm = recover_pssm_pspa(row)\n    logo_pssm = preprocess_pssm_pspa(pssm)\n    plot_logo_raw(logo_pssm,ytitle='log₂(Value / Median)',title=title,figsize=figsize)\n\n\nfor k, row in tqdm(pspa.iterrows(),total=len(pspa)): \n    plot_logo_heatmap_pspa(row,title=k,figsize=(5,10))\n    path1=prepare_path(f'fig/pspa/{k}/pssm.svg')\n    save_show(path1,show_only=SHOW)\n\n    plot_logo_pspa(row,title=k,figsize=(4,1.7))\n    path2=prepare_path(f'fig/pspa/{k}/logo.svg')\n    save_show(path2,show_only=SHOW)\n    # break\n\n100%|████████████████████████████████████████████████████████████████████████████████████████████| 396/396 [20:14&lt;00:00,  3.07s/it]\n\n\n\nlen(pspa)\n\n396",
    "crumbs": [
      "PSPA figures"
    ]
  },
  {
    "objectID": "scoring_compare_all.html",
    "href": "scoring_compare_all.html",
    "title": "Scoring evaluation",
    "section": "",
    "text": "from katlas.core import *\nfrom katlas.plot import *\nimport pandas as pd,numpy as np\nfrom matplotlib import pyplot as plt",
    "crumbs": [
      "Scoring evaluation"
    ]
  },
  {
    "objectID": "scoring_compare_all.html#functions",
    "href": "scoring_compare_all.html#functions",
    "title": "Scoring evaluation",
    "section": "Functions",
    "text": "Functions\n\ndef split_data(df):\n    df_st = df[df.kinase_group !='TK'].copy().reset_index(drop=True)\n    df_tyr = df[df.kinase_group =='TK'].copy().reset_index(drop=True)\n    \n    df_st = df_st[df_st.site_seq.str[20]!='y'].copy().reset_index(drop=True)\n    df_tyr = df_tyr[df_tyr.site_seq.str[20]=='y'].copy().reset_index(drop=True)\n    return df_st, df_tyr\n\n\ndef split_ref(ref):\n    ref_st = ref[ref.index.isin(ST)].copy()\n    ref_tk = ref[ref.index.isin(TK)].copy()\n    return ref_st,ref_tk\n\n\ndef get_kinase_rank(row_index,df,result):\n    kinase = df.loc[row_index, 'kinase_protein']\n    scores = result.loc[row_index]\n    ranked = scores.sort_values(ascending=False)\n    rank = ranked.index.get_loc(kinase) + 1  # +1 to make rank start from 1\n    return rank\n\n\ndef score_data(df,ref,seq_col='site_seq',func=sumup,pct_ref=None):\n    df_st, df_tyr = split_data(df)\n    ref_st,ref_tk = split_ref(ref)\n    \n    df_st_result = predict_kinase_df(df_st,seq_col=seq_col,ref=ref_st,func=func)\n    df_tyr_result = predict_kinase_df(df_tyr,seq_col=seq_col,ref=ref_tk,func=func)\n    \n    if pct_ref is not None:\n        df_st_result = get_pct_df(df_st_result,pct_ref)\n        df_tyr_result = get_pct_df(df_tyr_result,pct_ref)\n    \n    df_st['rank'] = df_st_result.index.to_series().apply(lambda idx: get_kinase_rank(idx,df_st,df_st_result))\n    df_tyr['rank'] = df_tyr_result.index.to_series().apply(lambda idx: get_kinase_rank(idx,df_tyr,df_tyr_result))\n    \n    return df_st,df_tyr,df_st_result,df_tyr_result\n\n\ndef get_ref(df, pssm, seq_col='site_seq', func=sumup, n_chunk=5):\n    chunk_size = (len(df) + n_chunk - 1) // n_chunk  # ceiling division\n    pct_refs = []\n    for i in range(n_chunk):\n        start = i * chunk_size\n        end = min((i + 1) * chunk_size, len(df))\n        if start &gt;= end:\n            break\n        print(f\"Processing chunk {i+1}/{n_chunk} → rows {start}:{end}\")\n        sub_df = df.iloc[start:end]\n        pct_ref = predict_kinase_df(\n            sub_df,\n            seq_col=seq_col,\n            ref=pssm,\n            func=func\n        )\n        pct_refs.append(pct_ref)\n    return pd.concat(pct_refs, ignore_index=True)\n\n\ndef top_k_accuracy(df, result, k):\n    def is_in_top_k(row_index):\n        kinase = df.loc[row_index, 'kinase_protein']\n        scores = result.loc[row_index]\n        top_k = scores.nlargest(k).index\n        return kinase in top_k\n\n    return result.index.to_series().apply(is_in_top_k).mean()\n\n\ndef top_k_accuracy_group(group_indices,df,result, k=10):\n    def is_correct(row_index):\n        kinase = df.loc[row_index, 'kinase_protein']\n        scores = result.loc[row_index]\n        top_k = scores.nlargest(k).index\n        return kinase in top_k\n\n    return pd.Series(group_indices).apply(is_correct).mean()\n\n\ndef get_topk(df,result,k=10):\n    grouped = df.groupby('kinase_group').groups\n    \n    topk_scores = {\n        subfam: top_k_accuracy_group(indices,df,result,k=k)\n        for subfam, indices in grouped.items()}\n    \n    topk_df = pd.DataFrame.from_dict(topk_scores, orient='index', columns=['top10_accuracy']).sort_values('top10_accuracy', ascending=False)\n    return topk_df\n\n\ndef get_group_topk(df_st,df_tyr,df_st_result,df_tyr_result):\n\n    topk_st = get_topk(df_st,df_st_result)\n    topk_tyr = get_topk(df_tyr,df_tyr_result)\n    \n    topk = pd.concat([topk_st,topk_tyr]).sort_values('top10_accuracy',ascending=False)\n\n    return topk\n\n\ndef get_results(df_st,df_tyr,df_st_result,df_tyr_result):\n    topk = get_group_topk(df_st,df_tyr,df_st_result,df_tyr_result)\n    aucdf_st = get_AUCDF(df_st,'rank')\n    aucdf_tyr = get_AUCDF(df_tyr,'rank')\n    \n    return topk, aucdf_st,aucdf_tyr\n\n\nset_sns()",
    "crumbs": [
      "Scoring evaluation"
    ]
  },
  {
    "objectID": "scoring_compare_all.html#overall",
    "href": "scoring_compare_all.html#overall",
    "title": "Scoring evaluation",
    "section": "Overall",
    "text": "Overall\npspa\n\npspa = pd.read_parquet('raw/overlap_pspa.parquet')\npspa.index = pspa.index.str.split('_').str[1]\npspa.shape\n\n(312, 236)\n\n\nData to be scored\n\npsp = Data.get_ks_dataset()\n\n\ndf = psp[psp.source.str.contains('PSP')].copy()\n\n\ndf['site_seq_upper'] = df.site_seq.str.upper()\n\n\n# only filter those with tested kinase\ndf = df[df.kinase_protein.isin(pspa.index)].copy().reset_index(drop=True)\n\n\ndf.shape\n\n(12639, 22)\n\n\n\ngroup_map = df[['kinase_protein','kinase_group']].drop_duplicates().set_index('kinase_protein')['kinase_group']\nTK = group_map[group_map=='TK'].index\nST = group_map[group_map!='TK'].index\n\n\ndef prepare_ref(path):\n    ref = pd.read_parquet(path)\n    ref.index = ref.index.str.split('_').str[1]\n    ref = ref[ref.index.isin(pspa.index)]\n    print(ref.shape)\n    return ref\n\ncddm:\n\ncddm = prepare_ref('out/CDDM_pssms.parquet')\ncddm_upper = prepare_ref('out/CDDM_pssms_upper.parquet')\n\ncddm_lo = prepare_ref('out/CDDM_pssms_LO.parquet')\ncddm_lo_upper = prepare_ref('out/CDDM_pssms_LO_upper.parquet')\n\n(312, 943)\n(312, 943)\n(312, 943)\n(312, 943)\n\n\n\n# ref_dict = {\n#     'PSPA: PSSM + multiply': (pspa,'site_seq',multiply,False),\n#     'CDDM: PSSM + multiply': (cddm, 'site_seq', multiply_23,False),\n#     'CDDM: PSSM upper + multiply': (cddm_upper, 'site_seq_upper', multiply_20,False),\n#     'CDDM: LO + sum': (cddm_lo, 'site_seq',sumup,False),\n#     'CDDM: LO upper + sum': (cddm_lo_upper, 'site_seq_upper',sumup,False),\n# }\n\n\n# human =Data.get_human_site()\n\n# human['site_seq_upper'] = human.site_seq.str.upper()\n\n# human = human.drop_duplicates('site_seq').reset_index()\n\n# for name,(ref,seq_col,func,_) in ref_dict.items():\n#     print(name)\n#     pct_ref = get_ref(human,pssm=ref,seq_col=seq_col,func=func)\n#     pct_ref.to_parquet(f'raw/{name}.parquet')\n#     print(pct_ref.head())\n#     # break\n\n\nref_dict = {\n    'PSPA: PSSM + multiply': (pspa,'site_seq',multiply,False),\n    'PSPA: PSSM + multiply + pct': (pspa,'site_seq',multiply, True),\n    \n    'CDDM: PSSM + multiply': (cddm, 'site_seq', multiply_23,False),\n    'CDDM: PSSM + multiply + pct': (cddm, 'site_seq', multiply_23, True),\n    \n    'CDDM: PSSM upper + multiply': (cddm_upper, 'site_seq_upper', multiply_20,False),\n    'CDDM: PSSM upper + multiply + pct': (cddm_upper, 'site_seq_upper', multiply_20,True),\n    \n    'CDDM: LO + sum': (cddm_lo, 'site_seq',sumup,False),\n    'CDDM: LO + sum + pct': (cddm_lo, 'site_seq',sumup,True),\n    \n    'CDDM: LO upper + sum': (cddm_lo_upper, 'site_seq_upper',sumup,False),\n    'CDDM: LO upper + sum + pct': (cddm_lo_upper, 'site_seq_upper',sumup,True),\n}\n\n\ntopk_dfs = []\naucdf = pd.DataFrame()\nfor name,(ref,seq_col,func,use_pct) in ref_dict.items():\n    print('---------------------------------------------')\n    print(name)\n    pct_ref = pd.read_parquet(f'raw/{name[:-6]}.parquet') if use_pct else None # -6 to remove + pct from parquet name\n    df_st,df_tyr,df_st_result,df_tyr_result = score_data(df,ref,seq_col=seq_col,func=func,pct_ref=pct_ref)\n    topk,aucdf_st,aucdf_tyr = get_results(df_st,df_tyr,df_st_result,df_tyr_result)\n    topk_dfs.append(topk)\n    aucdf.loc[name,'ST'] = aucdf_st\n    aucdf.loc[name,'Tyr'] = aucdf_tyr\n\n---------------------------------------------\nPSPA: PSSM + multiply\ninput dataframe has a length 10603\nPreprocessing\nFinish preprocessing\nMerging reference\nFinish merging\n\n\n100%|███████████████████████████████████████████████████████████████████████████| 213/213 [00:02&lt;00:00, 81.69it/s]\n\n\ninput dataframe has a length 1912\nPreprocessing\nFinish preprocessing\nMerging reference\nFinish merging\n\n\n100%|████████████████████████████████████████████████████████████████████████████| 71/71 [00:00&lt;00:00, 428.49it/s]\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n---------------------------------------------\nPSPA: PSSM + multiply + pct\ninput dataframe has a length 10603\nPreprocessing\nFinish preprocessing\nMerging reference\nFinish merging\n\n\n100%|███████████████████████████████████████████████████████████████████████████| 213/213 [00:02&lt;00:00, 85.26it/s]\n\n\ninput dataframe has a length 1912\nPreprocessing\nFinish preprocessing\nMerging reference\nFinish merging\n\n\n100%|████████████████████████████████████████████████████████████████████████████| 71/71 [00:00&lt;00:00, 423.93it/s]\n100%|██████████████████████████████████████████████████████████████████████████| 213/213 [00:00&lt;00:00, 389.86it/s]\n100%|████████████████████████████████████████████████████████████████████████████| 71/71 [00:00&lt;00:00, 764.05it/s]\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n---------------------------------------------\nCDDM: PSSM + multiply\ninput dataframe has a length 10603\nPreprocessing\nFinish preprocessing\nMerging reference\nFinish merging\n\n\n100%|███████████████████████████████████████████████████████████████████████████| 213/213 [00:04&lt;00:00, 50.58it/s]\n\n\ninput dataframe has a length 1912\nPreprocessing\nFinish preprocessing\nMerging reference\nFinish merging\n\n\n100%|████████████████████████████████████████████████████████████████████████████| 71/71 [00:00&lt;00:00, 215.43it/s]\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n---------------------------------------------\nCDDM: PSSM + multiply + pct\ninput dataframe has a length 10603\nPreprocessing\nFinish preprocessing\nMerging reference\nFinish merging\n\n\n100%|███████████████████████████████████████████████████████████████████████████| 213/213 [00:04&lt;00:00, 50.47it/s]\n\n\ninput dataframe has a length 1912\nPreprocessing\nFinish preprocessing\nMerging reference\nFinish merging\n\n\n100%|████████████████████████████████████████████████████████████████████████████| 71/71 [00:00&lt;00:00, 177.45it/s]\n100%|██████████████████████████████████████████████████████████████████████████| 213/213 [00:00&lt;00:00, 373.54it/s]\n100%|████████████████████████████████████████████████████████████████████████████| 71/71 [00:00&lt;00:00, 509.36it/s]\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n---------------------------------------------\nCDDM: PSSM upper + multiply\ninput dataframe has a length 10603\nPreprocessing\nFinish preprocessing\nMerging reference\nFinish merging\n\n\n100%|███████████████████████████████████████████████████████████████████████████| 213/213 [00:04&lt;00:00, 51.73it/s]\n\n\ninput dataframe has a length 1912\nPreprocessing\nFinish preprocessing\nMerging reference\nFinish merging\n\n\n100%|████████████████████████████████████████████████████████████████████████████| 71/71 [00:00&lt;00:00, 228.69it/s]\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n---------------------------------------------\nCDDM: PSSM upper + multiply + pct\ninput dataframe has a length 10603\nPreprocessing\nFinish preprocessing\nMerging reference\nFinish merging\n\n\n100%|███████████████████████████████████████████████████████████████████████████| 213/213 [00:04&lt;00:00, 52.55it/s]\n\n\ninput dataframe has a length 1912\nPreprocessing\nFinish preprocessing\nMerging reference\nFinish merging\n\n\n100%|████████████████████████████████████████████████████████████████████████████| 71/71 [00:00&lt;00:00, 225.45it/s]\n100%|██████████████████████████████████████████████████████████████████████████| 213/213 [00:00&lt;00:00, 388.72it/s]\n100%|████████████████████████████████████████████████████████████████████████████| 71/71 [00:00&lt;00:00, 701.91it/s]\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n---------------------------------------------\nCDDM: LO + sum\ninput dataframe has a length 10603\nPreprocessing\nFinish preprocessing\nMerging reference\nFinish merging\ninput dataframe has a length 1912\nPreprocessing\nFinish preprocessing\nMerging reference\nFinish merging\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n---------------------------------------------\nCDDM: LO + sum + pct\ninput dataframe has a length 10603\nPreprocessing\nFinish preprocessing\nMerging reference\nFinish merging\ninput dataframe has a length 1912\nPreprocessing\nFinish preprocessing\nMerging reference\nFinish merging\n\n\n100%|██████████████████████████████████████████████████████████████████████████| 213/213 [00:00&lt;00:00, 382.47it/s]\n100%|████████████████████████████████████████████████████████████████████████████| 71/71 [00:00&lt;00:00, 749.55it/s]\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n---------------------------------------------\nCDDM: LO upper + sum\ninput dataframe has a length 10603\nPreprocessing\nFinish preprocessing\nMerging reference\nFinish merging\ninput dataframe has a length 1912\nPreprocessing\nFinish preprocessing\nMerging reference\nFinish merging\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n---------------------------------------------\nCDDM: LO upper + sum + pct\ninput dataframe has a length 10603\nPreprocessing\nFinish preprocessing\nMerging reference\nFinish merging\ninput dataframe has a length 1912\nPreprocessing\nFinish preprocessing\nMerging reference\nFinish merging\n\n\n100%|██████████████████████████████████████████████████████████████████████████| 213/213 [00:00&lt;00:00, 378.69it/s]\n100%|████████████████████████████████████████████████████████████████████████████| 71/71 [00:00&lt;00:00, 764.31it/s]\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\naucdf = aucdf.T\n\n\naucdf = aucdf.reset_index(names='group')\n\n\naucdf.set_index('group').T.sort_values('Tyr')\n\n\n\n\n\n\n\ngroup\nST\nTyr\n\n\n\n\nPSPA: PSSM + multiply + pct\n0.788949\n0.572925\n\n\nPSPA: PSSM + multiply\n0.803919\n0.599230\n\n\nCDDM: PSSM upper + multiply + pct\n0.845689\n0.720623\n\n\nCDDM: PSSM + multiply + pct\n0.853593\n0.767071\n\n\nCDDM: LO upper + sum + pct\n0.890996\n0.776887\n\n\nCDDM: PSSM upper + multiply\n0.915436\n0.797867\n\n\nCDDM: LO upper + sum\n0.915436\n0.797867\n\n\nCDDM: LO + sum + pct\n0.896505\n0.802644\n\n\nCDDM: LO + sum\n0.927760\n0.821030\n\n\nCDDM: PSSM + multiply\n0.927760\n0.821030\n\n\n\n\n\n\n\n\nplot_group_bar(aucdf,value_cols=aucdf.columns[1:],group='group',rotation=0)\nplt.ylabel('AUCDF')\n\nText(0, 0.5, 'AUCDF')\n\n\n\n\n\n\n\n\n\n\ntopk_df = pd.concat(topk_dfs,axis=1)\n\n\ntopk_df.columns = ref_dict.keys()\n\n\nidx_ordered = topk_df.mean(1).sort_values(ascending=False).index\n\n\ntopk_df = topk_df.loc[idx_ordered]\n\n\ntopk_df = topk_df.reset_index(names='group')\n\n\nplot_group_bar(topk_df,value_cols=topk_df.columns[1:],group='group')\nplt.ylabel('Top10 accuracy')\n\nText(0, 0.5, 'Top10 accuracy')\n\n\n\n\n\n\n\n\n\n\ncol = topk_df.columns[~topk_df.columns.str.contains('pct')][1:]\n\n\nplot_group_bar(topk_df,value_cols=col,group='group')\nplt.ylabel('Top10 accuracy')\nsave_svg('img.svg')",
    "crumbs": [
      "Scoring evaluation"
    ]
  },
  {
    "objectID": "05_PSSM_example.html",
    "href": "05_PSSM_example.html",
    "title": "katlas-raw",
    "section": "",
    "text": "from katlas.data import *\n\n\n\ndf = Data.get_ks_dataset()\n\n\ndf['kinase_id'] = df['kinase_uniprot'] + '_' + df['kinase_protein'].str.split().str[0]\n\n\nfrom katlas.plot import *\n\n\ndef plot_k(df,k):\n    df_k = df[df.kinase_protein==k].copy()\n    pssm = get_prob(df_k,col ='site_seq')\n    plot_logo_heatmap(pssm,f\"{k}(n={len(df_k)})\",figsize=(17-4,10-3))\n    save_svg(f\"raw/{k}.svg\")\n    print(f\"saved raw/{k}.svg\")\n\n\nplot_k(df,'GSK3B')\n\nsaved raw/GSK3B.svg",
    "crumbs": [
      "05_PSSM_example.html"
    ]
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "katlas-raw",
    "section": "",
    "text": "$ pip install \"python-katlas[dev]\"\nDocumentation can be found hosted on this GitHub repository’s pages. Additionally you can find package manager specific guidelines on conda and pypi respectively.",
    "crumbs": [
      "katlas-raw"
    ]
  },
  {
    "objectID": "index.html#install-katlas-in-development-mode",
    "href": "index.html#install-katlas-in-development-mode",
    "title": "katlas-raw",
    "section": "",
    "text": "$ pip install \"python-katlas[dev]\"\nDocumentation can be found hosted on this GitHub repository’s pages. Additionally you can find package manager specific guidelines on conda and pypi respectively.",
    "crumbs": [
      "katlas-raw"
    ]
  },
  {
    "objectID": "index.html#directory",
    "href": "index.html#directory",
    "title": "katlas-raw",
    "section": "Directory",
    "text": "Directory\nUnder nbs folder, check each .ipyn notebook to generate data and figures\nUnder nbs/kinase_domain, check more training details of kinase domain",
    "crumbs": [
      "katlas-raw"
    ]
  },
  {
    "objectID": "motif_clustering.html",
    "href": "motif_clustering.html",
    "title": "Kmeans motifs",
    "section": "",
    "text": "from sklearn.cluster import KMeans\nimport matplotlib.pyplot as plt\nfrom tqdm import tqdm\nfrom katlas.core import *\nimport pandas as pd, numpy as np,seaborn as sns\n\n\n# human = pd.read_parquet('raw/human_phosphoproteome.parquet')\n# df_grouped = pd.read_parquet('raw/combine_source_grouped.parquet')\nhuman = Data.get_human_site()\nks_dataset = Data.get_ks_dataset()\n\n\nall_site = pd.concat([human,ks_dataset])\n\n\nall_site.sub_site.isna().sum()\n\nnp.int64(0)\n\n\n\nall_site = all_site.drop_duplicates('sub_site')\n\n\nall_site.shape\n\n(131843, 23)\n\n\n\n# all_site = all_site[['sub_site','site_seq']].drop_duplicates('sub_site')",
    "crumbs": [
      "Kmeans motifs"
    ]
  },
  {
    "objectID": "motif_clustering.html#kmeans",
    "href": "motif_clustering.html#kmeans",
    "title": "Kmeans motifs",
    "section": "",
    "text": "from sklearn.cluster import KMeans\nimport matplotlib.pyplot as plt\nfrom tqdm import tqdm\nfrom katlas.core import *\nimport pandas as pd, numpy as np,seaborn as sns\n\n\n# human = pd.read_parquet('raw/human_phosphoproteome.parquet')\n# df_grouped = pd.read_parquet('raw/combine_source_grouped.parquet')\nhuman = Data.get_human_site()\nks_dataset = Data.get_ks_dataset()\n\n\nall_site = pd.concat([human,ks_dataset])\n\n\nall_site.sub_site.isna().sum()\n\nnp.int64(0)\n\n\n\nall_site = all_site.drop_duplicates('sub_site')\n\n\nall_site.shape\n\n(131843, 23)\n\n\n\n# all_site = all_site[['sub_site','site_seq']].drop_duplicates('sub_site')",
    "crumbs": [
      "Kmeans motifs"
    ]
  },
  {
    "objectID": "motif_clustering.html#one-hot-encode",
    "href": "motif_clustering.html#one-hot-encode",
    "title": "Kmeans motifs",
    "section": "One-hot encode",
    "text": "One-hot encode\n\nfrom katlas.feature import *\n\n\nonehot = onehot_encode_df(all_site,'site_seq')\n\nCPU times: user 2.53 s, sys: 911 ms, total: 3.44 s\nWall time: 3.44 s\n\n\n\nonehot.head()\n\n\n\n\n\n\n\n\n-20A\n-20C\n-20D\n-20E\n-20F\n-20G\n-20H\n-20I\n-20K\n-20L\n...\n20R\n20S\n20T\n20V\n20W\n20Y\n20_\n20s\n20t\n20y\n\n\n\n\n0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n...\n1.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n\n\n1\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n...\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n\n\n2\n0.0\n0.0\n0.0\n1.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n...\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n\n\n3\n0.0\n0.0\n0.0\n1.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n...\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n\n\n4\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n...\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n\n\n\n\n5 rows × 967 columns\n\n\n\n\nElbow method\n\nall_site.shape\n\n(131843, 23)\n\n\n\nsns.set(rc={\"figure.dpi\":300, 'savefig.dpi':300})\nsns.set_context('notebook')\nsns.set_style(\"ticks\")\n\n\nget_clusters_elbow(onehot)\n\nCPU times: user 23min 20s, sys: 46.3 s, total: 24min 6s\nWall time: 9min 50s\n\n\n\n\n\n\n\n\n\n\n\nKmeans\nIf using RAPIDS\n\n# # pip install --extra-index-url=https://pypi.nvidia.com \\\"cudf-cu12==25.2.*\\\" \\\"cuml-cu12==25.2.*\\\"\n\n# %load_ext cudf.pandas\n\n# import numpy as np, pandas as pd\n# from cuml import KMeans\n# import matplotlib.pyplot as plt\n# import seaborn as sns\n# from tqdm import tqdm\n# from katlas.core import *\n# from katlas.plot import *\n\n\ndef kmeans(onehot,n=2,seed=42):\n    kmeans = KMeans(n_clusters=n, random_state=seed,n_init='auto')\n    return kmeans.fit_predict(onehot)\n\n\nncluster=[50,150,300,500]\nseeds=[42,2025,28]\n\n\nall_site['test_id']=1\n\n\nget_cluster_pssms(all_site,'test_id')\n\n100%|████████████████████████████████████████████| 1/1 [00:02&lt;00:00,  2.38s/it]\n\n\n\n\n\n\n\n\n\n-20P\n-20G\n-20A\n-20C\n-20S\n-20T\n-20V\n-20I\n-20L\n-20M\n...\n20H\n20K\n20R\n20Q\n20N\n20D\n20E\n20pS\n20pT\n20pY\n\n\n\n\n1\n0.079841\n0.066693\n0.07291\n0.013331\n0.064879\n0.040649\n0.050503\n0.034598\n0.081195\n0.01958\n...\n0.021924\n0.067816\n0.063392\n0.047306\n0.033401\n0.052386\n0.079796\n0.041843\n0.013849\n0.00508\n\n\n\n\n1 rows × 943 columns\n\n\n\n\npssms=[]\nfor seed in seeds:\n    print('seed',seed)\n    for n in ncluster:\n        colname = f'cluster{n}_seed{seed}'\n        print(colname)\n        all_site[colname] = kmeans(onehot,n=n,seed=seed)\n        pssm_df = get_cluster_pssms(all_site,colname,count_thr=0) # count threshold 0, no threshold for non-nan\n        pssm_df.index =colname+'_'+pssm_df.index.astype(str)\n        pssms.append(pssm_df)\n\nseed 42\ncluster50_seed42\n\n\n100%|██████████████████████████████████████████| 50/50 [00:02&lt;00:00, 17.83it/s]\n\n\ncluster150_seed42\n\n\n100%|████████████████████████████████████████| 150/150 [00:04&lt;00:00, 32.45it/s]\n\n\ncluster300_seed42\n\n\n100%|████████████████████████████████████████| 300/300 [00:07&lt;00:00, 41.01it/s]\n\n\ncluster500_seed42\n\n\n100%|████████████████████████████████████████| 500/500 [00:11&lt;00:00, 44.43it/s]\n\n\nseed 2025\ncluster50_seed2025\n\n\n100%|██████████████████████████████████████████| 50/50 [00:02&lt;00:00, 17.08it/s]\n\n\ncluster150_seed2025\n\n\n100%|████████████████████████████████████████| 150/150 [00:04&lt;00:00, 32.05it/s]\n\n\ncluster300_seed2025\n\n\n100%|████████████████████████████████████████| 300/300 [00:08&lt;00:00, 37.39it/s]\n\n\ncluster500_seed2025\n\n\n100%|████████████████████████████████████████| 500/500 [00:10&lt;00:00, 46.36it/s]\n\n\nseed 28\ncluster50_seed28\n\n\n100%|██████████████████████████████████████████| 50/50 [00:02&lt;00:00, 18.25it/s]\n\n\ncluster150_seed28\n\n\n100%|████████████████████████████████████████| 150/150 [00:04&lt;00:00, 32.84it/s]\n\n\ncluster300_seed28\n\n\n100%|████████████████████████████████████████| 300/300 [00:06&lt;00:00, 43.14it/s]\n\n\ncluster500_seed28\n\n\n100%|████████████████████████████████████████| 500/500 [00:10&lt;00:00, 46.35it/s]\n\n\nCPU times: user 2h 16min 41s, sys: 35.7 s, total: 2h 17min 17s\nWall time: 19min 31s\n\n\n\n\n\n\npssms = pd.concat(pssms,axis=0)\n\n\npssms.shape\n\n(3000, 943)\n\n\nSave:\n\npssms.to_parquet('raw/kmeans.parquet')\nall_site.to_parquet('raw/kmeans_site.parquet',index=False)\n\n\npssms.shape\n\n(3000, 943)",
    "crumbs": [
      "Kmeans motifs"
    ]
  },
  {
    "objectID": "motif_clustering.html#filter-max-pssm-value",
    "href": "motif_clustering.html#filter-max-pssm-value",
    "title": "Kmeans motifs",
    "section": "Filter max PSSM value",
    "text": "Filter max PSSM value\n\nimport pandas as pd\nfrom katlas.pssm import *\nfrom functools import partial\n\n\npssms = pd.read_parquet('raw/kmeans.parquet')\nall_site=pd.read_parquet('raw/kmeans_site.parquet')\n\n\npssms.shape\n\n(3000, 943)",
    "crumbs": [
      "Kmeans motifs"
    ]
  },
  {
    "objectID": "motif_clustering.html#hierarchical-clustering",
    "href": "motif_clustering.html#hierarchical-clustering",
    "title": "Kmeans motifs",
    "section": "Hierarchical clustering",
    "text": "Hierarchical clustering\n\nHierarchical clustering of all pssms\n\nfrom scipy.cluster.hierarchy import linkage, fcluster,dendrogram\n\n\nimport pandas as pd\nfrom katlas.core import *\n\n\n# pssms = pd.read_parquet('raw/kmeans.parquet')\n\n\nZ = get_Z(pssms)\n\n\n\n\n\nlabels= get_pssm_seq_labels(pssms,thr=0.3)\n\n\n# plot_dendrogram(Z,color_thr=0.05, labels=labels)\n# save_pdf('raw/dendrogram.pdf')\n# plt.close()\n\nVisualize and find out the color threshold that works.\nAfter determine the color threshold, use it to cut the tree.\nVisualize some logos\n\nplot_logos_idx(pssms, 'cluster50_seed42_32','cluster300_seed2025_212')\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCut trees to merge similar pssms\n\nlabels = fcluster(Z, t=0.05, criterion='distance')\n# pssm_df['cluster'] = labels\n\n\nlen(labels)\n\n3000\n\n\n\nnp.unique(labels)[:10] # always start from 1\n\narray([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10], dtype=int32)\n\n\n\n\nExpand the cluster into a single column\n\nid_vars = ['sub_site', 'site_seq']\nvalue_vars = [col for col in all_site.columns if col.startswith('cluster')]\n\n\nall_site_long = pd.melt(all_site, id_vars=id_vars, value_vars=value_vars, var_name='cluster_info', value_name='cluster')\n\n\nall_site_long['cluster_id']=all_site_long['cluster_info'] + '_' + all_site_long['cluster'].astype(str)\n\n\nall_site_long.head()\n\n\n\n\n\n\n\n\nsub_site\nsite_seq\ncluster_info\ncluster\ncluster_id\n\n\n\n\n0\nA0A024R4G9_S20\n_MTVLEAVLEIQAITGSRLLsMVPGPARPPGSCWDPTQCTR\ncluster50_seed42\n33\ncluster50_seed42_33\n\n\n1\nA0A075B6Q4_S24\nQKSENEDDSEWEDVDDEKGDsNDDYDSAGLLsDEDCMSVPG\ncluster50_seed42\n41\ncluster50_seed42_41\n\n\n2\nA0A075B6Q4_S35\nEDVDDEKGDsNDDYDSAGLLsDEDCMSVPGKTHRAIADHLF\ncluster50_seed42\n30\ncluster50_seed42_30\n\n\n3\nA0A075B6Q4_S57\nEDCMSVPGKTHRAIADHLFWsEETKSRFTEYsMTssVMRRN\ncluster50_seed42\n30\ncluster50_seed42_30\n\n\n4\nA0A075B6Q4_S68\nRAIADHLFWsEETKSRFTEYsMTssVMRRNEQLTLHDERFE\ncluster50_seed42\n11\ncluster50_seed42_11\n\n\n\n\n\n\n\n\n\nMap merged cluster\n\nlen(labels)\n\n3000\n\n\n\nmax(labels)\n\nnp.int32(1290)\n\n\n\ncluster_map = pd.Series(labels,index=pssms.index)\n\n\ncluster_map.sort_values()\n\ncluster500_seed28_228         1\ncluster500_seed42_403         1\ncluster150_seed2025_111       2\ncluster500_seed2025_76        2\ncluster300_seed42_249         3\n                           ... \ncluster300_seed28_203      1286\ncluster500_seed42_321      1287\ncluster500_seed28_458      1288\ncluster300_seed42_262      1289\ncluster500_seed42_268      1290\nLength: 3000, dtype: int32\n\n\nFor those unmapped cluster_ID, we assign them zero value:\n\n# not all cluster_id have a corresponding for new cluster ID, as they could be filtered out\nall_site_long['cluster_new'] = all_site_long.cluster_id.map(lambda x: cluster_map.get(x, 0)) #0 is unmapped\n\n\nall_site_long.shape\n\n(1582116, 6)\n\n\n\nall_site_long = all_site_long.drop_duplicates(subset=['cluster_new','sub_site'])\n\n\nall_site_long.shape\n\n(843252, 6)\n\n\n\nall_site_long.to_parquet('raw/kmeans_site_long_cluster_new.parquet',index=False)\n\n\n\nGet new cluster motifs\n\npssms2 = get_cluster_pssms(all_site_long,\n                           'cluster_new')\n\n100%|██████████████████████████████████████| 1290/1290 [00:31&lt;00:00, 40.73it/s]\n\n\nNote here we didn’t put count threshold here, the default is 10\n\npssms2.shape\n\n(1286, 943)\n\n\n\n# pssms2 = pssms2.drop(index=0) # as 0 represents unmapped",
    "crumbs": [
      "Kmeans motifs"
    ]
  },
  {
    "objectID": "motif_clustering.html#filter",
    "href": "motif_clustering.html#filter",
    "title": "Kmeans motifs",
    "section": "Filter",
    "text": "Filter\n\ncount_map = all_site_long.cluster_new.value_counts()\n\n\nidxs = count_map[count_map&gt;40].index\n\n\npssms2 = pssms2.loc[idxs]\n\n\ndef get_surrounding_max(r):\n    return float(recover_pssm(r).drop(columns=[0]).max().max())\n\n\nmax_val = pssms2.apply(get_surrounding_max,axis=1)\n# max_val.hist(bins=50);\npssms2 = pssms2.loc[max_val&gt;=0.4]\n\n\npssms2.shape\n\n(1169, 943)\n\n\n\npssms2.to_parquet('out/all_site_pssms_filter.parquet') # the index order is from count high to count low",
    "crumbs": [
      "Kmeans motifs"
    ]
  },
  {
    "objectID": "motif_clustering.html#hierarchical-clustering-of-merged-pssms",
    "href": "motif_clustering.html#hierarchical-clustering-of-merged-pssms",
    "title": "Kmeans motifs",
    "section": "Hierarchical clustering of merged pssms",
    "text": "Hierarchical clustering of merged pssms\n\nZ2 = get_Z(pssms2)\n\n\n\n\nNote that a sub site may have multiple cluster_new ID, so we need to drop duplicates to get correct value counts\n\nlabels= get_pssm_seq_labels(pssms2,count_map = count_map , thr=0.3)\n\n\nlabels[:4]\n\n['29 (n=8,243): ....................s*P...................',\n '369 (n=6,453): ....................s*.s..................',\n '1054 (n=6,368): ....................t*P...................',\n '338 (n=6,182): .................R..s*....................']\n\n\n\nplot_dendrogram(Z2,labels=labels,color_thr=0.07)\nsave_pdf('out/dendrogram.pdf')\nsave_svg('out/human_motif_dendrogram.svg')\nplt.close()\n\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.\nfindfont: Font family 'Arial' not found.",
    "crumbs": [
      "Kmeans motifs"
    ]
  },
  {
    "objectID": "motif_clustering.html#old-onehot-of-cluster-number",
    "href": "motif_clustering.html#old-onehot-of-cluster-number",
    "title": "Kmeans motifs",
    "section": "(Old) Onehot of cluster number",
    "text": "(Old) Onehot of cluster number\n\nall_site_long['sub_site_seq'] = all_site_long['sub_site']+'_'+all_site_long['site_seq']\n\n\nall_site_onehot = pd.crosstab(all_site_long['sub_site_seq'], all_site_long['cluster_new'])\n\n\n# greater than 0 to be True and convert to int\nall_site_onehot = all_site_onehot.gt(0).astype(int)\n\n\nall_site_onehot.max()\n\ncluster_new\n1       1\n2       1\n3       1\n4       1\n5       1\n       ..\n1286    1\n1287    1\n1288    1\n1289    1\n1290    1\nLength: 1290, dtype: int64\n\n\n\n# remove 0 as it is unassigned for cut tree\n# all_site_onehot = all_site_onehot.drop(columns=0)\n\n\nall_site_onehot.sum().sort_values()\n\n\n# for save in parquet, needs column type to be str\nall_site_onehot.columns = all_site_onehot.columns.astype(str)\n\n\nall_site_onehot.to_parquet('out/all_site_cluster_onehot.parquet')\n\n\n# all_site_onehot=pd.read_parquet('out/all_site_cluster_onehot.parquet')\n\n\nall_site_onehot.reset_index()",
    "crumbs": [
      "Kmeans motifs"
    ]
  },
  {
    "objectID": "site_promiscuity_fig1.html",
    "href": "site_promiscuity_fig1.html",
    "title": "Site promiscuity",
    "section": "",
    "text": "from katlas.core import *\nimport pandas as pd\nimport seaborn as sns\nfrom matplotlib import pyplot as plt\nfrom katlas.plot import *\nimport matplotlib.ticker as mticker\ndf=Data.get_ks_dataset()\ndf.head()\n\n\n\n\n\n\n\n\nkin_sub_site\nkinase_uniprot\nsubstrate_uniprot\nsite\nsource\nsubstrate_genes\nsubstrate_phosphoseq\nposition\nsite_seq\nsub_site\nsubstrate_sequence\nkinase_on_tree\nkinase_genes\nkinase_group\nkinase_family\nkinase_pspa_big\nkinase_pspa_small\nkinase_coral_ID\nnum_kin\n\n\n\n\n0\nO00141_A4FU28_S140\nO00141\nA4FU28\nS140\nSugiyama\nCTAGE9\nMEEPGATPQPYLGLVLEELGRVVAALPESMRPDENPYGFPSELVVC...\n140\nAAAEEARSLEATCEKLSRsNsELEDEILCLEKDLKEEKSKH\nA4FU28_S140\nMEEPGATPQPYLGLVLEELGRVVAALPESMRPDENPYGFPSELVVC...\n1\nSGK1 SGK\nAGC\nSGK\nBasophilic\nAkt/rock\nSGK1\n22\n\n\n1\nO00141_O00141_S252\nO00141\nO00141\nS252\nSugiyama\nSGK1 SGK\nMTVKTEAAKGTLTYSRMRGMVAILIAFMKQRRMGLNDFIQKIANNS...\n252\nSQGHIVLTDFGLCKENIEHNsTtstFCGtPEyLAPEVLHKQ\nO00141_S252\nMTVKTEAAKGTLTYSRMRGMVAILIAFMKQRRMGLNDFIQKIANNS...\n1\nSGK1 SGK\nAGC\nSGK\nBasophilic\nAkt/rock\nSGK1\n1\n\n\n2\nO00141_O00141_S255\nO00141\nO00141\nS255\nSugiyama\nSGK1 SGK\nMTVKTEAAKGTLTYSRMRGMVAILIAFMKQRRMGLNDFIQKIANNS...\n255\nHIVLTDFGLCKENIEHNsTtstFCGtPEyLAPEVLHKQPYD\nO00141_S255\nMTVKTEAAKGTLTYSRMRGMVAILIAFMKQRRMGLNDFIQKIANNS...\n1\nSGK1 SGK\nAGC\nSGK\nBasophilic\nAkt/rock\nSGK1\n1\n\n\n3\nO00141_O00141_S397\nO00141\nO00141\nS397\nSugiyama\nSGK1 SGK\nMTVKTEAAKGTLTYSRMRGMVAILIAFMKQRRMGLNDFIQKIANNS...\n397\nsGPNDLRHFDPEFTEEPVPNsIGKsPDsVLVTAsVKEAAEA\nO00141_S397\nMTVKTEAAKGTLTYSRMRGMVAILIAFMKQRRMGLNDFIQKIANNS...\n1\nSGK1 SGK\nAGC\nSGK\nBasophilic\nAkt/rock\nSGK1\n1\n\n\n4\nO00141_O00141_S404\nO00141\nO00141\nS404\nSugiyama\nSGK1 SGK\nMTVKTEAAKGTLTYSRMRGMVAILIAFMKQRRMGLNDFIQKIANNS...\n404\nHFDPEFTEEPVPNsIGKsPDsVLVTAsVKEAAEAFLGFsYA\nO00141_S404\nMTVKTEAAKGTLTYSRMRGMVAILIAFMKQRRMGLNDFIQKIANNS...\n1\nSGK1 SGK\nAGC\nSGK\nBasophilic\nAkt/rock\nSGK1\n1",
    "crumbs": [
      "Site promiscuity"
    ]
  },
  {
    "objectID": "site_promiscuity_fig1.html#total-kinase-count-per-site",
    "href": "site_promiscuity_fig1.html#total-kinase-count-per-site",
    "title": "Site promiscuity",
    "section": "Total kinase count per site",
    "text": "Total kinase count per site\n\npivot = pd.crosstab(df['sub_site'], df['substrate_uniprot'])\n\nhist_data = pivot.sum(1)  # total kinase count per sub_site\n\n# Define bins and labels\nbins = [0, 1, 10, 100, 300]\nlabels = ['1', '2~10', '11~100', '101~300']\n\n# Cut into categories\nbinned = pd.cut(hist_data, bins=bins, labels=labels, right=True, include_lowest=True)\n\n# Count how many kin_sub_sites fall into each bin\nbinned_counts = binned.value_counts().sort_index()\n\nsites = pd.concat([hist_data,binned],axis=1)\n\nsites.columns=['num_kin','bin']\n\nsites = sites.reset_index()",
    "crumbs": [
      "Site promiscuity"
    ]
  },
  {
    "objectID": "site_promiscuity_fig1.html#plot-sites-kin-distribution",
    "href": "site_promiscuity_fig1.html#plot-sites-kin-distribution",
    "title": "Site promiscuity",
    "section": "Plot sites kin distribution",
    "text": "Plot sites kin distribution\n\n# pip install brokenaxes\n\n\nimport matplotlib.pyplot as plt\nfrom brokenaxes import brokenaxes\n\nimport pandas as pd\nimport numpy as np\n\n\nset_sns(100)\n\n\nfig = plt.figure(figsize=(5, 4))\nbax = brokenaxes(ylims=((0, 5000), (20_000, 22_000)), hspace=0.2)\n\n# Plot histogram\nbax.hist(sites.num_kin, bins=100, edgecolor='black');\n\n# bax.set_xlabel('# Kinases')\n# bax.set_ylabel('Frequency') # overlap, does not work very well\nplt.title('Histogram of # Kinases per Substrate Site');\nsave_pdf('fig/promi_hist.pdf')\n\n\n\n\n\n\n\n\n\ncnt=sites.bin.value_counts()\n\n\ndef plot_pie(value_counts, # value counts\n             hue_order=None, # list of strings\n             labeldistance=0.8,\n             fontsize=12,\n             fontcolor='black',\n             palette='tab20' ,\n             figsize=(4,3)\n            ):\n    if hue_order is not None: value_counts = value_counts.reindex(hue_order)\n    colors = sns.color_palette(palette, n_colors=len(value_counts))\n    value_counts.plot.pie(\n        autopct='%1.1f%%',    # Show percentage inside slices\n        labeldistance=labeldistance,    # Move labels closer to center\n        textprops={'fontsize': fontsize, 'color': fontcolor} ,\n        colors=colors,\n        figsize=figsize,\n    )\n    plt.ylabel('')\n    plt.title(f'n={value_counts.sum():,}')\n\n\nplot_pie(cnt,\n         fontsize=9,labeldistance=1,palette='Pastel1')\nsave_pdf('fig/promi_pie.pdf')\n\n\n\n\n\n\n\n\n\ndef plot_cnt(cnt, xlabel=None,ylabel='Count',figsize=(6, 3)):\n    fig, ax = plt.subplots(figsize=figsize)\n    cnt.plot.bar(ax=ax)\n    # Add text on top of each bar\n    for idx, value in enumerate(cnt):\n        ax.text(idx, value + 0.5, f\"{value:,}\", ha='center', va='bottom', fontsize=10)\n\n    ax.spines['top'].set_visible(False)\n    ax.spines['right'].set_visible(False)\n    ax.set_ylabel(ylabel)\n    ax.set_xlabel(xlabel)\n    plt.xticks(rotation=0)\n    plt.tight_layout()\n\n\nplot_cnt(cnt,\n         xlabel='# Kinases per Substrate Site',\n         ylabel='# Substrate Sites',\n         figsize=(5,2.4)\n        )\nsave_pdf('fig/promi_bar.pdf')\n\n\n\n\n\n\n\n\n\n# sites.num_kin.sort_values(ascending=False).to_csv('test.csv')",
    "crumbs": [
      "Site promiscuity"
    ]
  },
  {
    "objectID": "site_promiscuity_fig1.html#characterize-promicuous-motif",
    "href": "site_promiscuity_fig1.html#characterize-promicuous-motif",
    "title": "Site promiscuity",
    "section": "Characterize promicuous motif",
    "text": "Characterize promicuous motif\n\nseqs = Data.get_ks_unique()\n\n\nseqs\n\n\n\n\n\n\n\n\nsub_site\nnum_kin\nbin\nsub_genes\nsite_seq\nsource_combine\nacceptor\nO00141_SGK1\nO00238_BMPR1B\nO00311_CDC7\n...\nQ9Y2K2_SIK3\nQ9Y2U5_MAP3K2\nQ9Y3S1_WNK2\nQ9Y463_DYRK1B\nQ9Y4K4_MAP4K5\nQ9Y572_RIPK3\nQ9Y5S2_CDC42BPB\nQ9Y6E0_STK24\nQ9Y6M4_CSNK1G3\nQ9Y6R4_MAP3K4\n\n\n\n\n0\nA0A2R8Y4L2_S158\n1\n1\nHNRNPA1L3 HNRNPA1P48\nTDRGSGKKRGFAFVTFDDHDsVDKIVIQKYHTVNGHNCEVR\nSugiyama\nS\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n1\nA0A2R8Y4L2_S22\n3\n2~10\nHNRNPA1L3 HNRNPA1P48\nSKSEsPKEPEQLRKLFIGGLsFEtTDESLRSHFEQWGTLTD\nSugiyama\nS\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n2\nA0A2R8Y4L2_S6\n3\n2~10\nHNRNPA1L3 HNRNPA1P48\n_______________MSKSEsPKEPEQLRKLFIGGLsFEtT\nSugiyama\nS\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n3\nA0A2R8Y4L2_S95\n65\n11~100\nHNRNPA1L3 HNRNPA1P48\nRPHKVDGRVVEPKRAVSREDsQRPDAHLTVKKIFVGGIKED\nSugiyama\nS\n0\n1\n0\n...\n0\n1\n0\n0\n1\n0\n0\n0\n0\n0\n\n\n4\nA0A2R8Y4L2_T25\n3\n2~10\nHNRNPA1L3 HNRNPA1P48\nEsPKEPEQLRKLFIGGLsFEtTDESLRSHFEQWGTLTDCVV\nSugiyama\nT\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\n29806\nQ9Y6Y8_S894\n2\n2~10\nSEC23IP MSTP053\nFISSLKSAWQTLNEFARAHtsstQLQEELEKVANQIKEEEE\nSugiyama\nS\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n29807\nQ9Y6Y8_T893\n4\n2~10\nSEC23IP MSTP053\nGFISSLKSAWQTLNEFARAHtsstQLQEELEKVANQIKEEE\nSugiyama\nT\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n29808\nQ9Y6Y8_Y935\n2\n2~10\nSEC23IP MSTP053\nKQVVEAEKVVEsPDFsKDEDyLGKVGMLNGGRRIDYVLQEK\nSugiyama\nY\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n29809\nQ9Y6Y9_Y131\n1\n1\nLY96 ESOP1 MD2\nETVNTTISFSFKGIKFSKGKyKCVVEAISGSPEEMLFCLEF\nNon-Sugiyama\nY\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n29810\nQ9Y6Y9_Y22\n1\n1\nLY96 ESOP1 MD2\nLPFLFFSTLFSSIFTEAQKQyWVCNSSDASISYTYCDKMQY\nNon-Sugiyama\nY\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n\n\n29811 rows × 462 columns\n\n\n\n\nseq_map=df.drop_duplicates('sub_site').set_index('sub_site').site_seq\n\ngene_map = df.drop_duplicates('sub_site').set_index('sub_site').substrate_genes\n\n\nsites['sub_genes'] = sites.sub_site.map(gene_map)\nsites['site_seq'] = sites.sub_site.map(seq_map)\n\n\nfor b in sites.bin.value_counts().index:\n    sites_b=sites[sites.bin==b].copy()\n    pssm_df= get_prob(sites_b,'site_seq')\n    plot_logo(pssm_df,b,figsize=(13,2))\n    kin_str='kinase' if b=='1' else 'kinases'\n    plt.title(f\"Sites with {b} {kin_str} (n={len(sites_b)})\")\n    plt.show()\n    plt.close()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n# a = sites[(sites.bin=='101~300')|(sites.bin=='11~100')].copy()\n\n# s_sites = a[a.sub_site.str.split('_').str[1].str[0]=='S']\n\n# y_sites = a[a.sub_site.str.split('_').str[1].str[0]=='Y']\n\n# pssm_df_s = get_prob(s_sites,'site_seq')\n# pssm_df_y = get_prob(y_sites,'site_seq')",
    "crumbs": [
      "Site promiscuity"
    ]
  },
  {
    "objectID": "site_promiscuity_fig1.html#genes-in-promicuous-site",
    "href": "site_promiscuity_fig1.html#genes-in-promicuous-site",
    "title": "Site promiscuity",
    "section": "Genes in promicuous site",
    "text": "Genes in promicuous site\n\nsites['gene'] = sites.sub_genes.str.split(' ').str[0]\n\n\nsites_b=sites[sites.bin=='101~300'].copy()\n\n\ndata = pd.read_csv('raw/genes_grouped.csv')\n\n\ndata.Gene.isin(genes).sum()\n\n72\n\n\n\n# remove (small) and (large) for rebosomal protein\ndata.Group = data.Group.str.split('(').str[0]\n\n\ngroup_map = data.set_index('Gene')['Group'].to_dict()\n\n\nsites_b['gene_group'] = sites_b.gene.map(group_map)\n\n\nsites_b.gene_group.value_counts()\n\ngene_group\nGlycolysis                 16\nActin cytoskeleton         15\nHeat shock protein         12\nRibosomal protein          12\nRNA‑binding protein         6\nPOTE family                 3\nNME family                  2\nSignaling/regulatory        2\nTubulin cytoskeleton        2\nCytoskeleton‑associated     1\nRegulatory/other            1\nName: count, dtype: int64",
    "crumbs": [
      "Site promiscuity"
    ]
  },
  {
    "objectID": "site_promiscuity_fig1.html#stacked-by-source",
    "href": "site_promiscuity_fig1.html#stacked-by-source",
    "title": "Site promiscuity",
    "section": "Stacked by source",
    "text": "Stacked by source\n\ndef convert_source(x):\n    if x == \"Sugiyama\":\n        return x\n    elif 'Sugiyama' in x and '|' in x:\n        return 'Both'\n    elif 'Sugiyama' not in x:\n        return 'Non-Sugiyama'\n\n\n# df=Data.get_ks_dataset()\n\n\ndf['source2'] = df.source.apply(convert_source)\n\n\nout = df.groupby('sub_site')['source2'].unique()\n\n\nsites['source'] = sites.sub_site.map(out)\n\n\ndef combine_source(sources):\n    sources = set(sources)  # remove duplicates\n    if sources == {'Sugiyama'}:\n        return 'Sugiyama'\n    elif sources == {'Non-Sugiyama'}:\n        return 'Non-Sugiyama'\n    else:\n        return 'Both'\n\n\nsites['source_num'] = sites.source.str.len()\n\n\nsites['source_combine'] = sites.source.apply(combine_source)\n\n\ndef get_pct(df,bin_col, hue_col):\n    count_df = df.groupby([bin_col, hue_col], observed=False).size().unstack(fill_value=0)\n    pct_df = count_df.div(count_df.sum(axis=1), axis=0) * 100\n    return pct_df\n\n\npct_df = get_pct(sites,'bin','source_combine')\n\n\npct_df\n\n\n\n\n\n\n\nsource_combine\nBoth\nNon-Sugiyama\nSugiyama\n\n\nbin\n\n\n\n\n\n\n\n1\n1.102740\n47.445205\n51.452055\n\n\n2~10\n7.470243\n30.582697\n61.947060\n\n\n11~100\n7.137336\n1.056429\n91.806236\n\n\n101~300\n12.500000\n0.000000\n87.500000\n\n\n\n\n\n\n\n\n# pct_df.plot.bar()\n# plt.legend(title='Source')\n\n\ndef get_plt_color(palette, # dict, list, or set name (tab10)\n                  columns, # columns in the df for plot\n                 ):\n    \"Given a dict, list or set name, return the list of names; if dict, need to provide column names of the df.\"\n    if isinstance(palette, dict):\n        # Match colors to column order in pct_df\n        colors = [palette.get(col, '#cccccc') for col in columns]  # fallback color if missing\n    elif isinstance(palette, str):\n        colors = sns.color_palette(palette, n_colors=len(columns))\n    elif isinstance(palette, list):\n        colors = palette\n    return colors\n\n\nget_plt_color('Set2',['a','b'])\n\n\n\n\n\nimport matplotlib.pyplot as plt\n\ndef plot_composition(df, bin_col, hue_col,palette='tab20',legend_title=None,rotate=45,xlabel=None,ylabel='Percentage',figsize=(5,3)):\n    pct_df = get_pct(df,bin_col,hue_col)\n\n    colors = get_plt_color(palette,pct_df.columns)\n    \n    pct_df.plot(kind='bar', figsize=figsize,stacked=True,color=colors)\n    \n    plt.ylabel(ylabel)\n    plt.xlabel(xlabel)\n    plt.xticks(rotation=rotate)\n    if legend_title is None: legend_title = hue_col \n    plt.legend(title=legend_title, bbox_to_anchor=(1.05, 1), loc='upper left')\n\n\nplot_composition(sites,\n                 'bin',\n                 'source_combine',\n                 palette='Set2',\n                 legend_title='Source',\n                 figsize=(3,3)\n                )\nsave_pdf('fig/promi_bar_source_percentage.pdf')",
    "crumbs": [
      "Site promiscuity"
    ]
  },
  {
    "objectID": "site_promiscuity_fig1.html#stacked-plot-by-site-type",
    "href": "site_promiscuity_fig1.html#stacked-plot-by-site-type",
    "title": "Site promiscuity",
    "section": "Stacked plot by site type",
    "text": "Stacked plot by site type\n\nsites['acceptor'] = sites.sub_site.str.split('_').str[1].str[0]\n\n\nplot_composition(sites,'bin',\n                 'acceptor',\n                 palette=sty_color,\n                 figsize=(3,3),\n                 legend_title='Acceptor'\n                )\n\nsave_pdf('fig/promi_bar_site_percentage.pdf')\n\n\n\n\n\n\n\n\n\npct_df=get_pct(sites,'bin','acceptor')\n\n\npct_df\n\n\n\n\n\n\n\nacceptor\nS\nT\nY\n\n\nbin\n\n\n\n\n\n\n\n1\n57.760274\n24.431507\n17.808219\n\n\n2~10\n55.809202\n22.712738\n21.478060\n\n\n11~100\n31.512497\n16.361762\n52.125741\n\n\n101~300\n58.333333\n4.166667\n37.500000\n\n\n\n\n\n\n\n\nfig, axes = plt.subplots(3, 1, figsize=(5, 4.6), sharex=True)\nfor i, (ax, acc) in enumerate(zip(axes, ['S', 'T', 'Y'])):\n    pct_df[acc].plot(kind='bar', ax=ax, color=sty_color[acc])\n    ax.set_title(f'{acc} Sites')\n    ax.grid(axis='y')\n    ax.tick_params(axis='x', labelrotation=0)\n    \n    # Set ylabel only on the middle plot\n    if i == 1:\n        ax.set_ylabel('% of Total Substrate Sites Per Bin')\n    else:\n        ax.set_ylabel('')  # remove label from top/bottom\n\naxes[-1].set_xlabel('Number of Kinases Per Substrate Site')\nplt.subplots_adjust(hspace=0.3)\nsave_pdf('fig/promi_bar_site_percentage_split.pdf')",
    "crumbs": [
      "Site promiscuity"
    ]
  },
  {
    "objectID": "site_promiscuity_fig1.html#save-add-num_kin-to-the-ks_dataset",
    "href": "site_promiscuity_fig1.html#save-add-num_kin-to-the-ks_dataset",
    "title": "Site promiscuity",
    "section": "Save & Add num_kin to the ks_dataset",
    "text": "Save & Add num_kin to the ks_dataset\n\nsites = sites.drop(columns='source')\n\nLet’s add kinase binding info as one-hot\n\ndf['kinase_uniprot_gene']=df['kinase_uniprot']+'_'+df['kinase_genes'].str.split(' ').str[0]\n\n\npivot = pd.crosstab(df['sub_site'],df['kinase_uniprot_gene'])\n\n\npivot = pivot.reset_index()\n\n\nsites = sites.merge(pivot)\n\n\nsites.head()\n\n\n\n\n\n\n\n\nsub_site\nnum_kin\nbin\nsub_genes\nsite_seq\nsource_combine\nacceptor\nO00141_SGK1\nO00238_BMPR1B\nO00311_CDC7\n...\nQ9Y2K2_SIK3\nQ9Y2U5_MAP3K2\nQ9Y3S1_WNK2\nQ9Y463_DYRK1B\nQ9Y4K4_MAP4K5\nQ9Y572_RIPK3\nQ9Y5S2_CDC42BPB\nQ9Y6E0_STK24\nQ9Y6M4_CSNK1G3\nQ9Y6R4_MAP3K4\n\n\n\n\n0\nA0A2R8Y4L2_S158\n1\n1\nHNRNPA1L3 HNRNPA1P48\nTDRGSGKKRGFAFVTFDDHDsVDKIVIQKYHTVNGHNCEVR\nSugiyama\nS\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n1\nA0A2R8Y4L2_S22\n3\n2~10\nHNRNPA1L3 HNRNPA1P48\nSKSEsPKEPEQLRKLFIGGLsFEtTDESLRSHFEQWGTLTD\nSugiyama\nS\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n2\nA0A2R8Y4L2_S6\n3\n2~10\nHNRNPA1L3 HNRNPA1P48\n_______________MSKSEsPKEPEQLRKLFIGGLsFEtT\nSugiyama\nS\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n3\nA0A2R8Y4L2_S95\n65\n11~100\nHNRNPA1L3 HNRNPA1P48\nRPHKVDGRVVEPKRAVSREDsQRPDAHLTVKKIFVGGIKED\nSugiyama\nS\n0\n1\n0\n...\n0\n1\n0\n0\n1\n0\n0\n0\n0\n0\n\n\n4\nA0A2R8Y4L2_T25\n3\n2~10\nHNRNPA1L3 HNRNPA1P48\nEsPKEPEQLRKLFIGGLsFEtTDESLRSHFEQWGTLTDCVV\nSugiyama\nT\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n\n\n5 rows × 462 columns\n\n\n\n\n# sites.to_parquet('out/unique_ks_sites.parquet')\n\nSites data is available upon ‘Data.get_ks_unique’\nThe num_kin info is added to ks_dataset in Data",
    "crumbs": [
      "Site promiscuity"
    ]
  },
  {
    "objectID": "13_CDDM_umap.html",
    "href": "13_CDDM_umap.html",
    "title": "CDDM umap",
    "section": "",
    "text": "import pandas as pd\nfrom katlas.data import *\nfrom katlas.plot import *\nfrom matplotlib import pyplot as plt\n\n\ndf = Data.get_cddm()\n\n⬇️ Downloading katlas_dataset.zip ...\n\n\nDownloading...\nFrom (original): https://drive.google.com/uc?id=17wIl0DbdoHV036Z3xgaT_0H3LlM_W47l\nFrom (redirected): https://drive.google.com/uc?id=17wIl0DbdoHV036Z3xgaT_0H3LlM_W47l&confirm=t&uuid=d94f1f27-e902-4dde-8b31-470044fe39ec\nTo: /home/sky1ove/git/katlas-raw/nbs/katlas_datasets.zip\n100%|██████████████████████████████████████████████████████████████████████| 209M/209M [00:05&lt;00:00, 35.2MB/s]\n\n\n📂 Extracting to /tmp/katlas_dataset ...\n🧹 Removing zip file: katlas_datasets.zip\n✅ Done! Extracted dataset is at: /tmp/katlas_dataset\n\n\n\ninfo = Data.get_kinase_info()\n\n\ninfo = info[info.pseudo=='0'].copy()\n\n\nhue = info.set_index('kinase')['modi_group']\n\n\nembed_df= reduce_feature(df,method='umap',complexity=6,min_dist=0.5)\n\n/home/sky1ove/git/katlas/.venv/lib/python3.11/site-packages/logomaker/../umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.\n  warn(\n\n\n\nplot_2d(embed_df,\n        s=40,\n        height=4,\n        hue=hue,\n        legend=True,\n        palette=group_color,\n        legend_title='Group')\nplt.title('UMAP of CDDM PSSM')\nsave_svg('fig/CDDM_umap.svg')\n\nText(0.5, 1.0, 'UMAP of CDDM PSSM')",
    "crumbs": [
      "CDDM umap"
    ]
  },
  {
    "objectID": "23_motif_kinase_similarity.html",
    "href": "23_motif_kinase_similarity.html",
    "title": "katlas-raw",
    "section": "",
    "text": "from katlas.data import *\nfrom katlas.pssm import *\nimport pandas as pd,numpy as np\nfrom tqdm import tqdm\nfrom scipy.stats import pearsonr\npssms = pd.read_parquet('out/all_site_pssms_filter.parquet')",
    "crumbs": [
      "Cosine similarity with PSPA"
    ]
  },
  {
    "objectID": "23_motif_kinase_similarity.html#cosine-similarity-with-pspa",
    "href": "23_motif_kinase_similarity.html#cosine-similarity-with-pspa",
    "title": "katlas-raw",
    "section": "Cosine similarity with PSPA",
    "text": "Cosine similarity with PSPA\n\npspa=Data.get_pspa_all_scale()\n\n\n(~pspa.columns.isin(pssms.columns)).sum()\n\nnp.int64(0)\n\n\n\ndf = pssms[pspa.columns].copy()\n\n\ndef js_similarity(pssm1,pssm2):\n    \"Convert JSD to bits to be in range (0,1) then 1-JSD.\"\n    distance = js_divergence(pssm1,pssm2)/np.log(2)\n    similarity = 1-distance\n    return similarity\n\n\ndef pearson_surrounding(p1, p2):\n    \"Compute Pearson correlation between two PSSMs, excluding column 0.\"\n    p1 = p1.drop(columns=0).copy()\n    p2 = p2.drop(columns=0).copy()\n    s1 = p1.unstack()\n    s2 = p2.unstack()\n    r, _ = pearsonr(s1, s2)\n    return r\n\n\ndef get_js_report(row1,# row1 is motif\n                  row2,# row1 is kinase pssm\n                 ):\n    p1 = recover_pssm(row1) # motif\n    p2 = recover_pssm(row2) # kinase pssm\n    \n    out = js_similarity(p1,p2)\n    \n    kinase_surrounding_IC=get_IC(p2,exclude_zero=True)\n    # motif_surrounding_IC = get_IC(p1,exclude_zero=True)\n    \n    maxIC_position =kinase_surrounding_IC.idxmax()\n    max_surrounding_value = out[maxIC_position]\n    \n    others = pd.Series(\n        {'JSD_mean': out.mean(),\n         'pearson_surrounding': pearson_surrounding(p1,p2),\n         'kinase_max_IC_position': maxIC_position,\n          'max_position_JSD': max_surrounding_value,\n          \n         # 'motif_IC_surrounding_max': motif_surrounding_IC.max() # -5 to +4\n          })\n    # return pd.concat([others,out])\n    return others\n\n\ndef test(motif,kinase):\n    r1 = df.loc[motif]\n    r2 = pspa.loc[kinase]\n    return get_js_report(r1,r2)\n\n\ndef test_motif(motif):\n    a=[]\n    for i,r in pspa.iterrows():\n        a.append(test(motif,i))\n    out = pd.DataFrame(a,index=pspa.index).sort_values('JSD_mean',ascending=False).round(3)\n    out['kinase_max_IC_position'] = out['kinase_max_IC_position'].astype(int)\n    return out\n\n\nss = test_motif(567)\n\n\nss\n\n\n\n\n\n\n\n\nJSD_mean\npearson_surrounding\nkinase_max_IC_position\nmax_position_JSD\n-5\n-4\n-3\n-2\n-1\n0\n1\n2\n3\n4\n\n\nkinase\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nBMPR1B\n0.827\n0.409\n1\n0.891\n0.911\n0.848\n0.332\n0.899\n0.891\n0.750\n0.891\n0.931\n0.899\n0.919\n\n\nBMPR1A\n0.824\n0.460\n1\n0.887\n0.909\n0.856\n0.379\n0.912\n0.884\n0.726\n0.887\n0.907\n0.872\n0.909\n\n\nCOT\n0.823\n0.232\n2\n0.911\n0.895\n0.841\n0.290\n0.793\n0.907\n0.907\n0.861\n0.911\n0.887\n0.937\n\n\nTGFBR1\n0.816\n0.397\n-2\n0.921\n0.897\n0.833\n0.310\n0.921\n0.894\n0.726\n0.844\n0.918\n0.904\n0.910\n\n\nPLK2\n0.814\n0.541\n-3\n0.630\n0.895\n0.856\n0.630\n0.833\n0.857\n0.742\n0.816\n0.779\n0.862\n0.869\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\nTNK1\n0.678\n-0.197\n3\n0.745\n0.876\n0.809\n0.203\n0.737\n0.827\n0.068\n0.791\n0.846\n0.745\n0.875\n\n\nDDR2\n0.675\n-0.120\n3\n0.696\n0.871\n0.795\n0.196\n0.728\n0.886\n0.068\n0.785\n0.895\n0.696\n0.833\n\n\nZAP70\n0.675\n0.034\n-1\n0.707\n0.886\n0.829\n0.284\n0.732\n0.707\n0.068\n0.681\n0.857\n0.779\n0.922\n\n\nFES\n0.671\n0.011\n-1\n0.696\n0.871\n0.816\n0.305\n0.781\n0.696\n0.068\n0.846\n0.814\n0.651\n0.859\n\n\nMUSK\n0.667\n-0.074\n1\n0.653\n0.866\n0.799\n0.244\n0.798\n0.790\n0.068\n0.653\n0.822\n0.758\n0.873\n\n\n\n\n396 rows × 14 columns\n\n\n\n\nout\n\n\n\n\n\n\n\n\nJSD_mean\npearson_surrounding\nkinase_max_IC_position\nmax_position_JSD\n-5\n-4\n-3\n-2\n-1\n0\n1\n2\n3\n4\n\n\nkinase\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCDK17\n0.897\n0.908\n1\n0.841\n0.930\n0.928\n0.925\n0.915\n0.901\n0.800\n0.841\n0.897\n0.907\n0.920\n\n\nP38G\n0.896\n0.926\n1\n0.850\n0.933\n0.931\n0.923\n0.930\n0.917\n0.714\n0.850\n0.897\n0.937\n0.925\n\n\nCDK18\n0.895\n0.885\n1\n0.806\n0.930\n0.934\n0.918\n0.913\n0.887\n0.831\n0.806\n0.898\n0.923\n0.910\n\n\nCDK19\n0.894\n0.865\n1\n0.789\n0.910\n0.910\n0.900\n0.897\n0.889\n0.896\n0.789\n0.908\n0.920\n0.921\n\n\nCDK3\n0.892\n0.808\n1\n0.833\n0.937\n0.932\n0.935\n0.931\n0.925\n0.791\n0.833\n0.920\n0.779\n0.936\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\nEPHA2\n0.696\n-0.145\n-1\n0.795\n0.921\n0.913\n0.901\n0.942\n0.795\n0.006\n0.037\n0.764\n0.801\n0.878\n\n\nYANK2\n0.695\n-0.105\n2\n0.427\n0.914\n0.907\n0.773\n0.826\n0.906\n0.592\n0.056\n0.427\n0.779\n0.765\n\n\nZAP70\n0.687\n-0.079\n-1\n0.710\n0.886\n0.886\n0.828\n0.853\n0.710\n0.006\n0.047\n0.847\n0.867\n0.940\n\n\nFES\n0.683\n-0.157\n-1\n0.732\n0.914\n0.905\n0.879\n0.922\n0.732\n0.006\n0.056\n0.804\n0.734\n0.875\n\n\nCK1G2\n0.673\n-0.092\n-3\n0.441\n0.798\n0.753\n0.441\n0.753\n0.891\n0.790\n0.079\n0.794\n0.657\n0.776\n\n\n\n\n396 rows × 14 columns\n\n\n\n\ndfs={}\nfor idx in tqdm(df.index,total=len(df)):\n    out = test_motif(idx)\n    dfs[idx]=out\n    out.to_parquet(f'fig/motif/{idx}/kinase3.parquet')\n    # break\n\n100%|████████████████████████████████████████████████████████████████████████████████████████| 1169/1169 [2:40:25&lt;00:00,  8.23s/it]\n\n\n\nout\n\n\n\n\n\n\n\n\nJSD_mean\npearson_surrounding\nkinase_max_IC_position\nmax_position_JSD\n\n\nkinase\n\n\n\n\n\n\n\n\nBMPR1B\n0.573\n0.089\n1\n0.632\n\n\nTGFBR1\n0.568\n0.109\n-2\n0.598\n\n\nJNK2\n0.565\n0.103\n1\n0.601\n\n\nCLK3\n0.565\n0.033\n1\n0.679\n\n\nKIS\n0.564\n0.104\n1\n0.629\n\n\n...\n...\n...\n...\n...\n\n\nWEE1_TYR\n0.435\n-0.103\n-1\n0.514\n\n\nPDGFRA\n0.434\n-0.161\n3\n0.589\n\n\nMUSK\n0.434\n-0.055\n1\n0.457\n\n\nDDR2\n0.433\n-0.107\n3\n0.513\n\n\nIGF1R\n0.433\n-0.085\n3\n0.452\n\n\n\n\n396 rows × 4 columns",
    "crumbs": [
      "Cosine similarity with PSPA"
    ]
  },
  {
    "objectID": "23_motif_kinase_similarity.html#with-cddm",
    "href": "23_motif_kinase_similarity.html#with-cddm",
    "title": "katlas-raw",
    "section": "With CDDM",
    "text": "With CDDM\n\ncddm=Data.get_cddm()\n\n\ninfo['idx'] = info['uniprot']+'_' + info['kinase']\n\n\n[cddm.index.isin(info.idx)]\n\n[array([ True,  True,  True,  True,  True,  True,  True,  True,  True,\n         True,  True,  True,  True,  True,  True,  True,  True,  True,\n         True,  True,  True,  True,  True,  True,  True,  True,  True,\n         True,  True,  True,  True,  True,  True,  True,  True,  True,\n         True,  True,  True,  True,  True,  True,  True,  True,  True,\n         True,  True,  True,  True,  True,  True,  True,  True,  True,\n         True,  True,  True,  True,  True,  True,  True,  True,  True,\n         True,  True,  True,  True,  True,  True,  True,  True,  True,\n         True,  True,  True,  True,  True,  True,  True,  True,  True,\n         True,  True,  True,  True,  True,  True,  True,  True,  True,\n         True,  True,  True,  True,  True,  True,  True,  True,  True,\n         True,  True,  True,  True,  True,  True,  True,  True,  True,\n         True,  True,  True,  True,  True,  True,  True,  True,  True,\n         True,  True,  True,  True,  True,  True,  True,  True,  True,\n         True,  True,  True,  True,  True,  True,  True,  True,  True,\n         True,  True,  True,  True,  True,  True,  True,  True,  True,\n         True,  True,  True,  True,  True,  True,  True,  True,  True,\n         True,  True,  True,  True,  True,  True,  True,  True,  True,\n         True,  True,  True,  True,  True,  True,  True,  True,  True,\n         True,  True,  True,  True,  True,  True,  True,  True,  True,\n         True,  True,  True,  True,  True,  True,  True,  True,  True,\n         True,  True,  True,  True,  True,  True,  True,  True,  True,\n         True,  True,  True,  True,  True,  True,  True,  True,  True,\n         True,  True,  True,  True,  True,  True,  True,  True,  True,\n         True,  True,  True,  True,  True,  True,  True,  True,  True,\n         True,  True,  True,  True,  True,  True,  True,  True,  True,\n         True,  True,  True,  True,  True,  True,  True,  True,  True,\n         True,  True,  True,  True,  True,  True,  True,  True,  True,\n         True,  True,  True,  True,  True,  True,  True,  True,  True,\n         True,  True,  True,  True,  True,  True,  True,  True,  True,\n         True,  True,  True,  True,  True,  True,  True,  True,  True,\n         True,  True,  True,  True,  True,  True,  True,  True,  True,\n         True,  True,  True,  True,  True,  True,  True,  True,  True,\n         True,  True,  True,  True,  True,  True,  True,  True,  True,\n         True,  True,  True,  True,  True,  True,  True,  True,  True,\n         True,  True,  True,  True,  True,  True,  True,  True,  True,\n         True,  True,  True,  True])]\n\n\n\ncddm\n\n\n\n\n\n\n\n\n-20P\n-20G\n-20A\n-20C\n-20S\n-20T\n-20V\n-20I\n-20L\n-20M\n...\n20H\n20K\n20R\n20Q\n20N\n20D\n20E\n20pS\n20pT\n20pY\n\n\n\n\nP12931_SRC\n0.054538\n0.081380\n0.060077\n0.012356\n0.036216\n0.032382\n0.055816\n0.052407\n0.083511\n0.023434\n...\n0.013351\n0.076992\n0.060970\n0.037383\n0.036938\n0.052960\n0.086337\n0.025367\n0.015576\n0.023142\n\n\nP29320_EPHA3\n0.044276\n0.088013\n0.065335\n0.008639\n0.037797\n0.036717\n0.072354\n0.048596\n0.075594\n0.026998\n...\n0.014132\n0.083098\n0.059356\n0.031091\n0.033917\n0.056529\n0.100622\n0.025438\n0.013567\n0.015828\n\n\nP07332_FES\n0.047231\n0.082519\n0.070575\n0.011401\n0.034745\n0.039088\n0.061889\n0.053203\n0.088491\n0.026059\n...\n0.013053\n0.086266\n0.055619\n0.040863\n0.038025\n0.059024\n0.085698\n0.026674\n0.013621\n0.019296\n\n\nQ16288_NTRK3\n0.044444\n0.074644\n0.074074\n0.017094\n0.033048\n0.035328\n0.060969\n0.058120\n0.084330\n0.026781\n...\n0.015682\n0.091677\n0.052473\n0.030760\n0.044029\n0.057298\n0.088661\n0.021713\n0.015682\n0.018094\n\n\nQ9UM73_ALK\n0.045748\n0.079765\n0.073314\n0.018182\n0.032845\n0.035191\n0.067449\n0.051026\n0.076246\n0.027566\n...\n0.015634\n0.090198\n0.069152\n0.030066\n0.043897\n0.051112\n0.096212\n0.026458\n0.013229\n0.017438\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\nQ15746_SMMLCK\n0.078947\n0.052632\n0.078947\n0.026316\n0.052632\n0.026316\n0.052632\n0.052632\n0.052632\n0.000000\n...\n0.000000\n0.066667\n0.022222\n0.044444\n0.133333\n0.044444\n0.000000\n0.044444\n0.022222\n0.000000\n\n\nQ01973_ROR1\n0.097561\n0.097561\n0.024390\n0.000000\n0.024390\n0.146341\n0.170732\n0.024390\n0.048780\n0.000000\n...\n0.000000\n0.075000\n0.050000\n0.000000\n0.050000\n0.025000\n0.125000\n0.125000\n0.000000\n0.025000\n\n\nO14976_GAK\n0.075000\n0.075000\n0.175000\n0.000000\n0.025000\n0.025000\n0.100000\n0.025000\n0.050000\n0.175000\n...\n0.000000\n0.024390\n0.024390\n0.000000\n0.170732\n0.195122\n0.024390\n0.048780\n0.024390\n0.000000\n\n\nQ6P0Q8_MAST2\n0.046512\n0.116279\n0.069767\n0.000000\n0.023256\n0.069767\n0.069767\n0.000000\n0.046512\n0.046512\n...\n0.000000\n0.048780\n0.219512\n0.000000\n0.048780\n0.024390\n0.024390\n0.024390\n0.000000\n0.000000\n\n\nP15056_BRAF\n0.095238\n0.071429\n0.047619\n0.000000\n0.095238\n0.047619\n0.071429\n0.000000\n0.095238\n0.047619\n...\n0.000000\n0.075000\n0.075000\n0.025000\n0.025000\n0.075000\n0.075000\n0.050000\n0.000000\n0.000000\n\n\n\n\n328 rows × 943 columns",
    "crumbs": [
      "Cosine similarity with PSPA"
    ]
  },
  {
    "objectID": "background.html",
    "href": "background.html",
    "title": "Background frequencies",
    "section": "",
    "text": "from katlas.core import *\nimport pandas as pd\nacceptors = ['S','T','Y','ST','STY']\ndf = Data.get_ks_unique()\ndf.head()\n\n\n\n\n\n\n\n\nsub_site\nnum_kin\nbin\nsub_genes\nsite_seq\nsource_combine\nacceptor\nO00141_SGK1\nO00238_BMPR1B\nO00311_CDC7\n...\nQ9Y2K2_SIK3\nQ9Y2U5_MAP3K2\nQ9Y3S1_WNK2\nQ9Y463_DYRK1B\nQ9Y4K4_MAP4K5\nQ9Y572_RIPK3\nQ9Y5S2_CDC42BPB\nQ9Y6E0_STK24\nQ9Y6M4_CSNK1G3\nQ9Y6R4_MAP3K4\n\n\n\n\n0\nA0A2R8Y4L2_S158\n1\n1\nHNRNPA1L3 HNRNPA1P48\nTDRGSGKKRGFAFVTFDDHDsVDKIVIQKYHTVNGHNCEVR\nSugiyama\nS\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n1\nA0A2R8Y4L2_S22\n3\n2~10\nHNRNPA1L3 HNRNPA1P48\nSKSEsPKEPEQLRKLFIGGLsFEtTDESLRSHFEQWGTLTD\nSugiyama\nS\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n2\nA0A2R8Y4L2_S6\n3\n2~10\nHNRNPA1L3 HNRNPA1P48\n_______________MSKSEsPKEPEQLRKLFIGGLsFEtT\nSugiyama\nS\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n3\nA0A2R8Y4L2_S95\n65\n11~100\nHNRNPA1L3 HNRNPA1P48\nRPHKVDGRVVEPKRAVSREDsQRPDAHLTVKKIFVGGIKED\nSugiyama\nS\n0\n1\n0\n...\n0\n1\n0\n0\n1\n0\n0\n0\n0\n0\n\n\n4\nA0A2R8Y4L2_T25\n3\n2~10\nHNRNPA1L3 HNRNPA1P48\nEsPKEPEQLRKLFIGGLsFEtTDESLRSHFEQWGTLTDCVV\nSugiyama\nT\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n\n\n5 rows × 462 columns",
    "crumbs": [
      "Background frequencies"
    ]
  },
  {
    "objectID": "background.html#pssms---ks-dataset",
    "href": "background.html#pssms---ks-dataset",
    "title": "Background frequencies",
    "section": "PSSMs - ks dataset",
    "text": "PSSMs - ks dataset\n\ndef get_bg_dict(df, acceptor, seq_col='site_seq'):\n    site = df[df.acceptor.isin(list(acceptor))].copy()\n    site_pssm = get_prob(site, seq_col)\n    return flatten_pssm(site_pssm, True)\n\n\nindex_names = 'ks_' + pd.Series(acceptors)\n\n\nbg_pssms = pd.DataFrame([get_bg_dict(df,acceptor) for acceptor in acceptors],index=index_names)\n\n\nbg_pssms\n\n\n\n\n\n\n\n\n-20P\n-20G\n-20A\n-20C\n-20S\n-20T\n-20V\n-20I\n-20L\n-20M\n...\n20H\n20K\n20R\n20Q\n20N\n20D\n20E\n20s\n20t\n20y\n\n\n\n\nks_S\n0.074296\n0.068105\n0.075925\n0.014664\n0.053246\n0.038517\n0.051290\n0.040342\n0.078989\n0.020269\n...\n0.021294\n0.070330\n0.059313\n0.044200\n0.036273\n0.054880\n0.077316\n0.043461\n0.014980\n0.006449\n\n\nks_T\n0.061634\n0.065896\n0.074266\n0.016436\n0.043829\n0.034394\n0.059656\n0.040177\n0.089484\n0.024806\n...\n0.022394\n0.075067\n0.060558\n0.045261\n0.038007\n0.058666\n0.076644\n0.035483\n0.019871\n0.008989\n\n\nks_Y\n0.056181\n0.072421\n0.070666\n0.015947\n0.044477\n0.038771\n0.055889\n0.045940\n0.086320\n0.024287\n...\n0.019500\n0.071146\n0.057892\n0.042505\n0.037629\n0.056216\n0.083181\n0.023157\n0.012492\n0.017367\n\n\nks_ST\n0.070500\n0.067442\n0.075428\n0.015195\n0.050422\n0.037280\n0.053799\n0.040292\n0.082136\n0.021629\n...\n0.021622\n0.071745\n0.059685\n0.044517\n0.036791\n0.056011\n0.077115\n0.041078\n0.016441\n0.007207\n\n\nks_STY\n0.067096\n0.068626\n0.074296\n0.015374\n0.049009\n0.037635\n0.054296\n0.041635\n0.083130\n0.022261\n...\n0.021121\n0.071603\n0.059262\n0.044041\n0.036989\n0.056059\n0.078548\n0.036845\n0.015508\n0.009607\n\n\n\n\n5 rows × 943 columns\n\n\n\n\nindex_names_upper = 'ks_' + pd.Series(acceptors) + '_upper'\n\n\ndf['site_seq_upper'] = df['site_seq'].str.upper()\n\n\nbg_pssms_upper = pd.DataFrame([get_bg_dict(df,acceptor,seq_col='site_seq_upper') for acceptor in acceptors],index=index_names_upper)\n\n\nbg_pssms = pd.concat([bg_pssms,bg_pssms_upper])\n\n\nbg_pssms\n\n\n\n\n\n\n\n\n-20P\n-20G\n-20A\n-20C\n-20S\n-20T\n-20V\n-20I\n-20L\n-20M\n...\n20H\n20K\n20R\n20Q\n20N\n20D\n20E\n20s\n20t\n20y\n\n\n\n\nks_S\n0.074296\n0.068105\n0.075925\n0.014664\n0.053246\n0.038517\n0.051290\n0.040342\n0.078989\n0.020269\n...\n0.021294\n0.070330\n0.059313\n0.044200\n0.036273\n0.054880\n0.077316\n0.043461\n0.014980\n0.006449\n\n\nks_T\n0.061634\n0.065896\n0.074266\n0.016436\n0.043829\n0.034394\n0.059656\n0.040177\n0.089484\n0.024806\n...\n0.022394\n0.075067\n0.060558\n0.045261\n0.038007\n0.058666\n0.076644\n0.035483\n0.019871\n0.008989\n\n\nks_Y\n0.056181\n0.072421\n0.070666\n0.015947\n0.044477\n0.038771\n0.055889\n0.045940\n0.086320\n0.024287\n...\n0.019500\n0.071146\n0.057892\n0.042505\n0.037629\n0.056216\n0.083181\n0.023157\n0.012492\n0.017367\n\n\nks_ST\n0.070500\n0.067442\n0.075428\n0.015195\n0.050422\n0.037280\n0.053799\n0.040292\n0.082136\n0.021629\n...\n0.021622\n0.071745\n0.059685\n0.044517\n0.036791\n0.056011\n0.077115\n0.041078\n0.016441\n0.007207\n\n\nks_STY\n0.067096\n0.068626\n0.074296\n0.015374\n0.049009\n0.037635\n0.054296\n0.041635\n0.083130\n0.022261\n...\n0.021121\n0.071603\n0.059262\n0.044041\n0.036989\n0.056059\n0.078548\n0.036845\n0.015508\n0.009607\n\n\nks_S_upper\n0.074296\n0.068105\n0.075925\n0.014664\n0.094891\n0.054028\n0.051290\n0.040342\n0.078989\n0.020269\n...\n0.021294\n0.070330\n0.059313\n0.044200\n0.036273\n0.054880\n0.077316\n0.000000\n0.000000\n0.000000\n\n\nks_T_upper\n0.061634\n0.065896\n0.074266\n0.016436\n0.072744\n0.052960\n0.059656\n0.040177\n0.089484\n0.024806\n...\n0.022394\n0.075067\n0.060558\n0.045261\n0.038007\n0.058666\n0.076644\n0.000000\n0.000000\n0.000000\n\n\nks_Y_upper\n0.056181\n0.072421\n0.070666\n0.015947\n0.067008\n0.050475\n0.055889\n0.045940\n0.086320\n0.024287\n...\n0.019500\n0.071146\n0.057892\n0.042505\n0.037629\n0.056216\n0.083181\n0.000000\n0.000000\n0.000000\n\n\nks_ST_upper\n0.070500\n0.067442\n0.075428\n0.015195\n0.088250\n0.053708\n0.053799\n0.040292\n0.082136\n0.021629\n...\n0.021622\n0.071745\n0.059685\n0.044517\n0.036791\n0.056011\n0.077115\n0.000000\n0.000000\n0.000000\n\n\nks_STY_upper\n0.067096\n0.068626\n0.074296\n0.015374\n0.083200\n0.052939\n0.054296\n0.041635\n0.083130\n0.022261\n...\n0.021121\n0.071603\n0.059262\n0.044041\n0.036989\n0.056059\n0.078548\n0.000000\n0.000000\n0.000000\n\n\n\n\n10 rows × 943 columns\n\n\n\n\ndef get_site_cnt(df, acceptor, seq_col='site_seq'):\n    site = df[df.acceptor.isin(list(acceptor))].copy()\n    return len(site)\n\n\ncnt = {name:get_site_cnt(df,acceptor) for acceptor,name in zip(acceptors,index_names)}\n\n\nplot_logos(bg_pssms,cnt,prefix='')\nsave_pdf('fig/background_ks.pdf')",
    "crumbs": [
      "Background frequencies"
    ]
  },
  {
    "objectID": "background.html#pssms---human-phosphoproteome",
    "href": "background.html#pssms---human-phosphoproteome",
    "title": "Background frequencies",
    "section": "PSSMs - human phosphoproteome",
    "text": "PSSMs - human phosphoproteome\n\nhuman = Data.get_human_site()\n\n\nhuman.acceptor\n\n0         S\n1         S\n2         S\n3         S\n4         S\n         ..\n121327    S\n121328    S\n121329    S\n121330    T\n121331    T\nName: acceptor, Length: 119955, dtype: object\n\n\n\ny_site = human[human.acceptor=='Y'].copy()\n\n\npssm = get_prob(y_site)\n\n\nfrom katlas.pssm import *\n\n\nplot_logo_heatmap\n\n&lt;function katlas.pssm.plot_logo_heatmap(pssm_df, title='Motif', figsize=(17, 10), include_zero=False)&gt;\n\n\n\nplot_logo_heatmap(pssm,title='Y sites in human phosphoproteome',figsize=(15,7))\nsave_svg('fig/human_y_site.svg')\n\n\n\n\n\n\n\n\n\nhuman['acceptor']=human.site.str[0]\n\n\nhuman.head(1)\n\n\n\n\n\n\n\n\nsubstrate_uniprot\nsubstrate_genes\nsite\nsource\nAM_pathogenicity\nsubstrate_sequence\nsubstrate_species\nsub_site\nsubstrate_phosphoseq\nposition\nsite_seq\nacceptor\n\n\n\n\n0\nA0A024R4G9\nC19orf48 MGC13170 hCG_2008493\nS20\npsp\nNaN\nMTVLEAVLEIQAITGSRLLSMVPGPARPPGSCWDPTQCTRTWLLSH...\nHomo sapiens (Human)\nA0A024R4G9_S20\nMTVLEAVLEIQAITGSRLLsMVPGPARPPGSCWDPTQCTRTWLLSH...\n20\n_MTVLEAVLEIQAITGSRLLsMVPGPARPPGSCWDPTQCTR\nS\n\n\n\n\n\n\n\n\nindex_names2 = 'human_' + pd.Series(acceptors)\n\n\nbg_pssms_human = pd.DataFrame([get_bg_dict(human,acceptor) for acceptor in acceptors],index=index_names2)\n\n\nbg_pssms_human\n\n\n\n\n\n\n\n\n-20P\n-20G\n-20A\n-20C\n-20S\n-20T\n-20V\n-20I\n-20L\n-20M\n...\n20H\n20K\n20R\n20Q\n20N\n20D\n20E\n20s\n20t\n20y\n\n\n\n\nhuman_S\n0.083640\n0.067324\n0.072426\n0.012983\n0.068431\n0.040755\n0.048601\n0.032621\n0.080464\n0.018531\n...\n0.022398\n0.066432\n0.064524\n0.047369\n0.033162\n0.051790\n0.079818\n0.044602\n0.013168\n0.003673\n\n\nhuman_T\n0.079864\n0.064356\n0.074764\n0.011942\n0.062697\n0.040927\n0.052994\n0.033463\n0.078537\n0.021811\n...\n0.020073\n0.070087\n0.062644\n0.048049\n0.032200\n0.051813\n0.078660\n0.043658\n0.017020\n0.004851\n\n\nhuman_Y\n0.073897\n0.067143\n0.073103\n0.016024\n0.058403\n0.039465\n0.051781\n0.041451\n0.087406\n0.020262\n...\n0.021772\n0.065723\n0.059600\n0.049939\n0.031297\n0.055382\n0.078106\n0.034699\n0.016193\n0.016601\n\n\nhuman_ST\n0.082791\n0.066656\n0.072951\n0.012749\n0.067141\n0.040794\n0.049589\n0.032810\n0.080030\n0.019268\n...\n0.021877\n0.067252\n0.064102\n0.047521\n0.032946\n0.051795\n0.079558\n0.044391\n0.014031\n0.003937\n\n\nhuman_STY\n0.082206\n0.066688\n0.072961\n0.012965\n0.066566\n0.040706\n0.049733\n0.033379\n0.080515\n0.019334\n...\n0.021870\n0.067153\n0.063812\n0.047677\n0.032840\n0.052027\n0.079465\n0.043766\n0.014171\n0.004753\n\n\n\n\n5 rows × 943 columns\n\n\n\n\nindex_names2_upper = 'human_' + pd.Series(acceptors) +'_upper'\n\n\nhuman['site_seq_upper'] = human['site_seq'].str.upper()\n\n\nbg_pssms_human_upper = pd.DataFrame([get_bg_dict(human,acceptor,seq_col='site_seq_upper') for acceptor in acceptors],index=index_names2_upper)\n\n\nbg_pssms_human_upper\n\n\n\n\n\n\n\n\n-20P\n-20G\n-20A\n-20C\n-20S\n-20T\n-20V\n-20I\n-20L\n-20M\n...\n20H\n20K\n20R\n20Q\n20N\n20D\n20E\n20s\n20t\n20y\n\n\n\n\nhuman_S_upper\n0.083640\n0.067324\n0.072426\n0.012983\n0.112772\n0.053678\n0.048601\n0.032621\n0.080464\n0.018531\n...\n0.022398\n0.066432\n0.064524\n0.047369\n0.033162\n0.051790\n0.079818\n0.0\n0.0\n0.0\n\n\nhuman_T_upper\n0.079864\n0.064356\n0.074764\n0.011942\n0.106734\n0.058260\n0.052994\n0.033463\n0.078537\n0.021811\n...\n0.020073\n0.070087\n0.062644\n0.048049\n0.032200\n0.051813\n0.078660\n0.0\n0.0\n0.0\n\n\nhuman_Y_upper\n0.073897\n0.067143\n0.073103\n0.016024\n0.093630\n0.053900\n0.051781\n0.041451\n0.087406\n0.020262\n...\n0.021772\n0.065723\n0.059600\n0.049939\n0.031297\n0.055382\n0.078106\n0.0\n0.0\n0.0\n\n\nhuman_ST_upper\n0.082791\n0.066656\n0.072951\n0.012749\n0.111414\n0.054709\n0.049589\n0.032810\n0.080030\n0.019268\n...\n0.021877\n0.067252\n0.064102\n0.047521\n0.032946\n0.051795\n0.079558\n0.0\n0.0\n0.0\n\n\nhuman_STY_upper\n0.082206\n0.066688\n0.072961\n0.012965\n0.110244\n0.054656\n0.049733\n0.033379\n0.080515\n0.019334\n...\n0.021870\n0.067153\n0.063812\n0.047677\n0.032840\n0.052027\n0.079465\n0.0\n0.0\n0.0\n\n\n\n\n5 rows × 943 columns\n\n\n\n\nbg_pssms_human = pd.concat([bg_pssms_human,bg_pssms_human_upper])\n\n\nbg_pssms_human\n\n\n\n\n\n\n\n\n-20P\n-20G\n-20A\n-20C\n-20S\n-20T\n-20V\n-20I\n-20L\n-20M\n...\n20H\n20K\n20R\n20Q\n20N\n20D\n20E\n20s\n20t\n20y\n\n\n\n\nhuman_S\n0.083640\n0.067324\n0.072426\n0.012983\n0.068431\n0.040755\n0.048601\n0.032621\n0.080464\n0.018531\n...\n0.022398\n0.066432\n0.064524\n0.047369\n0.033162\n0.051790\n0.079818\n0.044602\n0.013168\n0.003673\n\n\nhuman_T\n0.079864\n0.064356\n0.074764\n0.011942\n0.062697\n0.040927\n0.052994\n0.033463\n0.078537\n0.021811\n...\n0.020073\n0.070087\n0.062644\n0.048049\n0.032200\n0.051813\n0.078660\n0.043658\n0.017020\n0.004851\n\n\nhuman_Y\n0.073897\n0.067143\n0.073103\n0.016024\n0.058403\n0.039465\n0.051781\n0.041451\n0.087406\n0.020262\n...\n0.021772\n0.065723\n0.059600\n0.049939\n0.031297\n0.055382\n0.078106\n0.034699\n0.016193\n0.016601\n\n\nhuman_ST\n0.082791\n0.066656\n0.072951\n0.012749\n0.067141\n0.040794\n0.049589\n0.032810\n0.080030\n0.019268\n...\n0.021877\n0.067252\n0.064102\n0.047521\n0.032946\n0.051795\n0.079558\n0.044391\n0.014031\n0.003937\n\n\nhuman_STY\n0.082206\n0.066688\n0.072961\n0.012965\n0.066566\n0.040706\n0.049733\n0.033379\n0.080515\n0.019334\n...\n0.021870\n0.067153\n0.063812\n0.047677\n0.032840\n0.052027\n0.079465\n0.043766\n0.014171\n0.004753\n\n\nhuman_S_upper\n0.083640\n0.067324\n0.072426\n0.012983\n0.112772\n0.053678\n0.048601\n0.032621\n0.080464\n0.018531\n...\n0.022398\n0.066432\n0.064524\n0.047369\n0.033162\n0.051790\n0.079818\n0.000000\n0.000000\n0.000000\n\n\nhuman_T_upper\n0.079864\n0.064356\n0.074764\n0.011942\n0.106734\n0.058260\n0.052994\n0.033463\n0.078537\n0.021811\n...\n0.020073\n0.070087\n0.062644\n0.048049\n0.032200\n0.051813\n0.078660\n0.000000\n0.000000\n0.000000\n\n\nhuman_Y_upper\n0.073897\n0.067143\n0.073103\n0.016024\n0.093630\n0.053900\n0.051781\n0.041451\n0.087406\n0.020262\n...\n0.021772\n0.065723\n0.059600\n0.049939\n0.031297\n0.055382\n0.078106\n0.000000\n0.000000\n0.000000\n\n\nhuman_ST_upper\n0.082791\n0.066656\n0.072951\n0.012749\n0.111414\n0.054709\n0.049589\n0.032810\n0.080030\n0.019268\n...\n0.021877\n0.067252\n0.064102\n0.047521\n0.032946\n0.051795\n0.079558\n0.000000\n0.000000\n0.000000\n\n\nhuman_STY_upper\n0.082206\n0.066688\n0.072961\n0.012965\n0.110244\n0.054656\n0.049733\n0.033379\n0.080515\n0.019334\n...\n0.021870\n0.067153\n0.063812\n0.047677\n0.032840\n0.052027\n0.079465\n0.000000\n0.000000\n0.000000\n\n\n\n\n10 rows × 943 columns\n\n\n\n\nall_pssms = pd.concat([bg_pssms,bg_pssms_human])\n\n\nall_pssms\n\n\n\n\n\n\n\n\n-20P\n-20G\n-20A\n-20C\n-20S\n-20T\n-20V\n-20I\n-20L\n-20M\n...\n20H\n20K\n20R\n20Q\n20N\n20D\n20E\n20s\n20t\n20y\n\n\n\n\nks_S\n0.074296\n0.068105\n0.075925\n0.014664\n0.053246\n0.038517\n0.051290\n0.040342\n0.078989\n0.020269\n...\n0.021294\n0.070330\n0.059313\n0.044200\n0.036273\n0.054880\n0.077316\n0.043461\n0.014980\n0.006449\n\n\nks_T\n0.061634\n0.065896\n0.074266\n0.016436\n0.043829\n0.034394\n0.059656\n0.040177\n0.089484\n0.024806\n...\n0.022394\n0.075067\n0.060558\n0.045261\n0.038007\n0.058666\n0.076644\n0.035483\n0.019871\n0.008989\n\n\nks_Y\n0.056181\n0.072421\n0.070666\n0.015947\n0.044477\n0.038771\n0.055889\n0.045940\n0.086320\n0.024287\n...\n0.019500\n0.071146\n0.057892\n0.042505\n0.037629\n0.056216\n0.083181\n0.023157\n0.012492\n0.017367\n\n\nks_ST\n0.070500\n0.067442\n0.075428\n0.015195\n0.050422\n0.037280\n0.053799\n0.040292\n0.082136\n0.021629\n...\n0.021622\n0.071745\n0.059685\n0.044517\n0.036791\n0.056011\n0.077115\n0.041078\n0.016441\n0.007207\n\n\nks_STY\n0.067096\n0.068626\n0.074296\n0.015374\n0.049009\n0.037635\n0.054296\n0.041635\n0.083130\n0.022261\n...\n0.021121\n0.071603\n0.059262\n0.044041\n0.036989\n0.056059\n0.078548\n0.036845\n0.015508\n0.009607\n\n\nks_S_upper\n0.074296\n0.068105\n0.075925\n0.014664\n0.094891\n0.054028\n0.051290\n0.040342\n0.078989\n0.020269\n...\n0.021294\n0.070330\n0.059313\n0.044200\n0.036273\n0.054880\n0.077316\n0.000000\n0.000000\n0.000000\n\n\nks_T_upper\n0.061634\n0.065896\n0.074266\n0.016436\n0.072744\n0.052960\n0.059656\n0.040177\n0.089484\n0.024806\n...\n0.022394\n0.075067\n0.060558\n0.045261\n0.038007\n0.058666\n0.076644\n0.000000\n0.000000\n0.000000\n\n\nks_Y_upper\n0.056181\n0.072421\n0.070666\n0.015947\n0.067008\n0.050475\n0.055889\n0.045940\n0.086320\n0.024287\n...\n0.019500\n0.071146\n0.057892\n0.042505\n0.037629\n0.056216\n0.083181\n0.000000\n0.000000\n0.000000\n\n\nks_ST_upper\n0.070500\n0.067442\n0.075428\n0.015195\n0.088250\n0.053708\n0.053799\n0.040292\n0.082136\n0.021629\n...\n0.021622\n0.071745\n0.059685\n0.044517\n0.036791\n0.056011\n0.077115\n0.000000\n0.000000\n0.000000\n\n\nks_STY_upper\n0.067096\n0.068626\n0.074296\n0.015374\n0.083200\n0.052939\n0.054296\n0.041635\n0.083130\n0.022261\n...\n0.021121\n0.071603\n0.059262\n0.044041\n0.036989\n0.056059\n0.078548\n0.000000\n0.000000\n0.000000\n\n\nhuman_S\n0.083640\n0.067324\n0.072426\n0.012983\n0.068431\n0.040755\n0.048601\n0.032621\n0.080464\n0.018531\n...\n0.022398\n0.066432\n0.064524\n0.047369\n0.033162\n0.051790\n0.079818\n0.044602\n0.013168\n0.003673\n\n\nhuman_T\n0.079864\n0.064356\n0.074764\n0.011942\n0.062697\n0.040927\n0.052994\n0.033463\n0.078537\n0.021811\n...\n0.020073\n0.070087\n0.062644\n0.048049\n0.032200\n0.051813\n0.078660\n0.043658\n0.017020\n0.004851\n\n\nhuman_Y\n0.073897\n0.067143\n0.073103\n0.016024\n0.058403\n0.039465\n0.051781\n0.041451\n0.087406\n0.020262\n...\n0.021772\n0.065723\n0.059600\n0.049939\n0.031297\n0.055382\n0.078106\n0.034699\n0.016193\n0.016601\n\n\nhuman_ST\n0.082791\n0.066656\n0.072951\n0.012749\n0.067141\n0.040794\n0.049589\n0.032810\n0.080030\n0.019268\n...\n0.021877\n0.067252\n0.064102\n0.047521\n0.032946\n0.051795\n0.079558\n0.044391\n0.014031\n0.003937\n\n\nhuman_STY\n0.082206\n0.066688\n0.072961\n0.012965\n0.066566\n0.040706\n0.049733\n0.033379\n0.080515\n0.019334\n...\n0.021870\n0.067153\n0.063812\n0.047677\n0.032840\n0.052027\n0.079465\n0.043766\n0.014171\n0.004753\n\n\nhuman_S_upper\n0.083640\n0.067324\n0.072426\n0.012983\n0.112772\n0.053678\n0.048601\n0.032621\n0.080464\n0.018531\n...\n0.022398\n0.066432\n0.064524\n0.047369\n0.033162\n0.051790\n0.079818\n0.000000\n0.000000\n0.000000\n\n\nhuman_T_upper\n0.079864\n0.064356\n0.074764\n0.011942\n0.106734\n0.058260\n0.052994\n0.033463\n0.078537\n0.021811\n...\n0.020073\n0.070087\n0.062644\n0.048049\n0.032200\n0.051813\n0.078660\n0.000000\n0.000000\n0.000000\n\n\nhuman_Y_upper\n0.073897\n0.067143\n0.073103\n0.016024\n0.093630\n0.053900\n0.051781\n0.041451\n0.087406\n0.020262\n...\n0.021772\n0.065723\n0.059600\n0.049939\n0.031297\n0.055382\n0.078106\n0.000000\n0.000000\n0.000000\n\n\nhuman_ST_upper\n0.082791\n0.066656\n0.072951\n0.012749\n0.111414\n0.054709\n0.049589\n0.032810\n0.080030\n0.019268\n...\n0.021877\n0.067252\n0.064102\n0.047521\n0.032946\n0.051795\n0.079558\n0.000000\n0.000000\n0.000000\n\n\nhuman_STY_upper\n0.082206\n0.066688\n0.072961\n0.012965\n0.110244\n0.054656\n0.049733\n0.033379\n0.080515\n0.019334\n...\n0.021870\n0.067153\n0.063812\n0.047677\n0.032840\n0.052027\n0.079465\n0.000000\n0.000000\n0.000000\n\n\n\n\n20 rows × 943 columns\n\n\n\n\n# all_pssms.to_parquet('out/ks_background.parquet')\n\nAccessible through Data.get_ks_background\n\ncnt_human = {name:get_site_cnt(human,acceptor) for acceptor,name in zip(acceptors,index_names2)}\n\n\ncnt.update(cnt_human)\n\n\ncnt\n\n{'KS Dataset Background: S': 15981,\n 'KS Dataset Background: T': 6762,\n 'KS Dataset Background: Y': 7068,\n 'KS Dataset Background: ST': 22743,\n 'KS Dataset Background: STY': 29811,\n 'Human Phosphoproteome Background: S': 86995,\n 'Human Phosphoproteome Background: T': 25091,\n 'Human Phosphoproteome Background: Y': 7869,\n 'Human Phosphoproteome Background: ST': 112086,\n 'Human Phosphoproteome Background: STY': 119955}\n\n\n\nplot_logos(bg_pssms_human,cnt,prefix='')\nsave_pdf('fig/background_human.pdf')",
    "crumbs": [
      "Background frequencies"
    ]
  },
  {
    "objectID": "22_motif_web_data.html",
    "href": "22_motif_web_data.html",
    "title": "katlas-raw",
    "section": "",
    "text": "import pandas as pd\n\n\n\ndf=pd.read_parquet('out/web_motif_df.parquet')\n\n\n# df.uniprot.drop_duplicates().to_csv('ss.csv')\n\nQuery on Uniprot in ID mapping to get protein name and function annotations.\n\ninfo = pd.read_excel('raw/idmapping_2025_10_142.xlsx')\n\n\ninfo.function = info.function.str.replace(r'^FUNCTION:\\s*', '', regex=True)\n\n\ninfo.to_parquet('raw/motif_pro_info.parquet')\n\n\ndf.shape\n\n(751513, 7)\n\n\n\n# df.merge(info).shape\n\n(751513, 9)\n\n\n\ndf = df.merge(info)",
    "crumbs": [
      "22_motif_web_data.html"
    ]
  },
  {
    "objectID": "pssm_hierarchical.html",
    "href": "pssm_hierarchical.html",
    "title": "Hierarchical clustering of PSSM",
    "section": "",
    "text": "from katlas.data import *\nimport pandas as pd\nfrom katlas.clustering import *\ndf = pd.read_parquet('out/CDDM_pssms.parquet')\ndf\n\n\n\n\n\n\n\n\n-20P\n-20G\n-20A\n-20C\n-20S\n-20T\n-20V\n-20I\n-20L\n-20M\n...\n20H\n20K\n20R\n20Q\n20N\n20D\n20E\n20pS\n20pT\n20pY\n\n\nindex\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nP12931_SRC\n0.054538\n0.081380\n0.060077\n0.012356\n0.036216\n0.032382\n0.055816\n0.052407\n0.083511\n0.023434\n...\n0.013351\n0.076992\n0.060970\n0.037383\n0.036938\n0.052960\n0.086337\n0.025367\n0.015576\n0.023142\n\n\nP29320_EPHA3\n0.044276\n0.088013\n0.065335\n0.008639\n0.037797\n0.036717\n0.072354\n0.048596\n0.075594\n0.026998\n...\n0.014132\n0.083098\n0.059356\n0.031091\n0.033917\n0.056529\n0.100622\n0.025438\n0.013567\n0.015828\n\n\nP07332_FES\n0.047231\n0.082519\n0.070575\n0.011401\n0.034745\n0.039088\n0.061889\n0.053203\n0.088491\n0.026059\n...\n0.013053\n0.086266\n0.055619\n0.040863\n0.038025\n0.059024\n0.085698\n0.026674\n0.013621\n0.019296\n\n\nQ16288_NTRK3\n0.044444\n0.074644\n0.074074\n0.017094\n0.033048\n0.035328\n0.060969\n0.058120\n0.084330\n0.026781\n...\n0.015682\n0.091677\n0.052473\n0.030760\n0.044029\n0.057298\n0.088661\n0.021713\n0.015682\n0.018094\n\n\nQ9UM73_ALK\n0.045748\n0.079765\n0.073314\n0.018182\n0.032845\n0.035191\n0.067449\n0.051026\n0.076246\n0.027566\n...\n0.015634\n0.090198\n0.069152\n0.030066\n0.043897\n0.051112\n0.096212\n0.026458\n0.013229\n0.017438\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\nQ15746_SMMLCK\n0.078947\n0.052632\n0.078947\n0.026316\n0.052632\n0.026316\n0.052632\n0.052632\n0.052632\n0.000000\n...\n0.000000\n0.066667\n0.022222\n0.044444\n0.133333\n0.044444\n0.000000\n0.044444\n0.022222\n0.000000\n\n\nQ01973_ROR1\n0.097561\n0.097561\n0.024390\n0.000000\n0.024390\n0.146341\n0.170732\n0.024390\n0.048780\n0.000000\n...\n0.000000\n0.075000\n0.050000\n0.000000\n0.050000\n0.025000\n0.125000\n0.125000\n0.000000\n0.025000\n\n\nP15056_BRAF\n0.095238\n0.071429\n0.047619\n0.000000\n0.095238\n0.047619\n0.071429\n0.000000\n0.095238\n0.047619\n...\n0.000000\n0.075000\n0.075000\n0.025000\n0.025000\n0.075000\n0.075000\n0.050000\n0.000000\n0.000000\n\n\nO14976_GAK\n0.075000\n0.075000\n0.175000\n0.000000\n0.025000\n0.025000\n0.100000\n0.025000\n0.050000\n0.175000\n...\n0.000000\n0.024390\n0.024390\n0.000000\n0.170732\n0.195122\n0.024390\n0.048780\n0.024390\n0.000000\n\n\nQ6P0Q8_MAST2\n0.046512\n0.116279\n0.069767\n0.000000\n0.023256\n0.069767\n0.069767\n0.000000\n0.046512\n0.046512\n...\n0.000000\n0.048780\n0.219512\n0.000000\n0.048780\n0.024390\n0.024390\n0.024390\n0.000000\n0.000000\n\n\n\n\n329 rows × 943 columns\nZ = get_Z(df)\ndata = Data.get_ks_dataset()\ndata['kinase_id'] = data['kinase_uniprot'] + '_' + data['kinase_protein'].str.split().str[0]\ncnt = data['kinase_id'].value_counts()\nlabels= get_pssm_seq_labels(df,count_map=cnt,thr=0.2)\nfrom katlas.plot import *\nplot_dendrogram(Z,dense=5,labels=labels,title='CDDM Hierarchical Clustering') \nsave_pdf('out/CDDM_hierarchical.pdf')",
    "crumbs": [
      "Hierarchical clustering of PSSM"
    ]
  },
  {
    "objectID": "pssm_hierarchical.html#pspa",
    "href": "pssm_hierarchical.html#pspa",
    "title": "Hierarchical clustering of PSSM",
    "section": "PSPA",
    "text": "PSPA\n\ndf2 = Data.get_pspa_all_scale()\n\n\ninfo = Data.get_kinase_info()\n\n\nkmap = info.set_index('kinase')['uniprot']\n\n\ndf2.index = df2.index.str.split('_').str[0].map(kmap) + \"_\" + df2.index\n\n\nZ2 = get_Z(df2)\n\n\n\n\n\nlabels2= get_pssm_seq_labels(df2,thr=0.2)\n\n\nplot_dendrogram(Z2,dense=5,labels=labels2,title='PSPA Hierarchical Clustering') \nsave_pdf('out/PSPA_hierarchical.pdf')",
    "crumbs": [
      "Hierarchical clustering of PSSM"
    ]
  },
  {
    "objectID": "modi_group.html",
    "href": "modi_group.html",
    "title": "Modi group",
    "section": "",
    "text": "import pandas as pd\nfrom katlas.data import *\n\nDownloaded from Modi et al.,\n\ngroup = pd.read_excel('raw/modi_group_41598_2019_56499_MOESM5_ESM.xlsx')\n\n\ndup = group[group['5_Uni_acc'].duplicated(keep=False)]\n\n\n# dup.to_csv('test.csv',index=False)\n\n\ngroup=group[~group['5_Uni_acc'].duplicated(keep=False)]\n\n\ninfo=Data.get_kinase_info()\n\n\ninfo\n\n\n\n\n\n\n\n\nkinase\nID_coral\nuniprot\nID_HGNC\ngroup\nfamily\nsubfamily_coral\nsubfamily\nin_ST_paper\nin_Tyr_paper\n...\ncytosol\ncytoskeleton\nplasma membrane\nmitochondrion\nGolgi apparatus\nendoplasmic reticulum\nvesicle\ncentrosome\naggresome\nmain_location\n\n\n\n\n0\nAAK1\nAAK1\nQ2M2I8\nAAK1\nOther\nNAK\nNaN\nNAK\n1\n0\n...\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\n\n\n1\nABL1\nABL1\nP00519\nABL1\nTK\nAbl\nNaN\nAbl\n0\n1\n...\n6.0\nNaN\n4.0\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\ncytosol\n\n\n2\nABL2\nABL2\nP42684\nABL2\nTK\nAbl\nNaN\nAbl\n0\n1\n...\n4.0\n6.0\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\ncytoskeleton\n\n\n3\nTNK2\nACK\nQ07912\nTNK2\nTK\nAck\nNaN\nAck\n0\n1\n...\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\n8.0\nNaN\n2.0\nvesicle\n\n\n4\nACVR2A\nACTR2\nP27037\nACVR2A\nTKL\nSTKR\nSTKR2\nSTKR2\n1\n0\n...\n5.0\nNaN\nNaN\nNaN\nNaN\n5.0\nNaN\nNaN\nNaN\ncytosol\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\n518\nYSK1\nYSK1\nO00506\nSTK25\nSTE\nSTE20\nYSK\nYSK\n1\n0\n...\n6.0\nNaN\nNaN\nNaN\n4.0\nNaN\nNaN\nNaN\nNaN\ncytosol\n\n\n519\nZAK\nZAK\nQ9NYL2\nMAP3K20\nTKL\nMLK\nZAK\nZAK\n1\n0\n...\n5.0\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nnucleus\n\n\n520\nZAP70\nZAP70\nP43403\nZAP70\nTK\nSyk\nNaN\nSyk\n0\n1\n...\n5.0\nNaN\n2.0\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\ncytosol\n\n\n521\nEEF2K\neEF2K\nO00418\nEEF2K\nAtypical\nAlpha\neEF2K\neEF2K\n1\n0\n...\n9.0\nNaN\n1.0\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\ncytosol\n\n\n522\nFAM20C\nFAM20C\nQ8IXL6\nFAM20C\nAtypical\nFAM20C\nNaN\nFAM20C\n1\n0\n...\n2.0\nNaN\nNaN\nNaN\n7.0\n1.0\nNaN\nNaN\nNaN\nGolgi apparatus\n\n\n\n\n523 rows × 30 columns\n\n\n\n\ngroup\n\n\n\n\n\n\n\n\n1_Group\n2_Gene\n3_HGNC\n4_Uni_entry\n5_Uni_acc\n6_Domain_begin\n7_Domain_end\n8_Domain_length\n9_Largest_insert_length\n10_PDB_validation\n11_Conformational_state\n12_Dihedral_state\n13_Group_in_Uni\n14_Group_in_Manning\n15_Synonymn\n\n\n\n\n0\nOTHER\nAAK1\nHGNC:19679\nAAK1_HUMAN\nQ2M2I8\n46\n313\n268\n11\n4WSQB\nDFGin\nBLAminus\nOTHER\nOTHER\nKIAA1048\n\n\n1\nTYR\nAATK\nHGNC:21\nLMTK1_HUMAN\nQ6ZMQ8\n125\n397\n273\n15\nNaN\nNaN\nNaN\nTYR\nTYR\nAATYK,KIAA0641,LMR1,LMTK1\n\n\n2\nTYR\nABL1\nHGNC:76\nABL1_HUMAN\nP00519\n242\n495\n254\n10\n4TWPB\nDFGin\nBLAminus\nTYR\nTYR\nABL,JTK7\n\n\n3\nTYR\nABL2\nHGNC:77\nABL2_HUMAN\nP42684\n288\n541\n254\n10\n2XYNC\nDFGin\nBLAminus\nTYR\nTYR\nABLL,ARG\n\n\n4\nTKL\nACVR1\nHGNC:171\nACVR1_HUMAN\nQ04771\n208\n497\n290\n16\n6GIPA\nDFGin\nBLAminus\nTKL\nTKL\nACVRLK2\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\n492\nOTHER\nWNK2\nHGNC:14542\nWNK2_HUMAN\nQ9Y3S1\n194\n453\n260\n11\nNaN\nNaN\nNaN\nOTHER\nOTHER\nKIAA1760,PRKWNK2,SDCCAG43\n\n\n493\nOTHER\nWNK3\nHGNC:14543\nWNK3_HUMAN\nQ9BYP7\n146\n405\n260\n11\n5O21B\nDFGin\nBLAminus\nOTHER\nOTHER\nKIAA1566,PRKWNK3\n\n\n494\nOTHER\nWNK4\nHGNC:14544\nWNK4_HUMAN\nQ96J92\n173\n432\n260\n11\nNaN\nNaN\nNaN\nOTHER\nOTHER\nPRKWNK4\n\n\n495\nTYR\nYES1\nHGNC:12841\nYES_HUMAN\nP07947\n277\n528\n252\n10\nNaN\nNaN\nNaN\nTYR\nTYR\nYES\n\n\n496\nTYR\nZAP70\nHGNC:12858\nZAP70_HUMAN\nP43403\n337\n595\n259\n10\n1U59A\nDFGin\nBLAminus\nTYR\nTYR\nSRK\n\n\n\n\n471 rows × 15 columns\n\n\n\n\ngroup = group[['1_Group','2_Gene','5_Uni_acc']]\n\n\ngroup.columns=['modi_group','modi_gene','uniprot']\n\n\ngroup_id = group.set_index('uniprot')['modi_group']\n\n\ninfo.uniprot.isin(group_id.index).sum()\n\n465\n\n\n\ninfo['modi_group']=info.uniprot.map(group_id)\n\n\nreorder=['kinase', 'ID_coral', 'uniprot', 'ID_HGNC', 'modi_group', 'group', 'family',\n       'subfamily_coral', 'subfamily', 'in_ST_paper', 'in_Tyr_paper',\n       'in_cddm', 'pseudo', 'pspa_category_small', 'pspa_category_big',\n       'cddm_big', 'cddm_small', 'length', 'human_uniprot_sequence',\n       'kinasecom_domain', 'nucleus', 'cytosol', 'cytoskeleton',\n       'plasma membrane', 'mitochondrion', 'Golgi apparatus',\n       'endoplasmic reticulum', 'vesicle', 'centrosome', 'aggresome',\n       'main_location']\n\n\ninfo = info[reorder]\n\n\n# info.to_csv('out/kinase_info_modi.csv',index=False)\n\nGet the dup ‘test.csv’ matched manually\nAdd atypical group, change OTHER to Other\nKinase in modi group but not in kinome tree:\n\ngroup[~group.uniprot.isin(info.uniprot)]\n\n\n\n\n\n\n\n\nmodi_group\nmodi_gene\nuniprot\n\n\n\n\n51\nCMGC\nCDK11A\nQ9UQ88\n\n\n94\nCMGC\nCSNK2A3\nQ8NEV1\n\n\n307\nOTHER\nPAN3\nQ58A45\n\n\n314\nAGC\nPDPK2P\nQ6A1A2\n\n\n316\nOTHER\nPEAK3\nQ6ZS72\n\n\n333\nCAMK\nPLK5\nQ496M5\n\n\n406\nCAMK\nSIK1B\nA0A0B4J2F2\n\n\n\n\n\n\n\n\ngroup_id\n\nuniprot\nQ2M2I8    OTHER\nQ6ZMQ8      TYR\nP00519      TYR\nP42684      TYR\nQ04771      TKL\n          ...  \nQ9Y3S1    OTHER\nQ9BYP7    OTHER\nQ96J92    OTHER\nP07947      TYR\nP43403      TYR\nName: modi_group, Length: 471, dtype: object\n\n\n\ninfo.merge(group_id.reset_index(),'left')\n\n\n\n\n\n\n\n\nkinase\nID_coral\nuniprot\nID_HGNC\ngroup\nfamily\nsubfamily_coral\nsubfamily\nin_ST_paper\nin_Tyr_paper\n...\ncytoskeleton\nplasma membrane\nmitochondrion\nGolgi apparatus\nendoplasmic reticulum\nvesicle\ncentrosome\naggresome\nmain_location\nmodi_group\n\n\n\n\n0\nAAK1\nAAK1\nQ2M2I8\nAAK1\nOther\nNAK\nNaN\nNAK\n1\n0\n...\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nOTHER\n\n\n1\nABL1\nABL1\nP00519\nABL1\nTK\nAbl\nNaN\nAbl\n0\n1\n...\nNaN\n4.0\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\ncytosol\nTYR\n\n\n2\nABL2\nABL2\nP42684\nABL2\nTK\nAbl\nNaN\nAbl\n0\n1\n...\n6.0\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\ncytoskeleton\nTYR\n\n\n3\nTNK2\nACK\nQ07912\nTNK2\nTK\nAck\nNaN\nAck\n0\n1\n...\nNaN\nNaN\nNaN\nNaN\nNaN\n8.0\nNaN\n2.0\nvesicle\nTYR\n\n\n4\nACVR2A\nACTR2\nP27037\nACVR2A\nTKL\nSTKR\nSTKR2\nSTKR2\n1\n0\n...\nNaN\nNaN\nNaN\nNaN\n5.0\nNaN\nNaN\nNaN\ncytosol\nTKL\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\n518\nYSK1\nYSK1\nO00506\nSTK25\nSTE\nSTE20\nYSK\nYSK\n1\n0\n...\nNaN\nNaN\nNaN\n4.0\nNaN\nNaN\nNaN\nNaN\ncytosol\nSTE\n\n\n519\nZAK\nZAK\nQ9NYL2\nMAP3K20\nTKL\nMLK\nZAK\nZAK\n1\n0\n...\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nnucleus\nTKL\n\n\n520\nZAP70\nZAP70\nP43403\nZAP70\nTK\nSyk\nNaN\nSyk\n0\n1\n...\nNaN\n2.0\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\ncytosol\nTYR\n\n\n521\nEEF2K\neEF2K\nO00418\nEEF2K\nAtypical\nAlpha\neEF2K\neEF2K\n1\n0\n...\nNaN\n1.0\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\ncytosol\nNaN\n\n\n522\nFAM20C\nFAM20C\nQ8IXL6\nFAM20C\nAtypical\nFAM20C\nNaN\nFAM20C\n1\n0\n...\nNaN\nNaN\nNaN\n7.0\n1.0\nNaN\nNaN\nNaN\nGolgi apparatus\nNaN\n\n\n\n\n523 rows × 31 columns",
    "crumbs": [
      "Modi group"
    ]
  },
  {
    "objectID": "kinase_domain/kd_12_compare_pred_psp_known.html",
    "href": "kinase_domain/kd_12_compare_pred_psp_known.html",
    "title": "katlas-raw",
    "section": "",
    "text": "import pandas as pd\nfrom katlas.pssm import *\nfrom matplotlib import pyplot as plt\nfrom functools import partial\ndf = pd.read_csv('raw/psp_ks_dataset_2408.csv')\ndf['kin_uniprot'] = df.KIN_ACC_ID.str.split('-').str[0]\ndf.kin_uniprot.value_counts()\n\nkin_uniprot\nP17612    1105\nP06493     816\nP68400     799\nP17252     772\nP12931     753\n          ... \nO54988       1\nQ9BRS2       1\nQ80X41       1\nO55098       1\nQ5U4C9       1\nName: count, Length: 834, dtype: int64\nnonhuman = (df.KIN_ORGANISM.value_counts()&gt;13)[lambda x: x].index[1:]\nnonhuman\n\nIndex(['mouse', 'rat', 'cow', 'chicken', 'rabbit', 'pig', 'herpesvirus'], dtype='object', name='KIN_ORGANISM')\ndf = df[df.KIN_ORGANISM.isin(nonhuman)]\ndf.shape\n\n(4759, 17)\ndf['sub_uniprot']=df.SUB_ACC_ID.str.split('-').str[0]\ndf['sub_site'] = df.sub_uniprot+\"_\"+df.SUB_MOD_RSD\ndf.shape\n\n(4759, 19)\n# remove sub site duplicates for each kinase\ndf = df.drop_duplicates(subset=['kin_uniprot','sub_site'])\ndf.shape\n\n(4734, 19)\nkin_idxs = (df.kin_uniprot.value_counts()&gt;=30)[lambda x: x].index\npred_pspa=pd.read_parquet('raw/pred_new_pspa.parquet')\npred_cddm=pd.read_parquet('raw/pred_new_cddm.parquet')\nidxs = pred_pspa.index.str.split('_').str[0]\nidxs.isin(df.kin_uniprot).sum()\n\nnp.int64(322)\nidxs.isin(kin_idxs).sum()\n\nnp.int64(34)\ndf['site_seq'] = df['SITE_+/-7_AA']\npsp_nonhuman = get_cluster_pssms(df,cluster_col = 'kin_uniprot',count_thr=30)\n\n100%|███████████████████████████████████████████████████████████████████████████████████████████| 391/391 [00:00&lt;00:00, 706.09it/s]\nidx_overlap = list(set(idxs)&set(psp_nonhuman.index))\nori_index = pred_pspa.index\npred_pspa.index=pred_pspa.index.str.split('_').str[0]\npred_pspa = pred_pspa.loc[idx_overlap]\nnonhuman_pspa = psp_nonhuman.loc[idx_overlap]",
    "crumbs": [
      "kinase_domain",
      "Comopare the two"
    ]
  },
  {
    "objectID": "kinase_domain/kd_12_compare_pred_psp_known.html#comopare-the-two",
    "href": "kinase_domain/kd_12_compare_pred_psp_known.html#comopare-the-two",
    "title": "katlas-raw",
    "section": "Comopare the two",
    "text": "Comopare the two\n\ndef score_df(target,pred,func):\n    cols = list(set(target.columns)&set(pred.columns))\n    distance = [func(target.loc[i,cols],pred.loc[i,cols]) for i in target.index]\n    return pd.Series(distance,index=target.index)\n\n\njsd_df = partial(score_df,func=js_divergence_flat)\n\n\njsd_score = jsd_df(nonhuman_pspa,pred_pspa).sort_values()\n\n\npred_pspa,nonhuman_pspa = pred_pspa.align(nonhuman_pspa,join='inner')\n\n\nfor idx,score in jsd_score.items():\n    pssm1 = recover_pssm(nonhuman_pspa.loc[idx])\n    pssm2 = recover_pssm(pred_pspa.loc[idx])\n    \n    plot_two_heatmaps(pssm1,pssm2,f'{idx}:{score:.3f}','PSP','Predicted',scale_01=False)\n    plt.show()\n    plt.close()\n    # break",
    "crumbs": [
      "kinase_domain",
      "Comopare the two"
    ]
  },
  {
    "objectID": "kinase_domain/kd_08b_similarity_relationship_cddm.html",
    "href": "kinase_domain/kd_08b_similarity_relationship_cddm.html",
    "title": "KD similarity & PSSM similarity",
    "section": "",
    "text": "import pandas as pd, numpy as np\nimport matplotlib.pyplot as plt\nfrom numpy.linalg import norm\nfrom katlas.data import *\nfrom scipy.stats import spearmanr\nfrom katlas.clustering import *\n# pspa_t5 = pd.read_parquet('train/pspa_t5.parquet')\ncddm_t5 = pd.read_parquet('train/cddm_t5.parquet')\ndf = cddm_t5.copy()\ndf['0pY'].sort_values()\n\nO75385_ULK1_HUMAN_KD1     0.000000\nO15530_PDPK1_HUMAN_KD1    0.000000\nP78527_PRKDC_HUMAN_KD1    0.000000\nQ8IU85_KCC1D_HUMAN_KD1    0.000000\nQ13535_ATR_HUMAN_KD1      0.000000\n                            ...   \nQ15303_ERBB4_HUMAN_KD1    0.933654\nP22455_FGFR4_HUMAN_KD1    0.936460\nP54764_EPHA4_HUMAN_KD1    0.936728\nP10721_KIT_HUMAN_KD1      0.939353\nQ15375_EPHA7_HUMAN_KD1    0.939747\nName: 0pY, Length: 320, dtype: float64\nst = df[df['0pY']&lt;0.7].copy()\ntyr = df[df['0pY']&gt;=0.7].copy()\ndef euclidean_dist(u, v):\n    return norm(u - v)\ndef get_dist(df):\n    df =df.copy()\n    t5_cols = df.columns[df.columns.str.startswith('T5')]\n    pssm_cols = df.columns[~df.columns.str.startswith('T5')]\n    D_pssm = get_1d_js_parallel(df[pssm_cols])\n    D_t5 = get_1d_distance_parallel(df[t5_cols],func_flat=euclidean_dist)\n    return D_t5,D_pssm\nD_t5,D_pssm= get_dist(st)\n\n100%|████████████████████████████████████████████████████████████████████████████████████████████| 241/241 [00:42&lt;00:00,  5.62it/s]\n100%|████████████████████████████████████████████████████████████████████████████████████████████| 241/241 [00:03&lt;00:00, 70.38it/s]\nD_t5_y,D_pssm_y= get_dist(tyr)\n\n100%|██████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:04&lt;00:00, 16.69it/s]\n100%|█████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:00&lt;00:00, 185.65it/s]\ndef plot_scatter(x, y,line=None):\n    plt.figure(figsize=(4,3), dpi=300)\n    plt.scatter(x, y, s=3, alpha=0.3)\n\n    # labels\n    plt.xlabel(\"Euclidean distance in T5 embeddings of KDs\")\n    plt.ylabel(\"JS divergence in PSSMs\")\n\n    # calculate Spearman correlation\n    rho, pval = spearmanr(x, y)\n\n    # annotate Spearman correlation coefficient on the plot\n    plt.text(0.95, 0.95, f\"Spearman ρ = {rho:.3f}\", \n             ha=\"right\", va=\"top\", transform=plt.gca().transAxes,\n             fontsize=10, bbox=dict(facecolor=\"white\", alpha=0.6, edgecolor=\"none\"))\n\n    if line is not None: plt.axvline(x=line, color=\"darkred\", alpha=0.7,linestyle=\"--\", linewidth=1)\n    plt.tight_layout()\nplot_scatter(D_t5,D_pssm,line=0.25)\nplot_scatter(D_t5_y,D_pssm_y,line=0.25)",
    "crumbs": [
      "kinase_domain",
      "KD similarity & PSSM similarity"
    ]
  },
  {
    "objectID": "kinase_domain/kd_08b_similarity_relationship_cddm.html#distance-in-all-kd",
    "href": "kinase_domain/kd_08b_similarity_relationship_cddm.html#distance-in-all-kd",
    "title": "KD similarity & PSSM similarity",
    "section": "Distance in all kd",
    "text": "Distance in all kd\n\ndf  = Data.get_kd_uniprot()\ndf = df[df.active_D1_D2==1].reset_index(drop=True)\n\n\n# df['in_pspa']  = df.kd_ID.isin(pspa_t5.index).astype(int)\ndf['in_cddm']  = df.kd_ID.isin(cddm_t5.index).astype(int)\n\n\nfrom katlas.feature import *\n\n\n# t5 = get_t5(df,col='kd_seq')\n\n# t5.index=df.kd_ID\n\n# t5 = t5.astype('float64')\n\n# t5.to_parquet('out/uniprot_kd_t5.parquet')\n\n\nt5_df = pd.read_parquet('raw/t5_kd.parquet')\n\n\ndef find_close_negatives(df: pd.DataFrame,\n                         label_series,\n                         threshold: float = 0.25,\n                         return_all: bool = False) -&gt; pd.DataFrame:\n    \"\"\"\n    For each negative (label_col==0), find the nearest positive (label_col==1)\n    by Euclidean distance over `features`, and mark whether it's within `threshold`.\n\n    Returns a DataFrame indexed by the negatives' index with columns:\n      - closest_pos_index\n      - closest_dist\n      - within_threshold (bool)\n    If `return_all=False`, only rows within threshold are returned.\n    \"\"\"\n\n    # Extract arrays\n    mask_pos = label_series.eq(1).to_numpy()\n    mask_neg = ~mask_pos\n\n    X_pos = df.loc[mask_pos].to_numpy(dtype=float, copy=False)\n    X_neg = df.loc[mask_neg].to_numpy(dtype=float, copy=False)\n\n    # Handle edge cases\n    if X_pos.size == 0 or X_neg.size == 0:\n        out = pd.DataFrame(columns=[\"closest_pos_index\", \"closest_dist\", \"within_threshold\"],\n                           index=df.index[mask_neg])\n        return out if return_all else out.iloc[0:0]\n\n    # Pairwise squared distances: ||a-b||^2 = ||a||^2 + ||b||^2 - 2 a·b\n    sq_pos = np.einsum('ij,ij-&gt;i', X_pos, X_pos)            # (P,)\n    sq_neg = np.einsum('ij,ij-&gt;i', X_neg, X_neg)            # (N,)\n    D2 = sq_neg[:, None] + sq_pos[None, :] - 2.0 * (X_neg @ X_pos.T)\n    np.maximum(D2, 0.0, out=D2)                             # numerical safety\n    # Nearest positive for each negative\n    idx_min = D2.argmin(axis=1)                             # (N,)\n    dmin = np.sqrt(D2[np.arange(D2.shape[0]), idx_min])     # (N,)\n\n    # Map back to indices\n    pos_index = df.index[mask_pos].to_numpy()\n    neg_index = df.index[mask_neg].to_numpy()\n    closest_pos_index = pos_index[idx_min]\n\n    out = pd.DataFrame({\n        \"closest_pos_index\": closest_pos_index,\n        \"closest_dist\": dmin,\n        \"within_threshold\": dmin &lt;= threshold,\n    }, index=neg_index)\n\n    return out if return_all else out[out[\"within_threshold\"]]\n\n\nresults_cddm = find_close_negatives(t5_df, label_series=df.in_cddm,\n                                   threshold=0.25, return_all=True)\n\n\nresults_cddm.to_parquet('raw/kd_similar_cddm.parquet')\n\n\nresults_cddm[results_cddm.within_threshold].sort_values('closest_dist')\n\n\n\n\n\n\n\n\nclosest_pos_index\nclosest_dist\nwithin_threshold\n\n\n\n\nA4K2T0_STK4_MACMU_KD1\nQ13043_STK4_HUMAN_KD1\n0.000000\nTrue\n\n\nQ9WV60_GSK3B_MOUSE_KD1\nP49841_GSK3B_HUMAN_KD1\n0.000000\nTrue\n\n\nA4K2Y1_STK4_CHLAE_KD1\nQ13043_STK4_HUMAN_KD1\n0.000000\nTrue\n\n\nE2QWQ2_NLK_CANLF_KD1\nQ9UBE8_NLK_HUMAN_KD1\n0.000000\nTrue\n\n\nQ8CIP4_MARK4_MOUSE_KD1\nQ96L34_MARK4_HUMAN_KD1\n0.000000\nTrue\n\n\n...\n...\n...\n...\n\n\nO08605_MKNK1_MOUSE_KD1\nQ9HBH9_MKNK2_HUMAN_KD1\n0.248701\nTrue\n\n\nP87253_KPC1_NEUCR_KD1\nQ04759_KPCT_HUMAN_KD1\n0.249016\nTrue\n\n\nP47817_WEE2A_XENLA_KD1\nP30291_WEE1_HUMAN_KD1\n0.249110\nTrue\n\n\nQ9W739_CDK1_RANDY_KD1\nP06493_CDK1_HUMAN_KD1\n0.249479\nTrue\n\n\nQ8AYG3_TTK_DANRE_KD1\nP33981_TTK_HUMAN_KD1\n0.249601\nTrue\n\n\n\n\n1195 rows × 3 columns",
    "crumbs": [
      "kinase_domain",
      "KD similarity & PSSM similarity"
    ]
  },
  {
    "objectID": "kinase_domain/kd_09a_predict_pspa.html",
    "href": "kinase_domain/kd_09a_predict_pspa.html",
    "title": "Predict",
    "section": "",
    "text": "import pandas as pd\nfrom katlas.train import *\nfrom katlas.dnn import *\nfrom fastai.vision.all import *\nfrom katlas.pssm import *\npspa_unk = pd.read_parquet('raw/kd_similar_pspa.parquet')\npspa_unk = pspa_unk[pspa_unk.within_threshold].copy()\nlen(pspa_unk)\n\n1230\n# from katlas.data import *\n\n# kd = Data.get_kd_uniprot()\nt5 = pd.read_parquet('raw/t5_kd.parquet')\ntest_pspa = t5.loc[pspa_unk.index].reset_index()",
    "crumbs": [
      "kinase_domain",
      "Predict"
    ]
  },
  {
    "objectID": "kinase_domain/kd_09a_predict_pspa.html#predict",
    "href": "kinase_domain/kd_09a_predict_pspa.html#predict",
    "title": "Predict",
    "section": "Predict",
    "text": "Predict\n\nsample=pd.read_parquet('train/pspa_t5.parquet')\n\n\ntarget_col = sample.columns[~sample.columns.str.startswith('T5')]\n\n\ntarget_col\n\nIndex(['-5P', '-4P', '-3P', '-2P', '-1P', '0P', '1P', '2P', '3P', '4P',\n       ...\n       '-5pY', '-4pY', '-3pY', '-2pY', '-1pY', '0pY', '1pY', '2pY', '3pY',\n       '4pY'],\n      dtype='object', length=230)\n\n\n\nfeat_col = test_pspa.columns[1:]\n\n\nfeat_col\n\nIndex(['T5_0', 'T5_1', 'T5_2', 'T5_3', 'T5_4', 'T5_5', 'T5_6', 'T5_7', 'T5_8',\n       'T5_9',\n       ...\n       'T5_1014', 'T5_1015', 'T5_1016', 'T5_1017', 'T5_1018', 'T5_1019',\n       'T5_1020', 'T5_1021', 'T5_1022', 'T5_1023'],\n      dtype='object', length=1024)\n\n\n\nn_feature = len(feat_col)\nn_target = len(target_col)\n\n\nn_feature,n_target\n\n(1024, 230)\n\n\n\ndef get_cnn(): return PSSM_model(n_feature,n_target,model='CNN')\n\n\nfrom tqdm import tqdm\n\n\ndef get_ensemble_pred(test_df, model_name,nfold=5):\n    ensemble = None\n    for i in tqdm(range(nfold)):\n        test_pred = predict_dl(test_df, \n                   feat_col, \n                   target_col,\n                   model_func=get_cnn, # model architecture\n                   model_pth=f'{model_name}_fold{i}', # only name, not with .pth\n                  )\n        if ensemble is None:\n            ensemble = test_pred.copy()   # start with first prediction\n        else:\n            ensemble += test_pred         # accumulate\n    \n    ensemble /= 5\n    return ensemble\n\n\npred = get_ensemble_pred(test_pspa,'cnn_pspa')\n\n100%|████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:05&lt;00:00,  1.16s/it]\n\n\n\npred.index=pspa_unk.index\n\n\npred.to_parquet('raw/pred_new_pspa.parquet')\n\n\npred\n\n\n\n\n\n\n\n\n-5P\n-4P\n-3P\n-2P\n-1P\n0P\n1P\n2P\n3P\n4P\n...\n-5pY\n-4pY\n-3pY\n-2pY\n-1pY\n0pY\n1pY\n2pY\n3pY\n4pY\n\n\n\n\nA0A8I3S724_AURKA_CANLF_KD1\n0.037882\n0.043779\n0.047041\n0.015380\n0.041898\n0.000035\n0.014323\n0.038704\n0.043827\n0.049526\n...\n0.044010\n0.040576\n0.037645\n0.013764\n0.059714\n3.364276e-06\n0.038454\n0.043046\n0.061429\n0.046730\n\n\nA0A8I5ZNK2_OXSR1_RAT_KD1\n0.049239\n0.043381\n0.043311\n0.028526\n0.024280\n0.000017\n0.015904\n0.036569\n0.055815\n0.055253\n...\n0.056746\n0.050559\n0.046230\n0.048480\n0.063029\n1.908836e-06\n0.024791\n0.022593\n0.038125\n0.032603\n\n\nA0JM20_TYRO3_XENTR_KD1\n0.051376\n0.052102\n0.052074\n0.052638\n0.039458\n0.000007\n0.014260\n0.036449\n0.041221\n0.043479\n...\n0.047453\n0.048676\n0.052394\n0.046324\n0.091800\n9.998582e-01\n0.070185\n0.070169\n0.022106\n0.042790\n\n\nA0JNB0_FYN_BOVIN_KD1\n0.046870\n0.045461\n0.040785\n0.051638\n0.031777\n0.000042\n0.014092\n0.031362\n0.044332\n0.045642\n...\n0.053741\n0.067277\n0.067271\n0.058158\n0.079825\n9.992056e-01\n0.115731\n0.104918\n0.031915\n0.042396\n\n\nA0M8R7_MET_PAPAN_KD1\n0.050430\n0.051898\n0.046124\n0.052797\n0.030787\n0.000008\n0.012470\n0.035201\n0.051783\n0.045867\n...\n0.055322\n0.063184\n0.067201\n0.055751\n0.128271\n9.998606e-01\n0.096431\n0.081910\n0.025833\n0.041041\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\nQ9Z2R9_E2AK1_MOUSE_KD1\n0.034602\n0.038246\n0.029201\n0.018279\n0.023267\n0.000089\n0.006634\n0.026299\n0.060636\n0.040961\n...\n0.036762\n0.033087\n0.052582\n0.034784\n0.052302\n4.450690e-07\n0.022007\n0.019414\n0.033284\n0.040663\n\n\nQ9Z2W1_STK25_MOUSE_KD1\n0.045502\n0.040996\n0.040295\n0.032663\n0.030100\n0.000020\n0.017534\n0.042085\n0.043391\n0.050217\n...\n0.042046\n0.036751\n0.047517\n0.044899\n0.036057\n3.428805e-06\n0.019266\n0.016506\n0.029094\n0.024208\n\n\nQ9Z335_SBK1_RAT_KD1\n0.040285\n0.027252\n0.026376\n0.035437\n0.108038\n0.000049\n0.061123\n0.050412\n0.066567\n0.059834\n...\n0.026251\n0.025690\n0.013364\n0.027668\n0.028979\n1.546801e-06\n0.043730\n0.041582\n0.060285\n0.045016\n\n\nW0LYS5_CAMKI_MACNP_KD1\n0.049159\n0.035515\n0.025772\n0.020806\n0.057251\n0.000065\n0.014600\n0.028858\n0.027823\n0.049323\n...\n0.028890\n0.024585\n0.017603\n0.015780\n0.031326\n4.352188e-06\n0.035301\n0.101816\n0.042666\n0.032528\n\n\nX5M5N0_WNK_CAEEL_KD1\n0.038345\n0.037591\n0.039816\n0.043162\n0.025581\n0.000033\n0.016244\n0.033651\n0.038988\n0.045358\n...\n0.037754\n0.033027\n0.036153\n0.035582\n0.047813\n1.219898e-05\n0.028811\n0.033507\n0.038083\n0.036475\n\n\n\n\n1230 rows × 230 columns",
    "crumbs": [
      "kinase_domain",
      "Predict"
    ]
  },
  {
    "objectID": "kinase_domain/kd_09a_predict_pspa.html#test",
    "href": "kinase_domain/kd_09a_predict_pspa.html#test",
    "title": "Predict",
    "section": "test",
    "text": "test\n\ncdks = pspa_unk[pspa_unk.closest_pos_index.str.contains('CDK')]\n\n\nfor i in cdks.head(5).index:\n    plot_heatmap(recover_pssm(pred.loc[i]))\n    plt.show()\n    plt.close()",
    "crumbs": [
      "kinase_domain",
      "Predict"
    ]
  },
  {
    "objectID": "kinase_domain/kd_06b_pspa_training_feature_comparison_cnn_subfamily.html",
    "href": "kinase_domain/kd_06b_pspa_training_feature_comparison_cnn_subfamily.html",
    "title": "DL training: Feature comparison on CNN model",
    "section": "",
    "text": "import numpy as np, pandas as pd\nimport os, random\nfrom katlas.data import *\nfrom katlas.train import *\nfrom fastai.vision.all import *\nfrom katlas.dnn import *\n\n\nseed_everything()\n\n\ndef_device\n\n'cuda'",
    "crumbs": [
      "kinase_domain",
      "DL training: Feature comparison on CNN model"
    ]
  },
  {
    "objectID": "kinase_domain/kd_06b_pspa_training_feature_comparison_cnn_subfamily.html#setup",
    "href": "kinase_domain/kd_06b_pspa_training_feature_comparison_cnn_subfamily.html#setup",
    "title": "DL training: Feature comparison on CNN model",
    "section": "",
    "text": "import numpy as np, pandas as pd\nimport os, random\nfrom katlas.data import *\nfrom katlas.train import *\nfrom fastai.vision.all import *\nfrom katlas.dnn import *\n\n\nseed_everything()\n\n\ndef_device\n\n'cuda'",
    "crumbs": [
      "kinase_domain",
      "DL training: Feature comparison on CNN model"
    ]
  },
  {
    "objectID": "kinase_domain/kd_06b_pspa_training_feature_comparison_cnn_subfamily.html#data",
    "href": "kinase_domain/kd_06b_pspa_training_feature_comparison_cnn_subfamily.html#data",
    "title": "DL training: Feature comparison on CNN model",
    "section": "Data",
    "text": "Data\n\ndf_t5=pd.read_parquet('train/pspa_t5.parquet').reset_index()\ndf_esm=pd.read_parquet('train/pspa_esm.parquet').reset_index()\ndf_onehot = pd.read_parquet('train/pspa_onehot.parquet').reset_index()\ndf_onehot_pca = pd.read_parquet('train/pspa_onehot_pca.parquet').reset_index()\n\n\n(df_onehot['index'] == df_esm['index']).value_counts()\n\nindex\nTrue    368\nName: count, dtype: int64\n\n\n\n(df_t5['index'] == df_esm['index']).value_counts()\n\nindex\nTrue    368\nName: count, dtype: int64\n\n\n\nt5_col = df_t5.columns[df_t5.columns.str.startswith('T5_')]\n\n\nt5_col\n\nIndex(['T5_0', 'T5_1', 'T5_2', 'T5_3', 'T5_4', 'T5_5', 'T5_6', 'T5_7', 'T5_8',\n       'T5_9',\n       ...\n       'T5_1014', 'T5_1015', 'T5_1016', 'T5_1017', 'T5_1018', 'T5_1019',\n       'T5_1020', 'T5_1021', 'T5_1022', 'T5_1023'],\n      dtype='object', length=1024)\n\n\n\nesm_col = df_esm.columns[df_esm.columns.str.startswith('esm_')]\n\n\nesm_col\n\nIndex(['esm_0', 'esm_1', 'esm_2', 'esm_3', 'esm_4', 'esm_5', 'esm_6', 'esm_7',\n       'esm_8', 'esm_9',\n       ...\n       'esm_1270', 'esm_1271', 'esm_1272', 'esm_1273', 'esm_1274', 'esm_1275',\n       'esm_1276', 'esm_1277', 'esm_1278', 'esm_1279'],\n      dtype='object', length=1280)\n\n\n\ntarget_col = df_t5.columns[~df_t5.columns.isin(t5_col)][1:]\n\n\ntarget_col\n\nIndex(['-5P', '-4P', '-3P', '-2P', '-1P', '0P', '1P', '2P', '3P', '4P',\n       ...\n       '-5pY', '-4pY', '-3pY', '-2pY', '-1pY', '0pY', '1pY', '2pY', '3pY',\n       '4pY'],\n      dtype='object', length=230)\n\n\n\nonehot_col = df_onehot.columns[~df_onehot.columns.isin(target_col)][1:]\n\n\nonehot_col\n\nIndex(['65_-', '65_A', '65_C', '65_D', '65_E', '65_F', '65_G', '65_H', '65_I',\n       '65_K',\n       ...\n       '3192_M', '3192_N', '3192_P', '3192_Q', '3192_R', '3192_S', '3192_T',\n       '3192_V', '3192_W', '3192_Y'],\n      dtype='object', length=6849)\n\n\n\nonehot_pca_col = df_onehot_pca.columns[df_onehot_pca.columns.str.startswith('PCA')]\n\n\nonehot_pca_col\n\nIndex(['PCA1', 'PCA2', 'PCA3', 'PCA4', 'PCA5', 'PCA6', 'PCA7', 'PCA8', 'PCA9',\n       'PCA10',\n       ...\n       'PCA991', 'PCA992', 'PCA993', 'PCA994', 'PCA995', 'PCA996', 'PCA997',\n       'PCA998', 'PCA999', 'PCA1000'],\n      dtype='object', length=1000)\n\n\n\ninfo=Data.get_kinase_info()\n\ninfo = info[info.pseudo=='0']\n\ninfo = info[info.kd_ID.notna()]\n\nsubfamily_map = info[['kd_ID','subfamily']].drop_duplicates().set_index('kd_ID')['subfamily']\nfamily_map = info[['kd_ID','family']].drop_duplicates().set_index('kd_ID')['family']\ngroup_map = info[['kd_ID','group']].drop_duplicates().set_index('kd_ID')['group']\n\npspa_info = pd.DataFrame(df_t5['index'].tolist(),columns=['kinase'])\n\npspa_info['subfamily'] = pspa_info.kinase.map(subfamily_map)\npspa_info['family'] = pspa_info.kinase.map(family_map)\npspa_info['group'] = pspa_info.kinase.map(group_map)",
    "crumbs": [
      "kinase_domain",
      "DL training: Feature comparison on CNN model"
    ]
  },
  {
    "objectID": "kinase_domain/kd_06b_pspa_training_feature_comparison_cnn_subfamily.html#split",
    "href": "kinase_domain/kd_06b_pspa_training_feature_comparison_cnn_subfamily.html#split",
    "title": "DL training: Feature comparison on CNN model",
    "section": "Split",
    "text": "Split\n\nsplits = get_splits(pspa_info, group='subfamily',nfold=5)\n\nsplit0 = splits[0]\n\nGroupKFold(n_splits=5, random_state=None, shuffle=False)\n# subfamily in train set: 120\n# subfamily in test set: 29",
    "crumbs": [
      "kinase_domain",
      "DL training: Feature comparison on CNN model"
    ]
  },
  {
    "objectID": "kinase_domain/kd_06b_pspa_training_feature_comparison_cnn_subfamily.html#dataset",
    "href": "kinase_domain/kd_06b_pspa_training_feature_comparison_cnn_subfamily.html#dataset",
    "title": "DL training: Feature comparison on CNN model",
    "section": "Dataset",
    "text": "Dataset\n\n# dataset\nds_t5 = GeneralDataset(df_t5,t5_col,target_col)\nds_esm = GeneralDataset(df_esm,esm_col,target_col)\nds_onehot = GeneralDataset(df_onehot,onehot_col,target_col)\nds_onehot_pca = GeneralDataset(df_onehot_pca,onehot_pca_col,target_col)\n\n\nlen(ds_t5)\n\n368\n\n\n\ndl_t5 = DataLoader(ds_t5, batch_size=64, shuffle=True)\ndl_esm = DataLoader(ds_esm, batch_size=64, shuffle=True)\ndl_onehot = DataLoader(ds_onehot, batch_size=64, shuffle=True)\ndl_onehot_pca = DataLoader(ds_onehot_pca, batch_size=64, shuffle=True)\n\n\nxb,yb = next(iter(dl_t5))\n\nxb.shape,yb.shape\n\n(torch.Size([64, 1024]), torch.Size([64, 23, 10]))",
    "crumbs": [
      "kinase_domain",
      "DL training: Feature comparison on CNN model"
    ]
  },
  {
    "objectID": "kinase_domain/kd_06b_pspa_training_feature_comparison_cnn_subfamily.html#model",
    "href": "kinase_domain/kd_06b_pspa_training_feature_comparison_cnn_subfamily.html#model",
    "title": "DL training: Feature comparison on CNN model",
    "section": "Model",
    "text": "Model\n\nn_t5 = len(t5_col)\nn_esm = len(esm_col)\nn_onehot = len(onehot_col)\nn_onehot_pca = len(onehot_pca_col)\nn_target = len(target_col)\n\n\nn_t5,n_esm,n_onehot,n_onehot_pca\n\n(1024, 1280, 6849, 1000)\n\n\n\n# def get_cnn(): return PSSM_model(n_feature,n_target,model='CNN')\n\ndef get_cnn_t5(): return PSSM_model(n_t5,n_target,model='CNN')\ndef get_cnn_esm(): return PSSM_model(n_esm,n_target,model='CNN')\ndef get_cnn_onehot(): return PSSM_model(n_onehot,n_target,model='CNN')\ndef get_cnn_onehot_pca(): return PSSM_model(n_onehot_pca,n_target,model='CNN')\n\n\nmodel = get_cnn_t5()\n\n\nlogits= model(xb)\n\n\nlogits.shape\n\ntorch.Size([64, 23, 10])",
    "crumbs": [
      "kinase_domain",
      "DL training: Feature comparison on CNN model"
    ]
  },
  {
    "objectID": "kinase_domain/kd_06b_pspa_training_feature_comparison_cnn_subfamily.html#loss",
    "href": "kinase_domain/kd_06b_pspa_training_feature_comparison_cnn_subfamily.html#loss",
    "title": "DL training: Feature comparison on CNN model",
    "section": "Loss",
    "text": "Loss\n\nCE(logits,yb)\n\ntensor(3.3157, grad_fn=&lt;MeanBackward0&gt;)",
    "crumbs": [
      "kinase_domain",
      "DL training: Feature comparison on CNN model"
    ]
  },
  {
    "objectID": "kinase_domain/kd_06b_pspa_training_feature_comparison_cnn_subfamily.html#metrics",
    "href": "kinase_domain/kd_06b_pspa_training_feature_comparison_cnn_subfamily.html#metrics",
    "title": "DL training: Feature comparison on CNN model",
    "section": "Metrics",
    "text": "Metrics\n\nKLD(logits,yb)\n\ntensor(0.5744, grad_fn=&lt;MeanBackward0&gt;)\n\n\n\nJSD(logits,yb)\n\ntensor(0.1175, grad_fn=&lt;MeanBackward0&gt;)",
    "crumbs": [
      "kinase_domain",
      "DL training: Feature comparison on CNN model"
    ]
  },
  {
    "objectID": "kinase_domain/kd_06b_pspa_training_feature_comparison_cnn_subfamily.html#cv-train",
    "href": "kinase_domain/kd_06b_pspa_training_feature_comparison_cnn_subfamily.html#cv-train",
    "title": "DL training: Feature comparison on CNN model",
    "section": "CV train",
    "text": "CV train\n\ncross-validation\n\n\noof_t5 = train_dl_cv(df_t5,t5_col,target_col,\n                  splits = splits,\n                  model_func = get_cnn_t5,\n                  n_epoch=20,lr=3e-3)\n\n------fold0------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.231986\n3.125983\n0.406525\n0.085582\n00:05\n\n\n1\n3.138005\n3.045690\n0.326232\n0.073996\n-1:59:59\n\n\n2\n3.062126\n3.090588\n0.371130\n0.064781\n00:00\n\n\n3\n3.016940\n3.291427\n0.571969\n0.066470\n00:00\n\n\n4\n2.984665\n3.187309\n0.467851\n0.060243\n00:00\n\n\n5\n2.961451\n3.084717\n0.365259\n0.054002\n00:00\n\n\n6\n2.941049\n2.889636\n0.170178\n0.037260\n00:00\n\n\n7\n2.921982\n2.814090\n0.094632\n0.022759\n00:00\n\n\n8\n2.903746\n2.809765\n0.090306\n0.021266\n00:00\n\n\n9\n2.886869\n2.812037\n0.092579\n0.021582\n00:00\n\n\n10\n2.873026\n2.804671\n0.085213\n0.020041\n00:00\n\n\n11\n2.860586\n2.802081\n0.082622\n0.019404\n00:00\n\n\n12\n2.849770\n2.801163\n0.081705\n0.019056\n00:00\n\n\n13\n2.840398\n2.798161\n0.078702\n0.018495\n00:00\n\n\n14\n2.832530\n2.796730\n0.077272\n0.018087\n00:00\n\n\n15\n2.825470\n2.793934\n0.074476\n0.017469\n00:00\n\n\n16\n2.819361\n2.792650\n0.073192\n0.017139\n00:00\n\n\n17\n2.813775\n2.791878\n0.072420\n0.016957\n00:00\n\n\n18\n2.809550\n2.791618\n0.072160\n0.016895\n00:00\n\n\n19\n2.805743\n2.792055\n0.072597\n0.017010\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold1------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.223793\n3.123396\n0.368487\n0.080072\n00:00\n\n\n1\n3.109371\n2.997170\n0.242260\n0.058150\n00:00\n\n\n2\n3.033735\n3.019090\n0.264181\n0.044971\n00:00\n\n\n3\n2.987771\n3.001078\n0.246169\n0.046103\n00:00\n\n\n4\n2.961214\n2.931023\n0.176114\n0.040472\n00:00\n\n\n5\n2.945465\n3.011463\n0.256553\n0.040134\n00:00\n\n\n6\n2.926350\n2.862420\n0.107510\n0.025649\n00:00\n\n\n7\n2.906650\n2.837383\n0.082474\n0.019798\n00:00\n\n\n8\n2.888857\n2.830983\n0.076073\n0.018363\n00:00\n\n\n9\n2.874208\n2.834179\n0.079269\n0.019154\n00:00\n\n\n10\n2.861201\n2.829423\n0.074513\n0.017991\n00:00\n\n\n11\n2.849588\n2.825483\n0.070573\n0.017101\n00:00\n\n\n12\n2.839652\n2.827988\n0.073079\n0.017595\n00:00\n\n\n13\n2.830881\n2.823435\n0.068526\n0.016582\n00:00\n\n\n14\n2.823120\n2.821404\n0.066494\n0.016110\n00:00\n\n\n15\n2.816741\n2.820865\n0.065955\n0.016028\n00:00\n\n\n16\n2.810546\n2.820960\n0.066051\n0.015982\n00:00\n\n\n17\n2.805398\n2.819608\n0.064698\n0.015681\n00:00\n\n\n18\n2.801101\n2.819678\n0.064768\n0.015713\n00:00\n\n\n19\n2.797163\n2.819703\n0.064793\n0.015706\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold2------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.205939\n3.130619\n0.378235\n0.081714\n00:00\n\n\n1\n3.090387\n2.985123\n0.232739\n0.056950\n00:00\n\n\n2\n3.015869\n2.955130\n0.202746\n0.040430\n00:00\n\n\n3\n2.973886\n2.998454\n0.246071\n0.044894\n00:00\n\n\n4\n2.949371\n2.935931\n0.183547\n0.036840\n00:00\n\n\n5\n2.933519\n2.903759\n0.151375\n0.034098\n00:00\n\n\n6\n2.916420\n2.860321\n0.107937\n0.025347\n00:00\n\n\n7\n2.899531\n2.850880\n0.098496\n0.023110\n00:00\n\n\n8\n2.883238\n2.847718\n0.095335\n0.022554\n00:00\n\n\n9\n2.869618\n2.845551\n0.093167\n0.021987\n00:00\n\n\n10\n2.857811\n2.846352\n0.093968\n0.022244\n00:00\n\n\n11\n2.847661\n2.848390\n0.096006\n0.022610\n00:00\n\n\n12\n2.837994\n2.837989\n0.085605\n0.020239\n00:00\n\n\n13\n2.829376\n2.838523\n0.086140\n0.020283\n00:00\n\n\n14\n2.821541\n2.838088\n0.085704\n0.020245\n00:00\n\n\n15\n2.814889\n2.837663\n0.085279\n0.020044\n00:00\n\n\n16\n2.809013\n2.836939\n0.084556\n0.019932\n00:00\n\n\n17\n2.804235\n2.837022\n0.084638\n0.019987\n00:00\n\n\n18\n2.800163\n2.836908\n0.084524\n0.019963\n00:00\n\n\n19\n2.796664\n2.837320\n0.084936\n0.020062\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold3------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.195777\n3.128514\n0.365497\n0.079057\n00:00\n\n\n1\n3.092799\n2.992926\n0.229910\n0.056550\n00:00\n\n\n2\n3.020890\n2.947406\n0.184389\n0.036858\n00:00\n\n\n3\n2.978407\n2.962161\n0.199145\n0.039832\n00:00\n\n\n4\n2.953886\n2.903328\n0.140312\n0.033179\n00:00\n\n\n5\n2.935057\n2.900674\n0.137657\n0.032843\n00:00\n\n\n6\n2.915807\n2.865473\n0.102457\n0.024280\n00:00\n\n\n7\n2.896900\n2.858213\n0.095196\n0.022447\n-1:59:59\n\n\n8\n2.880532\n2.851980\n0.088964\n0.020906\n00:00\n\n\n9\n2.865812\n2.847365\n0.084349\n0.019993\n00:00\n\n\n10\n2.854017\n2.852216\n0.089200\n0.021138\n00:00\n\n\n11\n2.843368\n2.847860\n0.084843\n0.020181\n00:00\n\n\n12\n2.834106\n2.849026\n0.086009\n0.020298\n00:00\n\n\n13\n2.825445\n2.847659\n0.084642\n0.019993\n00:00\n\n\n14\n2.817815\n2.844594\n0.081577\n0.019337\n00:00\n\n\n15\n2.811150\n2.846112\n0.083096\n0.019709\n00:00\n\n\n16\n2.805433\n2.846061\n0.083044\n0.019748\n00:00\n\n\n17\n2.800725\n2.844932\n0.081915\n0.019495\n00:00\n\n\n18\n2.796557\n2.844240\n0.081223\n0.019321\n00:00\n\n\n19\n2.792958\n2.843945\n0.080928\n0.019248\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold4------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.215276\n3.119204\n0.369650\n0.080322\n00:00\n\n\n1\n3.105301\n3.022647\n0.273093\n0.061793\n00:00\n\n\n2\n3.028362\n3.080863\n0.331309\n0.054420\n00:00\n\n\n3\n2.985426\n3.196383\n0.446829\n0.055891\n00:00\n\n\n4\n2.960793\n3.046122\n0.296568\n0.049703\n00:00\n\n\n5\n2.939009\n3.013057\n0.263503\n0.045952\n00:00\n\n\n6\n2.919321\n2.914121\n0.164567\n0.036086\n00:00\n\n\n7\n2.903089\n2.873691\n0.124137\n0.027872\n00:00\n\n\n8\n2.885899\n2.859200\n0.109647\n0.025433\n00:00\n\n\n9\n2.871264\n2.847255\n0.097701\n0.022960\n00:00\n\n\n10\n2.858492\n2.841490\n0.091936\n0.021539\n00:00\n\n\n11\n2.847539\n2.846025\n0.096471\n0.022673\n00:00\n\n\n12\n2.838090\n2.838202\n0.088648\n0.020919\n00:00\n\n\n13\n2.829323\n2.837742\n0.088187\n0.020805\n00:00\n\n\n14\n2.821924\n2.836483\n0.086929\n0.020406\n00:00\n\n\n15\n2.815163\n2.835881\n0.086327\n0.020336\n00:00\n\n\n16\n2.809431\n2.836192\n0.086638\n0.020370\n00:00\n\n\n17\n2.804560\n2.835043\n0.085489\n0.020140\n00:00\n\n\n18\n2.800263\n2.834559\n0.085005\n0.019972\n00:00\n\n\n19\n2.796827\n2.834709\n0.085155\n0.019986\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n\noof_esm = train_dl_cv(df_esm,esm_col,target_col,\n                  splits = splits,\n                  model_func = get_cnn_esm,\n                  n_epoch=20,lr=3e-3)\n\n------fold0------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.218573\n3.130500\n0.411041\n0.085887\n00:00\n\n\n1\n3.113306\n3.063366\n0.343908\n0.072510\n00:00\n\n\n2\n3.044713\n3.128430\n0.408971\n0.062826\n00:00\n\n\n3\n3.012064\n2.918778\n0.199320\n0.044662\n00:00\n\n\n4\n2.992838\n2.883704\n0.164246\n0.038140\n00:00\n\n\n5\n2.973829\n2.886671\n0.167212\n0.033750\n00:00\n\n\n6\n2.950023\n2.871562\n0.152104\n0.033124\n00:00\n\n\n7\n2.928650\n2.842351\n0.122893\n0.028465\n00:00\n\n\n8\n2.909526\n2.846817\n0.127358\n0.028738\n00:00\n\n\n9\n2.893397\n2.839327\n0.119868\n0.027651\n00:00\n\n\n10\n2.879705\n2.830204\n0.110746\n0.024490\n00:00\n\n\n11\n2.867001\n2.815144\n0.095686\n0.022132\n00:00\n\n\n12\n2.856134\n2.815215\n0.095757\n0.021334\n00:00\n\n\n13\n2.846439\n2.817239\n0.097781\n0.021900\n00:00\n\n\n14\n2.837932\n2.804470\n0.085012\n0.019254\n00:00\n\n\n15\n2.830515\n2.802957\n0.083499\n0.018903\n00:00\n\n\n16\n2.823586\n2.798179\n0.078721\n0.017778\n00:00\n\n\n17\n2.818660\n2.797979\n0.078521\n0.017781\n00:00\n\n\n18\n2.813803\n2.799959\n0.080501\n0.018190\n00:00\n\n\n19\n2.809424\n2.804340\n0.084882\n0.019029\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold1------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.211175\n3.126740\n0.371830\n0.080277\n00:00\n\n\n1\n3.097714\n3.006917\n0.252008\n0.059454\n00:00\n\n\n2\n3.029892\n2.989221\n0.234312\n0.043331\n00:00\n\n\n3\n2.996601\n2.897515\n0.142605\n0.033353\n00:00\n\n\n4\n2.971514\n2.883874\n0.128964\n0.030243\n00:00\n\n\n5\n2.950985\n2.868078\n0.113169\n0.026240\n00:00\n\n\n6\n2.929707\n2.863897\n0.108988\n0.025840\n00:00\n\n\n7\n2.909894\n2.847964\n0.093055\n0.022102\n00:00\n\n\n8\n2.891619\n2.835438\n0.080528\n0.019342\n00:00\n\n\n9\n2.875592\n2.832419\n0.077509\n0.018515\n00:00\n\n\n10\n2.861742\n2.844769\n0.089860\n0.021164\n00:00\n\n\n11\n2.850034\n2.837570\n0.082661\n0.019627\n-1:59:59\n\n\n12\n2.840404\n2.834485\n0.079576\n0.018942\n00:00\n\n\n13\n2.831792\n2.829283\n0.074373\n0.017769\n00:00\n\n\n14\n2.823824\n2.832996\n0.078087\n0.018544\n00:00\n\n\n15\n2.817176\n2.830905\n0.075995\n0.018151\n00:00\n\n\n16\n2.811294\n2.828579\n0.073670\n0.017569\n00:00\n\n\n17\n2.805925\n2.828720\n0.073810\n0.017546\n00:00\n\n\n18\n2.802000\n2.828678\n0.073768\n0.017531\n00:00\n\n\n19\n2.798535\n2.829595\n0.074686\n0.017751\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold2------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.189650\n3.118795\n0.366411\n0.080454\n00:00\n\n\n1\n3.072933\n2.949069\n0.196684\n0.047955\n00:00\n\n\n2\n3.003989\n2.902878\n0.150494\n0.033450\n00:00\n\n\n3\n2.965584\n2.923450\n0.171066\n0.038818\n00:00\n\n\n4\n2.947126\n2.894336\n0.141952\n0.032567\n00:00\n\n\n5\n2.933414\n2.899068\n0.146684\n0.030714\n00:00\n\n\n6\n2.917402\n2.874743\n0.122359\n0.027284\n00:00\n\n\n7\n2.903033\n2.867019\n0.114635\n0.026187\n00:00\n\n\n8\n2.887363\n2.861744\n0.109360\n0.025812\n00:00\n\n\n9\n2.873385\n2.852415\n0.100031\n0.023334\n00:00\n\n\n10\n2.860936\n2.855808\n0.103425\n0.024052\n00:00\n\n\n11\n2.849715\n2.848728\n0.096344\n0.022468\n00:00\n\n\n12\n2.840556\n2.851071\n0.098687\n0.022918\n00:00\n\n\n13\n2.831758\n2.845567\n0.093183\n0.021839\n00:00\n\n\n14\n2.824259\n2.845999\n0.093615\n0.021907\n00:00\n\n\n15\n2.817586\n2.840322\n0.087939\n0.020656\n00:00\n\n\n16\n2.811570\n2.841125\n0.088741\n0.020902\n00:00\n\n\n17\n2.806726\n2.842466\n0.090083\n0.021186\n00:00\n\n\n18\n2.802485\n2.842681\n0.090297\n0.021231\n00:00\n\n\n19\n2.798630\n2.842020\n0.089636\n0.021074\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold3------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.195183\n3.118322\n0.355305\n0.077934\n00:00\n\n\n1\n3.082233\n2.968889\n0.205872\n0.049987\n00:00\n\n\n2\n3.011883\n2.904984\n0.141968\n0.033716\n00:00\n\n\n3\n2.976276\n2.899045\n0.136029\n0.031855\n00:00\n\n\n4\n2.955704\n2.873515\n0.110498\n0.026167\n00:00\n\n\n5\n2.940040\n2.871017\n0.108000\n0.025250\n00:00\n\n\n6\n2.924179\n2.870664\n0.107647\n0.025609\n00:00\n\n\n7\n2.906053\n2.868157\n0.105140\n0.024547\n00:00\n\n\n8\n2.890117\n2.877202\n0.114185\n0.026758\n00:00\n\n\n9\n2.877448\n2.862576\n0.099559\n0.023611\n00:00\n\n\n10\n2.865353\n2.870563\n0.107546\n0.025280\n00:00\n\n\n11\n2.854365\n2.874944\n0.111927\n0.025855\n00:00\n\n\n12\n2.844372\n2.848586\n0.085569\n0.020533\n00:00\n\n\n13\n2.835772\n2.843719\n0.080703\n0.019419\n00:00\n\n\n14\n2.827890\n2.840074\n0.077057\n0.018537\n00:00\n\n\n15\n2.821218\n2.842312\n0.079296\n0.019070\n00:00\n\n\n16\n2.814460\n2.843519\n0.080502\n0.019425\n00:00\n\n\n17\n2.808998\n2.843082\n0.080066\n0.019307\n00:00\n\n\n18\n2.804054\n2.842385\n0.079369\n0.019130\n00:00\n\n\n19\n2.800103\n2.842556\n0.079539\n0.019165\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold4------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.215894\n3.136908\n0.387354\n0.082165\n00:00\n\n\n1\n3.104306\n3.038435\n0.288881\n0.063788\n00:00\n\n\n2\n3.030590\n2.996898\n0.247344\n0.048807\n00:00\n\n\n3\n2.991358\n3.048996\n0.299443\n0.054110\n00:00\n\n\n4\n2.970840\n2.980138\n0.230584\n0.042031\n00:00\n\n\n5\n2.953562\n2.913853\n0.164299\n0.032929\n00:00\n\n\n6\n2.932394\n2.891885\n0.142331\n0.030453\n00:00\n\n\n7\n2.912592\n2.876103\n0.126549\n0.028662\n00:00\n\n\n8\n2.894378\n2.854946\n0.105392\n0.024091\n00:00\n\n\n9\n2.880475\n2.878469\n0.128915\n0.029187\n00:00\n\n\n10\n2.869399\n2.866315\n0.116761\n0.026870\n-1:59:59\n\n\n11\n2.858616\n2.857310\n0.107756\n0.024535\n00:00\n\n\n12\n2.848621\n2.851251\n0.101698\n0.023382\n00:00\n\n\n13\n2.839408\n2.850880\n0.101326\n0.023133\n00:00\n\n\n14\n2.831282\n2.846311\n0.096757\n0.021999\n00:00\n\n\n15\n2.823905\n2.847420\n0.097865\n0.022233\n00:00\n\n\n16\n2.817375\n2.846087\n0.096534\n0.021952\n00:00\n\n\n17\n2.811876\n2.846603\n0.097049\n0.022015\n00:00\n\n\n18\n2.807177\n2.846167\n0.096613\n0.021907\n00:00\n\n\n19\n2.803102\n2.845773\n0.096219\n0.021831\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n\noof_onehot = train_dl_cv(df_onehot,onehot_col,target_col,\n                  splits = splits,\n                  model_func = get_cnn_onehot,\n                  n_epoch=20,lr=3e-3)\n\n------fold0------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.241729\n3.129855\n0.410396\n0.085954\n00:00\n\n\n1\n3.118459\n2.949030\n0.229572\n0.057765\n00:00\n\n\n2\n3.033988\n3.190781\n0.471323\n0.088334\n00:00\n\n\n3\n2.987704\n3.219481\n0.500022\n0.092999\n00:00\n\n\n4\n2.960431\n3.010416\n0.290958\n0.060399\n00:00\n\n\n5\n2.937186\n2.858489\n0.139031\n0.032035\n00:00\n\n\n6\n2.915117\n2.825965\n0.106507\n0.024763\n00:00\n\n\n7\n2.895487\n2.815709\n0.096251\n0.022334\n00:00\n\n\n8\n2.878620\n2.811600\n0.092142\n0.021431\n00:00\n\n\n9\n2.864766\n2.806806\n0.087348\n0.020594\n00:00\n\n\n10\n2.865335\n2.823398\n0.103940\n0.024710\n00:00\n\n\n11\n2.856643\n2.865551\n0.146093\n0.034317\n00:00\n\n\n12\n2.846323\n2.844410\n0.124952\n0.029596\n00:00\n\n\n13\n2.837237\n2.846503\n0.127045\n0.030165\n00:00\n\n\n14\n2.828622\n2.844773\n0.125314\n0.029970\n00:00\n\n\n15\n2.821803\n2.845659\n0.126200\n0.030336\n00:00\n\n\n16\n2.815231\n2.854499\n0.135041\n0.032065\n00:00\n\n\n17\n2.809646\n2.853918\n0.134460\n0.031880\n00:00\n\n\n18\n2.804690\n2.863812\n0.144354\n0.033740\n00:00\n\n\n19\n2.800869\n2.862019\n0.142560\n0.033397\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold1------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.225740\n3.120343\n0.365433\n0.079265\n00:00\n\n\n1\n3.092932\n2.929717\n0.174807\n0.044543\n00:00\n\n\n2\n3.012357\n2.933971\n0.179062\n0.040116\n00:00\n\n\n3\n2.967497\n3.008852\n0.253942\n0.056422\n00:00\n\n\n4\n2.944517\n2.931387\n0.176478\n0.040202\n00:00\n\n\n5\n2.922362\n2.869078\n0.114169\n0.027175\n00:00\n\n\n6\n2.900000\n2.860790\n0.105881\n0.024987\n00:00\n\n\n7\n2.880755\n2.837488\n0.082578\n0.019853\n00:00\n\n\n8\n2.864326\n2.835598\n0.080688\n0.019286\n00:00\n\n\n9\n2.851032\n2.834610\n0.079701\n0.019193\n00:00\n\n\n10\n2.839240\n2.844608\n0.089698\n0.021751\n00:00\n\n\n11\n2.829191\n2.859667\n0.104757\n0.025480\n00:00\n\n\n12\n2.820400\n2.889618\n0.134709\n0.031713\n00:00\n\n\n13\n2.812532\n2.917234\n0.162324\n0.036734\n00:00\n\n\n14\n2.805487\n2.923786\n0.168876\n0.037859\n00:00\n\n\n15\n2.799415\n2.923557\n0.168647\n0.037845\n00:00\n\n\n16\n2.794328\n2.922689\n0.167780\n0.037635\n00:00\n\n\n17\n2.790126\n2.923844\n0.168935\n0.037836\n00:00\n\n\n18\n2.786213\n2.926367\n0.171457\n0.038297\n00:00\n\n\n19\n2.783368\n2.932413\n0.177504\n0.039521\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold2------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.218967\n3.136732\n0.384348\n0.082663\n00:00\n\n\n1\n3.093906\n2.985634\n0.233250\n0.058933\n00:00\n\n\n2\n3.011333\n2.894614\n0.142230\n0.033043\n-1:59:59\n\n\n3\n2.964075\n2.965128\n0.212744\n0.048578\n00:00\n\n\n4\n2.935478\n2.924548\n0.172164\n0.038266\n00:00\n\n\n5\n2.912812\n2.881381\n0.128998\n0.030290\n00:00\n\n\n6\n2.891613\n2.869622\n0.117238\n0.027099\n00:00\n\n\n7\n2.873108\n2.853028\n0.100644\n0.023654\n00:00\n\n\n8\n2.857590\n2.854012\n0.101628\n0.023780\n00:00\n\n\n9\n2.844302\n2.851610\n0.099226\n0.023698\n00:00\n\n\n10\n2.833019\n2.861218\n0.108834\n0.026176\n00:00\n\n\n11\n2.823390\n2.882062\n0.129678\n0.031256\n00:00\n\n\n12\n2.815375\n2.889038\n0.136654\n0.032736\n00:00\n\n\n13\n2.808285\n2.902188\n0.149804\n0.035950\n00:00\n\n\n14\n2.802253\n2.903341\n0.150957\n0.036045\n00:00\n\n\n15\n2.796853\n2.907264\n0.154880\n0.036983\n00:00\n\n\n16\n2.792192\n2.902311\n0.149927\n0.035911\n00:00\n\n\n17\n2.788202\n2.903109\n0.150725\n0.036129\n00:00\n\n\n18\n2.784824\n2.899214\n0.146830\n0.035210\n00:00\n\n\n19\n2.782123\n2.900155\n0.147771\n0.035431\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold3------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.213708\n3.135517\n0.372500\n0.080080\n00:00\n\n\n1\n3.082177\n2.988177\n0.225160\n0.056223\n00:00\n\n\n2\n3.008039\n2.911906\n0.148889\n0.033736\n00:00\n\n\n3\n2.966871\n2.987444\n0.224428\n0.049782\n00:00\n\n\n4\n2.939433\n2.915975\n0.152958\n0.035874\n00:00\n\n\n5\n2.916206\n2.878711\n0.115695\n0.027269\n00:00\n\n\n6\n2.895659\n2.865530\n0.102513\n0.024003\n00:00\n\n\n7\n2.876751\n2.852249\n0.089232\n0.021229\n00:00\n\n\n8\n2.861058\n2.847203\n0.084186\n0.019942\n00:00\n\n\n9\n2.847239\n2.851352\n0.088336\n0.021081\n00:00\n\n\n10\n2.835290\n2.867659\n0.104643\n0.025002\n00:00\n\n\n11\n2.824708\n2.896570\n0.133553\n0.031582\n00:00\n\n\n12\n2.815918\n2.988853\n0.225836\n0.051229\n00:00\n\n\n13\n2.808455\n2.996560\n0.233543\n0.053215\n00:00\n\n\n14\n2.801627\n3.011542\n0.248525\n0.055930\n00:00\n\n\n15\n2.796005\n3.014872\n0.251855\n0.055839\n00:00\n\n\n16\n2.791337\n3.019489\n0.256472\n0.056878\n00:00\n\n\n17\n2.787318\n3.022802\n0.259785\n0.057687\n00:00\n\n\n18\n2.783826\n3.014363\n0.251346\n0.056254\n00:00\n\n\n19\n2.780691\n2.995501\n0.232485\n0.052495\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold4------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.221471\n3.127624\n0.378070\n0.081323\n00:00\n\n\n1\n3.095710\n2.945078\n0.195524\n0.050102\n00:00\n\n\n2\n3.017401\n3.028205\n0.278651\n0.058818\n00:00\n\n\n3\n2.970227\n3.120655\n0.371100\n0.075140\n00:00\n\n\n4\n2.941291\n2.943682\n0.194128\n0.043123\n00:00\n\n\n5\n2.918821\n2.882842\n0.133289\n0.030490\n00:00\n\n\n6\n2.899817\n2.868371\n0.118817\n0.027515\n00:00\n\n\n7\n2.882284\n2.851362\n0.101808\n0.023707\n00:00\n\n\n8\n2.866183\n2.837627\n0.088073\n0.020545\n00:00\n\n\n9\n2.852493\n2.839459\n0.089905\n0.021024\n00:00\n\n\n10\n2.841285\n2.850833\n0.101280\n0.024133\n00:00\n\n\n11\n2.830965\n2.872638\n0.123084\n0.029573\n00:00\n\n\n12\n2.822024\n2.901451\n0.151897\n0.036424\n00:00\n\n\n13\n2.814215\n2.933485\n0.183931\n0.042047\n00:00\n\n\n14\n2.807524\n2.958659\n0.209105\n0.045336\n00:00\n\n\n15\n2.801464\n2.967607\n0.218053\n0.045995\n00:00\n\n\n16\n2.796345\n2.964210\n0.214656\n0.045273\n00:00\n\n\n17\n2.791933\n2.971480\n0.221927\n0.044817\n00:00\n\n\n18\n2.788266\n2.966847\n0.217293\n0.044949\n-1:59:59\n\n\n19\n2.785469\n2.979415\n0.229862\n0.045319\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n\noof_onehot_pca = train_dl_cv(df_onehot_pca,onehot_pca_col,target_col,\n                  splits = splits,\n                  model_func = get_cnn_onehot_pca,\n                  n_epoch=20,lr=3e-3)\n\n------fold0------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.302440\n3.130807\n0.411349\n0.086566\n00:00\n\n\n1\n3.258555\n3.101584\n0.382126\n0.083854\n00:00\n\n\n2\n3.196990\n3.068951\n0.349493\n0.082148\n00:00\n\n\n3\n3.125379\n3.158087\n0.438629\n0.068792\n00:00\n\n\n4\n3.080759\n3.176002\n0.456544\n0.077207\n00:00\n\n\n5\n3.050390\n3.093245\n0.373786\n0.066183\n00:00\n\n\n6\n3.017987\n3.061568\n0.342110\n0.061022\n00:00\n\n\n7\n2.991386\n3.028012\n0.308554\n0.056661\n00:00\n\n\n8\n2.964049\n3.037252\n0.317794\n0.056610\n00:00\n\n\n9\n2.938226\n3.053089\n0.333631\n0.054992\n00:00\n\n\n10\n2.915097\n3.048690\n0.329231\n0.054219\n00:00\n\n\n11\n2.895682\n3.044618\n0.325159\n0.054037\n00:00\n\n\n12\n2.878375\n3.060385\n0.340927\n0.054751\n00:00\n\n\n13\n2.864154\n3.070291\n0.350833\n0.056314\n00:00\n\n\n14\n2.851747\n3.085761\n0.366303\n0.056557\n00:00\n\n\n15\n2.840938\n3.102062\n0.382604\n0.056397\n00:00\n\n\n16\n2.832283\n3.087585\n0.368127\n0.056023\n00:00\n\n\n17\n2.824592\n3.096884\n0.377425\n0.056253\n00:00\n\n\n18\n2.818097\n3.101140\n0.381682\n0.056162\n00:00\n\n\n19\n2.812865\n3.097883\n0.378425\n0.056126\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold1------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.298354\n3.127964\n0.373055\n0.080283\n00:00\n\n\n1\n3.247030\n3.087290\n0.332380\n0.074519\n00:00\n\n\n2\n3.169113\n3.031182\n0.276272\n0.063327\n00:00\n\n\n3\n3.094595\n3.071009\n0.316100\n0.054053\n00:00\n\n\n4\n3.048136\n3.109707\n0.354797\n0.058029\n00:00\n\n\n5\n3.015306\n3.053497\n0.298587\n0.050945\n00:00\n\n\n6\n2.986099\n2.997001\n0.242091\n0.045967\n00:00\n\n\n7\n2.957597\n3.006883\n0.251973\n0.043309\n00:00\n\n\n8\n2.931612\n2.995919\n0.241009\n0.042291\n00:00\n\n\n9\n2.908235\n2.980366\n0.225457\n0.039946\n00:00\n\n\n10\n2.888220\n2.985113\n0.230204\n0.039824\n00:00\n\n\n11\n2.871639\n2.990987\n0.236077\n0.040318\n00:00\n\n\n12\n2.856382\n2.995271\n0.240361\n0.042191\n00:00\n\n\n13\n2.843849\n2.994337\n0.239427\n0.040818\n00:00\n\n\n14\n2.833019\n2.995513\n0.240604\n0.040078\n00:00\n\n\n15\n2.823323\n3.001781\n0.246871\n0.039956\n00:00\n\n\n16\n2.815298\n3.001314\n0.246405\n0.040305\n00:00\n\n\n17\n2.808631\n3.002243\n0.247333\n0.040168\n00:00\n\n\n18\n2.803132\n2.998774\n0.243864\n0.040040\n00:00\n\n\n19\n2.798175\n2.994358\n0.239448\n0.040091\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold2------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.295080\n3.126930\n0.374546\n0.081449\n00:00\n\n\n1\n3.249624\n3.091933\n0.339549\n0.076986\n00:00\n\n\n2\n3.182515\n2.991126\n0.238742\n0.057952\n00:00\n\n\n3\n3.101832\n3.075372\n0.322987\n0.061918\n00:00\n\n\n4\n3.048044\n2.938845\n0.186461\n0.039768\n-1:59:59\n\n\n5\n3.006992\n3.011719\n0.259335\n0.053039\n00:00\n\n\n6\n2.981125\n2.945875\n0.193491\n0.042032\n00:00\n\n\n7\n2.959295\n2.916867\n0.164483\n0.037105\n00:00\n\n\n8\n2.933144\n2.903755\n0.151371\n0.034518\n00:00\n\n\n9\n2.909949\n2.905956\n0.153572\n0.034873\n00:00\n\n\n10\n2.889870\n2.902935\n0.150551\n0.032707\n00:00\n\n\n11\n2.872226\n2.900230\n0.147846\n0.032321\n00:00\n\n\n12\n2.857007\n2.898504\n0.146120\n0.031974\n00:00\n\n\n13\n2.844069\n2.895706\n0.143322\n0.031052\n00:00\n\n\n14\n2.833025\n2.895215\n0.142831\n0.030986\n00:00\n\n\n15\n2.823420\n2.898483\n0.146099\n0.032434\n00:00\n\n\n16\n2.815266\n2.897087\n0.144703\n0.032159\n00:00\n\n\n17\n2.808564\n2.899021\n0.146637\n0.032996\n00:00\n\n\n18\n2.802753\n2.897997\n0.145613\n0.032420\n00:00\n\n\n19\n2.798148\n2.898978\n0.146594\n0.032950\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold3------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.293581\n3.119297\n0.356281\n0.078183\n00:00\n\n\n1\n3.248300\n3.077060\n0.314044\n0.072615\n00:00\n\n\n2\n3.173673\n2.981124\n0.218107\n0.052698\n00:00\n\n\n3\n3.098941\n3.123670\n0.360653\n0.068389\n00:00\n\n\n4\n3.045402\n3.049009\n0.285992\n0.048215\n00:00\n\n\n5\n3.002400\n2.988642\n0.225625\n0.040536\n00:00\n\n\n6\n2.968429\n2.965917\n0.202901\n0.038006\n00:00\n\n\n7\n2.938216\n2.946674\n0.183658\n0.037474\n00:00\n\n\n8\n2.912993\n2.939785\n0.176768\n0.034624\n00:00\n\n\n9\n2.892099\n2.941057\n0.178041\n0.032950\n00:00\n\n\n10\n2.873873\n2.945688\n0.182671\n0.034669\n00:00\n\n\n11\n2.858302\n2.944762\n0.181746\n0.035534\n00:00\n\n\n12\n2.845130\n2.942033\n0.179016\n0.034631\n00:00\n\n\n13\n2.833590\n2.942556\n0.179540\n0.034126\n00:00\n\n\n14\n2.823955\n2.941175\n0.178158\n0.033951\n00:00\n\n\n15\n2.815761\n2.937775\n0.174758\n0.034204\n00:00\n\n\n16\n2.808282\n2.935336\n0.172319\n0.033550\n00:00\n\n\n17\n2.801749\n2.935470\n0.172453\n0.033193\n00:00\n\n\n18\n2.797108\n2.935189\n0.172173\n0.033423\n00:00\n\n\n19\n2.792621\n2.937222\n0.174205\n0.033567\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold4------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.293233\n3.128303\n0.378749\n0.081393\n00:00\n\n\n1\n3.246272\n3.100235\n0.350681\n0.078923\n00:00\n\n\n2\n3.178545\n3.058215\n0.308661\n0.072782\n00:00\n\n\n3\n3.108605\n3.107502\n0.357948\n0.070461\n00:00\n\n\n4\n3.062140\n3.080914\n0.331360\n0.057099\n00:00\n\n\n5\n3.025861\n3.006822\n0.257267\n0.049742\n00:00\n\n\n6\n2.992774\n3.009558\n0.260004\n0.047551\n00:00\n\n\n7\n2.959965\n2.975889\n0.226335\n0.046804\n00:00\n\n\n8\n2.932391\n2.991217\n0.241663\n0.043936\n00:00\n\n\n9\n2.909734\n2.957846\n0.208292\n0.042982\n00:00\n\n\n10\n2.888991\n2.960818\n0.211264\n0.042051\n00:00\n\n\n11\n2.871214\n2.967185\n0.217631\n0.041836\n00:00\n\n\n12\n2.856800\n2.963915\n0.214361\n0.040480\n00:00\n\n\n13\n2.844832\n2.964497\n0.214943\n0.040377\n00:00\n\n\n14\n2.833627\n2.967331\n0.217777\n0.040385\n00:00\n\n\n15\n2.824268\n2.961550\n0.211997\n0.040102\n00:00\n\n\n16\n2.816160\n2.961649\n0.212095\n0.040024\n00:00\n\n\n17\n2.809274\n2.973128\n0.223574\n0.040583\n00:00\n\n\n18\n2.803682\n2.963612\n0.214058\n0.039905\n00:00\n\n\n19\n2.798880\n2.968170\n0.218616\n0.040145\n00:00",
    "crumbs": [
      "kinase_domain",
      "DL training: Feature comparison on CNN model"
    ]
  },
  {
    "objectID": "kinase_domain/kd_06b_pspa_training_feature_comparison_cnn_subfamily.html#score",
    "href": "kinase_domain/kd_06b_pspa_training_feature_comparison_cnn_subfamily.html#score",
    "title": "DL training: Feature comparison on CNN model",
    "section": "Score",
    "text": "Score\n\nfrom katlas.pssm import *\n\nfrom functools import partial\n\n\ndef score_df(target,pred,func):\n    distance = [func(target.loc[i],pred.loc[i,target.columns]) for i in target.index]\n    return pd.Series(distance,index=target.index)\n\n\njsd_df = partial(score_df,func=js_divergence_flat)\njss_df = partial(score_df,func=js_similarity_flat)\n\nkld_df = partial(score_df,func=kl_divergence_flat)\n\n\ntarget=df_t5[target_col].copy()\n\n\n(oof_t5.nfold == oof_esm.nfold).value_counts()\n\nnfold\nTrue    368\nName: count, dtype: int64\n\n\n\npspa_info['split'] = oof_t5.nfold\n\n\npspa_info['t5'] =jsd_df(target,oof_t5)\npspa_info['esm'] =jsd_df(target,oof_esm)\npspa_info['onehot'] =jsd_df(target,oof_onehot)\npspa_info['onehot_pca'] =jsd_df(target,oof_onehot_pca)\n\n\nimport pandas as pd\n\nfrom katlas.plot import *\nfrom matplotlib import pyplot as plt\n\n\nset_sns()\n\n\npspa_info.to_parquet('raw/CNN_feature_compare_subfamily.parquet')\n\n\npspa_info=pd.read_parquet('raw/CNN_feature_compare_subfamily.parquet')\n\n\npspa_info = pspa_info.rename(columns={'t5':'T5(n=1,024)','esm':'ESM2(n=1,280)','onehot':'OneHot(n=6,849)','onehot_pca':'OneHot+PCA(n=1,000)'})\n\ncols=['OneHot(n=6,849)',\n      'OneHot+PCA(n=1,000)',\n      'ESM2(n=1,280)',\n      'T5(n=1,024)']\n\n\nplot_group_bar(pspa_info,cols,group='group')\nplt.ylabel('JS divergence')\nsave_svg('fig/CNN_feature_comparison_subfamily.svg')\n\n\n\n\n\n\n\n\n\nFor JS similarity (less differentiated)\n\npspa_info['t5'] =jss_df(target,oof_t5)\npspa_info['esm'] =jss_df(target,oof_esm)\npspa_info['onehot'] =jss_df(target,oof_onehot)\npspa_info['onehot_pca'] =jss_df(target,oof_onehot_pca)\n\n\nplot_group_bar(pspa_info,['t5','esm','onehot','onehot_pca'],group='group')\nplt.ylabel('JS divergence')\n\nText(0, 0.5, 'JS divergence')",
    "crumbs": [
      "kinase_domain",
      "DL training: Feature comparison on CNN model"
    ]
  },
  {
    "objectID": "kinase_domain/kd_06c_pspa_training_feature_comparison_mlp.html",
    "href": "kinase_domain/kd_06c_pspa_training_feature_comparison_mlp.html",
    "title": "DL training: Feature comparison on MLP model",
    "section": "",
    "text": "import numpy as np, pandas as pd\nimport os, random\nfrom katlas.data import *\nfrom katlas.train import *\nfrom fastai.vision.all import *\nfrom katlas.dnn import *\n\n\nseed_everything()\n\n\ndef_device\n\n'cuda'",
    "crumbs": [
      "kinase_domain",
      "DL training: Feature comparison on MLP model"
    ]
  },
  {
    "objectID": "kinase_domain/kd_06c_pspa_training_feature_comparison_mlp.html#setup",
    "href": "kinase_domain/kd_06c_pspa_training_feature_comparison_mlp.html#setup",
    "title": "DL training: Feature comparison on MLP model",
    "section": "",
    "text": "import numpy as np, pandas as pd\nimport os, random\nfrom katlas.data import *\nfrom katlas.train import *\nfrom fastai.vision.all import *\nfrom katlas.dnn import *\n\n\nseed_everything()\n\n\ndef_device\n\n'cuda'",
    "crumbs": [
      "kinase_domain",
      "DL training: Feature comparison on MLP model"
    ]
  },
  {
    "objectID": "kinase_domain/kd_06c_pspa_training_feature_comparison_mlp.html#data",
    "href": "kinase_domain/kd_06c_pspa_training_feature_comparison_mlp.html#data",
    "title": "DL training: Feature comparison on MLP model",
    "section": "Data",
    "text": "Data\n\ndf_t5=pd.read_parquet('train/pspa_t5.parquet').reset_index()\ndf_esm=pd.read_parquet('train/pspa_esm.parquet').reset_index()\ndf_onehot = pd.read_parquet('train/pspa_onehot.parquet').reset_index()\ndf_onehot_pca = pd.read_parquet('train/pspa_onehot_pca.parquet').reset_index()\n\n\n(df_onehot['index'] == df_esm['index']).value_counts()\n\nindex\nTrue    368\nName: count, dtype: int64\n\n\n\n(df_t5['index'] == df_esm['index']).value_counts()\n\nindex\nTrue    368\nName: count, dtype: int64\n\n\n\nt5_col = df_t5.columns[df_t5.columns.str.startswith('T5_')]\n\n\nt5_col\n\nIndex(['T5_0', 'T5_1', 'T5_2', 'T5_3', 'T5_4', 'T5_5', 'T5_6', 'T5_7', 'T5_8',\n       'T5_9',\n       ...\n       'T5_1014', 'T5_1015', 'T5_1016', 'T5_1017', 'T5_1018', 'T5_1019',\n       'T5_1020', 'T5_1021', 'T5_1022', 'T5_1023'],\n      dtype='object', length=1024)\n\n\n\nesm_col = df_esm.columns[df_esm.columns.str.startswith('esm_')]\n\n\nesm_col\n\nIndex(['esm_0', 'esm_1', 'esm_2', 'esm_3', 'esm_4', 'esm_5', 'esm_6', 'esm_7',\n       'esm_8', 'esm_9',\n       ...\n       'esm_1270', 'esm_1271', 'esm_1272', 'esm_1273', 'esm_1274', 'esm_1275',\n       'esm_1276', 'esm_1277', 'esm_1278', 'esm_1279'],\n      dtype='object', length=1280)\n\n\n\ntarget_col = df_t5.columns[~df_t5.columns.isin(t5_col)][1:]\n\n\ntarget_col\n\nIndex(['-5P', '-4P', '-3P', '-2P', '-1P', '0P', '1P', '2P', '3P', '4P',\n       ...\n       '-5pY', '-4pY', '-3pY', '-2pY', '-1pY', '0pY', '1pY', '2pY', '3pY',\n       '4pY'],\n      dtype='object', length=230)\n\n\n\nonehot_col = df_onehot.columns[~df_onehot.columns.isin(target_col)][1:]\n\n\nonehot_col\n\nIndex(['65_-', '65_A', '65_C', '65_D', '65_E', '65_F', '65_G', '65_H', '65_I',\n       '65_K',\n       ...\n       '3192_M', '3192_N', '3192_P', '3192_Q', '3192_R', '3192_S', '3192_T',\n       '3192_V', '3192_W', '3192_Y'],\n      dtype='object', length=6849)\n\n\n\nonehot_pca_col = df_onehot_pca.columns[df_onehot_pca.columns.str.startswith('PCA')]\n\n\nonehot_pca_col\n\nIndex(['PCA1', 'PCA2', 'PCA3', 'PCA4', 'PCA5', 'PCA6', 'PCA7', 'PCA8', 'PCA9',\n       'PCA10',\n       ...\n       'PCA991', 'PCA992', 'PCA993', 'PCA994', 'PCA995', 'PCA996', 'PCA997',\n       'PCA998', 'PCA999', 'PCA1000'],\n      dtype='object', length=1000)\n\n\n\ninfo=Data.get_kinase_info()\n\ninfo = info[info.pseudo=='0']\n\ninfo = info[info.kd_ID.notna()]\n\nsubfamily_map = info[['kd_ID','subfamily']].drop_duplicates().set_index('kd_ID')['subfamily']\nfamily_map = info[['kd_ID','family']].drop_duplicates().set_index('kd_ID')['family']\ngroup_map = info[['kd_ID','group']].drop_duplicates().set_index('kd_ID')['group']\n\npspa_info = pd.DataFrame(df_t5['index'].tolist(),columns=['kinase'])\n\npspa_info['subfamily'] = pspa_info.kinase.map(subfamily_map)\npspa_info['family'] = pspa_info.kinase.map(family_map)\npspa_info['group'] = pspa_info.kinase.map(group_map)",
    "crumbs": [
      "kinase_domain",
      "DL training: Feature comparison on MLP model"
    ]
  },
  {
    "objectID": "kinase_domain/kd_06c_pspa_training_feature_comparison_mlp.html#split",
    "href": "kinase_domain/kd_06c_pspa_training_feature_comparison_mlp.html#split",
    "title": "DL training: Feature comparison on MLP model",
    "section": "Split",
    "text": "Split\n\nsplits = get_splits(pspa_info, group='subfamily',nfold=5)\n\nsplit0 = splits[0]\n\nGroupKFold(n_splits=5, random_state=None, shuffle=False)\n# subfamily in train set: 120\n# subfamily in test set: 29",
    "crumbs": [
      "kinase_domain",
      "DL training: Feature comparison on MLP model"
    ]
  },
  {
    "objectID": "kinase_domain/kd_06c_pspa_training_feature_comparison_mlp.html#dataset",
    "href": "kinase_domain/kd_06c_pspa_training_feature_comparison_mlp.html#dataset",
    "title": "DL training: Feature comparison on MLP model",
    "section": "Dataset",
    "text": "Dataset\n\n# dataset\nds_t5 = GeneralDataset(df_t5,t5_col,target_col)\nds_esm = GeneralDataset(df_esm,esm_col,target_col)\nds_onehot = GeneralDataset(df_onehot,onehot_col,target_col)\nds_onehot_pca = GeneralDataset(df_onehot_pca,onehot_pca_col,target_col)\n\n\nlen(ds_t5)\n\n368\n\n\n\ndl_t5 = DataLoader(ds_t5, batch_size=64, shuffle=True)\ndl_esm = DataLoader(ds_esm, batch_size=64, shuffle=True)\ndl_onehot = DataLoader(ds_onehot, batch_size=64, shuffle=True)\ndl_onehot_pca = DataLoader(ds_onehot_pca, batch_size=64, shuffle=True)\n\n\nxb,yb = next(iter(dl_t5))\n\nxb.shape,yb.shape\n\n(torch.Size([64, 1024]), torch.Size([64, 23, 10]))",
    "crumbs": [
      "kinase_domain",
      "DL training: Feature comparison on MLP model"
    ]
  },
  {
    "objectID": "kinase_domain/kd_06c_pspa_training_feature_comparison_mlp.html#model",
    "href": "kinase_domain/kd_06c_pspa_training_feature_comparison_mlp.html#model",
    "title": "DL training: Feature comparison on MLP model",
    "section": "Model",
    "text": "Model\n\nn_t5 = len(t5_col)\nn_esm = len(esm_col)\nn_onehot = len(onehot_col)\nn_onehot_pca = len(onehot_pca_col)\nn_target = len(target_col)\n\n\nn_t5,n_esm,n_onehot,n_onehot_pca\n\n(1024, 1280, 6849, 1000)\n\n\n\n# def get_cnn(): return PSSM_model(n_feature,n_target,model='CNN')\n\ndef get_mlp_t5(): return PSSM_model(n_t5,n_target,model='MLP')\ndef get_mlp_esm(): return PSSM_model(n_esm,n_target,model='MLP')\ndef get_mlp_onehot(): return PSSM_model(n_onehot,n_target,model='MLP')\ndef get_mlp_onehot_pca(): return PSSM_model(n_onehot_pca,n_target,model='MLP')\n\n\nmodel = get_mlp_t5()\n\n\nlogits= model(xb)\n\n\nlogits.shape\n\ntorch.Size([64, 23, 10])",
    "crumbs": [
      "kinase_domain",
      "DL training: Feature comparison on MLP model"
    ]
  },
  {
    "objectID": "kinase_domain/kd_06c_pspa_training_feature_comparison_mlp.html#loss",
    "href": "kinase_domain/kd_06c_pspa_training_feature_comparison_mlp.html#loss",
    "title": "DL training: Feature comparison on MLP model",
    "section": "Loss",
    "text": "Loss\n\nCE(logits,yb)\n\ntensor(3.2301, grad_fn=&lt;MeanBackward0&gt;)",
    "crumbs": [
      "kinase_domain",
      "DL training: Feature comparison on MLP model"
    ]
  },
  {
    "objectID": "kinase_domain/kd_06c_pspa_training_feature_comparison_mlp.html#metrics",
    "href": "kinase_domain/kd_06c_pspa_training_feature_comparison_mlp.html#metrics",
    "title": "DL training: Feature comparison on MLP model",
    "section": "Metrics",
    "text": "Metrics\n\nKLD(logits,yb)\n\ntensor(0.4888, grad_fn=&lt;MeanBackward0&gt;)\n\n\n\nJSD(logits,yb)\n\ntensor(0.1021, grad_fn=&lt;MeanBackward0&gt;)",
    "crumbs": [
      "kinase_domain",
      "DL training: Feature comparison on MLP model"
    ]
  },
  {
    "objectID": "kinase_domain/kd_06c_pspa_training_feature_comparison_mlp.html#cv-train",
    "href": "kinase_domain/kd_06c_pspa_training_feature_comparison_mlp.html#cv-train",
    "title": "DL training: Feature comparison on MLP model",
    "section": "CV train",
    "text": "CV train\n\ncross-validation\n\n\noof_t5 = train_dl_cv(df_t5,t5_col,target_col,\n                  splits = splits,\n                  model_func = get_mlp_t5,\n                  n_epoch=20,lr=3e-3)\n\n------fold0------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.148606\n3.121804\n0.402347\n0.085257\n00:00\n\n\n1\n3.072263\n3.087032\n0.367574\n0.081199\n00:00\n\n\n2\n3.009716\n3.024146\n0.304688\n0.072146\n00:00\n\n\n3\n2.956377\n2.943933\n0.224475\n0.056424\n00:00\n\n\n4\n2.916552\n2.875516\n0.156058\n0.040018\n00:00\n\n\n5\n2.888994\n2.847860\n0.128402\n0.031854\n00:00\n\n\n6\n2.868063\n2.812665\n0.093207\n0.022109\n00:00\n\n\n7\n2.851901\n2.805371\n0.085913\n0.020331\n00:00\n\n\n8\n2.839283\n2.805355\n0.085897\n0.020335\n00:00\n\n\n9\n2.829078\n2.798256\n0.078798\n0.018366\n00:00\n\n\n10\n2.821064\n2.804793\n0.085335\n0.019795\n00:00\n\n\n11\n2.814147\n2.798561\n0.079103\n0.018454\n00:00\n\n\n12\n2.808187\n2.798406\n0.078948\n0.018366\n00:00\n\n\n13\n2.802989\n2.801632\n0.082174\n0.019130\n00:00\n\n\n14\n2.798415\n2.798108\n0.078650\n0.018254\n00:00\n\n\n15\n2.794516\n2.796008\n0.076550\n0.017756\n00:00\n\n\n16\n2.791063\n2.795204\n0.075746\n0.017629\n00:00\n\n\n17\n2.787868\n2.795507\n0.076049\n0.017736\n-1:59:59\n\n\n18\n2.785587\n2.795144\n0.075686\n0.017636\n00:00\n\n\n19\n2.783626\n2.795208\n0.075750\n0.017641\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold1------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.138617\n3.128191\n0.373281\n0.080388\n00:00\n\n\n1\n3.052587\n3.099994\n0.345084\n0.076962\n00:00\n\n\n2\n2.987546\n3.036049\n0.281140\n0.067385\n00:00\n\n\n3\n2.936046\n2.949912\n0.195002\n0.050177\n00:00\n\n\n4\n2.899863\n2.884509\n0.129600\n0.033173\n00:00\n\n\n5\n2.874496\n2.846201\n0.091292\n0.022750\n00:00\n\n\n6\n2.855753\n2.834026\n0.079116\n0.019371\n00:00\n\n\n7\n2.840722\n2.826782\n0.071872\n0.017719\n00:00\n\n\n8\n2.828521\n2.834439\n0.079530\n0.019417\n00:00\n\n\n9\n2.819003\n2.826963\n0.072054\n0.017538\n00:00\n\n\n10\n2.810733\n2.823351\n0.068442\n0.016784\n00:00\n\n\n11\n2.803984\n2.826729\n0.071820\n0.017377\n00:00\n\n\n12\n2.798471\n2.822295\n0.067386\n0.016392\n00:00\n\n\n13\n2.793528\n2.823175\n0.068266\n0.016555\n00:00\n\n\n14\n2.789041\n2.821938\n0.067028\n0.016247\n00:00\n\n\n15\n2.785495\n2.819557\n0.064648\n0.015734\n00:00\n\n\n16\n2.782051\n2.820376\n0.065467\n0.015946\n00:00\n\n\n17\n2.779409\n2.819542\n0.064633\n0.015715\n00:00\n\n\n18\n2.776891\n2.820054\n0.065144\n0.015840\n00:00\n\n\n19\n2.774755\n2.820162\n0.065253\n0.015864\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold2------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.132746\n3.129335\n0.376952\n0.081733\n00:00\n\n\n1\n3.044635\n3.098221\n0.345837\n0.077880\n00:00\n\n\n2\n2.977475\n3.029599\n0.277215\n0.067289\n00:00\n\n\n3\n2.928447\n2.946265\n0.193881\n0.049801\n00:00\n\n\n4\n2.894571\n2.878941\n0.126558\n0.031526\n00:00\n\n\n5\n2.870487\n2.854545\n0.102161\n0.024659\n00:00\n\n\n6\n2.851943\n2.844638\n0.092254\n0.021932\n00:00\n\n\n7\n2.837645\n2.839031\n0.086647\n0.020559\n00:00\n\n\n8\n2.826392\n2.835832\n0.083448\n0.019848\n00:00\n\n\n9\n2.817550\n2.839705\n0.087322\n0.020473\n00:00\n\n\n10\n2.810197\n2.840906\n0.088522\n0.021065\n00:00\n\n\n11\n2.804141\n2.835611\n0.083227\n0.019450\n00:00\n\n\n12\n2.798564\n2.835332\n0.082948\n0.019531\n00:00\n\n\n13\n2.793507\n2.836511\n0.084127\n0.019697\n00:00\n\n\n14\n2.789054\n2.836247\n0.083863\n0.019667\n00:00\n\n\n15\n2.785331\n2.834682\n0.082298\n0.019266\n00:00\n\n\n16\n2.782074\n2.837207\n0.084823\n0.019836\n00:00\n\n\n17\n2.779473\n2.836932\n0.084548\n0.019785\n00:00\n\n\n18\n2.777340\n2.836301\n0.083917\n0.019662\n00:00\n\n\n19\n2.775474\n2.836297\n0.083913\n0.019675\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold3------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.133904\n3.137529\n0.374512\n0.080143\n00:00\n\n\n1\n3.051439\n3.116435\n0.353418\n0.077698\n00:00\n\n\n2\n2.983982\n3.059940\n0.296923\n0.069758\n00:00\n\n\n3\n2.933919\n2.971472\n0.208456\n0.052888\n00:00\n\n\n4\n2.897793\n2.900559\n0.137543\n0.035083\n00:00\n\n\n5\n2.873204\n2.871643\n0.108627\n0.026768\n00:00\n\n\n6\n2.854192\n2.859234\n0.096217\n0.023959\n00:00\n\n\n7\n2.838984\n2.853621\n0.090605\n0.021992\n00:00\n\n\n8\n2.827404\n2.853444\n0.090427\n0.021758\n00:00\n\n\n9\n2.817780\n2.850291\n0.087274\n0.021522\n00:00\n\n\n10\n2.809961\n2.848032\n0.085015\n0.020275\n00:00\n\n\n11\n2.803262\n2.850563\n0.087546\n0.021736\n00:00\n\n\n12\n2.797405\n2.849761\n0.086744\n0.020918\n00:00\n\n\n13\n2.792234\n2.845738\n0.082722\n0.019952\n00:00\n\n\n14\n2.787778\n2.846671\n0.083654\n0.020148\n00:00\n\n\n15\n2.783718\n2.847657\n0.084641\n0.020426\n00:00\n\n\n16\n2.780527\n2.846283\n0.083267\n0.020192\n00:00\n\n\n17\n2.777715\n2.846755\n0.083738\n0.020268\n00:00\n\n\n18\n2.775372\n2.846951\n0.083934\n0.020351\n00:00\n\n\n19\n2.773362\n2.846569\n0.083552\n0.020249\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold4------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.125827\n3.126822\n0.377269\n0.081392\n00:00\n\n\n1\n3.043140\n3.096131\n0.346577\n0.077685\n00:00\n\n\n2\n2.979392\n3.034656\n0.285102\n0.068493\n00:00\n\n\n3\n2.931132\n2.957115\n0.207562\n0.052795\n00:00\n\n\n4\n2.896671\n2.893782\n0.144228\n0.036598\n00:00\n\n\n5\n2.872172\n2.861912\n0.112359\n0.027619\n00:00\n\n\n6\n2.854473\n2.847451\n0.097898\n0.023141\n00:00\n\n\n7\n2.840559\n2.843453\n0.093899\n0.022363\n00:00\n\n\n8\n2.829472\n2.845010\n0.095456\n0.022714\n00:00\n\n\n9\n2.820066\n2.836954\n0.087400\n0.020894\n00:00\n\n\n10\n2.812284\n2.835765\n0.086211\n0.020910\n00:00\n\n\n11\n2.805969\n2.840066\n0.090512\n0.021520\n00:00\n\n\n12\n2.800283\n2.836174\n0.086620\n0.020442\n00:00\n\n\n13\n2.795211\n2.834489\n0.084936\n0.020178\n00:00\n\n\n14\n2.790876\n2.834798\n0.085245\n0.020084\n00:00\n\n\n15\n2.786967\n2.835122\n0.085568\n0.020155\n00:00\n\n\n16\n2.783756\n2.831621\n0.082068\n0.019498\n-1:59:59\n\n\n17\n2.781121\n2.831618\n0.082064\n0.019431\n00:00\n\n\n18\n2.778701\n2.832057\n0.082503\n0.019483\n00:00\n\n\n19\n2.776771\n2.832255\n0.082701\n0.019531\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n\noof_esm = train_dl_cv(df_esm,esm_col,target_col,\n                  splits = splits,\n                  model_func = get_mlp_esm,\n                  n_epoch=20,lr=3e-3)\n\n------fold0------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.170443\n3.128315\n0.408857\n0.086049\n00:00\n\n\n1\n3.091747\n3.074181\n0.354723\n0.079727\n00:00\n\n\n2\n3.024167\n2.957788\n0.238329\n0.059704\n00:00\n\n\n3\n2.968613\n2.866479\n0.147021\n0.037654\n00:00\n\n\n4\n2.926947\n2.807119\n0.087661\n0.020968\n00:00\n\n\n5\n2.896099\n2.801955\n0.082497\n0.019621\n00:00\n\n\n6\n2.873465\n2.799124\n0.079666\n0.018746\n00:00\n\n\n7\n2.856784\n2.796772\n0.077314\n0.018224\n00:00\n\n\n8\n2.843669\n2.794605\n0.075147\n0.017636\n00:00\n\n\n9\n2.833229\n2.799318\n0.079859\n0.018553\n00:00\n\n\n10\n2.824726\n2.800097\n0.080639\n0.018848\n00:00\n\n\n11\n2.817148\n2.793399\n0.073941\n0.017220\n00:00\n\n\n12\n2.810647\n2.795838\n0.076380\n0.017713\n00:00\n\n\n13\n2.805257\n2.795752\n0.076294\n0.017630\n00:00\n\n\n14\n2.800452\n2.791506\n0.072048\n0.016825\n00:00\n\n\n15\n2.796498\n2.791960\n0.072502\n0.016795\n00:00\n\n\n16\n2.792618\n2.793065\n0.073607\n0.017045\n00:00\n\n\n17\n2.789762\n2.792158\n0.072700\n0.016887\n00:00\n\n\n18\n2.787136\n2.791858\n0.072400\n0.016806\n00:00\n\n\n19\n2.784748\n2.791649\n0.072191\n0.016751\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold1------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.122061\n3.125437\n0.370527\n0.079903\n00:00\n\n\n1\n3.039709\n3.077375\n0.322466\n0.073699\n00:00\n\n\n2\n2.981365\n2.966509\n0.211600\n0.053809\n00:00\n\n\n3\n2.933924\n2.868390\n0.113481\n0.029373\n00:00\n\n\n4\n2.898599\n2.839211\n0.084302\n0.020951\n00:00\n\n\n5\n2.873605\n2.834185\n0.079276\n0.019625\n00:00\n\n\n6\n2.855162\n2.833194\n0.078285\n0.018720\n00:00\n\n\n7\n2.840910\n2.828449\n0.073540\n0.017761\n00:00\n\n\n8\n2.829222\n2.824754\n0.069845\n0.016848\n00:00\n\n\n9\n2.819603\n2.827720\n0.072810\n0.017521\n00:00\n\n\n10\n2.811651\n2.827686\n0.072777\n0.017430\n00:00\n\n\n11\n2.804908\n2.822721\n0.067812\n0.016356\n00:00\n\n\n12\n2.799530\n2.821344\n0.066434\n0.016001\n00:00\n\n\n13\n2.794613\n2.824224\n0.069315\n0.016675\n00:00\n\n\n14\n2.790092\n2.823013\n0.068104\n0.016371\n00:00\n\n\n15\n2.786438\n2.824799\n0.069890\n0.016737\n00:00\n\n\n16\n2.783296\n2.822070\n0.067161\n0.016108\n00:00\n\n\n17\n2.780327\n2.822039\n0.067130\n0.016070\n00:00\n\n\n18\n2.778242\n2.822380\n0.067470\n0.016145\n00:00\n\n\n19\n2.776311\n2.822826\n0.067917\n0.016256\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold2------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.131628\n3.128202\n0.375819\n0.081358\n00:00\n\n\n1\n3.046990\n3.089172\n0.336788\n0.076419\n00:00\n\n\n2\n2.980138\n2.984057\n0.231674\n0.058168\n00:00\n\n\n3\n2.931372\n2.893255\n0.140872\n0.035893\n00:00\n\n\n4\n2.896703\n2.848695\n0.096311\n0.023613\n00:00\n\n\n5\n2.872715\n2.847809\n0.095425\n0.022987\n00:00\n\n\n6\n2.854965\n2.840352\n0.087968\n0.021104\n00:00\n\n\n7\n2.841479\n2.841226\n0.088842\n0.021400\n00:00\n\n\n8\n2.829988\n2.839816\n0.087432\n0.020786\n00:00\n\n\n9\n2.820873\n2.840088\n0.087704\n0.020787\n00:00\n\n\n10\n2.813017\n2.840173\n0.087789\n0.021121\n00:00\n\n\n11\n2.806214\n2.837716\n0.085333\n0.020274\n00:00\n\n\n12\n2.800474\n2.840278\n0.087895\n0.020892\n00:00\n\n\n13\n2.795398\n2.837604\n0.085220\n0.020280\n00:00\n\n\n14\n2.791186\n2.838032\n0.085647\n0.020317\n00:00\n\n\n15\n2.787181\n2.837193\n0.084809\n0.020108\n00:00\n\n\n16\n2.783750\n2.837958\n0.085574\n0.020211\n00:00\n\n\n17\n2.781101\n2.838556\n0.086172\n0.020365\n00:00\n\n\n18\n2.778903\n2.838520\n0.086137\n0.020391\n00:00\n\n\n19\n2.776784\n2.838481\n0.086097\n0.020377\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold3------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.120882\n3.127987\n0.364970\n0.079264\n00:00\n\n\n1\n3.036895\n3.088904\n0.325887\n0.074284\n00:00\n\n\n2\n2.972838\n2.992755\n0.229738\n0.057605\n00:00\n\n\n3\n2.926071\n2.886852\n0.123836\n0.031949\n00:00\n\n\n4\n2.892499\n2.848272\n0.085255\n0.020823\n00:00\n\n\n5\n2.870296\n2.847814\n0.084798\n0.020389\n00:00\n\n\n6\n2.853154\n2.849026\n0.086010\n0.020700\n00:00\n\n\n7\n2.839834\n2.847083\n0.084066\n0.020318\n-1:59:59\n\n\n8\n2.828994\n2.844793\n0.081776\n0.019672\n00:00\n\n\n9\n2.819419\n2.842653\n0.079636\n0.019257\n00:00\n\n\n10\n2.811447\n2.841825\n0.078808\n0.019056\n00:00\n\n\n11\n2.804928\n2.848768\n0.085752\n0.020495\n00:00\n\n\n12\n2.799309\n2.842607\n0.079590\n0.019078\n00:00\n\n\n13\n2.794755\n2.841860\n0.078843\n0.019069\n00:00\n\n\n14\n2.790560\n2.844399\n0.081383\n0.019448\n00:00\n\n\n15\n2.787015\n2.840157\n0.077140\n0.018435\n00:00\n\n\n16\n2.783412\n2.840241\n0.077225\n0.018553\n00:00\n\n\n17\n2.780463\n2.841109\n0.078092\n0.018732\n00:00\n\n\n18\n2.777783\n2.840881\n0.077865\n0.018649\n00:00\n\n\n19\n2.775528\n2.840620\n0.077603\n0.018587\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold4------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.133451\n3.130460\n0.380906\n0.081534\n00:00\n\n\n1\n3.053220\n3.090420\n0.340867\n0.076725\n00:00\n\n\n2\n2.989331\n2.990456\n0.240902\n0.060124\n00:00\n\n\n3\n2.940887\n2.895016\n0.145463\n0.037410\n00:00\n\n\n4\n2.905284\n2.854676\n0.105123\n0.025265\n00:00\n\n\n5\n2.879787\n2.847856\n0.098302\n0.023136\n00:01\n\n\n6\n2.860288\n2.840653\n0.091100\n0.021613\n00:00\n\n\n7\n2.845451\n2.835020\n0.085466\n0.020448\n00:00\n\n\n8\n2.833287\n2.837122\n0.087568\n0.020906\n00:00\n\n\n9\n2.824138\n2.845146\n0.095592\n0.022325\n00:00\n\n\n10\n2.816832\n2.844034\n0.094480\n0.021783\n00:00\n\n\n11\n2.809799\n2.845085\n0.095532\n0.021947\n00:00\n\n\n12\n2.803902\n2.840001\n0.090448\n0.020957\n00:00\n\n\n13\n2.798779\n2.840082\n0.090528\n0.020978\n00:00\n\n\n14\n2.794424\n2.840935\n0.091381\n0.021004\n00:00\n\n\n15\n2.790275\n2.840972\n0.091418\n0.021129\n00:00\n\n\n16\n2.786711\n2.842730\n0.093176\n0.021477\n00:00\n\n\n17\n2.783685\n2.841322\n0.091769\n0.021195\n00:00\n\n\n18\n2.781190\n2.841967\n0.092414\n0.021321\n00:00\n\n\n19\n2.779186\n2.842168\n0.092614\n0.021357\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n\noof_onehot = train_dl_cv(df_onehot,onehot_col,target_col,\n                  splits = splits,\n                  model_func = get_mlp_onehot,\n                  n_epoch=20,lr=3e-3)\n\n------fold0------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.107481\n3.079334\n0.359876\n0.080672\n00:00\n\n\n1\n3.024266\n2.912568\n0.193110\n0.048698\n00:00\n\n\n2\n2.961029\n2.823816\n0.104358\n0.026342\n00:00\n\n\n3\n2.913608\n2.798980\n0.079521\n0.019046\n00:00\n\n\n4\n2.879827\n2.794405\n0.074947\n0.017684\n00:00\n\n\n5\n2.855628\n2.792629\n0.073171\n0.017242\n00:00\n\n\n6\n2.837858\n2.791636\n0.072178\n0.017052\n00:00\n\n\n7\n2.824691\n2.795679\n0.076221\n0.017815\n00:00\n\n\n8\n2.814432\n2.790493\n0.071035\n0.016618\n00:00\n\n\n9\n2.806232\n2.789299\n0.069841\n0.016276\n00:00\n\n\n10\n2.799621\n2.789852\n0.070394\n0.016454\n00:00\n\n\n11\n2.794031\n2.789215\n0.069757\n0.016316\n00:00\n\n\n12\n2.789312\n2.786340\n0.066882\n0.015715\n00:00\n\n\n13\n2.785412\n2.787108\n0.067650\n0.015764\n00:00\n\n\n14\n2.781868\n2.788352\n0.068894\n0.016100\n00:00\n\n\n15\n2.779205\n2.786545\n0.067087\n0.015683\n00:00\n\n\n16\n2.776669\n2.787676\n0.068218\n0.015941\n00:00\n\n\n17\n2.774686\n2.786329\n0.066871\n0.015623\n00:00\n\n\n18\n2.772782\n2.786216\n0.066758\n0.015591\n00:00\n\n\n19\n2.771490\n2.786206\n0.066748\n0.015591\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold1------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.105893\n3.100944\n0.346035\n0.077511\n00:00\n\n\n1\n3.014429\n2.962021\n0.207112\n0.052557\n00:00\n\n\n2\n2.950377\n2.859910\n0.105000\n0.026838\n00:00\n\n\n3\n2.902731\n2.833114\n0.078204\n0.019364\n00:00\n\n\n4\n2.869296\n2.823380\n0.068471\n0.016776\n00:00\n\n\n5\n2.846127\n2.823797\n0.068887\n0.016775\n00:00\n\n\n6\n2.828729\n2.825376\n0.070467\n0.017084\n00:00\n\n\n7\n2.815908\n2.820808\n0.065898\n0.015970\n00:00\n\n\n8\n2.805543\n2.821366\n0.066457\n0.016000\n00:00\n\n\n9\n2.797379\n2.821266\n0.066356\n0.015913\n00:00\n\n\n10\n2.790692\n2.820984\n0.066074\n0.015859\n-1:59:59\n\n\n11\n2.785251\n2.819274\n0.064364\n0.015452\n00:00\n\n\n12\n2.780683\n2.820099\n0.065189\n0.015606\n00:00\n\n\n13\n2.776782\n2.818330\n0.063421\n0.015201\n00:00\n\n\n14\n2.773221\n2.820004\n0.065095\n0.015603\n00:00\n\n\n15\n2.770192\n2.818957\n0.064048\n0.015363\n00:00\n\n\n16\n2.767708\n2.818357\n0.063448\n0.015216\n00:00\n\n\n17\n2.765712\n2.818135\n0.063225\n0.015147\n00:00\n\n\n18\n2.763849\n2.818332\n0.063422\n0.015199\n00:00\n\n\n19\n2.762640\n2.818598\n0.063689\n0.015266\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold2------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.088713\n3.107045\n0.354661\n0.078924\n00:00\n\n\n1\n3.003663\n2.985674\n0.233290\n0.057648\n00:00\n\n\n2\n2.941490\n2.883777\n0.131393\n0.032687\n00:00\n\n\n3\n2.897114\n2.852958\n0.100574\n0.024289\n00:00\n\n\n4\n2.864851\n2.847725\n0.095341\n0.022589\n00:00\n\n\n5\n2.842869\n2.844643\n0.092260\n0.021997\n00:00\n\n\n6\n2.826611\n2.845072\n0.092688\n0.021976\n00:00\n\n\n7\n2.813991\n2.847180\n0.094796\n0.022378\n00:00\n\n\n8\n2.804400\n2.841731\n0.089347\n0.021196\n00:00\n\n\n9\n2.796265\n2.840563\n0.088179\n0.020948\n00:00\n\n\n10\n2.789751\n2.840242\n0.087858\n0.020796\n00:00\n\n\n11\n2.784153\n2.840891\n0.088507\n0.021003\n00:00\n\n\n12\n2.779781\n2.840099\n0.087715\n0.020793\n00:00\n\n\n13\n2.775961\n2.839979\n0.087595\n0.020757\n00:00\n\n\n14\n2.772897\n2.838845\n0.086462\n0.020503\n00:00\n\n\n15\n2.770104\n2.839367\n0.086983\n0.020601\n00:00\n\n\n16\n2.767797\n2.839252\n0.086869\n0.020576\n00:00\n\n\n17\n2.765796\n2.839692\n0.087309\n0.020678\n00:00\n\n\n18\n2.764111\n2.839003\n0.086619\n0.020530\n00:00\n\n\n19\n2.762813\n2.839128\n0.086744\n0.020563\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold3------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.096087\n3.110922\n0.347905\n0.077215\n00:00\n\n\n1\n3.005267\n2.995671\n0.232655\n0.057557\n00:00\n\n\n2\n2.944075\n2.882715\n0.119698\n0.030261\n00:00\n\n\n3\n2.899745\n2.851894\n0.088877\n0.021891\n00:00\n\n\n4\n2.867660\n2.845201\n0.082184\n0.019869\n00:00\n\n\n5\n2.844286\n2.842517\n0.079500\n0.019032\n00:00\n\n\n6\n2.827374\n2.840275\n0.077259\n0.018516\n00:00\n\n\n7\n2.814086\n2.840380\n0.077364\n0.018408\n00:00\n\n\n8\n2.803528\n2.838695\n0.075679\n0.018048\n00:00\n\n\n9\n2.794903\n2.840422\n0.077406\n0.018451\n00:00\n\n\n10\n2.787970\n2.838255\n0.075238\n0.017898\n00:00\n\n\n11\n2.782125\n2.838354\n0.075338\n0.017878\n00:00\n\n\n12\n2.777524\n2.837784\n0.074767\n0.017789\n00:00\n\n\n13\n2.773693\n2.837262\n0.074245\n0.017670\n00:00\n\n\n14\n2.770172\n2.836403\n0.073387\n0.017436\n00:00\n\n\n15\n2.767393\n2.836872\n0.073856\n0.017510\n00:00\n\n\n16\n2.765167\n2.836347\n0.073330\n0.017404\n00:00\n\n\n17\n2.763296\n2.836466\n0.073450\n0.017456\n00:00\n\n\n18\n2.761725\n2.836351\n0.073334\n0.017465\n00:00\n\n\n19\n2.760158\n2.836510\n0.073494\n0.017488\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold4------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.100043\n3.093074\n0.343521\n0.077535\n00:00\n\n\n1\n3.013312\n2.967172\n0.217618\n0.053456\n00:00\n\n\n2\n2.951631\n2.892219\n0.142666\n0.035091\n00:00\n\n\n3\n2.903811\n2.850470\n0.100917\n0.024567\n00:00\n\n\n4\n2.870965\n2.840093\n0.090540\n0.021754\n00:00\n\n\n5\n2.847079\n2.836390\n0.086837\n0.020592\n00:00\n\n\n6\n2.830200\n2.832452\n0.082898\n0.019636\n00:00\n\n\n7\n2.817096\n2.833317\n0.083763\n0.019721\n00:00\n\n\n8\n2.806404\n2.832405\n0.082851\n0.019474\n00:00\n\n\n9\n2.798034\n2.832736\n0.083183\n0.019539\n00:00\n\n\n10\n2.791615\n2.829747\n0.080194\n0.018905\n00:00\n\n\n11\n2.786198\n2.830539\n0.080985\n0.018936\n00:00\n\n\n12\n2.781335\n2.829982\n0.080428\n0.018835\n00:00\n\n\n13\n2.777448\n2.830047\n0.080494\n0.018879\n00:00\n\n\n14\n2.774225\n2.829092\n0.079538\n0.018666\n00:00\n\n\n15\n2.771223\n2.828914\n0.079361\n0.018591\n00:00\n\n\n16\n2.768771\n2.828378\n0.078825\n0.018487\n00:00\n\n\n17\n2.766705\n2.828239\n0.078686\n0.018401\n-1:59:59\n\n\n18\n2.765024\n2.827764\n0.078210\n0.018329\n00:00\n\n\n19\n2.763847\n2.827958\n0.078404\n0.018370\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n\noof_onehot_pca = train_dl_cv(df_onehot_pca,onehot_pca_col,target_col,\n                  splits = splits,\n                  model_func = get_mlp_onehot_pca,\n                  n_epoch=20,lr=3e-3)\n\n------fold0------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.189602\n3.113463\n0.394005\n0.084773\n00:00\n\n\n1\n3.104172\n2.977305\n0.257847\n0.062730\n00:00\n\n\n2\n3.021253\n2.857183\n0.137725\n0.035252\n00:00\n\n\n3\n2.958511\n2.821630\n0.102172\n0.025253\n00:00\n\n\n4\n2.914731\n2.809329\n0.089871\n0.021631\n00:00\n\n\n5\n2.883622\n2.808552\n0.089094\n0.021433\n00:00\n\n\n6\n2.860193\n2.807707\n0.088249\n0.021026\n00:00\n\n\n7\n2.842225\n2.802818\n0.083360\n0.019840\n00:00\n\n\n8\n2.828530\n2.801093\n0.081635\n0.019522\n00:00\n\n\n9\n2.817219\n2.799792\n0.080334\n0.019123\n00:00\n\n\n10\n2.807956\n2.800104\n0.080646\n0.019109\n00:00\n\n\n11\n2.800482\n2.800750\n0.081292\n0.019176\n00:00\n\n\n12\n2.794514\n2.799026\n0.079568\n0.018824\n00:00\n\n\n13\n2.789384\n2.798746\n0.079288\n0.018717\n00:00\n\n\n14\n2.785229\n2.799291\n0.079833\n0.018810\n00:00\n\n\n15\n2.781757\n2.798232\n0.078774\n0.018590\n00:00\n\n\n16\n2.778828\n2.797459\n0.078001\n0.018401\n00:00\n\n\n17\n2.776417\n2.797653\n0.078195\n0.018469\n00:00\n\n\n18\n2.774153\n2.798243\n0.078785\n0.018586\n00:00\n\n\n19\n2.772419\n2.798348\n0.078890\n0.018593\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold1------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.182634\n3.119604\n0.364695\n0.079957\n00:00\n\n\n1\n3.094388\n3.023017\n0.268108\n0.064864\n00:00\n\n\n2\n3.009603\n2.895565\n0.140655\n0.037207\n00:00\n\n\n3\n2.945920\n2.855029\n0.100119\n0.025731\n00:00\n\n\n4\n2.902055\n2.841548\n0.086639\n0.021765\n00:00\n\n\n5\n2.870601\n2.840891\n0.085981\n0.021420\n00:00\n\n\n6\n2.847384\n2.835758\n0.080849\n0.019897\n00:00\n\n\n7\n2.830473\n2.836553\n0.081643\n0.020070\n00:00\n\n\n8\n2.816775\n2.834080\n0.079170\n0.019415\n00:00\n\n\n9\n2.806609\n2.833592\n0.078683\n0.019308\n00:00\n\n\n10\n2.798110\n2.834079\n0.079170\n0.019278\n00:00\n\n\n11\n2.791102\n2.832111\n0.077202\n0.018827\n00:00\n\n\n12\n2.785033\n2.833967\n0.079058\n0.019225\n00:00\n\n\n13\n2.779964\n2.833513\n0.078604\n0.019094\n00:00\n\n\n14\n2.776213\n2.832083\n0.077174\n0.018749\n00:00\n\n\n15\n2.772797\n2.832464\n0.077554\n0.018839\n00:00\n\n\n16\n2.770095\n2.831249\n0.076339\n0.018502\n00:00\n\n\n17\n2.767329\n2.832006\n0.077097\n0.018690\n00:00\n\n\n18\n2.765280\n2.832045\n0.077135\n0.018729\n00:00\n\n\n19\n2.763488\n2.831995\n0.077086\n0.018688\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold2------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.180655\n3.133078\n0.380694\n0.082307\n00:00\n\n\n1\n3.087744\n3.049715\n0.297332\n0.070353\n00:00\n\n\n2\n3.001378\n2.914612\n0.162228\n0.041429\n00:00\n\n\n3\n2.940427\n2.872758\n0.120375\n0.030020\n00:00\n\n\n4\n2.897774\n2.859895\n0.107511\n0.026098\n00:00\n\n\n5\n2.867156\n2.863013\n0.110629\n0.026861\n00:00\n\n\n6\n2.844925\n2.856844\n0.104461\n0.025312\n00:00\n\n\n7\n2.828006\n2.852781\n0.100397\n0.024134\n00:00\n\n\n8\n2.815066\n2.853749\n0.101365\n0.024317\n00:00\n\n\n9\n2.804623\n2.853329\n0.100945\n0.024254\n00:00\n\n\n10\n2.796463\n2.850767\n0.098383\n0.023635\n00:00\n\n\n11\n2.789638\n2.851188\n0.098804\n0.023729\n00:00\n\n\n12\n2.784149\n2.847641\n0.095257\n0.022792\n00:00\n\n\n13\n2.779597\n2.850568\n0.098185\n0.023457\n00:00\n\n\n14\n2.775884\n2.850853\n0.098469\n0.023641\n00:00\n\n\n15\n2.772516\n2.850517\n0.098133\n0.023541\n00:00\n\n\n16\n2.769773\n2.849717\n0.097334\n0.023291\n00:00\n\n\n17\n2.767376\n2.848876\n0.096492\n0.023068\n00:00\n\n\n18\n2.765348\n2.848939\n0.096556\n0.023068\n00:00\n\n\n19\n2.763793\n2.849362\n0.096978\n0.023216\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold3------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.171948\n3.122044\n0.359027\n0.078739\n00:00\n\n\n1\n3.078477\n3.038632\n0.275615\n0.066434\n00:00\n\n\n2\n2.995987\n2.918788\n0.155771\n0.040377\n00:00\n\n\n3\n2.935148\n2.868035\n0.105018\n0.026499\n00:00\n\n\n4\n2.893677\n2.856677\n0.093661\n0.023154\n00:00\n\n\n5\n2.863889\n2.860430\n0.097414\n0.023751\n00:00\n\n\n6\n2.841698\n2.854681\n0.091664\n0.022408\n00:00\n\n\n7\n2.825094\n2.852442\n0.089426\n0.021593\n00:00\n\n\n8\n2.812347\n2.851212\n0.088195\n0.021338\n00:00\n\n\n9\n2.802684\n2.850125\n0.087109\n0.020951\n00:00\n\n\n10\n2.794548\n2.848400\n0.085383\n0.020580\n00:00\n\n\n11\n2.788096\n2.847420\n0.084403\n0.020379\n-1:59:59\n\n\n12\n2.782459\n2.848621\n0.085605\n0.020491\n00:00\n\n\n13\n2.777640\n2.847715\n0.084698\n0.020367\n00:00\n\n\n14\n2.773699\n2.847724\n0.084707\n0.020411\n00:00\n\n\n15\n2.770435\n2.847151\n0.084134\n0.020171\n00:00\n\n\n16\n2.767452\n2.847463\n0.084447\n0.020274\n00:00\n\n\n17\n2.765041\n2.847303\n0.084286\n0.020241\n00:00\n\n\n18\n2.762976\n2.847187\n0.084170\n0.020176\n00:00\n\n\n19\n2.761266\n2.846792\n0.083776\n0.020062\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold4------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.168980\n3.113049\n0.363495\n0.080159\n00:00\n\n\n1\n3.080419\n3.011974\n0.262420\n0.064262\n00:00\n\n\n2\n2.998897\n2.907214\n0.157660\n0.039925\n00:00\n\n\n3\n2.938524\n2.865003\n0.115449\n0.028375\n00:00\n\n\n4\n2.896167\n2.856457\n0.106903\n0.026023\n00:00\n\n\n5\n2.866137\n2.853608\n0.104054\n0.025234\n00:00\n\n\n6\n2.844121\n2.851347\n0.101793\n0.024680\n00:00\n\n\n7\n2.827480\n2.847170\n0.097616\n0.023724\n00:00\n\n\n8\n2.815023\n2.844982\n0.095428\n0.023147\n00:00\n\n\n9\n2.804815\n2.843091\n0.093538\n0.022543\n00:00\n\n\n10\n2.796711\n2.843977\n0.094423\n0.022789\n00:00\n\n\n11\n2.790092\n2.843254\n0.093701\n0.022592\n00:00\n\n\n12\n2.784432\n2.842181\n0.092628\n0.022250\n00:00\n\n\n13\n2.779616\n2.841425\n0.091872\n0.022164\n00:00\n\n\n14\n2.776180\n2.840833\n0.091280\n0.021957\n00:00\n\n\n15\n2.772646\n2.840190\n0.090637\n0.021706\n00:00\n\n\n16\n2.770050\n2.839524\n0.089970\n0.021553\n00:00\n\n\n17\n2.767612\n2.840582\n0.091028\n0.021872\n00:00\n\n\n18\n2.765678\n2.840996\n0.091442\n0.021974\n00:00\n\n\n19\n2.764087\n2.840355\n0.090801\n0.021799\n00:00",
    "crumbs": [
      "kinase_domain",
      "DL training: Feature comparison on MLP model"
    ]
  },
  {
    "objectID": "kinase_domain/kd_06c_pspa_training_feature_comparison_mlp.html#score",
    "href": "kinase_domain/kd_06c_pspa_training_feature_comparison_mlp.html#score",
    "title": "DL training: Feature comparison on MLP model",
    "section": "Score",
    "text": "Score\n\nfrom katlas.pssm import *\n\nfrom functools import partial\n\n\ndef score_df(target,pred,func):\n    distance = [func(target.loc[i],pred.loc[i,target.columns]) for i in target.index]\n    return pd.Series(distance,index=target.index)\n\n\njsd_df = partial(score_df,func=js_divergence_flat)\njss_df = partial(score_df,func=js_similarity_flat)\n\nkld_df = partial(score_df,func=kl_divergence_flat)\n\n\ntarget=df_t5[target_col].copy()\n\n\n(oof_t5.nfold == oof_esm.nfold).value_counts()\n\nnfold\nTrue    368\nName: count, dtype: int64\n\n\n\npspa_info['split'] = oof_t5.nfold\n\n\npspa_info['t5'] =jsd_df(target,oof_t5)\npspa_info['esm'] =jsd_df(target,oof_esm)\npspa_info['onehot'] =jsd_df(target,oof_onehot)\npspa_info['onehot_pca'] =jsd_df(target,oof_onehot_pca)\n\n\nfrom katlas.plot import *\n\n\nset_sns()\n\n\npspa_info.to_parquet('raw/MLP_feature_compare_subfamily.parquet')\n\n\nplot_group_bar(pspa_info,['onehot','onehot_pca','esm','t5',],group='group')\nplt.ylabel('JS divergence')\nsave_svg('fig/MLP_feature_comparison.svg')\n\n\n\n\n\n\n\n\n\nFor JS similarity (less differentiated)\n\npspa_info['t5'] =jss_df(target,oof_t5)\npspa_info['esm'] =jss_df(target,oof_esm)\npspa_info['onehot'] =jss_df(target,oof_onehot)\npspa_info['onehot_pca'] =jss_df(target,oof_onehot_pca)\n\n\nplot_group_bar(pspa_info,['t5','esm','onehot','onehot_pca'],group='group')\nplt.ylabel('JS divergence')\n\nText(0, 0.5, 'JS divergence')",
    "crumbs": [
      "kinase_domain",
      "DL training: Feature comparison on MLP model"
    ]
  },
  {
    "objectID": "kinase_domain/kd_09b_predict_cddm.html",
    "href": "kinase_domain/kd_09b_predict_cddm.html",
    "title": "Predict",
    "section": "",
    "text": "import pandas as pd\nfrom katlas.train import *\nfrom katlas.dnn import *\nfrom fastai.vision.all import *\nfrom katlas.pssm import *\ncddm_unk = pd.read_parquet('raw/kd_similar_cddm.parquet')\ncddm_unk = cddm_unk[cddm_unk.within_threshold].copy()\n# from katlas.data import *\n\n# kd = Data.get_kd_uniprot()\nt5 = pd.read_parquet('raw/t5_kd.parquet')\ntest_cddm = t5.loc[cddm_unk.index].reset_index()",
    "crumbs": [
      "kinase_domain",
      "Predict"
    ]
  },
  {
    "objectID": "kinase_domain/kd_09b_predict_cddm.html#predict",
    "href": "kinase_domain/kd_09b_predict_cddm.html#predict",
    "title": "Predict",
    "section": "Predict",
    "text": "Predict\n\nsample=pd.read_parquet('train/cddm_t5.parquet')\n\n\ntarget_col = sample.columns[~sample.columns.str.startswith('T5')]\n\n\ntarget_col\n\nIndex(['-20P', '-19P', '-18P', '-17P', '-16P', '-15P', '-14P', '-13P', '-12P',\n       '-11P',\n       ...\n       '11pY', '12pY', '13pY', '14pY', '15pY', '16pY', '17pY', '18pY', '19pY',\n       '20pY'],\n      dtype='object', length=943)\n\n\n\nfeat_col = test_cddm.columns[1:]\n\n\nfeat_col\n\nIndex(['T5_0', 'T5_1', 'T5_2', 'T5_3', 'T5_4', 'T5_5', 'T5_6', 'T5_7', 'T5_8',\n       'T5_9',\n       ...\n       'T5_1014', 'T5_1015', 'T5_1016', 'T5_1017', 'T5_1018', 'T5_1019',\n       'T5_1020', 'T5_1021', 'T5_1022', 'T5_1023'],\n      dtype='object', length=1024)\n\n\n\nn_feature = len(feat_col)\nn_target = len(target_col)\n\n\nn_feature,n_target\n\n(1024, 943)\n\n\n\ndef get_cnn(): return PSSM_model(n_feature,n_target,model='CNN')\n\n\nfrom tqdm import tqdm\n\n\ndef get_ensemble_pred(test_df, model_name,nfold=5):\n    ensemble = None\n    for i in tqdm(range(nfold)):\n        test_pred = predict_dl(test_df, \n                   feat_col, \n                   target_col,\n                   model_func=get_cnn, # model architecture\n                   model_pth=f'{model_name}_fold{i}', # only name, not with .pth\n                  )\n        if ensemble is None:\n            ensemble = test_pred.copy()   # start with first prediction\n        else:\n            ensemble += test_pred         # accumulate\n    \n    ensemble /= 5\n    return ensemble\n\n\npred = get_ensemble_pred(test_cddm,'cnn_cddm')\n\n100%|████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:09&lt;00:00,  1.89s/it]\n\n\n\npred.index=cddm_unk.index\n\n\npred.to_parquet('raw/pred_new_cddm.parquet')\n\n\npred\n\n\n\n\n\n\n\n\n-20P\n-19P\n-18P\n-17P\n-16P\n-15P\n-14P\n-13P\n-12P\n-11P\n...\n11pY\n12pY\n13pY\n14pY\n15pY\n16pY\n17pY\n18pY\n19pY\n20pY\n\n\n\n\nA0A8I3S724_AURKA_CANLF_KD1\n0.058566\n0.047093\n0.038226\n0.060463\n0.059130\n0.054548\n0.054172\n0.049232\n0.047558\n0.059301\n...\n0.011735\n0.011759\n0.015638\n0.011591\n0.011264\n0.015564\n0.016801\n0.013457\n0.016039\n0.015655\n\n\nA0A8I5ZNK2_OXSR1_RAT_KD1\n0.062874\n0.044732\n0.037693\n0.069321\n0.069203\n0.048762\n0.055191\n0.046259\n0.054198\n0.052150\n...\n0.009368\n0.014231\n0.010534\n0.009535\n0.007872\n0.018224\n0.026171\n0.012271\n0.011304\n0.023689\n\n\nA0JM20_TYRO3_XENTR_KD1\n0.043008\n0.046507\n0.053662\n0.055524\n0.040229\n0.046882\n0.063473\n0.061160\n0.048801\n0.045304\n...\n0.013642\n0.019686\n0.012491\n0.010734\n0.012548\n0.011841\n0.014706\n0.006341\n0.018013\n0.015684\n\n\nA0JNB0_FYN_BOVIN_KD1\n0.045568\n0.047251\n0.050904\n0.050163\n0.047431\n0.048869\n0.060826\n0.054838\n0.052466\n0.041447\n...\n0.015842\n0.020160\n0.014444\n0.012258\n0.011229\n0.013144\n0.014181\n0.007040\n0.017035\n0.017139\n\n\nA0M8R7_MET_PAPAN_KD1\n0.042183\n0.045986\n0.049634\n0.047944\n0.040924\n0.046336\n0.061326\n0.060749\n0.046776\n0.042471\n...\n0.014246\n0.020650\n0.013831\n0.011233\n0.012048\n0.012316\n0.014068\n0.006437\n0.017606\n0.016929\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\nQ9Z2B9_KS6A4_MOUSE_KD1\n0.062978\n0.046201\n0.043306\n0.047586\n0.060256\n0.057318\n0.069925\n0.054924\n0.057089\n0.056542\n...\n0.009725\n0.009109\n0.013359\n0.011704\n0.007290\n0.015323\n0.023502\n0.008287\n0.016022\n0.014946\n\n\nQ9Z2G7_GRK7_ICTTR_KD1\n0.069125\n0.050716\n0.028324\n0.078284\n0.088472\n0.043415\n0.070791\n0.038503\n0.033959\n0.072650\n...\n0.007297\n0.005966\n0.006196\n0.012518\n0.006082\n0.022531\n0.026919\n0.019598\n0.009070\n0.015517\n\n\nQ9Z2R9_E2AK1_MOUSE_KD1\n0.052221\n0.055948\n0.027863\n0.051704\n0.028007\n0.048318\n0.038666\n0.040143\n0.050289\n0.033800\n...\n0.007105\n0.004360\n0.002075\n0.015135\n0.002591\n0.014851\n0.005058\n0.013597\n0.005913\n0.015426\n\n\nQ9Z2W1_STK25_MOUSE_KD1\n0.053220\n0.045374\n0.031947\n0.051374\n0.052299\n0.055456\n0.054058\n0.051449\n0.048602\n0.050390\n...\n0.010350\n0.012648\n0.010529\n0.008406\n0.008619\n0.020545\n0.017907\n0.013738\n0.011008\n0.021155\n\n\nW0LYS5_CAMKI_MACNP_KD1\n0.075941\n0.072653\n0.044654\n0.047528\n0.066485\n0.048711\n0.076716\n0.036033\n0.064526\n0.062745\n...\n0.012258\n0.011500\n0.007500\n0.017919\n0.009034\n0.013052\n0.025094\n0.009916\n0.012742\n0.014000\n\n\n\n\n1195 rows × 943 columns",
    "crumbs": [
      "kinase_domain",
      "Predict"
    ]
  },
  {
    "objectID": "kinase_domain/kd_09b_predict_cddm.html#test",
    "href": "kinase_domain/kd_09b_predict_cddm.html#test",
    "title": "Predict",
    "section": "test",
    "text": "test\n\ncdks = cddm_unk[cddm_unk.closest_pos_index.str.contains('CDK')]\n\n\nfor i in cdks.head(5).index:\n    print(i)\n    plot_heatmap(recover_pssm(pred.loc[i]))\n    plt.show()\n    plt.close()\n\nB2MVY4_CDK4_SHEEP_KD1\n\n\n\n\n\n\n\n\n\nO35831_CDK17_RAT_KD1\n\n\n\n\n\n\n\n\n\nO55076_CDK2_CRIGR_KD1\n\n\n\n\n\n\n\n\n\nP11440_CDK1_MOUSE_KD1\n\n\n\n\n\n\n\n\n\nP13863_CDK1_CHICK_KD1",
    "crumbs": [
      "kinase_domain",
      "Predict"
    ]
  },
  {
    "objectID": "kinase_domain/kd_03_feature_extract.html",
    "href": "kinase_domain/kd_03_feature_extract.html",
    "title": "Extract KD features",
    "section": "",
    "text": "import pandas as pd\nfrom katlas.core import *\nfrom katlas.feature import *\nfrom katlas.plot import *\ndf = Data.get_kd_uniprot()\n# filter active kinase domain\ndf = df[df.active_D1_D2.astype(bool)].reset_index(drop=True)\ndf.columns\n\nIndex(['kd_ID', 'Uniprot', 'Entry Name', 'Protein names', 'Gene Names',\n       'Gene Names (primary)', 'Organism', 'kd_note', 'kd_evidence',\n       'kd_start', 'kd_end', 'kd_seq', 'Domain [FT]', 'Domain [CC]', 'Region',\n       'Motif', 'Protein families', 'Reactome', 'ComplexPortal',\n       'Subcellular location [CC]', 'Gene Ontology (biological process)',\n       'Tissue specificity', 'Interacts with', 'Subunit structure',\n       'Function [CC]', 'Activity regulation', 'full_seq', 'D1', 'D2', 'D3',\n       'N1', 'active_D1_D2'],\n      dtype='object')\ndf.shape\n\n(4209, 32)",
    "crumbs": [
      "kinase_domain",
      "Extract KD features"
    ]
  },
  {
    "objectID": "kinase_domain/kd_03_feature_extract.html#onehot-of-sequence-alignment",
    "href": "kinase_domain/kd_03_feature_extract.html#onehot-of-sequence-alignment",
    "title": "Extract KD features",
    "section": "Onehot of sequence alignment",
    "text": "Onehot of sequence alignment\n\nalign = pd.read_parquet('raw/uniprot_kd_align.parquet')\n\n\nalign.columns = align.columns.astype(int)\n\n\nactive=(align[1525]=='D')& (align[1724]=='D')\nalign = align[active]\n\n\nalign.shape\n\n(4209, 3434)\n\n\n\ncounts_df = align.apply(lambda col: col.value_counts(), axis=0).fillna(0)\nfreq_df = counts_df.div(counts_df.sum(axis=0), axis=1)\n\n\n# remove '-' first line\nmax_series=freq_df.iloc[1:,:]\n\n\nfreq_max = pd.concat([max_series.idxmax(),max_series.max()],axis=1)\nfreq_max.columns = ['aa','max_value']\nfreq_max = freq_max.sort_values('max_value',ascending=False).reset_index(names='position')\n\n\nfreq_max\n\n\n\n\n\n\n\n\nposition\naa\nmax_value\n\n\n\n\n0\n1724\nD\n1.000000\n\n\n1\n1525\nD\n1.000000\n\n\n2\n1549\nN\n0.988121\n\n\n3\n1730\nG\n0.959135\n\n\n4\n2618\nD\n0.948919\n\n\n...\n...\n...\n...\n\n\n3429\n337\nA\n0.000000\n\n\n3430\n338\nA\n0.000000\n\n\n3431\n339\nA\n0.000000\n\n\n3432\n1899\nA\n0.000000\n\n\n3433\n1900\nA\n0.000000\n\n\n\n\n3434 rows × 3 columns\n\n\n\n\nonehot_col = freq_max[freq_max.max_value&gt;0.05].position.sort_values().tolist()\n\n\nlen(onehot_col)\n\n358\n\n\n\nalign = align[onehot_col]\n\n\nfrom sklearn.preprocessing import OneHotEncoder\n\ndef get_onehot(df):\n    df=df.copy()\n    encoded_df = pd.DataFrame(index=df.index)\n    \n    encoder = OneHotEncoder(sparse_output=False, dtype=int, handle_unknown='ignore')\n    \n    for col in df.columns:\n        reshaped = df[[col]]  # keep as DataFrame\n        encoded = encoder.fit_transform(reshaped)\n        aa_labels = encoder.categories_[0]\n        new_col_names = [f\"{col}_{aa}\" for aa in aa_labels]\n        encoded_subdf = pd.DataFrame(encoded,index=df.index)\n        encoded_subdf.columns=new_col_names\n        encoded_df = pd.concat([encoded_df, encoded_subdf], axis=1)\n    return encoded_df\n\n\nonehot=get_onehot(align)\n\n\nonehot.head()\n\n\n\n\n\n\n\n\n65_-\n65_A\n65_C\n65_D\n65_E\n65_F\n65_G\n65_H\n65_I\n65_K\n...\n3192_M\n3192_N\n3192_P\n3192_Q\n3192_R\n3192_S\n3192_T\n3192_V\n3192_W\n3192_Y\n\n\n\n\nA0A075F7E9_LERK1_ORYSI_KD1\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\nA0A078CGE6_M3KE1_BRANA_KD1\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\nA0A0K3AV08_MLK1_CAEEL_KD1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\nA0A0P0VIP0_LRSK7_ORYSJ_KD1\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\nA0A0P0XII1_CERK1_ORYSJ_KD1\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n\n\n5 rows × 6849 columns\n\n\n\n\nonehot.shape\n\n(4209, 6849)\n\n\nIt contains the active kd_ID\n\nonehot.to_parquet('raw/onehot_kd.parquet')",
    "crumbs": [
      "kinase_domain",
      "Extract KD features"
    ]
  },
  {
    "objectID": "kinase_domain/kd_03_feature_extract.html#onehot-pca",
    "href": "kinase_domain/kd_03_feature_extract.html#onehot-pca",
    "title": "Extract KD features",
    "section": "Onehot + PCA",
    "text": "Onehot + PCA\nSince onehot gives 6849 columns, we can PCA reduce the column number.\nWe chose 1000 as t5 and esm have a range of 1000 features.\n\nonehot_pca = reduce_feature(onehot,n=1000)\n\n\nonehot_pca.to_parquet('raw/onehot_pca_kd.parquet')",
    "crumbs": [
      "kinase_domain",
      "Extract KD features"
    ]
  },
  {
    "objectID": "kinase_domain/kd_03_feature_extract.html#t5-embeddings",
    "href": "kinase_domain/kd_03_feature_extract.html#t5-embeddings",
    "title": "Extract KD features",
    "section": "T5 embeddings",
    "text": "T5 embeddings\n\nfeat_t5 = get_t5(df,'kd_seq')\n\nYou are using the default legacy behaviour of the &lt;class 'transformers.models.t5.tokenization_t5.T5Tokenizer'&gt;. This is expected, and simply means that the `legacy` (previous) behavior will be used so nothing changes for you. If you want to use the new behaviour, set `legacy=False`. This should only be set if you understand what it means, and thoroughly read the reason why this was added as explained in https://github.com/huggingface/transformers/pull/24565\n\n\n\n\n\n\n\n\n\nfeat_t5.index=df.kd_ID\n\n\nfeat_t5.head()\n\n/home/sky1ove/git/KATLAS/katlas/.venv/lib/python3.12/site-packages/pandas/io/formats/format.py:1458: RuntimeWarning: overflow encountered in cast\n  has_large_values = (abs_vals &gt; 1e6).any()\n/home/sky1ove/git/KATLAS/katlas/.venv/lib/python3.12/site-packages/pandas/io/formats/format.py:1458: RuntimeWarning: overflow encountered in cast\n  has_large_values = (abs_vals &gt; 1e6).any()\n\n\n\n\n\n\n\n\n\nT5_0\nT5_1\nT5_2\nT5_3\nT5_4\nT5_5\nT5_6\nT5_7\nT5_8\nT5_9\n...\nT5_1014\nT5_1015\nT5_1016\nT5_1017\nT5_1018\nT5_1019\nT5_1020\nT5_1021\nT5_1022\nT5_1023\n\n\nkd_ID\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nA0A075F7E9_LERK1_ORYSI_KD1\n0.014122\n0.068848\n0.016113\n-0.001555\n-0.001301\n0.021393\n0.030304\n-0.062408\n0.028427\n-0.017532\n...\n-0.029297\n0.014900\n-0.006233\n-0.069824\n0.044067\n-0.009636\n-0.007458\n0.021240\n0.005264\n-0.034637\n\n\nA0A078CGE6_M3KE1_BRANA_KD1\n0.054565\n0.093811\n-0.007420\n0.018890\n-0.042236\n-0.005402\n-0.004921\n-0.046844\n-0.013443\n-0.019501\n...\n-0.016037\n0.000758\n-0.038391\n-0.041321\n0.069580\n-0.022415\n-0.026306\n-0.001375\n0.006599\n-0.034485\n\n\nA0A0K3AV08_MLK1_CAEEL_KD1\n0.014870\n-0.008934\n0.000822\n0.001986\n-0.035767\n0.023880\n-0.012856\n-0.056274\n-0.004978\n-0.001923\n...\n-0.032349\n-0.057129\n-0.005463\n-0.107910\n0.020889\n-0.009666\n-0.022614\n-0.019882\n0.040466\n-0.021912\n\n\nA0A0P0VIP0_LRSK7_ORYSJ_KD1\n-0.008522\n0.062134\n-0.014053\n-0.027054\n-0.025665\n0.014648\n0.015022\n-0.045959\n0.023544\n-0.036133\n...\n0.037994\n-0.022903\n0.046082\n-0.082703\n0.000940\n-0.009811\n0.008896\n0.014931\n0.028061\n-0.037994\n\n\nA0A0P0XII1_CERK1_ORYSJ_KD1\n0.029053\n0.076050\n0.014656\n0.015732\n-0.006050\n0.019882\n-0.003336\n-0.041016\n0.060211\n-0.014572\n...\n0.014740\n0.019989\n0.011230\n-0.040222\n0.044403\n-0.001749\n-0.013168\n0.018524\n-0.018280\n-0.034912\n\n\n\n\n5 rows × 1024 columns\n\n\n\n\n# feat_t5.to_parquet('raw/t5_kd.parquet')",
    "crumbs": [
      "kinase_domain",
      "Extract KD features"
    ]
  },
  {
    "objectID": "kinase_domain/kd_03_feature_extract.html#esm2-embeddings",
    "href": "kinase_domain/kd_03_feature_extract.html#esm2-embeddings",
    "title": "Extract KD features",
    "section": "ESM2 embeddings",
    "text": "ESM2 embeddings\n\nget_esm\n\n\nfeat_esm = get_esm(df,'kd_seq')\n\nrepr_layers number for model esm2_t33_650M_UR50D is 33.\nYou can also choose other esm2 models: \nesm2_t48_15B_UR50D\nesm2_t36_3B_UR50D\nesm2_t33_650M_UR50D\nesm2_t30_150M_UR50D\nesm2_t12_35M_UR50D\nesm2_t6_8M_UR50D\n\n\n\n\n\n\n/home/sky1ove/git/KATLAS/katlas/.venv/lib/python3.12/site-packages/logomaker/../fairscale/nn/data_parallel/fully_sharded_data_parallel.py:2562: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()\n  if data.storage().size() &gt; 0:\n\n\n\nfeat_esm.index=df.kd_ID\n\n\nfeat_esm.to_parquet('raw/esm_kd.parquet')\n\n\nfeat_esm.head()\n\n/home/sky1ove/git/KATLAS/katlas/.venv/lib/python3.12/site-packages/pandas/io/formats/format.py:1458: RuntimeWarning: overflow encountered in cast\n  has_large_values = (abs_vals &gt; 1e6).any()\n/home/sky1ove/git/KATLAS/katlas/.venv/lib/python3.12/site-packages/pandas/io/formats/format.py:1458: RuntimeWarning: overflow encountered in cast\n  has_large_values = (abs_vals &gt; 1e6).any()\n\n\n\n\n\n\n\n\n\nesm_0\nesm_1\nesm_2\nesm_3\nesm_4\nesm_5\nesm_6\nesm_7\nesm_8\nesm_9\n...\nesm_1270\nesm_1271\nesm_1272\nesm_1273\nesm_1274\nesm_1275\nesm_1276\nesm_1277\nesm_1278\nesm_1279\n\n\nkd_ID\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nA0A075F7E9_LERK1_ORYSI_KD1\n-0.014076\n-0.047668\n-0.030716\n-0.045868\n-0.062622\n-0.116272\n-0.007904\n0.056915\n0.010590\n0.020737\n...\n0.020691\n-0.012749\n-0.077209\n0.087402\n0.007301\n-0.010765\n0.094604\n-0.053802\n0.049164\n0.014648\n\n\nA0A078CGE6_M3KE1_BRANA_KD1\n0.012405\n-0.039764\n-0.004433\n-0.019089\n-0.064331\n-0.048035\n0.120789\n-0.026199\n-0.058777\n0.143188\n...\n0.082520\n-0.046143\n-0.080872\n0.077515\n0.004078\n-0.046143\n0.029099\n-0.214355\n0.070923\n0.146851\n\n\nA0A0K3AV08_MLK1_CAEEL_KD1\n0.047180\n-0.048553\n0.022888\n0.006191\n-0.028015\n-0.094177\n0.104492\n-0.006901\n0.016891\n0.066223\n...\n0.023575\n-0.010071\n-0.090149\n0.075684\n0.022385\n-0.044006\n0.071838\n-0.078369\n0.013710\n0.071838\n\n\nA0A0P0VIP0_LRSK7_ORYSJ_KD1\n-0.086121\n-0.039001\n-0.012978\n-0.087524\n-0.117981\n-0.046600\n-0.037628\n0.059875\n0.037323\n0.087708\n...\n-0.061615\n-0.025787\n-0.085449\n0.133667\n0.016953\n-0.106079\n0.025635\n-0.045868\n0.080750\n0.021927\n\n\nA0A0P0XII1_CERK1_ORYSJ_KD1\n0.004047\n-0.067383\n-0.022156\n-0.011215\n-0.110840\n-0.077637\n0.012314\n0.012299\n-0.011688\n0.047485\n...\n0.056519\n-0.023270\n-0.094849\n0.101746\n-0.033417\n-0.050415\n0.054749\n-0.071594\n0.046631\n0.021667\n\n\n\n\n5 rows × 1280 columns\n\n\n\n\nfeat_esm.shape\n\n(4209, 1280)",
    "crumbs": [
      "kinase_domain",
      "Extract KD features"
    ]
  },
  {
    "objectID": "kinase_domain/kd_11_plot_pspa_kd_t5.html",
    "href": "kinase_domain/kd_11_plot_pspa_kd_t5.html",
    "title": "katlas-raw",
    "section": "",
    "text": "from katlas.common import *\nimport pandas as pd\n\nfrom katlas.plot import *\nfrom matplotlib import pyplot as plt\n\n\n\nt5 = pd.read_parquet('raw/t5_kd.parquet')\n\n\npspa=pd.read_parquet('train/pspa_t5.parquet')\n\n\ninfo=Data.get_kinase_info()\n\n\ninfo = info[info.pseudo=='0']\n\n\ninfo.kd_ID.str.len().sort_values()\n\n518    20.0\n32     20.0\n28     20.0\n27     20.0\n497    20.0\n       ... \n43      NaN\n44      NaN\n486     NaN\n487     NaN\n488     NaN\nName: kd_ID, Length: 462, dtype: float64\n\n\n\ninfo=info.dropna(subset='kd_ID')\n\n\npspa_cat_map = info.set_index('kd_ID')['pspa_category_big']\n\n\nidxs = (pspa_cat_map.value_counts()&gt;=8)[lambda s: s].index\nhue_map = pspa_cat_map[pspa_cat_map.isin(idxs)]\n\n\npspa = pspa.loc[:,pspa.columns.str.startswith('T5')]\n\n\nembed_df=reduce_feature(pspa,method='UMAP',complexity=15,min_dist=0.2)\n\n/home/sky1ove/git/katlas/.venv/lib/python3.11/site-packages/logomaker/../umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.\n  warn(\n\n\n\nplot_2d(embed_df,hue=hue_map,\n        legend=True,\n        legend_title='PSPA category (cnt≥8)',height=4\n        )\nplt.title('UMAP plot of KD T5 embeddings')\nsave_svg('fig/umap_t5_pspa_category.svg')",
    "crumbs": [
      "kinase_domain",
      "kd_11_plot_pspa_kd_t5.html"
    ]
  },
  {
    "objectID": "kinase_domain/kd_05_pspa_training_model_comparison_all.html",
    "href": "kinase_domain/kd_05_pspa_training_model_comparison_all.html",
    "title": "DL training: Model comparison on T5 feature",
    "section": "",
    "text": "import numpy as np, pandas as pd\nimport os, random\nfrom katlas.data import *\nfrom katlas.train import *\nfrom fastai.vision.all import *\nfrom katlas.dnn import *\n\n\nseed_everything()\n\n\ndef_device\n\n'cuda'",
    "crumbs": [
      "kinase_domain",
      "DL training: Model comparison on T5 feature"
    ]
  },
  {
    "objectID": "kinase_domain/kd_05_pspa_training_model_comparison_all.html#setup",
    "href": "kinase_domain/kd_05_pspa_training_model_comparison_all.html#setup",
    "title": "DL training: Model comparison on T5 feature",
    "section": "",
    "text": "import numpy as np, pandas as pd\nimport os, random\nfrom katlas.data import *\nfrom katlas.train import *\nfrom fastai.vision.all import *\nfrom katlas.dnn import *\n\n\nseed_everything()\n\n\ndef_device\n\n'cuda'",
    "crumbs": [
      "kinase_domain",
      "DL training: Model comparison on T5 feature"
    ]
  },
  {
    "objectID": "kinase_domain/kd_05_pspa_training_model_comparison_all.html#data",
    "href": "kinase_domain/kd_05_pspa_training_model_comparison_all.html#data",
    "title": "DL training: Model comparison on T5 feature",
    "section": "Data",
    "text": "Data\n\ndf=pd.read_parquet('train/pspa_t5.parquet')\n\n\ninfo=Data.get_kinase_info()\n\ninfo = info[info.pseudo=='0']\n\ninfo = info[info.kd_ID.notna()]\n\nsubfamily_map = info[['kd_ID','subfamily']].drop_duplicates().set_index('kd_ID')['subfamily']\nfamily_map = info[['kd_ID','family']].drop_duplicates().set_index('kd_ID')['family']\ngroup_map = info[['kd_ID','group']].drop_duplicates().set_index('kd_ID')['group']\n\npspa_info = pd.DataFrame(df.index.tolist(),columns=['kinase'])\n\npspa_info['subfamily'] = pspa_info.kinase.map(subfamily_map)\npspa_info['family'] = pspa_info.kinase.map(family_map)\npspa_info['group'] = pspa_info.kinase.map(group_map)\n\n\ndf=df.reset_index()\n\n\ndf.columns\n\nIndex(['index', '-5P', '-4P', '-3P', '-2P', '-1P', '0P', '1P', '2P', '3P',\n       ...\n       'T5_1014', 'T5_1015', 'T5_1016', 'T5_1017', 'T5_1018', 'T5_1019',\n       'T5_1020', 'T5_1021', 'T5_1022', 'T5_1023'],\n      dtype='object', length=1255)\n\n\n\n# column name of feature and target\nfeat_col = df.columns[df.columns.str.startswith('T5_')]\ntarget_col = df.columns[~df.columns.isin(feat_col)][1:]\n\n\nfeat_col\n\nIndex(['T5_0', 'T5_1', 'T5_2', 'T5_3', 'T5_4', 'T5_5', 'T5_6', 'T5_7', 'T5_8',\n       'T5_9',\n       ...\n       'T5_1014', 'T5_1015', 'T5_1016', 'T5_1017', 'T5_1018', 'T5_1019',\n       'T5_1020', 'T5_1021', 'T5_1022', 'T5_1023'],\n      dtype='object', length=1024)",
    "crumbs": [
      "kinase_domain",
      "DL training: Model comparison on T5 feature"
    ]
  },
  {
    "objectID": "kinase_domain/kd_05_pspa_training_model_comparison_all.html#split",
    "href": "kinase_domain/kd_05_pspa_training_model_comparison_all.html#split",
    "title": "DL training: Model comparison on T5 feature",
    "section": "Split",
    "text": "Split\n\npspa_info.subfamily.value_counts()\n\nsubfamily\nEph      12\nSrc      11\nNEK      10\nCK1       7\nSTE11     7\n         ..\nZAK       1\nSev       1\nRet       1\nMusk      1\nTie       1\nName: count, Length: 149, dtype: int64\n\n\n\npspa_info.family.value_counts()\n\nfamily\nSTE20    27\nCAMKL    20\nCDK      17\nMAPK     12\nEph      12\n         ..\nSTK33     1\nSev       1\nRet       1\nMusk      1\nTie       1\nName: count, Length: 92, dtype: int64\n\n\n\npspa_info.group.value_counts()\n\ngroup\nTK          78\nCAMK        57\nCMGC        52\nAGC         52\nOther       49\nSTE         39\nTKL         25\nCK1         11\nAtypical     5\nName: count, dtype: int64\n\n\n\nsplits = get_splits(pspa_info, group='group',nfold=9)\n\nsplit0 = splits[0]\n\nGroupKFold(n_splits=9, random_state=None, shuffle=False)\n# group in train set: 8\n# group in test set: 1",
    "crumbs": [
      "kinase_domain",
      "DL training: Model comparison on T5 feature"
    ]
  },
  {
    "objectID": "kinase_domain/kd_05_pspa_training_model_comparison_all.html#dataset",
    "href": "kinase_domain/kd_05_pspa_training_model_comparison_all.html#dataset",
    "title": "DL training: Model comparison on T5 feature",
    "section": "Dataset",
    "text": "Dataset\n\n# dataset\nds = GeneralDataset(df,feat_col,target_col)\n\n\nlen(ds)\n\n368\n\n\n\ndl = DataLoader(ds, batch_size=64, shuffle=True)\n\n\nxb,yb = next(iter(dl))\n\nxb.shape,yb.shape\n\n(torch.Size([64, 1024]), torch.Size([64, 23, 10]))",
    "crumbs": [
      "kinase_domain",
      "DL training: Model comparison on T5 feature"
    ]
  },
  {
    "objectID": "kinase_domain/kd_05_pspa_training_model_comparison_all.html#model",
    "href": "kinase_domain/kd_05_pspa_training_model_comparison_all.html#model",
    "title": "DL training: Model comparison on T5 feature",
    "section": "Model",
    "text": "Model\n\nn_feature = len(feat_col)\nn_target = len(target_col)\n\n\ndef get_mlp(): return PSSM_model(n_feature,n_target,model='MLP')\n\ndef get_cnn(): return PSSM_model(n_feature,n_target,model='CNN')\n\n\nmodel = get_mlp()\n\n\nlogits= model(xb)\n\n\nlogits.shape\n\ntorch.Size([64, 23, 10])",
    "crumbs": [
      "kinase_domain",
      "DL training: Model comparison on T5 feature"
    ]
  },
  {
    "objectID": "kinase_domain/kd_05_pspa_training_model_comparison_all.html#loss",
    "href": "kinase_domain/kd_05_pspa_training_model_comparison_all.html#loss",
    "title": "DL training: Model comparison on T5 feature",
    "section": "Loss",
    "text": "Loss\n\nCE(logits,yb)\n\ntensor(3.2301, grad_fn=&lt;MeanBackward0&gt;)",
    "crumbs": [
      "kinase_domain",
      "DL training: Model comparison on T5 feature"
    ]
  },
  {
    "objectID": "kinase_domain/kd_05_pspa_training_model_comparison_all.html#metrics",
    "href": "kinase_domain/kd_05_pspa_training_model_comparison_all.html#metrics",
    "title": "DL training: Model comparison on T5 feature",
    "section": "Metrics",
    "text": "Metrics\n\nKLD(logits,yb)\n\ntensor(0.4888, grad_fn=&lt;MeanBackward0&gt;)\n\n\n\nJSD(logits,yb)\n\ntensor(0.1021, grad_fn=&lt;MeanBackward0&gt;)",
    "crumbs": [
      "kinase_domain",
      "DL training: Model comparison on T5 feature"
    ]
  },
  {
    "objectID": "kinase_domain/kd_05_pspa_training_model_comparison_all.html#cv-train",
    "href": "kinase_domain/kd_05_pspa_training_model_comparison_all.html#cv-train",
    "title": "DL training: Model comparison on T5 feature",
    "section": "CV train",
    "text": "CV train\n\ncross-validation\n\n\noof_cnn = train_dl_cv(df,feat_col,target_col,\n                  splits = splits,\n                  model_func = get_cnn,\n                  n_epoch=20,lr=3e-3,save='cnn')\n\n------fold0------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.269060\n3.143546\n0.404985\n0.081564\n00:01\n\n\n1\n3.223662\n3.147182\n0.408622\n0.083544\n00:00\n\n\n2\n3.187536\n3.175212\n0.436651\n0.091066\n00:00\n\n\n3\n3.168146\n3.216301\n0.477740\n0.099706\n00:00\n\n\n4\n3.147557\n3.231566\n0.493005\n0.093356\n00:00\n\n\n5\n3.121749\n3.311443\n0.572882\n0.093714\n00:00\n\n\n6\n3.083850\n3.368428\n0.629867\n0.097433\n00:00\n\n\n7\n3.045823\n3.430662\n0.692102\n0.095945\n00:00\n\n\n8\n3.008982\n3.513947\n0.775385\n0.096181\n00:00\n\n\n9\n2.975007\n3.527397\n0.788837\n0.095878\n00:00\n\n\n10\n2.945746\n3.548940\n0.810379\n0.095623\n00:00\n\n\n11\n2.921519\n3.570338\n0.831777\n0.096343\n00:00\n\n\n12\n2.900580\n3.571254\n0.832693\n0.095262\n00:00\n\n\n13\n2.883183\n3.574004\n0.835444\n0.095764\n00:00\n\n\n14\n2.867993\n3.589709\n0.851148\n0.097328\n00:00\n\n\n15\n2.855134\n3.583238\n0.844677\n0.095302\n00:00\n\n\n16\n2.844318\n3.581508\n0.842947\n0.094802\n00:00\n\n\n17\n2.835052\n3.586241\n0.847680\n0.094904\n00:00\n\n\n18\n2.827313\n3.586015\n0.847454\n0.095045\n00:00\n\n\n19\n2.820956\n3.586493\n0.847932\n0.094981\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold1------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.208314\n3.117808\n0.358415\n0.079423\n00:00\n\n\n1\n3.091133\n2.973638\n0.214245\n0.053701\n00:00\n\n\n2\n3.022374\n2.917496\n0.158104\n0.037164\n00:00\n\n\n3\n2.980688\n2.889112\n0.129719\n0.030823\n00:00\n\n\n4\n2.959795\n2.898824\n0.139432\n0.033074\n00:00\n\n\n5\n2.940522\n2.883660\n0.124267\n0.029325\n00:00\n\n\n6\n2.921029\n2.878609\n0.119217\n0.028216\n00:00\n\n\n7\n2.902735\n2.869094\n0.109702\n0.025721\n00:00\n\n\n8\n2.887330\n2.868969\n0.109577\n0.025599\n00:00\n\n\n9\n2.873613\n2.872907\n0.113515\n0.026461\n00:00\n\n\n10\n2.860784\n2.872873\n0.113481\n0.026225\n00:00\n\n\n11\n2.849614\n2.868307\n0.108915\n0.025198\n00:00\n\n\n12\n2.839491\n2.873788\n0.114396\n0.026422\n00:00\n\n\n13\n2.830676\n2.868858\n0.109465\n0.025601\n00:00\n\n\n14\n2.823313\n2.874800\n0.115407\n0.026648\n00:00\n\n\n15\n2.816295\n2.866525\n0.107132\n0.024936\n00:00\n\n\n16\n2.810380\n2.870265\n0.110873\n0.025660\n00:00\n\n\n17\n2.805311\n2.869317\n0.109924\n0.025484\n00:00\n\n\n18\n2.800941\n2.868959\n0.109566\n0.025435\n00:00\n\n\n19\n2.797494\n2.870798\n0.111405\n0.025791\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold2------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.207323\n3.115180\n0.398577\n0.086718\n00:00\n\n\n1\n3.097981\n2.949997\n0.233394\n0.056430\n00:00\n\n\n2\n3.025096\n2.871349\n0.154746\n0.034154\n00:00\n\n\n3\n2.984505\n2.890811\n0.174208\n0.039029\n00:00\n\n\n4\n2.961992\n2.936154\n0.219550\n0.045950\n00:00\n\n\n5\n2.947332\n2.864819\n0.148216\n0.033121\n00:00\n\n\n6\n2.927917\n2.851729\n0.135126\n0.030623\n00:00\n\n\n7\n2.908772\n2.825195\n0.108592\n0.024916\n00:00\n\n\n8\n2.892562\n2.845464\n0.128861\n0.030083\n00:00\n\n\n9\n2.878802\n2.841273\n0.124670\n0.028827\n00:00\n\n\n10\n2.866316\n2.843637\n0.127034\n0.029812\n00:00\n\n\n11\n2.855637\n2.836118\n0.119515\n0.027748\n00:00\n\n\n12\n2.846589\n2.832935\n0.116332\n0.027080\n00:00\n\n\n13\n2.838424\n2.835726\n0.119123\n0.027565\n00:00\n\n\n14\n2.831281\n2.835740\n0.119137\n0.027858\n00:00\n\n\n15\n2.824760\n2.836478\n0.119874\n0.027920\n00:00\n\n\n16\n2.819135\n2.836669\n0.120066\n0.028054\n00:00\n\n\n17\n2.813901\n2.836018\n0.119414\n0.027880\n00:00\n\n\n18\n2.809481\n2.835162\n0.118558\n0.027623\n00:00\n\n\n19\n2.805690\n2.835153\n0.118550\n0.027605\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold3------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.212164\n3.133327\n0.442183\n0.092641\n00:00\n\n\n1\n3.106295\n3.004756\n0.313612\n0.071707\n00:00\n\n\n2\n3.031961\n2.913970\n0.222826\n0.046670\n00:00\n\n\n3\n2.991078\n2.910705\n0.219561\n0.044440\n00:00\n\n\n4\n2.967807\n2.932624\n0.241480\n0.047336\n00:00\n\n\n5\n2.950043\n2.920186\n0.229042\n0.044831\n00:00\n\n\n6\n2.930707\n2.924624\n0.233481\n0.044545\n00:00\n\n\n7\n2.912056\n2.924119\n0.232976\n0.046182\n00:00\n\n\n8\n2.895589\n2.927319\n0.236175\n0.045777\n00:00\n\n\n9\n2.881679\n2.944932\n0.253788\n0.049072\n00:00\n\n\n10\n2.874621\n2.918363\n0.227219\n0.043250\n00:01\n\n\n11\n2.865599\n2.937680\n0.246536\n0.045307\n00:00\n\n\n12\n2.855621\n2.941553\n0.250409\n0.047418\n00:00\n\n\n13\n2.847044\n2.929435\n0.238291\n0.046189\n00:00\n\n\n14\n2.839755\n2.940788\n0.249644\n0.047378\n00:00\n\n\n15\n2.832605\n2.935419\n0.244275\n0.045755\n00:00\n\n\n16\n2.827509\n2.936834\n0.245690\n0.046259\n00:00\n\n\n17\n2.821800\n2.936816\n0.245672\n0.046310\n00:00\n\n\n18\n2.817129\n2.936852\n0.245708\n0.046441\n00:00\n\n\n19\n2.812903\n2.936368\n0.245224\n0.046412\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold4------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.194703\n3.130977\n0.341532\n0.074929\n00:00\n\n\n1\n3.085588\n2.979797\n0.190353\n0.049329\n00:00\n\n\n2\n3.013181\n2.915592\n0.126147\n0.030893\n00:00\n\n\n3\n2.973877\n2.928494\n0.139050\n0.034132\n00:00\n\n\n4\n2.948701\n2.913154\n0.123709\n0.029253\n00:00\n\n\n5\n2.930085\n2.901232\n0.111787\n0.026251\n00:00\n\n\n6\n2.916653\n2.904090\n0.114645\n0.026807\n00:00\n\n\n7\n2.899753\n2.907431\n0.117986\n0.027358\n00:00\n\n\n8\n2.883612\n2.907530\n0.118085\n0.027281\n00:00\n\n\n9\n2.868085\n2.901319\n0.111874\n0.025705\n00:00\n\n\n10\n2.853968\n2.900857\n0.111413\n0.025969\n00:00\n\n\n11\n2.842516\n2.899069\n0.109624\n0.025252\n00:00\n\n\n12\n2.832248\n2.896469\n0.107024\n0.024881\n00:00\n\n\n13\n2.823528\n2.895822\n0.106378\n0.024758\n-1:59:59\n\n\n14\n2.815598\n2.892243\n0.102798\n0.023783\n00:00\n\n\n15\n2.809208\n2.894634\n0.105189\n0.024339\n00:00\n\n\n16\n2.803236\n2.895056\n0.105612\n0.024392\n00:00\n\n\n17\n2.798623\n2.894188\n0.104743\n0.024226\n00:00\n\n\n18\n2.794693\n2.894770\n0.105325\n0.024397\n00:00\n\n\n19\n2.790938\n2.894322\n0.104877\n0.024302\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold5------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.199997\n3.129761\n0.340951\n0.074561\n00:00\n\n\n1\n3.075929\n2.966693\n0.177883\n0.046553\n00:00\n\n\n2\n3.002883\n2.903497\n0.114686\n0.028490\n00:00\n\n\n3\n2.964937\n2.902469\n0.113658\n0.027166\n00:00\n\n\n4\n2.942972\n2.900843\n0.112033\n0.027254\n00:00\n\n\n5\n2.928877\n2.899299\n0.110489\n0.027179\n00:00\n\n\n6\n2.910979\n2.892999\n0.104189\n0.025580\n00:00\n\n\n7\n2.892474\n2.903407\n0.114597\n0.027419\n00:00\n\n\n8\n2.876405\n2.880818\n0.092008\n0.022334\n00:00\n\n\n9\n2.861168\n2.885040\n0.096230\n0.023397\n00:00\n\n\n10\n2.848615\n2.875726\n0.086915\n0.021212\n00:00\n\n\n11\n2.838090\n2.879966\n0.091155\n0.021947\n00:00\n\n\n12\n2.829193\n2.876115\n0.087305\n0.021194\n00:00\n\n\n13\n2.820646\n2.882905\n0.094094\n0.023022\n00:00\n\n\n14\n2.813677\n2.882934\n0.094123\n0.022730\n00:00\n\n\n15\n2.807501\n2.883899\n0.095089\n0.023176\n00:00\n\n\n16\n2.801921\n2.882332\n0.093521\n0.022763\n00:00\n\n\n17\n2.797628\n2.881665\n0.092854\n0.022552\n00:00\n\n\n18\n2.793886\n2.882133\n0.093322\n0.022644\n00:01\n\n\n19\n2.790486\n2.881597\n0.092787\n0.022498\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold6------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.194320\n3.125801\n0.310535\n0.070329\n00:00\n\n\n1\n3.076676\n2.948623\n0.133357\n0.035381\n00:00\n\n\n2\n3.005836\n2.954429\n0.139163\n0.032063\n00:00\n\n\n3\n2.967523\n2.950755\n0.135489\n0.031137\n00:00\n\n\n4\n2.949190\n2.935955\n0.120688\n0.028899\n00:00\n\n\n5\n2.929599\n2.925230\n0.109964\n0.024822\n00:00\n\n\n6\n2.909208\n2.916939\n0.101673\n0.023810\n00:00\n\n\n7\n2.889302\n2.964673\n0.149406\n0.034152\n00:00\n\n\n8\n2.872472\n3.053467\n0.238200\n0.041788\n00:00\n\n\n9\n2.857490\n3.030991\n0.215725\n0.038701\n00:00\n\n\n10\n2.845153\n3.009413\n0.194146\n0.038094\n00:00\n\n\n11\n2.834631\n3.039492\n0.224225\n0.040353\n00:00\n\n\n12\n2.826049\n2.916903\n0.101637\n0.023530\n00:00\n\n\n13\n2.818126\n2.911845\n0.096579\n0.022495\n00:00\n\n\n14\n2.811524\n2.914006\n0.098740\n0.023023\n00:00\n\n\n15\n2.805404\n2.909503\n0.094237\n0.022106\n00:00\n\n\n16\n2.800207\n2.909804\n0.094538\n0.022054\n00:00\n\n\n17\n2.796073\n2.910941\n0.095674\n0.022245\n00:00\n\n\n18\n2.792119\n2.911169\n0.095903\n0.022274\n00:00\n\n\n19\n2.788670\n2.910234\n0.094968\n0.022100\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold7------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.193444\n3.132987\n0.470942\n0.100316\n00:00\n\n\n1\n3.075158\n2.953928\n0.291882\n0.064369\n00:00\n\n\n2\n3.004199\n2.975640\n0.313595\n0.064038\n00:00\n\n\n3\n2.964350\n3.090348\n0.428302\n0.083974\n00:00\n\n\n4\n2.943624\n3.035332\n0.373287\n0.070942\n00:00\n\n\n5\n2.922046\n2.968457\n0.306412\n0.065235\n00:00\n\n\n6\n2.901327\n2.954379\n0.292333\n0.065219\n-1:59:59\n\n\n7\n2.882046\n2.925243\n0.263198\n0.060871\n00:00\n\n\n8\n2.866063\n2.936579\n0.274533\n0.064218\n00:00\n\n\n9\n2.852979\n2.945917\n0.283871\n0.062147\n00:00\n\n\n10\n2.841709\n2.916834\n0.254789\n0.060364\n00:00\n\n\n11\n2.832586\n2.954140\n0.292095\n0.063815\n00:00\n\n\n12\n2.824114\n2.961896\n0.299851\n0.067524\n00:00\n\n\n13\n2.816724\n2.930872\n0.268827\n0.059107\n00:00\n\n\n14\n2.810433\n2.924781\n0.262736\n0.060047\n00:00\n\n\n15\n2.805051\n2.928467\n0.266421\n0.059658\n00:00\n\n\n16\n2.800364\n2.932495\n0.270450\n0.060461\n00:00\n\n\n17\n2.796210\n2.934587\n0.272542\n0.060946\n00:00\n\n\n18\n2.793103\n2.929379\n0.267334\n0.060319\n00:00\n\n\n19\n2.790570\n2.931830\n0.269785\n0.060809\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold8------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.204390\n3.128783\n0.330651\n0.071957\n00:00\n\n\n1\n3.082807\n2.936002\n0.137870\n0.031859\n00:00\n\n\n2\n3.005090\n2.969775\n0.171644\n0.036953\n00:00\n\n\n3\n2.965562\n2.997628\n0.199497\n0.044284\n00:00\n\n\n4\n2.942865\n2.932713\n0.134581\n0.028845\n00:00\n\n\n5\n2.922158\n2.932485\n0.134353\n0.029581\n00:00\n\n\n6\n2.903975\n2.920239\n0.122107\n0.026156\n00:00\n\n\n7\n2.885199\n2.901689\n0.103558\n0.022120\n00:00\n\n\n8\n2.868658\n2.909636\n0.111505\n0.023997\n00:00\n\n\n9\n2.854479\n2.915422\n0.117290\n0.025359\n00:00\n\n\n10\n2.842377\n2.908000\n0.109868\n0.023234\n00:00\n\n\n11\n2.833321\n2.904814\n0.106682\n0.023166\n00:00\n\n\n12\n2.824632\n2.907447\n0.109316\n0.024112\n00:00\n\n\n13\n2.817395\n2.901404\n0.103273\n0.022250\n00:00\n\n\n14\n2.811185\n2.907396\n0.109264\n0.023505\n00:00\n\n\n15\n2.805175\n2.903952\n0.105820\n0.022850\n00:00\n\n\n16\n2.799963\n2.907275\n0.109143\n0.023509\n00:00\n\n\n17\n2.795720\n2.908115\n0.109983\n0.023676\n00:00\n\n\n18\n2.792551\n2.907698\n0.109566\n0.023603\n00:00\n\n\n19\n2.790073\n2.907019\n0.108887\n0.023489\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n\noof_mlp = train_dl_cv(df,feat_col,target_col,\n                  splits = splits,\n                  model_func = get_mlp,\n                  n_epoch=20,lr=3e-3,save='mlp')\n\n------fold0------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.171476\n3.139420\n0.400859\n0.080985\n00:00\n\n\n1\n3.106711\n3.147713\n0.409152\n0.082218\n00:00\n\n\n2\n3.038125\n3.160561\n0.422000\n0.083707\n00:00\n\n\n3\n2.976095\n3.189467\n0.450906\n0.085103\n00:00\n\n\n4\n2.928933\n3.253317\n0.514757\n0.087918\n00:00\n\n\n5\n2.895859\n3.290741\n0.552180\n0.087818\n00:00\n\n\n6\n2.871152\n3.370811\n0.632249\n0.091517\n00:00\n\n\n7\n2.852960\n3.411198\n0.672637\n0.090949\n00:00\n\n\n8\n2.838817\n3.496814\n0.758253\n0.091359\n00:00\n\n\n9\n2.827737\n3.521644\n0.783083\n0.093565\n00:00\n\n\n10\n2.818174\n3.498032\n0.759471\n0.093064\n00:00\n\n\n11\n2.810489\n3.504961\n0.766400\n0.094115\n00:00\n\n\n12\n2.803670\n3.508696\n0.770135\n0.092760\n00:00\n\n\n13\n2.797866\n3.541964\n0.803403\n0.094965\n00:00\n\n\n14\n2.792816\n3.547325\n0.808764\n0.094005\n00:00\n\n\n15\n2.788567\n3.548905\n0.810344\n0.094359\n00:00\n\n\n16\n2.784840\n3.552236\n0.813675\n0.094531\n00:00\n\n\n17\n2.781688\n3.556740\n0.818179\n0.094105\n00:00\n\n\n18\n2.779126\n3.557160\n0.818599\n0.094202\n00:00\n\n\n19\n2.776936\n3.562564\n0.824003\n0.094342\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold1------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.138040\n3.135045\n0.375653\n0.082271\n00:00\n\n\n1\n3.054276\n3.113542\n0.354149\n0.079574\n00:00\n\n\n2\n2.989687\n3.048094\n0.288702\n0.069778\n00:00\n\n\n3\n2.937330\n2.952537\n0.193145\n0.050103\n-1:59:59\n\n\n4\n2.901045\n2.872171\n0.112778\n0.028355\n00:00\n\n\n5\n2.875492\n2.863093\n0.103700\n0.025160\n00:00\n\n\n6\n2.856277\n2.865705\n0.106313\n0.025039\n00:00\n\n\n7\n2.840961\n2.864216\n0.104823\n0.024369\n00:00\n\n\n8\n2.829274\n2.864235\n0.104842\n0.024402\n00:00\n\n\n9\n2.820478\n2.877947\n0.118554\n0.027575\n00:00\n\n\n10\n2.812226\n2.873299\n0.113906\n0.026126\n00:00\n\n\n11\n2.806044\n2.869767\n0.110374\n0.025534\n00:00\n\n\n12\n2.800019\n2.872890\n0.113498\n0.026378\n00:00\n\n\n13\n2.794942\n2.871101\n0.111708\n0.025842\n00:00\n\n\n14\n2.790824\n2.871950\n0.112557\n0.025829\n00:00\n\n\n15\n2.786819\n2.872271\n0.112878\n0.025944\n00:00\n\n\n16\n2.783419\n2.869001\n0.109609\n0.025354\n00:00\n\n\n17\n2.780620\n2.871257\n0.111865\n0.025823\n00:00\n\n\n18\n2.778407\n2.871228\n0.111836\n0.025827\n00:00\n\n\n19\n2.776483\n2.869788\n0.110395\n0.025548\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold2------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.132754\n3.134609\n0.418006\n0.089472\n00:00\n\n\n1\n3.046801\n3.113223\n0.396620\n0.086776\n00:00\n\n\n2\n2.980770\n3.055556\n0.338953\n0.078529\n00:00\n\n\n3\n2.932360\n2.969013\n0.252410\n0.062473\n00:00\n\n\n4\n2.899219\n2.899032\n0.182429\n0.046023\n00:00\n\n\n5\n2.875994\n2.873559\n0.156956\n0.038564\n00:00\n\n\n6\n2.858054\n2.845880\n0.129277\n0.030850\n00:00\n\n\n7\n2.844874\n2.827710\n0.111107\n0.026074\n00:00\n\n\n8\n2.834472\n2.832326\n0.115723\n0.026925\n00:00\n\n\n9\n2.826840\n2.842240\n0.125637\n0.030043\n00:00\n\n\n10\n2.819004\n2.836573\n0.119970\n0.027737\n00:00\n\n\n11\n2.812238\n2.861251\n0.144647\n0.033234\n00:00\n\n\n12\n2.806651\n2.852784\n0.136180\n0.031518\n00:00\n\n\n13\n2.801448\n2.847494\n0.130891\n0.030155\n00:00\n\n\n14\n2.796698\n2.846005\n0.129401\n0.029958\n00:00\n\n\n15\n2.792893\n2.848514\n0.131910\n0.030794\n00:00\n\n\n16\n2.789678\n2.848055\n0.131452\n0.030317\n00:00\n\n\n17\n2.786758\n2.846974\n0.130371\n0.030086\n00:00\n\n\n18\n2.784590\n2.847528\n0.130925\n0.030296\n00:00\n\n\n19\n2.782532\n2.848963\n0.132360\n0.030637\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold3------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.123281\n3.132412\n0.441268\n0.092814\n00:00\n\n\n1\n3.042101\n3.114030\n0.422886\n0.090477\n00:00\n\n\n2\n2.979384\n3.074581\n0.383437\n0.084360\n00:00\n\n\n3\n2.931671\n3.003192\n0.312048\n0.069243\n00:00\n\n\n4\n2.900101\n2.941841\n0.250698\n0.052327\n00:00\n\n\n5\n2.877186\n2.922068\n0.230924\n0.046006\n00:00\n\n\n6\n2.860131\n2.931553\n0.240410\n0.046516\n00:00\n\n\n7\n2.847045\n2.928376\n0.237232\n0.045358\n00:00\n\n\n8\n2.836282\n2.931814\n0.240670\n0.045169\n00:00\n\n\n9\n2.827431\n2.939419\n0.248275\n0.048628\n00:00\n\n\n10\n2.819919\n2.932438\n0.241294\n0.046815\n00:00\n\n\n11\n2.814036\n2.933811\n0.242668\n0.046418\n00:00\n\n\n12\n2.808680\n2.934338\n0.243194\n0.046852\n00:00\n\n\n13\n2.804248\n2.950339\n0.259195\n0.049754\n00:00\n\n\n14\n2.799972\n2.938487\n0.247343\n0.046829\n00:00\n\n\n15\n2.796435\n2.941572\n0.250429\n0.048000\n00:00\n\n\n16\n2.793111\n2.947199\n0.256055\n0.048709\n00:00\n\n\n17\n2.790409\n2.951463\n0.260319\n0.049281\n00:00\n\n\n18\n2.788168\n2.950207\n0.259063\n0.049058\n00:00\n\n\n19\n2.786237\n2.950060\n0.258915\n0.049077\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold4------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.124104\n3.134452\n0.345007\n0.075167\n00:00\n\n\n1\n3.038496\n3.111592\n0.322147\n0.072473\n00:00\n\n\n2\n2.970284\n3.048591\n0.259146\n0.063065\n00:00\n\n\n3\n2.920771\n2.958019\n0.168574\n0.043953\n00:00\n\n\n4\n2.887409\n2.898182\n0.108737\n0.026950\n00:00\n\n\n5\n2.863338\n2.887498\n0.098053\n0.023644\n00:00\n\n\n6\n2.845474\n2.888538\n0.099093\n0.023433\n-1:59:59\n\n\n7\n2.831556\n2.886909\n0.097465\n0.022886\n00:00\n\n\n8\n2.819985\n2.892709\n0.103265\n0.024001\n00:00\n\n\n9\n2.810792\n2.892037\n0.102592\n0.023989\n00:00\n\n\n10\n2.803365\n2.895198\n0.105753\n0.024882\n00:00\n\n\n11\n2.797357\n2.895902\n0.106458\n0.024947\n00:00\n\n\n12\n2.792247\n2.894876\n0.105431\n0.024678\n00:00\n\n\n13\n2.787674\n2.896597\n0.107152\n0.025046\n00:00\n\n\n14\n2.783528\n2.894453\n0.105008\n0.024469\n00:00\n\n\n15\n2.780488\n2.896704\n0.107260\n0.025280\n00:00\n\n\n16\n2.777241\n2.896692\n0.107246\n0.025114\n00:00\n\n\n17\n2.774627\n2.895978\n0.106533\n0.024936\n00:00\n\n\n18\n2.772030\n2.896508\n0.107063\n0.025073\n00:00\n\n\n19\n2.770392\n2.896650\n0.107205\n0.025118\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold5------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.140697\n3.135143\n0.346332\n0.075070\n00:00\n\n\n1\n3.048342\n3.119731\n0.330921\n0.073235\n00:00\n\n\n2\n2.979255\n3.078922\n0.290112\n0.067775\n00:00\n\n\n3\n2.929077\n2.995795\n0.206985\n0.052510\n00:00\n\n\n4\n2.893279\n2.975678\n0.186867\n0.047241\n00:00\n\n\n5\n2.868217\n2.886815\n0.098004\n0.024602\n00:00\n\n\n6\n2.849210\n2.916328\n0.127518\n0.032733\n00:00\n\n\n7\n2.835844\n2.884094\n0.095283\n0.024124\n00:00\n\n\n8\n2.824802\n2.893069\n0.104259\n0.026342\n00:00\n\n\n9\n2.815038\n2.909672\n0.120861\n0.030394\n00:00\n\n\n10\n2.806904\n2.879725\n0.090915\n0.022690\n00:00\n\n\n11\n2.800042\n2.910357\n0.121546\n0.030322\n00:00\n\n\n12\n2.794713\n2.887380\n0.098570\n0.024505\n00:00\n\n\n13\n2.789812\n2.891015\n0.102204\n0.025047\n00:00\n\n\n14\n2.785572\n2.883691\n0.094881\n0.023556\n00:00\n\n\n15\n2.781896\n2.886951\n0.098140\n0.024198\n00:00\n\n\n16\n2.778671\n2.888133\n0.099322\n0.024640\n00:00\n\n\n17\n2.775967\n2.890878\n0.102068\n0.025343\n00:00\n\n\n18\n2.773479\n2.889570\n0.100760\n0.025070\n00:00\n\n\n19\n2.771580\n2.886280\n0.097469\n0.024140\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold6------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.125239\n3.143044\n0.327779\n0.072367\n00:00\n\n\n1\n3.036369\n3.146004\n0.330738\n0.072551\n00:00\n\n\n2\n2.969717\n3.142249\n0.326984\n0.071680\n00:00\n\n\n3\n2.921383\n3.125622\n0.310355\n0.069347\n00:00\n\n\n4\n2.886705\n3.119030\n0.303763\n0.067855\n00:00\n\n\n5\n2.863236\n3.150701\n0.335435\n0.069734\n00:00\n\n\n6\n2.846394\n3.105358\n0.290092\n0.062999\n00:00\n\n\n7\n2.833611\n3.020862\n0.205596\n0.049413\n00:00\n\n\n8\n2.822827\n3.081616\n0.266349\n0.058375\n00:00\n\n\n9\n2.814345\n3.046980\n0.231714\n0.052382\n00:00\n\n\n10\n2.806578\n3.069500\n0.254234\n0.056023\n00:00\n\n\n11\n2.800230\n3.049825\n0.234558\n0.052775\n00:00\n\n\n12\n2.794504\n3.000489\n0.185223\n0.044598\n00:00\n\n\n13\n2.790055\n3.022670\n0.207403\n0.048725\n00:00\n\n\n14\n2.786135\n3.001585\n0.186319\n0.044600\n00:00\n\n\n15\n2.782260\n2.999725\n0.184458\n0.044126\n00:00\n\n\n16\n2.778924\n2.977914\n0.162648\n0.039644\n00:00\n\n\n17\n2.775975\n2.984549\n0.169282\n0.041061\n00:00\n\n\n18\n2.773758\n2.973586\n0.158320\n0.038846\n00:00\n\n\n19\n2.772370\n2.993045\n0.177778\n0.042562\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold7------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.110090\n3.133375\n0.471330\n0.100618\n00:00\n\n\n1\n3.027103\n3.102594\n0.440548\n0.096998\n00:00\n\n\n2\n2.965780\n3.024230\n0.362184\n0.084081\n00:00\n\n\n3\n2.917700\n2.935767\n0.273722\n0.061535\n00:00\n\n\n4\n2.885562\n2.921035\n0.258990\n0.056032\n00:00\n\n\n5\n2.862646\n2.910833\n0.248788\n0.054900\n00:00\n\n\n6\n2.845487\n2.937936\n0.275890\n0.060785\n00:00\n\n\n7\n2.832792\n2.922657\n0.260612\n0.060340\n-1:59:59\n\n\n8\n2.822367\n2.944104\n0.282059\n0.066009\n00:00\n\n\n9\n2.813707\n2.972666\n0.310620\n0.072871\n00:00\n\n\n10\n2.806854\n2.938702\n0.276657\n0.063607\n00:00\n\n\n11\n2.800919\n2.948178\n0.286132\n0.065069\n00:00\n\n\n12\n2.795901\n2.972046\n0.310001\n0.071711\n00:00\n\n\n13\n2.791595\n2.929130\n0.267085\n0.062957\n00:00\n\n\n14\n2.787729\n2.940015\n0.277970\n0.065189\n00:00\n\n\n15\n2.784400\n2.937132\n0.275087\n0.064643\n00:00\n\n\n16\n2.781541\n2.944604\n0.282559\n0.066189\n00:00\n\n\n17\n2.779098\n2.947384\n0.285339\n0.066931\n00:00\n\n\n18\n2.777092\n2.944833\n0.282787\n0.066404\n00:00\n\n\n19\n2.775365\n2.944260\n0.282215\n0.066229\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold8------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.140649\n3.132743\n0.334611\n0.072549\n00:00\n\n\n1\n3.045759\n3.118004\n0.319872\n0.070753\n00:00\n\n\n2\n2.977565\n3.083817\n0.285685\n0.065886\n00:00\n\n\n3\n2.924772\n3.019604\n0.221472\n0.054484\n00:00\n\n\n4\n2.889525\n3.027496\n0.229364\n0.055167\n00:00\n\n\n5\n2.864700\n3.021855\n0.223723\n0.052769\n00:00\n\n\n6\n2.847138\n3.056512\n0.258381\n0.059230\n00:00\n\n\n7\n2.833452\n3.042546\n0.244414\n0.056720\n00:00\n\n\n8\n2.822788\n3.159932\n0.361800\n0.073176\n00:00\n\n\n9\n2.814126\n3.136939\n0.338808\n0.071001\n00:00\n\n\n10\n2.806904\n3.083386\n0.285255\n0.064539\n00:00\n\n\n11\n2.800378\n3.071976\n0.273845\n0.062171\n00:00\n\n\n12\n2.794891\n3.084828\n0.286697\n0.064775\n00:00\n\n\n13\n2.790077\n3.075835\n0.277704\n0.062719\n00:00\n\n\n14\n2.785990\n3.074905\n0.276773\n0.062855\n00:00\n\n\n15\n2.782810\n3.051820\n0.253688\n0.058684\n00:00\n\n\n16\n2.779867\n3.048082\n0.249950\n0.057938\n00:00\n\n\n17\n2.777103\n3.049922\n0.251790\n0.058291\n00:00\n\n\n18\n2.775033\n3.048445\n0.250313\n0.058125\n00:00\n\n\n19\n2.773071\n3.064700\n0.266568\n0.061091\n00:00",
    "crumbs": [
      "kinase_domain",
      "DL training: Model comparison on T5 feature"
    ]
  },
  {
    "objectID": "kinase_domain/kd_05_pspa_training_model_comparison_all.html#ml",
    "href": "kinase_domain/kd_05_pspa_training_model_comparison_all.html#ml",
    "title": "DL training: Model comparison on T5 feature",
    "section": "ML",
    "text": "ML\n\nfrom sklearn.neighbors import *\nfrom sklearn.linear_model import *\nfrom sklearn.tree import *\nfrom sklearn.svm import *\nfrom sklearn.ensemble import *\nfrom sklearn.multioutput import MultiOutputRegressor\n\n\nml_models = {\n    'LinearRegression': LinearRegression(),\n    'Lasso': Lasso(0.1), # L1 regularization # changing alpha does not change the result\n    'Ridge': Ridge(alpha=0.1), # L2 regularization\n    'ElasticNet': ElasticNet(0.1), # Combine L1 and L2\n    \n    # 'SVR':SVR(C=10,gamma=1),\n    'DecisionTreeRegressor': DecisionTreeRegressor(), # not very good\n    'KNN': KNeighborsRegressor(n_neighbors=3), # compared with others, n=3 gives the best results\n    # 'XGBRegressor': XGBRegressor(), #slow without gpu\n    # 'RandomForestRegressor': RandomForestRegressor() # slow, use cuml to use gpu\n                                      }\n\n\noofs_ml = {}\n\n\nfor name,model in ml_models.items():\n    oofs_ml[name] = train_ml_cv(df, feat_col, target_col, splits, model)\n\n/home/sky1ove/git/katlas/.venv/lib/python3.11/site-packages/logomaker/../sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 0.000e+00, tolerance: 0.000e+00\n  model = cd_fast.enet_coordinate_descent(\n/home/sky1ove/git/katlas/.venv/lib/python3.11/site-packages/logomaker/../sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 0.000e+00, tolerance: 0.000e+00\n  model = cd_fast.enet_coordinate_descent(\n/home/sky1ove/git/katlas/.venv/lib/python3.11/site-packages/logomaker/../sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 0.000e+00, tolerance: 0.000e+00\n  model = cd_fast.enet_coordinate_descent(\n/home/sky1ove/git/katlas/.venv/lib/python3.11/site-packages/logomaker/../sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 0.000e+00, tolerance: 0.000e+00\n  model = cd_fast.enet_coordinate_descent(\n/home/sky1ove/git/katlas/.venv/lib/python3.11/site-packages/logomaker/../sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 0.000e+00, tolerance: 0.000e+00\n  model = cd_fast.enet_coordinate_descent(\n/home/sky1ove/git/katlas/.venv/lib/python3.11/site-packages/logomaker/../sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 0.000e+00, tolerance: 0.000e+00\n  model = cd_fast.enet_coordinate_descent(\n/home/sky1ove/git/katlas/.venv/lib/python3.11/site-packages/logomaker/../sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 0.000e+00, tolerance: 0.000e+00\n  model = cd_fast.enet_coordinate_descent(\n/home/sky1ove/git/katlas/.venv/lib/python3.11/site-packages/logomaker/../sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 0.000e+00, tolerance: 0.000e+00\n  model = cd_fast.enet_coordinate_descent(\n/home/sky1ove/git/katlas/.venv/lib/python3.11/site-packages/logomaker/../sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 0.000e+00, tolerance: 0.000e+00\n  model = cd_fast.enet_coordinate_descent(\n/home/sky1ove/git/katlas/.venv/lib/python3.11/site-packages/logomaker/../sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 0.000e+00, tolerance: 0.000e+00\n  model = cd_fast.enet_coordinate_descent(\n/home/sky1ove/git/katlas/.venv/lib/python3.11/site-packages/logomaker/../sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 0.000e+00, tolerance: 0.000e+00\n  model = cd_fast.enet_coordinate_descent(\n/home/sky1ove/git/katlas/.venv/lib/python3.11/site-packages/logomaker/../sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 0.000e+00, tolerance: 0.000e+00\n  model = cd_fast.enet_coordinate_descent(\n/home/sky1ove/git/katlas/.venv/lib/python3.11/site-packages/logomaker/../sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 0.000e+00, tolerance: 0.000e+00\n  model = cd_fast.enet_coordinate_descent(\n/home/sky1ove/git/katlas/.venv/lib/python3.11/site-packages/logomaker/../sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 0.000e+00, tolerance: 0.000e+00\n  model = cd_fast.enet_coordinate_descent(\n/home/sky1ove/git/katlas/.venv/lib/python3.11/site-packages/logomaker/../sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 0.000e+00, tolerance: 0.000e+00\n  model = cd_fast.enet_coordinate_descent(\n/home/sky1ove/git/katlas/.venv/lib/python3.11/site-packages/logomaker/../sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 0.000e+00, tolerance: 0.000e+00\n  model = cd_fast.enet_coordinate_descent(\n/home/sky1ove/git/katlas/.venv/lib/python3.11/site-packages/logomaker/../sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 0.000e+00, tolerance: 0.000e+00\n  model = cd_fast.enet_coordinate_descent(\n/home/sky1ove/git/katlas/.venv/lib/python3.11/site-packages/logomaker/../sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 0.000e+00, tolerance: 0.000e+00\n  model = cd_fast.enet_coordinate_descent(",
    "crumbs": [
      "kinase_domain",
      "DL training: Model comparison on T5 feature"
    ]
  },
  {
    "objectID": "kinase_domain/kd_05_pspa_training_model_comparison_all.html#score",
    "href": "kinase_domain/kd_05_pspa_training_model_comparison_all.html#score",
    "title": "DL training: Model comparison on T5 feature",
    "section": "Score",
    "text": "Score\n\ntarget=df[target_col].copy()\n\n\npspa_info['split'] = oof_cnn.nfold\n\n\npspa_info['MLP'] =get_score_jsd(target,oof_mlp)\npspa_info['CNN'] =get_score_jsd(target,oof_cnn)\n\n\nfrom tqdm import tqdm\nfrom katlas.pssm import *\n\n\ndef post_process_oof(oof_ml,target_col):\n    oof = oof_ml.copy()\n    oof[target_col] = oof.apply(lambda r: pd.Series(flatten_pssm(post_process(recover_pssm(r[target_col])),column_wise=False)), axis=1)\n    return oof\n\n\nfor name,oof in tqdm(oofs_ml.items()):\n    oof = post_process_oof(oof,target_col)\n    pspa_info[name] = get_score_jsd(target,oof)\n\n100%|████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:24&lt;00:00,  4.08s/it]\n\n\n\nfrom katlas.plot import *\n\n\nset_sns()\n\n\npspa_info\n\n\n\n\n\n\n\n\nkinase\nsubfamily\nfamily\ngroup\nsplit\nMLP\nCNN\nLinearRegression\nLasso\nRidge\nElasticNet\nDecisionTreeRegressor\nKNN\n\n\n\n\n0\nQ2M2I8_AAK1_HUMAN_KD1\nNAK\nNAK\nOther\n4\n0.048600\n0.050542\n0.098876\n0.067539\n0.056838\n0.067539\n0.083130\n0.048014\n\n\n1\nP27037_AVR2A_HUMAN_KD1\nSTKR2\nSTKR\nTKL\n6\n0.044587\n0.029185\n0.088647\n0.037442\n0.040927\n0.037442\n0.110160\n0.095125\n\n\n2\nQ13705_AVR2B_HUMAN_KD1\nSTKR2\nSTKR\nTKL\n6\n0.043153\n0.034765\n0.086192\n0.039007\n0.042801\n0.039007\n0.111369\n0.093459\n\n\n3\nP31749_AKT1_HUMAN_KD1\nAkt\nAkt\nAGC\n2\n0.023194\n0.022999\n0.084334\n0.042558\n0.039124\n0.042558\n0.055568\n0.068775\n\n\n4\nP31751_AKT2_HUMAN_KD1\nAkt\nAkt\nAGC\n2\n0.015898\n0.014478\n0.067616\n0.038013\n0.031472\n0.038013\n0.041074\n0.040728\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\n363\nP17948_VGFR1_HUMAN_KD1\nVEGFR\nVEGFR\nTK\n0\n0.089577\n0.088227\n0.150470\n0.095850\n0.107327\n0.095850\n0.100689\n0.088376\n\n\n364\nP35968_VGFR2_HUMAN_KD1\nVEGFR\nVEGFR\nTK\n0\n0.085835\n0.086581\n0.161182\n0.088967\n0.099599\n0.088967\n0.108746\n0.085550\n\n\n365\nP35916_VGFR3_HUMAN_KD1\nVEGFR\nVEGFR\nTK\n0\n0.088425\n0.088291\n0.170160\n0.092814\n0.109089\n0.092814\n0.093069\n0.095619\n\n\n366\nP07947_YES_HUMAN_KD1\nSrc\nSrc\nTK\n0\n0.095206\n0.094565\n0.127592\n0.093916\n0.103253\n0.093916\n0.100129\n0.094951\n\n\n367\nP43403_ZAP70_HUMAN_KD1\nSyk\nSyk\nTK\n0\n0.122080\n0.125690\n0.149385\n0.133662\n0.125509\n0.133662\n0.130504\n0.126143\n\n\n\n\n368 rows × 13 columns\n\n\n\n\npspa_info.columns\n\nIndex(['kinase', 'subfamily', 'family', 'group', 'split', 'MLP', 'CNN',\n       'LinearRegression', 'Lasso', 'Ridge', 'ElasticNet',\n       'DecisionTreeRegressor', 'KNN'],\n      dtype='object')\n\n\n\nmodel_list = ['MLP','CNN']+list(ml_models.keys())\n\n\nordered_list = pspa_info[model_list].mean().sort_values(ascending=False).index\nordered_list\n\nIndex(['LinearRegression', 'DecisionTreeRegressor', 'KNN', 'Ridge', 'Lasso',\n       'ElasticNet', 'MLP', 'CNN'],\n      dtype='object')\n\n\n\ndef plot_group_bar(df, \n                   value_cols,  # list of column names for values, the order depends on the first item\n                   group,       # column name of group (e.g., 'kinase')\n                   figsize=(12, 5),\n                   order=None,\n                   title=None,\n                   fontsize=14,\n                   rotation=90,\n                   **kwargs):\n    \n    \" Plot grouped bar graph from dataframe. \"\n\n    # Prepare the dataframe for plotting\n    # Melt the dataframe to go from wide to long format\n    df_melted = df.melt(id_vars=group, value_vars=value_cols, var_name='Ranking', value_name='Value')\n\n    plt.figure(figsize=figsize)\n    \n    # Create the bar plot\n    sns.barplot(data=df_melted, \n                x=group, \n                y='Value', \n                hue='Ranking', \n                order=order, \n                capsize=0.1,\n                err_kws={'linewidth': 1.5,'color': 'gray'}, \n                **kwargs)\n    \n    # Increase font size for the x-axis and y-axis tick labels\n    plt.tick_params(axis='x', labelsize=fontsize)  # Increase x-axis label size\n    plt.tick_params(axis='y', labelsize=fontsize)  # Increase y-axis label size\n    \n    # Modify x and y label and increase font size\n    plt.xlabel('', fontsize=fontsize)\n    plt.ylabel('Value', fontsize=fontsize)\n    \n    # Rotate X labels\n    plt.xticks(rotation=rotation)\n    \n    # Plot titles\n    if title is not None:\n        plt.title(title, fontsize=fontsize)\n    \n    plt.gca().spines[['right', 'top']].set_visible(False)\n    plt.legend(\n        fontsize=fontsize,\n        loc=\"upper left\",\n        # alpha=0.2\n        # bbox_to_anchor=(1.02, 1),\n        # borderaxespad=0\n    )\n\n\nimport seaborn as sns\n\n\npspa_info.to_parquet('raw/model_compare_results.parquet')\n\n\nplot_group_bar(pspa_info,ordered_list,group='group',figsize=(14,6))\nplt.ylabel('JS divergence')\nplt.title('Comparison of models')\nsave_svg('fig/model_comparison.svg')",
    "crumbs": [
      "kinase_domain",
      "DL training: Model comparison on T5 feature"
    ]
  },
  {
    "objectID": "kinase_domain/kd_07a_cddm_training_subfamily.html",
    "href": "kinase_domain/kd_07a_cddm_training_subfamily.html",
    "title": "DL training",
    "section": "",
    "text": "import numpy as np, pandas as pd\nimport os, random\nfrom katlas.data import *\nfrom katlas.train import *\nfrom fastai.vision.all import *\nfrom katlas.dnn import *\n\n\nseed_everything()\n\n\ndef_device\n\n'cuda'",
    "crumbs": [
      "kinase_domain",
      "DL training"
    ]
  },
  {
    "objectID": "kinase_domain/kd_07a_cddm_training_subfamily.html#setup",
    "href": "kinase_domain/kd_07a_cddm_training_subfamily.html#setup",
    "title": "DL training",
    "section": "",
    "text": "import numpy as np, pandas as pd\nimport os, random\nfrom katlas.data import *\nfrom katlas.train import *\nfrom fastai.vision.all import *\nfrom katlas.dnn import *\n\n\nseed_everything()\n\n\ndef_device\n\n'cuda'",
    "crumbs": [
      "kinase_domain",
      "DL training"
    ]
  },
  {
    "objectID": "kinase_domain/kd_07a_cddm_training_subfamily.html#data",
    "href": "kinase_domain/kd_07a_cddm_training_subfamily.html#data",
    "title": "DL training",
    "section": "Data",
    "text": "Data\n\ndf=pd.read_parquet('train/cddm_t5.parquet')\n\n\ninfo=Data.get_kinase_info()\n\ninfo = info[info.pseudo=='0']\n\ninfo = info[info.kd_ID.notna()]\n\nsubfamily_map = info[['kd_ID','subfamily']].drop_duplicates().set_index('kd_ID')['subfamily']\nfamily_map = info[['kd_ID','family']].drop_duplicates().set_index('kd_ID')['family']\ngroup_map = info[['kd_ID','group']].drop_duplicates().set_index('kd_ID')['group']\n\nkinase_info = pd.DataFrame(df.index.tolist(),columns=['kinase'])\n\nkinase_info['subfamily'] = kinase_info.kinase.map(subfamily_map)\nkinase_info['family'] = kinase_info.kinase.map(family_map)\nkinase_info['group'] = kinase_info.kinase.map(group_map)\n\n\ndf=df.reset_index()\n\n\ndf.columns\n\nIndex(['index', '-20P', '-19P', '-18P', '-17P', '-16P', '-15P', '-14P', '-13P',\n       '-12P',\n       ...\n       'T5_1014', 'T5_1015', 'T5_1016', 'T5_1017', 'T5_1018', 'T5_1019',\n       'T5_1020', 'T5_1021', 'T5_1022', 'T5_1023'],\n      dtype='object', length=1968)\n\n\n\n# column name of feature and target\nfeat_col = df.columns[df.columns.str.startswith('T5_')]\ntarget_col = df.columns[~df.columns.isin(feat_col)][1:]\n\n\nfeat_col\n\nIndex(['T5_0', 'T5_1', 'T5_2', 'T5_3', 'T5_4', 'T5_5', 'T5_6', 'T5_7', 'T5_8',\n       'T5_9',\n       ...\n       'T5_1014', 'T5_1015', 'T5_1016', 'T5_1017', 'T5_1018', 'T5_1019',\n       'T5_1020', 'T5_1021', 'T5_1022', 'T5_1023'],\n      dtype='object', length=1024)",
    "crumbs": [
      "kinase_domain",
      "DL training"
    ]
  },
  {
    "objectID": "kinase_domain/kd_07a_cddm_training_subfamily.html#split",
    "href": "kinase_domain/kd_07a_cddm_training_subfamily.html#split",
    "title": "DL training",
    "section": "Split",
    "text": "Split\n\nkinase_info.subfamily.value_counts()\n\nsubfamily\nEph     12\nSrc     11\nSTE7     7\nNEK      7\nCK1      6\n        ..\nPDK1     1\nGCN2     1\nCDC7     1\nMAST     1\nRAF      1\nName: count, Length: 136, dtype: int64\n\n\n\nkinase_info.family.value_counts()\n\nfamily\nSTE20    22\nCAMKL    17\nEph      12\nMAPK     12\nSrc      11\n         ..\nSTK33     1\nPDK1      1\nCDC7      1\nMAST      1\nRAF       1\nName: count, Length: 88, dtype: int64\n\n\n\nkinase_info.group.value_counts()\n\ngroup\nTK          80\nCAMK        47\nAGC         45\nOther       40\nCMGC        39\nSTE         35\nTKL         21\nCK1          9\nAtypical     4\nName: count, dtype: int64\n\n\n\nsplits = get_splits(kinase_info, group='subfamily',nfold=5)\n\nsplit0 = splits[0]\n\nGroupKFold(n_splits=5, random_state=None, shuffle=False)\n# subfamily in train set: 110\n# subfamily in test set: 26",
    "crumbs": [
      "kinase_domain",
      "DL training"
    ]
  },
  {
    "objectID": "kinase_domain/kd_07a_cddm_training_subfamily.html#dataset",
    "href": "kinase_domain/kd_07a_cddm_training_subfamily.html#dataset",
    "title": "DL training",
    "section": "Dataset",
    "text": "Dataset\n\n# dataset\nds = GeneralDataset(df,feat_col,target_col)\n\n\nlen(ds)\n\n320\n\n\n\ndl = DataLoader(ds, batch_size=64, shuffle=True)\n\n\nxb,yb = next(iter(dl))\n\nxb.shape,yb.shape\n\n(torch.Size([64, 1024]), torch.Size([64, 23, 41]))",
    "crumbs": [
      "kinase_domain",
      "DL training"
    ]
  },
  {
    "objectID": "kinase_domain/kd_07a_cddm_training_subfamily.html#model",
    "href": "kinase_domain/kd_07a_cddm_training_subfamily.html#model",
    "title": "DL training",
    "section": "Model",
    "text": "Model\n\nn_feature = len(feat_col)\nn_target = len(target_col)\n\n\n# def get_mlp(): return PSSM_model(n_feature,n_target,model='MLP')\n\ndef get_cnn(): return PSSM_model(n_feature,n_target,model='CNN')\n\n\nmodel = get_cnn()\n\n\nlogits= model(xb)\n\n\nlogits.shape\n\ntorch.Size([64, 23, 41])",
    "crumbs": [
      "kinase_domain",
      "DL training"
    ]
  },
  {
    "objectID": "kinase_domain/kd_07a_cddm_training_subfamily.html#loss",
    "href": "kinase_domain/kd_07a_cddm_training_subfamily.html#loss",
    "title": "DL training",
    "section": "Loss",
    "text": "Loss\n\nCE(logits,yb)\n\ntensor(3.3115, grad_fn=&lt;MeanBackward0&gt;)",
    "crumbs": [
      "kinase_domain",
      "DL training"
    ]
  },
  {
    "objectID": "kinase_domain/kd_07a_cddm_training_subfamily.html#metrics",
    "href": "kinase_domain/kd_07a_cddm_training_subfamily.html#metrics",
    "title": "DL training",
    "section": "Metrics",
    "text": "Metrics\n\nKLD(logits,yb)\n\ntensor(0.5317, grad_fn=&lt;MeanBackward0&gt;)\n\n\n\nJSD(logits,yb)\n\ntensor(0.1252, grad_fn=&lt;MeanBackward0&gt;)",
    "crumbs": [
      "kinase_domain",
      "DL training"
    ]
  },
  {
    "objectID": "kinase_domain/kd_07a_cddm_training_subfamily.html#cv-train",
    "href": "kinase_domain/kd_07a_cddm_training_subfamily.html#cv-train",
    "title": "DL training",
    "section": "CV train",
    "text": "CV train\n\ncross-validation\n\n\noof = train_dl_cv(df,feat_col,target_col,\n                  splits = splits,\n                  model_func = get_cnn,\n                  n_epoch=20,lr=3e-3,save='cnn_cddm')\n\n------fold0------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.282649\n3.128296\n0.319262\n0.081570\n00:01\n\n\n1\n3.241650\n3.113522\n0.304488\n0.079595\n00:00\n\n\n2\n3.212050\n3.113102\n0.304069\n0.077892\n00:00\n\n\n3\n3.195983\n3.120565\n0.311531\n0.078662\n00:00\n\n\n4\n3.178256\n2.976437\n0.167403\n0.044890\n00:00\n\n\n5\n3.148183\n2.948758\n0.139725\n0.036188\n00:00\n\n\n6\n3.109516\n2.925130\n0.116096\n0.029711\n00:00\n\n\n7\n3.072004\n2.909240\n0.100206\n0.026152\n00:00\n\n\n8\n3.039572\n2.904013\n0.094980\n0.025093\n00:00\n\n\n9\n3.012379\n2.898960\n0.089926\n0.023662\n00:00\n\n\n10\n2.989801\n2.899136\n0.090103\n0.023424\n00:00\n\n\n11\n2.970484\n2.899322\n0.090289\n0.023485\n00:00\n\n\n12\n2.954165\n2.898535\n0.089501\n0.023218\n00:00\n\n\n13\n2.940085\n2.897991\n0.088957\n0.023097\n00:00\n\n\n14\n2.927743\n2.896062\n0.087028\n0.022649\n00:00\n\n\n15\n2.917165\n2.895469\n0.086436\n0.022511\n00:00\n\n\n16\n2.907989\n2.896032\n0.086999\n0.022646\n00:00\n\n\n17\n2.899801\n2.895162\n0.086129\n0.022428\n00:00\n\n\n18\n2.892946\n2.894896\n0.085862\n0.022354\n00:00\n\n\n19\n2.886997\n2.894820\n0.085787\n0.022334\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold1------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.282195\n3.130908\n0.322224\n0.081733\n00:00\n\n\n1\n3.243584\n3.113548\n0.304865\n0.078650\n00:00\n\n\n2\n3.219855\n3.120547\n0.311864\n0.079403\n00:00\n\n\n3\n3.209427\n3.087194\n0.278511\n0.069197\n00:00\n\n\n4\n3.201059\n2.992566\n0.183883\n0.048371\n00:00\n\n\n5\n3.167005\n2.937138\n0.128454\n0.033072\n00:00\n\n\n6\n3.121017\n2.924041\n0.115357\n0.029413\n00:00\n\n\n7\n3.082160\n2.915458\n0.106775\n0.027174\n00:00\n\n\n8\n3.049422\n2.906384\n0.097700\n0.025222\n00:00\n\n\n9\n3.022278\n2.902709\n0.094025\n0.024238\n00:00\n\n\n10\n2.999649\n2.899378\n0.090695\n0.023322\n00:00\n\n\n11\n2.980213\n2.898759\n0.090075\n0.023229\n00:00\n\n\n12\n2.963545\n2.898273\n0.089589\n0.022956\n00:00\n\n\n13\n2.949331\n2.897189\n0.088506\n0.022689\n00:00\n\n\n14\n2.936587\n2.896288\n0.087604\n0.022514\n00:00\n\n\n15\n2.925316\n2.894401\n0.085718\n0.022021\n00:00\n\n\n16\n2.915478\n2.893880\n0.085196\n0.021894\n00:00\n\n\n17\n2.907102\n2.893515\n0.084832\n0.021793\n00:00\n\n\n18\n2.899950\n2.893503\n0.084820\n0.021781\n00:00\n\n\n19\n2.893546\n2.893279\n0.084595\n0.021737\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold2------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.282472\n3.127070\n0.353896\n0.091299\n00:00\n\n\n1\n3.241385\n3.109268\n0.336093\n0.088014\n00:00\n\n\n2\n3.209924\n3.114542\n0.341367\n0.087262\n00:00\n\n\n3\n3.193899\n3.053725\n0.280551\n0.073127\n00:00\n\n\n4\n3.181828\n2.961300\n0.188125\n0.050201\n00:00\n\n\n5\n3.145959\n2.931028\n0.157853\n0.041150\n00:00\n\n\n6\n3.109088\n2.925400\n0.152225\n0.038905\n00:00\n\n\n7\n3.075637\n2.922864\n0.149690\n0.038691\n00:00\n\n\n8\n3.047635\n2.909077\n0.135902\n0.035387\n00:00\n\n\n9\n3.024517\n2.901939\n0.128764\n0.033550\n00:00\n\n\n10\n3.003808\n2.899364\n0.126189\n0.032804\n00:00\n\n\n11\n2.984565\n2.898607\n0.125433\n0.032361\n00:00\n\n\n12\n2.967488\n2.896226\n0.123052\n0.031884\n00:00\n\n\n13\n2.952080\n2.895696\n0.122522\n0.031629\n00:00\n\n\n14\n2.938943\n2.895282\n0.122107\n0.031550\n00:00\n\n\n15\n2.927504\n2.894837\n0.121663\n0.031524\n00:00\n\n\n16\n2.917730\n2.893668\n0.120494\n0.031259\n00:00\n\n\n17\n2.908983\n2.893366\n0.120192\n0.031149\n00:00\n\n\n18\n2.901532\n2.893119\n0.119945\n0.031088\n00:00\n\n\n19\n2.895179\n2.893249\n0.120075\n0.031103\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold3------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.280588\n3.129339\n0.335539\n0.085304\n00:00\n\n\n1\n3.240295\n3.119176\n0.325376\n0.083852\n00:00\n\n\n2\n3.210839\n3.091391\n0.297591\n0.077241\n00:00\n\n\n3\n3.200143\n3.042270\n0.248470\n0.065589\n00:00\n\n\n4\n3.195208\n3.029967\n0.236167\n0.060239\n00:00\n\n\n5\n3.157714\n2.951658\n0.157859\n0.039547\n00:00\n\n\n6\n3.114407\n2.937240\n0.143440\n0.036184\n00:00\n\n\n7\n3.076996\n2.915984\n0.122185\n0.031200\n00:00\n\n\n8\n3.044734\n2.903373\n0.109573\n0.028193\n00:00\n\n\n9\n3.018122\n2.900592\n0.106792\n0.027362\n00:00\n\n\n10\n2.995771\n2.897802\n0.104002\n0.026672\n00:00\n\n\n11\n2.977186\n2.896495\n0.102695\n0.026356\n00:00\n\n\n12\n2.960754\n2.895625\n0.101826\n0.026132\n00:00\n\n\n13\n2.946897\n2.895158\n0.101358\n0.025921\n00:00\n\n\n14\n2.935326\n2.893981\n0.100182\n0.025680\n00:00\n\n\n15\n2.925143\n2.893090\n0.099290\n0.025458\n00:00\n\n\n16\n2.916389\n2.892680\n0.098880\n0.025363\n00:00\n\n\n17\n2.908602\n2.891653\n0.097853\n0.025092\n00:00\n\n\n18\n2.901875\n2.891660\n0.097860\n0.025101\n00:00\n\n\n19\n2.896487\n2.891503\n0.097704\n0.025064\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold4------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.283504\n3.130594\n0.363589\n0.093193\n00:00\n\n\n1\n3.243992\n3.116076\n0.349071\n0.090924\n00:00\n\n\n2\n3.210798\n3.120450\n0.353445\n0.090563\n00:00\n\n\n3\n3.199268\n3.072872\n0.305868\n0.079987\n00:00\n\n\n4\n3.177695\n2.966492\n0.199487\n0.053601\n00:00\n\n\n5\n3.137152\n2.917118\n0.150113\n0.039282\n-1:59:59\n\n\n6\n3.099840\n2.911311\n0.144307\n0.037135\n00:00\n\n\n7\n3.071257\n2.897541\n0.130536\n0.034004\n00:00\n\n\n8\n3.047829\n2.894860\n0.127856\n0.033557\n00:00\n\n\n9\n3.024281\n2.900576\n0.133571\n0.034486\n00:00\n\n\n10\n3.002414\n2.898617\n0.131613\n0.034054\n00:00\n\n\n11\n2.983205\n2.894372\n0.127367\n0.032931\n00:00\n\n\n12\n2.966494\n2.888815\n0.121811\n0.031625\n00:00\n\n\n13\n2.952212\n2.885732\n0.118727\n0.031049\n00:00\n\n\n14\n2.939676\n2.885109\n0.118105\n0.030705\n00:00\n\n\n15\n2.928643\n2.883477\n0.116472\n0.030395\n00:00\n\n\n16\n2.919168\n2.882151\n0.115146\n0.030121\n00:00\n\n\n17\n2.910880\n2.881615\n0.114610\n0.030057\n00:00\n\n\n18\n2.903741\n2.881046\n0.114041\n0.029917\n00:00\n\n\n19\n2.897946\n2.881109\n0.114104\n0.029928\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n\noof.to_parquet('raw/oof_cddm.parquet')",
    "crumbs": [
      "kinase_domain",
      "DL training"
    ]
  },
  {
    "objectID": "kinase_domain/kd_07a_cddm_training_subfamily.html#score",
    "href": "kinase_domain/kd_07a_cddm_training_subfamily.html#score",
    "title": "DL training",
    "section": "Score",
    "text": "Score\n\nfrom katlas.pssm import *\n\nfrom functools import partial\n\n\ndef score_df(target,pred,func):\n    distance = [func(target.loc[i],pred.loc[i,target.columns]) for i in target.index]\n    return pd.Series(distance,index=target.index)\n\n\njsd_df = partial(score_df,func=js_divergence_flat)\nkld_df = partial(score_df,func=kl_divergence_flat)\n\n\ntarget=df[target_col].copy()\n\n\nkinase_info['group_split'] = oof.nfold\n\n\nkinase_info['group_jsd'] =jsd_df(target,oof)\n\n\nfrom katlas.plot import *\n\n\nset_sns()\n\n\nplot_bar(kinase_info,'group_jsd',group='group',palette=group_color,figsize=(8,4))\nplt.ylabel('JS divergence')\nplt.title('GroupSplit by subfamily (nfold=5) in kinase subfamily')\n\nText(0.5, 1.0, 'GroupSplit by subfamily (nfold=5) in kinase subfamily')\n\n\n\n\n\n\n\n\n\n\ngroup_color = pd.DataFrame(group_color).T\n\n\nsty_color\n\n{'S': (0.12156862745098039, 0.4666666666666667, 0.7058823529411765),\n 'T': (0.6823529411764706, 0.7803921568627451, 0.9098039215686274),\n 'Y': (1.0, 0.4980392156862745, 0.054901960784313725)}\n\n\n\ngroup_color = group_color.reset_index(names='modi_group')\n\n\ninfo = Data.get_kinase_info()\n\n\nsubfamily_color = info[['modi_group','subfamily']].merge(group_color).drop(columns=['modi_group']).set_index('subfamily')\n\n\nsubfamily_color = subfamily_color.apply(tuple, axis=1).to_dict()\n\n\nplot_bar(kinase_info,'group_jsd',group='subfamily',palette = subfamily_color, figsize=(30,7))\nplt.ylabel('JS divergence')\n# plt.title('Stratified split in kinase subfamily')\n\nText(0, 0.5, 'JS divergence')\n\n\n\n\n\n\n\n\n\n\nfrom katlas.pssm import *\n\n\ndef plot_one_pssm(target,pred,idx):\n    target_pssm = recover_pssm(target.loc[idx])\n    pred_pssm = recover_pssm(pred.loc[idx,target.columns])\n    plot_heatmap(target_pssm,figsize=(10,6))\n    plot_heatmap(pred_pssm,figsize=(10,6))\n\n\nset_sns(100)\n\n\nkinase_info[kinase_info.kinase.str.contains('CDK')]\n\n\n\n\n\n\n\n\nkinase\nsubfamily\nfamily\ngroup\ngroup_split\ngroup_jsd\n\n\n\n\n34\nP06493_CDK1_HUMAN_KD1\nCDC2\nCDK\nCMGC\n1\n0.005642\n\n\n39\nP24941_CDK2_HUMAN_KD1\nCDK2\nCDK\nCMGC\n0\n0.006260\n\n\n102\nQ00535_CDK5_HUMAN_KD1\nCDK5\nCDK\nCMGC\n3\n0.008968\n\n\n168\nP50750_CDK9_HUMAN_KD1\nCDK9\nCDK\nCMGC\n4\n0.018047\n\n\n204\nQ00534_CDK6_HUMAN_KD1\nCDK4\nCDK\nCMGC\n1\n0.016037\n\n\n224\nP50613_CDK7_HUMAN_KD1\nCDK7\nCDK\nCMGC\n2\n0.030289\n\n\n228\nQ00526_CDK3_HUMAN_KD1\nCDK2\nCDK\nCMGC\n0\n0.020181\n\n\n240\nP11802_CDK4_HUMAN_KD1\nCDK4\nCDK\nCMGC\n1\n0.031994\n\n\n280\nP49336_CDK8_HUMAN_KD1\nCDK8\nCDK\nCMGC\n0\n0.045855\n\n\n\n\n\n\n\nCDK7:\n\nplot_one_pssm(target,oof,224)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCompare with pspa CDK:\n\ndf2=pd.read_parquet('train/pspa_t5.parquet')\n\n\nseries= df2[df2.index.str.contains('CDK7')].iloc[0]\n\n\nplot_heatmap(recover_pssm(series),figsize=(3.5,6))",
    "crumbs": [
      "kinase_domain",
      "DL training"
    ]
  },
  {
    "objectID": "kinase_domain/kd_07b_pspa_training_subfamily.html",
    "href": "kinase_domain/kd_07b_pspa_training_subfamily.html",
    "title": "DL training",
    "section": "",
    "text": "import numpy as np, pandas as pd\nimport os, random\nfrom katlas.data import *\nfrom katlas.train import *\nfrom fastai.vision.all import *\nfrom katlas.dnn import *\n\n\nseed_everything()\n\n\ndef_device\n\n'cuda'",
    "crumbs": [
      "kinase_domain",
      "DL training"
    ]
  },
  {
    "objectID": "kinase_domain/kd_07b_pspa_training_subfamily.html#setup",
    "href": "kinase_domain/kd_07b_pspa_training_subfamily.html#setup",
    "title": "DL training",
    "section": "",
    "text": "import numpy as np, pandas as pd\nimport os, random\nfrom katlas.data import *\nfrom katlas.train import *\nfrom fastai.vision.all import *\nfrom katlas.dnn import *\n\n\nseed_everything()\n\n\ndef_device\n\n'cuda'",
    "crumbs": [
      "kinase_domain",
      "DL training"
    ]
  },
  {
    "objectID": "kinase_domain/kd_07b_pspa_training_subfamily.html#data",
    "href": "kinase_domain/kd_07b_pspa_training_subfamily.html#data",
    "title": "DL training",
    "section": "Data",
    "text": "Data\n\ndf=pd.read_parquet('train/pspa_t5.parquet')\n\n\ninfo=Data.get_kinase_info()\n\ninfo = info[info.pseudo=='0']\n\ninfo = info[info.kd_ID.notna()]\n\nsubfamily_map = info[['kd_ID','subfamily']].drop_duplicates().set_index('kd_ID')['subfamily']\nfamily_map = info[['kd_ID','family']].drop_duplicates().set_index('kd_ID')['family']\ngroup_map = info[['kd_ID','group']].drop_duplicates().set_index('kd_ID')['group']\n\npspa_info = pd.DataFrame(df.index.tolist(),columns=['kinase'])\n\npspa_info['subfamily'] = pspa_info.kinase.map(subfamily_map)\npspa_info['family'] = pspa_info.kinase.map(family_map)\npspa_info['group'] = pspa_info.kinase.map(group_map)\n\n\ndf=df.reset_index()\n\n\ndf.columns\n\nIndex(['index', '-5P', '-4P', '-3P', '-2P', '-1P', '0P', '1P', '2P', '3P',\n       ...\n       'T5_1014', 'T5_1015', 'T5_1016', 'T5_1017', 'T5_1018', 'T5_1019',\n       'T5_1020', 'T5_1021', 'T5_1022', 'T5_1023'],\n      dtype='object', length=1255)\n\n\n\n# column name of feature and target\nfeat_col = df.columns[df.columns.str.startswith('T5_')]\ntarget_col = df.columns[~df.columns.isin(feat_col)][1:]\n\n\nfeat_col\n\nIndex(['T5_0', 'T5_1', 'T5_2', 'T5_3', 'T5_4', 'T5_5', 'T5_6', 'T5_7', 'T5_8',\n       'T5_9',\n       ...\n       'T5_1014', 'T5_1015', 'T5_1016', 'T5_1017', 'T5_1018', 'T5_1019',\n       'T5_1020', 'T5_1021', 'T5_1022', 'T5_1023'],\n      dtype='object', length=1024)",
    "crumbs": [
      "kinase_domain",
      "DL training"
    ]
  },
  {
    "objectID": "kinase_domain/kd_07b_pspa_training_subfamily.html#split",
    "href": "kinase_domain/kd_07b_pspa_training_subfamily.html#split",
    "title": "DL training",
    "section": "Split",
    "text": "Split\n\npspa_info.subfamily.value_counts()\n\nsubfamily\nEph      12\nSrc      11\nNEK      10\nCK1       7\nSTE11     7\n         ..\nZAK       1\nSev       1\nRet       1\nMusk      1\nTie       1\nName: count, Length: 149, dtype: int64\n\n\n\npspa_info.family.value_counts()\n\nfamily\nSTE20    27\nCAMKL    20\nCDK      17\nMAPK     12\nEph      12\n         ..\nSTK33     1\nSev       1\nRet       1\nMusk      1\nTie       1\nName: count, Length: 92, dtype: int64\n\n\n\npspa_info.group.value_counts()\n\ngroup\nTK          78\nCAMK        57\nCMGC        52\nAGC         52\nOther       49\nSTE         39\nTKL         25\nCK1         11\nAtypical     5\nName: count, dtype: int64\n\n\n\nsplits = get_splits(pspa_info, group='subfamily',nfold=5)\n\nsplit0 = splits[0]\n\nGroupKFold(n_splits=5, random_state=None, shuffle=False)\n# subfamily in train set: 120\n# subfamily in test set: 29",
    "crumbs": [
      "kinase_domain",
      "DL training"
    ]
  },
  {
    "objectID": "kinase_domain/kd_07b_pspa_training_subfamily.html#dataset",
    "href": "kinase_domain/kd_07b_pspa_training_subfamily.html#dataset",
    "title": "DL training",
    "section": "Dataset",
    "text": "Dataset\n\n# dataset\nds = GeneralDataset(df,feat_col,target_col)\n\n\nlen(ds)\n\n368\n\n\n\ndl = DataLoader(ds, batch_size=64, shuffle=True)\n\n\nxb,yb = next(iter(dl))\n\nxb.shape,yb.shape\n\n(torch.Size([64, 1024]), torch.Size([64, 23, 10]))",
    "crumbs": [
      "kinase_domain",
      "DL training"
    ]
  },
  {
    "objectID": "kinase_domain/kd_07b_pspa_training_subfamily.html#model",
    "href": "kinase_domain/kd_07b_pspa_training_subfamily.html#model",
    "title": "DL training",
    "section": "Model",
    "text": "Model\n\nn_feature = len(feat_col)\nn_target = len(target_col)\n\n\n# def get_mlp(): return PSSM_model(n_feature,n_target,model='MLP')\n\ndef get_cnn(): return PSSM_model(n_feature,n_target,model='CNN')\n\n\nmodel = get_cnn()\n\n\nlogits= model(xb)\n\n\nlogits.shape\n\ntorch.Size([64, 23, 10])",
    "crumbs": [
      "kinase_domain",
      "DL training"
    ]
  },
  {
    "objectID": "kinase_domain/kd_07b_pspa_training_subfamily.html#loss",
    "href": "kinase_domain/kd_07b_pspa_training_subfamily.html#loss",
    "title": "DL training",
    "section": "Loss",
    "text": "Loss\n\nCE(logits,yb)\n\ntensor(3.3157, grad_fn=&lt;MeanBackward0&gt;)",
    "crumbs": [
      "kinase_domain",
      "DL training"
    ]
  },
  {
    "objectID": "kinase_domain/kd_07b_pspa_training_subfamily.html#metrics",
    "href": "kinase_domain/kd_07b_pspa_training_subfamily.html#metrics",
    "title": "DL training",
    "section": "Metrics",
    "text": "Metrics\n\nKLD(logits,yb)\n\ntensor(0.5744, grad_fn=&lt;MeanBackward0&gt;)\n\n\n\nJSD(logits,yb)\n\ntensor(0.1175, grad_fn=&lt;MeanBackward0&gt;)",
    "crumbs": [
      "kinase_domain",
      "DL training"
    ]
  },
  {
    "objectID": "kinase_domain/kd_07b_pspa_training_subfamily.html#cv-train",
    "href": "kinase_domain/kd_07b_pspa_training_subfamily.html#cv-train",
    "title": "DL training",
    "section": "CV train",
    "text": "CV train\n\ncross-validation\n\n\noof = train_dl_cv(df,feat_col,target_col,\n                  splits = splits,\n                  model_func = get_cnn,\n                  n_epoch=20,lr=3e-3,save='cnn_pspa')\n\n------fold0------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.233706\n3.125911\n0.406453\n0.085575\n00:01\n\n\n1\n3.130510\n3.048949\n0.329490\n0.074209\n00:00\n\n\n2\n3.055997\n3.130454\n0.410995\n0.065571\n00:00\n\n\n3\n3.010011\n3.088417\n0.368959\n0.066432\n00:00\n\n\n4\n2.983442\n3.059395\n0.339937\n0.059636\n00:00\n\n\n5\n2.963942\n3.014983\n0.295525\n0.053493\n00:00\n\n\n6\n2.941524\n2.903284\n0.183826\n0.041339\n00:00\n\n\n7\n2.920246\n2.822921\n0.103463\n0.025377\n00:00\n\n\n8\n2.902542\n2.829456\n0.109998\n0.026529\n00:00\n\n\n9\n2.887325\n2.807781\n0.088324\n0.020793\n00:00\n\n\n10\n2.873063\n2.803475\n0.084017\n0.019533\n00:00\n\n\n11\n2.861299\n2.807706\n0.088248\n0.020885\n00:00\n\n\n12\n2.850185\n2.800845\n0.081387\n0.019359\n00:00\n\n\n13\n2.840891\n2.799504\n0.080046\n0.018768\n00:00\n\n\n14\n2.841491\n2.814084\n0.094626\n0.020952\n00:00\n\n\n15\n2.833544\n2.803974\n0.084516\n0.020174\n00:00\n\n\n16\n2.827274\n2.801270\n0.081811\n0.019360\n00:00\n\n\n17\n2.821252\n2.799191\n0.079733\n0.018746\n00:00\n\n\n18\n2.816021\n2.800156\n0.080698\n0.019058\n00:00\n\n\n19\n2.811490\n2.801163\n0.081706\n0.019365\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold1------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.220115\n3.122870\n0.367961\n0.079914\n00:00\n\n\n1\n3.110324\n3.013538\n0.258628\n0.061137\n00:00\n\n\n2\n3.029848\n3.004896\n0.249986\n0.043967\n00:00\n\n\n3\n2.986253\n3.025127\n0.270218\n0.044840\n00:00\n\n\n4\n2.962428\n2.937174\n0.182265\n0.038925\n00:00\n\n\n5\n2.944227\n2.868406\n0.113497\n0.027091\n00:00\n\n\n6\n2.925777\n2.851748\n0.096838\n0.023173\n00:00\n\n\n7\n2.907046\n2.846324\n0.091415\n0.022224\n00:00\n\n\n8\n2.890109\n2.833833\n0.078924\n0.018874\n00:00\n\n\n9\n2.874512\n2.829689\n0.074779\n0.018139\n00:00\n\n\n10\n2.860773\n2.830650\n0.075741\n0.018343\n00:00\n\n\n11\n2.849061\n2.825806\n0.070897\n0.017139\n00:00\n\n\n12\n2.838997\n2.826859\n0.071950\n0.017447\n00:00\n\n\n13\n2.830334\n2.829360\n0.074451\n0.018066\n00:00\n\n\n14\n2.822370\n2.820644\n0.065735\n0.015937\n00:00\n\n\n15\n2.815302\n2.823604\n0.068695\n0.016640\n00:00\n\n\n16\n2.809580\n2.821716\n0.066807\n0.016194\n00:00\n\n\n17\n2.804384\n2.819929\n0.065020\n0.015721\n00:00\n\n\n18\n2.800062\n2.819813\n0.064903\n0.015710\n00:00\n\n\n19\n2.796715\n2.820354\n0.065445\n0.015832\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold2------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.200740\n3.130967\n0.378583\n0.081704\n00:00\n\n\n1\n3.092526\n2.995235\n0.242852\n0.059953\n00:00\n\n\n2\n3.019362\n2.951045\n0.198661\n0.041754\n00:00\n\n\n3\n2.978442\n2.969943\n0.217558\n0.044737\n00:00\n\n\n4\n2.954714\n2.931453\n0.179070\n0.039580\n00:00\n\n\n5\n2.935677\n2.881018\n0.128634\n0.029679\n00:00\n\n\n6\n2.917925\n2.860357\n0.107974\n0.025191\n00:00\n\n\n7\n2.900897\n2.853231\n0.100847\n0.023653\n00:01\n\n\n8\n2.885049\n2.845886\n0.093502\n0.022020\n00:00\n\n\n9\n2.870798\n2.845885\n0.093501\n0.021971\n00:00\n\n\n10\n2.857675\n2.846555\n0.094171\n0.022086\n00:00\n\n\n11\n2.847099\n2.842916\n0.090532\n0.021348\n00:00\n\n\n12\n2.837596\n2.842217\n0.089834\n0.021036\n00:00\n\n\n13\n2.828788\n2.845114\n0.092730\n0.021663\n00:00\n\n\n14\n2.821526\n2.838382\n0.085998\n0.020212\n00:00\n\n\n15\n2.814844\n2.838639\n0.086255\n0.020221\n00:00\n\n\n16\n2.809012\n2.839795\n0.087412\n0.020456\n00:00\n\n\n17\n2.804014\n2.838342\n0.085959\n0.020113\n00:00\n\n\n18\n2.799799\n2.839126\n0.086743\n0.020303\n00:00\n\n\n19\n2.796194\n2.839238\n0.086854\n0.020336\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold3------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.204410\n3.124295\n0.361279\n0.078598\n00:00\n\n\n1\n3.096633\n3.004290\n0.241274\n0.059625\n00:00\n\n\n2\n3.020993\n2.954940\n0.191923\n0.038023\n00:00\n\n\n3\n2.977240\n2.974516\n0.211500\n0.043791\n00:00\n\n\n4\n2.949267\n2.924750\n0.161734\n0.036755\n00:00\n\n\n5\n2.927110\n2.898294\n0.135277\n0.031197\n00:00\n\n\n6\n2.907787\n2.866850\n0.103833\n0.024755\n00:00\n\n\n7\n2.889578\n2.859005\n0.095989\n0.022904\n00:00\n\n\n8\n2.873679\n2.851498\n0.088482\n0.020949\n00:00\n\n\n9\n2.860200\n2.855871\n0.092855\n0.022186\n00:00\n\n\n10\n2.848846\n2.852453\n0.089437\n0.021289\n00:00\n\n\n11\n2.838321\n2.855460\n0.092444\n0.021871\n00:00\n\n\n12\n2.829044\n2.850951\n0.087935\n0.020768\n00:00\n\n\n13\n2.820891\n2.850833\n0.087817\n0.020675\n00:00\n\n\n14\n2.813844\n2.850501\n0.087485\n0.020620\n00:00\n\n\n15\n2.807759\n2.848204\n0.085187\n0.020092\n00:00\n\n\n16\n2.802352\n2.848961\n0.085945\n0.020265\n00:00\n\n\n17\n2.797838\n2.848315\n0.085299\n0.020222\n00:00\n\n\n18\n2.793763\n2.847828\n0.084811\n0.020079\n00:00\n\n\n19\n2.790769\n2.847723\n0.084707\n0.020046\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold4------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.209750\n3.119418\n0.369865\n0.080478\n00:00\n\n\n1\n3.100083\n3.013516\n0.263963\n0.058817\n00:00\n\n\n2\n3.029029\n3.131990\n0.382436\n0.055820\n00:00\n\n\n3\n2.985650\n3.112973\n0.363419\n0.054572\n00:00\n\n\n4\n2.959636\n3.076775\n0.327221\n0.052438\n00:00\n\n\n5\n2.940694\n2.988379\n0.238825\n0.044601\n00:00\n\n\n6\n2.920553\n2.918243\n0.168689\n0.036624\n00:00\n\n\n7\n2.900961\n2.863245\n0.113691\n0.026403\n00:00\n\n\n8\n2.885111\n2.866303\n0.116750\n0.027012\n00:00\n\n\n9\n2.870587\n2.850549\n0.100995\n0.023691\n00:00\n\n\n10\n2.858413\n2.844527\n0.094974\n0.022394\n00:00\n\n\n11\n2.847218\n2.845756\n0.096203\n0.022637\n00:00\n\n\n12\n2.838991\n2.846041\n0.096488\n0.022478\n00:00\n\n\n13\n2.830662\n2.851257\n0.101704\n0.023702\n00:00\n\n\n14\n2.824315\n2.846768\n0.097214\n0.022712\n00:00\n\n\n15\n2.817429\n2.839707\n0.090153\n0.020986\n00:00\n\n\n16\n2.811808\n2.838882\n0.089328\n0.020835\n00:00\n\n\n17\n2.806540\n2.838375\n0.088822\n0.020646\n00:00\n\n\n18\n2.802111\n2.838036\n0.088482\n0.020585\n00:00\n\n\n19\n2.798786\n2.837518\n0.087965\n0.020500\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n\noof.to_parquet('raw/oof_pspa.parquet')",
    "crumbs": [
      "kinase_domain",
      "DL training"
    ]
  },
  {
    "objectID": "kinase_domain/kd_07b_pspa_training_subfamily.html#score",
    "href": "kinase_domain/kd_07b_pspa_training_subfamily.html#score",
    "title": "DL training",
    "section": "Score",
    "text": "Score\n\nfrom katlas.pssm import *\n\nfrom functools import partial\n\n\ndef score_df(target,pred,func):\n    distance = [func(target.loc[i],pred.loc[i,target.columns]) for i in target.index]\n    return pd.Series(distance,index=target.index)\n\n\njsd_df = partial(score_df,func=js_divergence_flat)\nkld_df = partial(score_df,func=kl_divergence_flat)\n\n\ntarget=df[target_col].copy()\n\n\npspa_info['group_split'] = oof.nfold\n\n\npspa_info['group_jsd'] =jsd_df(target,oof)\n\n\nfrom katlas.plot import *\n\n\nset_sns()\n\n\nplot_bar(pspa_info,'group_jsd',group='group',palette=group_color,figsize=(8,4))\nplt.ylabel('JS divergence')\nplt.title('GroupSplit by subfamily (nfold=5) in kinase subfamily')\n\nText(0.5, 1.0, 'GroupSplit by subfamily (nfold=5) in kinase subfamily')\n\n\n\n\n\n\n\n\n\n\ngroup_color = pd.DataFrame(group_color).T\n\n\nsty_color\n\n{'S': (0.12156862745098039, 0.4666666666666667, 0.7058823529411765),\n 'T': (0.6823529411764706, 0.7803921568627451, 0.9098039215686274),\n 'Y': (1.0, 0.4980392156862745, 0.054901960784313725)}\n\n\n\ngroup_color = group_color.reset_index(names='modi_group')\n\n\ninfo = Data.get_kinase_info()\n\n\nsubfamily_color = info[['modi_group','subfamily']].merge(group_color).drop(columns=['modi_group']).set_index('subfamily')\n\n\nsubfamily_color = subfamily_color.apply(tuple, axis=1).to_dict()\n\n\nplot_bar(pspa_info,'group_jsd',group='subfamily',palette = subfamily_color, figsize=(30,7))\nplt.ylabel('JS divergence')\n# plt.title('Stratified split in kinase subfamily')\n\nText(0, 0.5, 'JS divergence')\n\n\n\n\n\n\n\n\n\n\npspa_info.sort_values('group_jsd')\n\n\n\n\n\n\n\n\nkinase\nsubfamily\nfamily\ngroup\ngroup_split\ngroup_jsd\n\n\n\n\n272\nQ9UKE5_TNIK_HUMAN_KD1\nMSN\nSTE20\nSTE\n4\n0.003378\n\n\n246\nQ13464_ROCK1_HUMAN_KD1\nROCK\nDMPK\nAGC\n1\n0.003626\n\n\n104\nO95819_M4K4_HUMAN_KD1\nMSN\nSTE20\nSTE\n4\n0.003785\n\n\n20\nQ13873_BMPR2_HUMAN_KD1\nSTKR2\nSTKR\nTKL\n3\n0.003992\n\n\n265\nQ9UL54_TAOK2_HUMAN_KD1\nTAO\nSTE20\nSTE\n0\n0.004083\n\n\n...\n...\n...\n...\n...\n...\n...\n\n\n65\nP68400_CSK21_HUMAN_KD1\nCK2\nCK2\nCMGC\n2\n0.069807\n\n\n64\nQ9Y6M4_KC1G3_HUMAN_KD1\nCK1\nCK1\nCK1\n4\n0.072875\n\n\n58\nP48729_KC1A_HUMAN_KD1\nCK1\nCK1\nCK1\n4\n0.074366\n\n\n125\nQ8TAS1_UHMK1_HUMAN_KD1\nKIS\nKIS\nOther\n3\n0.075230\n\n\n63\nP78368_KC1G2_HUMAN_KD1\nCK1\nCK1\nCK1\n4\n0.083079\n\n\n\n\n368 rows × 6 columns\n\n\n\n\nfrom katlas.pssm import *\n\n\ndef plot_one_pssm(target,pred,idx):\n    target_pssm = recover_pssm(target.loc[idx])\n    pred_pssm = recover_pssm(pred.loc[idx,target.columns])\n    plot_heatmap(target_pssm)\n    plot_heatmap(pred_pssm)\n\n\nset_sns(50)\n\n\nplot_one_pssm(target,oof,246)",
    "crumbs": [
      "kinase_domain",
      "DL training"
    ]
  },
  {
    "objectID": "kinase_domain/kd_04_prepare_data.html",
    "href": "kinase_domain/kd_04_prepare_data.html",
    "title": "Prepare data for training",
    "section": "",
    "text": "import pandas as pd\nfrom katlas.data import *\nfrom katlas.pssm import *",
    "crumbs": [
      "kinase_domain",
      "Prepare data for training"
    ]
  },
  {
    "objectID": "kinase_domain/kd_04_prepare_data.html#feature-data",
    "href": "kinase_domain/kd_04_prepare_data.html#feature-data",
    "title": "Prepare data for training",
    "section": "feature data",
    "text": "feature data\n\n# T5 data\nt5 = pd.read_parquet('raw/t5_kd.parquet')\n\n# ESM data\nesm = pd.read_parquet('raw/esm_kd.parquet')\n\n# Onehot data\nonehot = pd.read_parquet('raw/onehot_kd.parquet')\n\n# Onehot pca data\nonehot_pca = pd.read_parquet('raw/onehot_pca_kd.parquet')\n\n\nt5_col = t5.columns\nesm_col = esm.columns\nonehot_col = onehot.columns\nonehot_pca_col = onehot_pca.columns\n\n\nt5.columns\n\nIndex(['T5_0', 'T5_1', 'T5_2', 'T5_3', 'T5_4', 'T5_5', 'T5_6', 'T5_7', 'T5_8',\n       'T5_9',\n       ...\n       'T5_1014', 'T5_1015', 'T5_1016', 'T5_1017', 'T5_1018', 'T5_1019',\n       'T5_1020', 'T5_1021', 'T5_1022', 'T5_1023'],\n      dtype='object', length=1024)\n\n\n\nesm.columns\n\nIndex(['esm_0', 'esm_1', 'esm_2', 'esm_3', 'esm_4', 'esm_5', 'esm_6', 'esm_7',\n       'esm_8', 'esm_9',\n       ...\n       'esm_1270', 'esm_1271', 'esm_1272', 'esm_1273', 'esm_1274', 'esm_1275',\n       'esm_1276', 'esm_1277', 'esm_1278', 'esm_1279'],\n      dtype='object', length=1280)\n\n\n\nonehot.columns\n\nIndex(['65_-', '65_A', '65_C', '65_D', '65_E', '65_F', '65_G', '65_H', '65_I',\n       '65_K',\n       ...\n       '3192_M', '3192_N', '3192_P', '3192_Q', '3192_R', '3192_S', '3192_T',\n       '3192_V', '3192_W', '3192_Y'],\n      dtype='object', length=6849)\n\n\n\nonehot_pca_col\n\nIndex(['PCA1', 'PCA2', 'PCA3', 'PCA4', 'PCA5', 'PCA6', 'PCA7', 'PCA8', 'PCA9',\n       'PCA10',\n       ...\n       'PCA991', 'PCA992', 'PCA993', 'PCA994', 'PCA995', 'PCA996', 'PCA997',\n       'PCA998', 'PCA999', 'PCA1000'],\n      dtype='object', length=1000)",
    "crumbs": [
      "kinase_domain",
      "Prepare data for training"
    ]
  },
  {
    "objectID": "kinase_domain/kd_04_prepare_data.html#target-data",
    "href": "kinase_domain/kd_04_prepare_data.html#target-data",
    "title": "Prepare data for training",
    "section": "target data",
    "text": "target data\n\nPSPA\n\npspa = Data.get_pspa_all_scale()\n\n\n# Remove those with _TYR due to their overall low specificity and overlap with main kinases\npspa = pspa[~pspa.index.str.contains('_')]\n\n\npspa.head()\n\n\n\n\n\n\n\n\n-5P\n-5G\n-5A\n-5C\n-5S\n-5T\n-5V\n-5I\n-5L\n-5M\n...\n4H\n4K\n4R\n4Q\n4N\n4D\n4E\n4pS\n4pT\n4pY\n\n\nkinase\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nAAK1\n0.05845\n0.01989\n0.02305\n0.03702\n0.03450\n0.03450\n0.07720\n0.12615\n0.08061\n0.07014\n...\n0.04482\n0.06651\n0.07427\n0.05082\n0.04738\n0.03113\n0.03657\n0.02009\n0.02009\n0.02161\n\n\nACVR2A\n0.02971\n0.03443\n0.04180\n0.03500\n0.04137\n0.04137\n0.04281\n0.04474\n0.04266\n0.03729\n...\n0.04202\n0.03865\n0.03601\n0.04517\n0.04077\n0.04693\n0.04693\n0.05155\n0.05155\n0.04319\n\n\nACVR2B\n0.03779\n0.03665\n0.04013\n0.05473\n0.03779\n0.03779\n0.03850\n0.03134\n0.03339\n0.03658\n...\n0.04056\n0.03261\n0.03514\n0.04229\n0.03846\n0.05278\n0.05039\n0.05502\n0.05502\n0.04605\n\n\nAKT1\n0.04669\n0.04599\n0.04274\n0.04684\n0.03995\n0.03995\n0.03306\n0.03368\n0.03592\n0.03910\n...\n0.05299\n0.09151\n0.08648\n0.05874\n0.05187\n0.03541\n0.02494\n0.03141\n0.03141\n0.02102\n\n\nAKT2\n0.04617\n0.04732\n0.04931\n0.04464\n0.04095\n0.04095\n0.03321\n0.03206\n0.03781\n0.03934\n...\n0.05199\n0.08844\n0.07580\n0.04992\n0.04770\n0.02772\n0.02680\n0.04196\n0.04196\n0.03193\n\n\n\n\n5 rows × 230 columns\n\n\n\n\ninfo = Data.get_kinase_info()\n\ninfo = info[info.pseudo=='0']\n\n\ninfo.shape\n\n(462, 36)\n\n\n\ninfo_map = info.set_index('kinase')['kd_ID']\n\n\npspa.index = pspa.index.to_series().map(info_map)\n\n\npspa\n\n\n\n\n\n\n\n\n-5P\n-5G\n-5A\n-5C\n-5S\n-5T\n-5V\n-5I\n-5L\n-5M\n...\n4H\n4K\n4R\n4Q\n4N\n4D\n4E\n4pS\n4pT\n4pY\n\n\nkinase\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nQ2M2I8_AAK1_HUMAN_KD1\n0.05845\n0.01989\n0.02305\n0.03702\n0.03450\n0.03450\n0.07720\n0.12615\n0.08061\n0.07014\n...\n0.04482\n0.06651\n0.07427\n0.05082\n0.04738\n0.03113\n0.03657\n0.02009\n0.02009\n0.02161\n\n\nP27037_AVR2A_HUMAN_KD1\n0.02971\n0.03443\n0.04180\n0.03500\n0.04137\n0.04137\n0.04281\n0.04474\n0.04266\n0.03729\n...\n0.04202\n0.03865\n0.03601\n0.04517\n0.04077\n0.04693\n0.04693\n0.05155\n0.05155\n0.04319\n\n\nQ13705_AVR2B_HUMAN_KD1\n0.03779\n0.03665\n0.04013\n0.05473\n0.03779\n0.03779\n0.03850\n0.03134\n0.03339\n0.03658\n...\n0.04056\n0.03261\n0.03514\n0.04229\n0.03846\n0.05278\n0.05039\n0.05502\n0.05502\n0.04605\n\n\nP31749_AKT1_HUMAN_KD1\n0.04669\n0.04599\n0.04274\n0.04684\n0.03995\n0.03995\n0.03306\n0.03368\n0.03592\n0.03910\n...\n0.05299\n0.09151\n0.08648\n0.05874\n0.05187\n0.03541\n0.02494\n0.03141\n0.03141\n0.02102\n\n\nP31751_AKT2_HUMAN_KD1\n0.04617\n0.04732\n0.04931\n0.04464\n0.04095\n0.04095\n0.03321\n0.03206\n0.03781\n0.03934\n...\n0.05199\n0.08844\n0.07580\n0.04992\n0.04770\n0.02772\n0.02680\n0.04196\n0.04196\n0.03193\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\nP17948_VGFR1_HUMAN_KD1\n0.04074\n0.04365\n0.03788\n0.03921\n0.03896\n0.03534\n0.03027\n0.02957\n0.02881\n0.03179\n...\n0.05811\n0.06189\n0.06516\n0.03921\n0.04734\n0.04891\n0.03636\n0.04827\n0.04827\n0.02709\n\n\nP35968_VGFR2_HUMAN_KD1\n0.04816\n0.05105\n0.04224\n0.03927\n0.04110\n0.03996\n0.03244\n0.03191\n0.03251\n0.03616\n...\n0.04386\n0.07036\n0.07377\n0.04718\n0.03979\n0.03074\n0.02808\n0.02492\n0.02492\n0.02426\n\n\nP35916_VGFR3_HUMAN_KD1\n0.03554\n0.04129\n0.03795\n0.04300\n0.03982\n0.03663\n0.03360\n0.03881\n0.03686\n0.04122\n...\n0.05899\n0.05158\n0.06051\n0.04823\n0.03842\n0.04042\n0.03962\n0.03548\n0.03548\n0.03986\n\n\nP07947_YES_HUMAN_KD1\n0.05216\n0.04399\n0.04137\n0.04084\n0.04060\n0.03891\n0.03352\n0.02889\n0.03082\n0.03567\n...\n0.04928\n0.04643\n0.05988\n0.05157\n0.03947\n0.03330\n0.03891\n0.02934\n0.02934\n0.03694\n\n\nP43403_ZAP70_HUMAN_KD1\n0.03902\n0.05704\n0.04038\n0.03215\n0.03053\n0.03332\n0.03014\n0.02463\n0.01990\n0.03410\n...\n0.05540\n0.04640\n0.04599\n0.05879\n0.03352\n0.04929\n0.04607\n0.03633\n0.03633\n0.02626\n\n\n\n\n381 rows × 230 columns\n\n\n\nGet the columns in order for reshape\n\npspa = pspa.apply(lambda r: pd.Series(flatten_pssm(recover_pssm(r),column_wise=False)), axis=1)\n\n\npspa # now the flattened pssm is row-wise flattend (go through position first)\n\n\n\n\n\n\n\n\n-5P\n-4P\n-3P\n-2P\n-1P\n0P\n1P\n2P\n3P\n4P\n...\n-5pY\n-4pY\n-3pY\n-2pY\n-1pY\n0pY\n1pY\n2pY\n3pY\n4pY\n\n\nkinase\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nQ2M2I8_AAK1_HUMAN_KD1\n0.05845\n0.04172\n0.08610\n0.01794\n0.09607\n0.0\n0.04265\n0.04048\n0.05264\n0.05026\n...\n0.04960\n0.02648\n0.02176\n0.03857\n0.01505\n0.0\n0.00921\n0.03149\n0.02775\n0.02161\n\n\nP27037_AVR2A_HUMAN_KD1\n0.02971\n0.03341\n0.03345\n0.01462\n0.02657\n0.0\n0.01055\n0.04285\n0.04958\n0.05559\n...\n0.05440\n0.04882\n0.06497\n0.03279\n0.07109\n0.0\n0.08706\n0.03799\n0.06031\n0.04319\n\n\nQ13705_AVR2B_HUMAN_KD1\n0.03779\n0.03774\n0.03044\n0.01482\n0.02331\n0.0\n0.01020\n0.05871\n0.05072\n0.05205\n...\n0.05268\n0.05987\n0.09086\n0.03918\n0.07259\n0.0\n0.08007\n0.04636\n0.05130\n0.04605\n\n\nP31749_AKT1_HUMAN_KD1\n0.04669\n0.04161\n0.02642\n0.01512\n0.04884\n0.0\n0.01689\n0.03375\n0.03828\n0.07361\n...\n0.03314\n0.03166\n0.01560\n0.01368\n0.04229\n0.0\n0.02693\n0.02975\n0.02656\n0.02102\n\n\nP31751_AKT2_HUMAN_KD1\n0.04617\n0.04437\n0.01778\n0.01873\n0.05226\n0.0\n0.03177\n0.03922\n0.04509\n0.07404\n...\n0.03651\n0.02930\n0.01671\n0.02063\n0.03864\n0.0\n0.03887\n0.04794\n0.04434\n0.03193\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\nP17948_VGFR1_HUMAN_KD1\n0.04074\n0.03414\n0.02854\n0.04313\n0.01986\n0.0\n0.01625\n0.02121\n0.04472\n0.06253\n...\n0.06599\n0.10046\n0.11411\n0.09176\n0.09614\n1.0\n0.10087\n0.10220\n0.03855\n0.02709\n\n\nP35968_VGFR2_HUMAN_KD1\n0.04816\n0.05296\n0.04610\n0.04524\n0.03253\n0.0\n0.02688\n0.02602\n0.03470\n0.05973\n...\n0.06115\n0.08767\n0.09090\n0.08310\n0.11178\n1.0\n0.08839\n0.07561\n0.01786\n0.02426\n\n\nP35916_VGFR3_HUMAN_KD1\n0.03554\n0.03875\n0.03354\n0.04111\n0.02239\n0.0\n0.02272\n0.01798\n0.02467\n0.05166\n...\n0.04596\n0.05470\n0.05802\n0.05403\n0.12136\n1.0\n0.09997\n0.11333\n0.02731\n0.03986\n\n\nP07947_YES_HUMAN_KD1\n0.05216\n0.04870\n0.04363\n0.05690\n0.05838\n0.0\n0.01899\n0.03019\n0.02228\n0.03449\n...\n0.05147\n0.05494\n0.05090\n0.05237\n0.03627\n1.0\n0.09052\n0.05174\n0.02739\n0.03694\n\n\nP43403_ZAP70_HUMAN_KD1\n0.03902\n0.06354\n0.03211\n0.02673\n0.01208\n0.0\n0.00802\n0.03680\n0.12355\n0.08125\n...\n0.07830\n0.10958\n0.13073\n0.11468\n0.33199\n1.0\n0.37989\n0.09746\n0.02374\n0.02626\n\n\n\n\n381 rows × 230 columns\n\n\n\n\n\nCDDM\n\ncddm=Data.get_cddm()\n\n\n# cddm = pd.read_parquet('out/CDDM_pssms.parquet')\n\n\ncddm.head()\n\n\n\n\n\n\n\n\n-20P\n-20G\n-20A\n-20C\n-20S\n-20T\n-20V\n-20I\n-20L\n-20M\n...\n20H\n20K\n20R\n20Q\n20N\n20D\n20E\n20pS\n20pT\n20pY\n\n\n\n\nSRC\n0.054538\n0.081380\n0.060077\n0.012356\n0.036216\n0.032382\n0.055816\n0.052407\n0.083511\n0.023434\n...\n0.013351\n0.076992\n0.060970\n0.037383\n0.036938\n0.052960\n0.086337\n0.025367\n0.015576\n0.023142\n\n\nEPHA3\n0.044276\n0.088013\n0.065335\n0.008639\n0.037797\n0.036717\n0.072354\n0.048596\n0.075594\n0.026998\n...\n0.014132\n0.083098\n0.059356\n0.031091\n0.033917\n0.056529\n0.100622\n0.025438\n0.013567\n0.015828\n\n\nFES\n0.047231\n0.082519\n0.070575\n0.011401\n0.034745\n0.039088\n0.061889\n0.053203\n0.088491\n0.026059\n...\n0.013053\n0.086266\n0.055619\n0.040863\n0.038025\n0.059024\n0.085698\n0.026674\n0.013621\n0.019296\n\n\nNTRK3\n0.044444\n0.074644\n0.074074\n0.017094\n0.033048\n0.035328\n0.060969\n0.058120\n0.084330\n0.026781\n...\n0.015682\n0.091677\n0.052473\n0.030760\n0.044029\n0.057298\n0.088661\n0.021713\n0.015682\n0.018094\n\n\nALK\n0.045748\n0.079765\n0.073314\n0.018182\n0.032845\n0.035191\n0.067449\n0.051026\n0.076246\n0.027566\n...\n0.015634\n0.090198\n0.069152\n0.030066\n0.043897\n0.051112\n0.096212\n0.026458\n0.013229\n0.017438\n\n\n\n\n5 rows × 943 columns\n\n\n\n\ncddm[cddm.index.to_series().map(info_map).isna()]\n\n\n\n\n\n\n\n\n-20P\n-20G\n-20A\n-20C\n-20S\n-20T\n-20V\n-20I\n-20L\n-20M\n...\n20H\n20K\n20R\n20Q\n20N\n20D\n20E\n20pS\n20pT\n20pY\n\n\n\n\n\n\n0 rows × 943 columns\n\n\n\n\ncddm.index = cddm.index.to_series().map(info_map)\n\n\ncddm = cddm[cddm.index.notna()]\n\n\ncddm.shape\n\n(328, 943)\n\n\n\ncddm\n\n\n\n\n\n\n\n\n-20P\n-20G\n-20A\n-20C\n-20S\n-20T\n-20V\n-20I\n-20L\n-20M\n...\n20H\n20K\n20R\n20Q\n20N\n20D\n20E\n20pS\n20pT\n20pY\n\n\n\n\nP12931_SRC_HUMAN_KD1\n0.054538\n0.081380\n0.060077\n0.012356\n0.036216\n0.032382\n0.055816\n0.052407\n0.083511\n0.023434\n...\n0.013351\n0.076992\n0.060970\n0.037383\n0.036938\n0.052960\n0.086337\n0.025367\n0.015576\n0.023142\n\n\nP29320_EPHA3_HUMAN_KD1\n0.044276\n0.088013\n0.065335\n0.008639\n0.037797\n0.036717\n0.072354\n0.048596\n0.075594\n0.026998\n...\n0.014132\n0.083098\n0.059356\n0.031091\n0.033917\n0.056529\n0.100622\n0.025438\n0.013567\n0.015828\n\n\nP07332_FES_HUMAN_KD1\n0.047231\n0.082519\n0.070575\n0.011401\n0.034745\n0.039088\n0.061889\n0.053203\n0.088491\n0.026059\n...\n0.013053\n0.086266\n0.055619\n0.040863\n0.038025\n0.059024\n0.085698\n0.026674\n0.013621\n0.019296\n\n\nQ16288_NTRK3_HUMAN_KD1\n0.044444\n0.074644\n0.074074\n0.017094\n0.033048\n0.035328\n0.060969\n0.058120\n0.084330\n0.026781\n...\n0.015682\n0.091677\n0.052473\n0.030760\n0.044029\n0.057298\n0.088661\n0.021713\n0.015682\n0.018094\n\n\nQ9UM73_ALK_HUMAN_KD1\n0.045748\n0.079765\n0.073314\n0.018182\n0.032845\n0.035191\n0.067449\n0.051026\n0.076246\n0.027566\n...\n0.015634\n0.090198\n0.069152\n0.030066\n0.043897\n0.051112\n0.096212\n0.026458\n0.013229\n0.017438\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\nQ15746_MYLK_HUMAN_KD1\n0.078947\n0.052632\n0.078947\n0.026316\n0.052632\n0.026316\n0.052632\n0.052632\n0.052632\n0.000000\n...\n0.000000\n0.066667\n0.022222\n0.044444\n0.133333\n0.044444\n0.000000\n0.044444\n0.022222\n0.000000\n\n\nQ01973_ROR1_HUMAN_KD1\n0.097561\n0.097561\n0.024390\n0.000000\n0.024390\n0.146341\n0.170732\n0.024390\n0.048780\n0.000000\n...\n0.000000\n0.075000\n0.050000\n0.000000\n0.050000\n0.025000\n0.125000\n0.125000\n0.000000\n0.025000\n\n\nO14976_GAK_HUMAN_KD1\n0.075000\n0.075000\n0.175000\n0.000000\n0.025000\n0.025000\n0.100000\n0.025000\n0.050000\n0.175000\n...\n0.000000\n0.024390\n0.024390\n0.000000\n0.170732\n0.195122\n0.024390\n0.048780\n0.024390\n0.000000\n\n\nQ6P0Q8_MAST2_HUMAN_KD1\n0.046512\n0.116279\n0.069767\n0.000000\n0.023256\n0.069767\n0.069767\n0.000000\n0.046512\n0.046512\n...\n0.000000\n0.048780\n0.219512\n0.000000\n0.048780\n0.024390\n0.024390\n0.024390\n0.000000\n0.000000\n\n\nP15056_BRAF_HUMAN_KD1\n0.095238\n0.071429\n0.047619\n0.000000\n0.095238\n0.047619\n0.071429\n0.000000\n0.095238\n0.047619\n...\n0.000000\n0.075000\n0.075000\n0.025000\n0.025000\n0.075000\n0.075000\n0.050000\n0.000000\n0.000000\n\n\n\n\n328 rows × 943 columns\n\n\n\n\ncddm.shape\n\n(328, 943)\n\n\n\n# row first flatten\ncddm = cddm.apply(lambda r: pd.Series(flatten_pssm(recover_pssm(r),column_wise=False)), axis=1)\n\n\ncddm\n\n\n\n\n\n\n\n\n-20P\n-19P\n-18P\n-17P\n-16P\n-15P\n-14P\n-13P\n-12P\n-11P\n...\n11pY\n12pY\n13pY\n14pY\n15pY\n16pY\n17pY\n18pY\n19pY\n20pY\n\n\n\n\nP12931_SRC_HUMAN_KD1\n0.054538\n0.048428\n0.054968\n0.050526\n0.045837\n0.046599\n0.060746\n0.060644\n0.056785\n0.055857\n...\n0.016818\n0.020346\n0.015231\n0.010512\n0.014912\n0.014952\n0.010568\n0.010615\n0.018198\n0.023142\n\n\nP29320_EPHA3_HUMAN_KD1\n0.044276\n0.047875\n0.047696\n0.043803\n0.046425\n0.052716\n0.053135\n0.055231\n0.040762\n0.047015\n...\n0.015795\n0.019704\n0.012672\n0.010538\n0.012236\n0.011161\n0.010626\n0.006738\n0.016356\n0.015828\n\n\nP07332_FES_HUMAN_KD1\n0.047231\n0.045455\n0.049569\n0.049919\n0.040729\n0.047568\n0.054400\n0.056503\n0.051623\n0.043039\n...\n0.014786\n0.018712\n0.011621\n0.018942\n0.012828\n0.012856\n0.011211\n0.007878\n0.014698\n0.019296\n\n\nQ16288_NTRK3_HUMAN_KD1\n0.044444\n0.049404\n0.046433\n0.049689\n0.041150\n0.045557\n0.049972\n0.048603\n0.045682\n0.043382\n...\n0.013945\n0.019848\n0.011137\n0.015348\n0.016588\n0.012470\n0.014863\n0.005970\n0.016837\n0.018094\n\n\nQ9UM73_ALK_HUMAN_KD1\n0.045748\n0.044418\n0.053976\n0.046821\n0.047921\n0.051208\n0.055587\n0.056128\n0.043950\n0.045610\n...\n0.018508\n0.016860\n0.011703\n0.012382\n0.011820\n0.010664\n0.010702\n0.005974\n0.014397\n0.017438\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\nQ15746_MYLK_HUMAN_KD1\n0.078947\n0.100000\n0.047619\n0.093023\n0.069767\n0.046512\n0.136364\n0.044444\n0.044444\n0.086957\n...\n0.021277\n0.000000\n0.000000\n0.021739\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n\n\nQ01973_ROR1_HUMAN_KD1\n0.097561\n0.024390\n0.024390\n0.219512\n0.024390\n0.000000\n0.073171\n0.071429\n0.047619\n0.190476\n...\n0.000000\n0.000000\n0.000000\n0.023810\n0.000000\n0.000000\n0.000000\n0.000000\n0.047619\n0.025000\n\n\nO14976_GAK_HUMAN_KD1\n0.075000\n0.200000\n0.000000\n0.073171\n0.048780\n0.024390\n0.073171\n0.073171\n0.024390\n0.097561\n...\n0.000000\n0.000000\n0.048780\n0.024390\n0.000000\n0.000000\n0.000000\n0.024390\n0.000000\n0.000000\n\n\nQ6P0Q8_MAST2_HUMAN_KD1\n0.046512\n0.023256\n0.023256\n0.000000\n0.139535\n0.046512\n0.069767\n0.093023\n0.000000\n0.162791\n...\n0.000000\n0.000000\n0.000000\n0.024390\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n\n\nP15056_BRAF_HUMAN_KD1\n0.095238\n0.071429\n0.047619\n0.047619\n0.095238\n0.047619\n0.047619\n0.023810\n0.047619\n0.047619\n...\n0.000000\n0.046512\n0.000000\n0.024390\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n\n\n\n\n328 rows × 943 columns",
    "crumbs": [
      "kinase_domain",
      "Prepare data for training"
    ]
  },
  {
    "objectID": "kinase_domain/kd_04_prepare_data.html#kinase-not-in-active-kd",
    "href": "kinase_domain/kd_04_prepare_data.html#kinase-not-in-active-kd",
    "title": "Prepare data for training",
    "section": "Kinase not in active kd",
    "text": "Kinase not in active kd\n\ncddm[~cddm.index.isin(t5.index)]\n\n\n\n\n\n\n\n\n-20P\n-19P\n-18P\n-17P\n-16P\n-15P\n-14P\n-13P\n-12P\n-11P\n...\n11pY\n12pY\n13pY\n14pY\n15pY\n16pY\n17pY\n18pY\n19pY\n20pY\n\n\n\n\nO00418_EF2K_HUMAN_KD1\n0.058201\n0.015873\n0.026316\n0.062827\n0.088083\n0.036269\n0.025773\n0.040816\n0.035714\n0.030303\n...\n0.010471\n0.010582\n0.005319\n0.010753\n0.005376\n0.005376\n0.010753\n0.038043\n0.043478\n0.022099\n\n\nQ8TF76_HASP_HUMAN_KD1\n0.045455\n0.036364\n0.036364\n0.118182\n0.117117\n0.097345\n0.034483\n0.025210\n0.066667\n0.082645\n...\n0.000000\n0.008403\n0.000000\n0.000000\n0.000000\n0.034483\n0.000000\n0.008850\n0.000000\n0.008850\n\n\nO43683_BUB1_HUMAN_KD1\n0.130000\n0.060000\n0.039604\n0.089109\n0.079208\n0.049505\n0.049505\n0.019802\n0.089109\n0.148515\n...\n0.000000\n0.020619\n0.010309\n0.000000\n0.010417\n0.000000\n0.000000\n0.000000\n0.000000\n0.043956\n\n\nQ15118_PDK1_HUMAN_KD1\n0.020619\n0.030928\n0.010309\n0.030928\n0.072165\n0.051546\n0.072165\n0.051546\n0.061856\n0.092784\n...\n0.000000\n0.000000\n0.021978\n0.021978\n0.021978\n0.010989\n0.010989\n0.065934\n0.000000\n0.043956\n\n\nQ15120_PDK3_HUMAN_KD1\n0.044776\n0.014925\n0.059701\n0.074627\n0.029851\n0.044776\n0.104478\n0.059701\n0.059701\n0.029851\n...\n0.000000\n0.015152\n0.015625\n0.000000\n0.000000\n0.016129\n0.000000\n0.000000\n0.049180\n0.016949\n\n\nQ9UPE1_SRPK3_HUMAN_KD1\n0.140351\n0.137931\n0.051724\n0.034483\n0.051724\n0.034483\n0.120690\n0.033898\n0.083333\n0.033333\n...\n0.017857\n0.000000\n0.018182\n0.000000\n0.000000\n0.018182\n0.072727\n0.000000\n0.000000\n0.000000\n\n\nQ96QT4_TRPM7_HUMAN_KD1\n0.056604\n0.056604\n0.037736\n0.037736\n0.018868\n0.056604\n0.037736\n0.018868\n0.075472\n0.037736\n...\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.018868\n0.000000\n0.000000\n0.000000\n0.000000\n\n\nP78362_SRPK2_HUMAN_KD1\n0.040816\n0.120000\n0.100000\n0.060000\n0.040000\n0.060000\n0.060000\n0.117647\n0.096154\n0.057692\n...\n0.019231\n0.000000\n0.038462\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.038462\n0.000000\n\n\n\n\n8 rows × 943 columns\n\n\n\n\npspa[~pspa.index.isin(t5.index)]\n\n\n\n\n\n\n\n\n-5P\n-4P\n-3P\n-2P\n-1P\n0P\n1P\n2P\n3P\n4P\n...\n-5pY\n-4pY\n-3pY\n-2pY\n-1pY\n0pY\n1pY\n2pY\n3pY\n4pY\n\n\nkinase\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nQ96QP1_ALPK1_HUMAN_KD1\n0.03973\n0.04168\n0.03652\n0.06123\n0.02496\n0.0\n0.01772\n0.04255\n0.03160\n0.04294\n...\n0.07500\n0.07550\n0.05888\n0.01946\n0.27908\n0.0\n0.07937\n0.05559\n0.07007\n0.11014\n\n\nO14874_BCKD_HUMAN_KD1\n0.03595\n0.04598\n0.04280\n0.03844\n0.02034\n0.0\n0.01931\n0.02783\n0.03869\n0.04788\n...\n0.03930\n0.04978\n0.05735\n0.04417\n0.02739\n0.0\n0.02393\n0.03109\n0.02469\n0.06467\n\n\nO43683_BUB1_HUMAN_KD1\n0.07426\n0.07109\n0.18419\n0.03555\n0.06640\n0.0\n0.01817\n0.10522\n0.18797\n0.04496\n...\n0.04824\n0.01959\n0.01247\n0.01383\n0.01573\n0.0\n0.01245\n0.01418\n0.03246\n0.02169\n\n\nQ96QT4_TRPM7_HUMAN_KD1\n0.04609\n0.04097\n0.04660\n0.05748\n0.04163\n0.0\n0.00657\n0.06653\n0.02913\n0.03127\n...\n0.04517\n0.03860\n0.04748\n0.03035\n0.03610\n0.0\n0.03936\n0.02287\n0.03167\n0.02498\n\n\nQ9BX84_TRPM6_HUMAN_KD1\n0.03886\n0.05789\n0.06523\n0.07878\n0.04588\n0.0\n0.01715\n0.10699\n0.04510\n0.05681\n...\n0.03397\n0.04355\n0.04162\n0.03310\n0.03471\n0.0\n0.05262\n0.03272\n0.03617\n0.03985\n\n\nO00418_EF2K_HUMAN_KD1\n0.04257\n0.03937\n0.04509\n0.06556\n0.04301\n0.0\n0.01077\n0.01711\n0.01597\n0.04253\n...\n0.06092\n0.03335\n0.05386\n0.08511\n0.04491\n0.0\n0.07859\n0.01808\n0.04185\n0.03273\n\n\nQ8IXL6_FA20C_HUMAN_KD1\n0.03618\n0.04512\n0.04155\n0.04672\n0.01342\n0.0\n0.01157\n0.00896\n0.01029\n0.02706\n...\n0.05085\n0.04692\n0.06779\n0.08276\n0.04771\n0.0\n0.03191\n0.05062\n0.08779\n0.09533\n\n\nQ8TF76_HASP_HUMAN_KD1\n0.05828\n0.04374\n0.04727\n0.07855\n0.02508\n0.0\n0.04105\n0.02664\n0.03435\n0.03703\n...\n0.04459\n0.03296\n0.04591\n0.04146\n0.02958\n0.0\n0.01633\n0.01709\n0.02363\n0.02728\n\n\nQ15118_PDK1_HUMAN_KD1\n0.03130\n0.04429\n0.04092\n0.03627\n0.03858\n0.0\n0.02843\n0.03993\n0.04791\n0.04700\n...\n0.04567\n0.05228\n0.03970\n0.04040\n0.03094\n0.0\n0.03391\n0.04205\n0.03010\n0.03992\n\n\nQ16654_PDK4_HUMAN_KD1\n0.03068\n0.03645\n0.04143\n0.04867\n0.03913\n0.0\n0.03689\n0.03562\n0.03821\n0.04236\n...\n0.04521\n0.07603\n0.05581\n0.04229\n0.03139\n0.0\n0.04003\n0.05163\n0.04070\n0.04230\n\n\nQ96SB4_SRPK1_HUMAN_KD1\n0.04459\n0.06105\n0.02966\n0.04491\n0.08984\n0.0\n0.23129\n0.05645\n0.08265\n0.05774\n...\n0.04182\n0.06301\n0.03428\n0.06097\n0.03566\n0.0\n0.02252\n0.04015\n0.03186\n0.04500\n\n\nP78362_SRPK2_HUMAN_KD1\n0.03484\n0.08329\n0.01786\n0.03738\n0.06923\n0.0\n0.21658\n0.05448\n0.08178\n0.04584\n...\n0.03718\n0.05643\n0.02320\n0.04946\n0.03666\n0.0\n0.03288\n0.03275\n0.03074\n0.04107\n\n\nQ9UPE1_SRPK3_HUMAN_KD1\n0.03248\n0.04123\n0.01834\n0.03205\n0.06979\n0.0\n0.18279\n0.04024\n0.06823\n0.04594\n...\n0.05033\n0.09188\n0.06132\n0.07519\n0.06084\n0.0\n0.03434\n0.03817\n0.03436\n0.04144\n\n\n\n\n13 rows × 230 columns",
    "crumbs": [
      "kinase_domain",
      "Prepare data for training"
    ]
  },
  {
    "objectID": "kinase_domain/kd_04_prepare_data.html#target-feature",
    "href": "kinase_domain/kd_04_prepare_data.html#target-feature",
    "title": "Prepare data for training",
    "section": "target + feature",
    "text": "target + feature\n\ndef combine(target_df,feat_df): return target_df.merge(feat_df,left_index=True,right_index=True)\n\n\npspa_onehot =combine(pspa,onehot)\npspa_onehot_pca =combine(pspa,onehot_pca)\n\npspa_esm = combine(pspa,esm)\npspa_t5 = combine(pspa,t5)\n\n\ncddm_onehot =combine(cddm,onehot)\ncddm_onehot_pca =combine(cddm,onehot_pca)\n\ncddm_esm = combine(cddm,esm)\ncddm_t5 = combine(cddm,t5)\n\n\nprint(pspa_onehot.shape)\nprint(pspa_onehot_pca.shape)\nprint(pspa_esm.shape)\nprint(pspa_t5.shape)\n\nprint(cddm_onehot.shape)\nprint(cddm_onehot_pca.shape)\nprint(cddm_esm.shape)\nprint(cddm_t5.shape)\n\n(368, 7079)\n(368, 1230)\n(368, 1510)\n(368, 1254)\n(320, 7792)\n(320, 1943)\n(320, 2223)\n(320, 1967)\n\n\n\npspa_onehot.to_parquet('train/pspa_onehot.parquet')\npspa_onehot_pca.to_parquet('train/pspa_onehot_pca.parquet')\npspa_esm.to_parquet('train/pspa_esm.parquet')\npspa_t5.to_parquet('train/pspa_t5.parquet')\n\n\ncddm_onehot.to_parquet('train/cddm_onehot.parquet')\ncddm_onehot_pca.to_parquet('train/cddm_onehot_pca.parquet')\ncddm_esm.to_parquet('train/cddm_esm.parquet')\ncddm_t5.to_parquet('train/cddm_t5.parquet')\n\n\npspa_onehot_pca\n\n\n\n\n\n\n\n\n-5P\n-4P\n-3P\n-2P\n-1P\n0P\n1P\n2P\n3P\n4P\n...\nPCA991\nPCA992\nPCA993\nPCA994\nPCA995\nPCA996\nPCA997\nPCA998\nPCA999\nPCA1000\n\n\n\n\nQ2M2I8_AAK1_HUMAN_KD1\n0.05845\n0.04172\n0.08610\n0.01794\n0.09607\n0.0\n0.04265\n0.04048\n0.05264\n0.05026\n...\n0.049938\n0.057859\n0.005693\n-0.006881\n0.041570\n0.039594\n0.080002\n0.022089\n0.017665\n0.013385\n\n\nP27037_AVR2A_HUMAN_KD1\n0.02971\n0.03341\n0.03345\n0.01462\n0.02657\n0.0\n0.01055\n0.04285\n0.04958\n0.05559\n...\n-0.024776\n0.001753\n-0.056504\n0.164427\n-0.072278\n0.052143\n-0.015666\n0.010091\n0.138182\n-0.033171\n\n\nQ13705_AVR2B_HUMAN_KD1\n0.03779\n0.03774\n0.03044\n0.01482\n0.02331\n0.0\n0.01020\n0.05871\n0.05072\n0.05205\n...\n0.009370\n-0.030940\n0.050483\n-0.100141\n0.045942\n-0.005657\n-0.010641\n0.112414\n-0.166770\n0.025360\n\n\nP31749_AKT1_HUMAN_KD1\n0.04669\n0.04161\n0.02642\n0.01512\n0.04884\n0.0\n0.01689\n0.03375\n0.03828\n0.07361\n...\n0.081445\n0.019706\n0.042164\n0.192072\n0.001691\n-0.068809\n0.071163\n-0.010879\n-0.028764\n0.042163\n\n\nP31751_AKT2_HUMAN_KD1\n0.04617\n0.04437\n0.01778\n0.01873\n0.05226\n0.0\n0.03177\n0.03922\n0.04509\n0.07404\n...\n-0.059736\n-0.120186\n-0.060415\n-0.245777\n-0.113104\n0.116407\n0.054151\n0.135826\n0.001413\n-0.007756\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\nP17948_VGFR1_HUMAN_KD1\n0.04074\n0.03414\n0.02854\n0.04313\n0.01986\n0.0\n0.01625\n0.02121\n0.04472\n0.06253\n...\n-0.031060\n-0.010548\n0.035789\n-0.113515\n0.221636\n0.034873\n-0.093145\n-0.005760\n0.110737\n0.147448\n\n\nP35968_VGFR2_HUMAN_KD1\n0.04816\n0.05296\n0.04610\n0.04524\n0.03253\n0.0\n0.02688\n0.02602\n0.03470\n0.05973\n...\n0.131558\n-0.033205\n0.098801\n0.054086\n0.010220\n0.041245\n-0.004853\n-0.205461\n-0.048656\n-0.156289\n\n\nP35916_VGFR3_HUMAN_KD1\n0.03554\n0.03875\n0.03354\n0.04111\n0.02239\n0.0\n0.02272\n0.01798\n0.02467\n0.05166\n...\n-0.067793\n0.110357\n-0.015003\n0.090916\n-0.156411\n0.001075\n-0.101868\n0.228029\n0.076798\n-0.143131\n\n\nP07947_YES_HUMAN_KD1\n0.05216\n0.04870\n0.04363\n0.05690\n0.05838\n0.0\n0.01899\n0.03019\n0.02228\n0.03449\n...\n0.065050\n-0.028076\n-0.064543\n0.093354\n0.083031\n0.011155\n-0.002236\n-0.147592\n-0.093897\n0.161915\n\n\nP43403_ZAP70_HUMAN_KD1\n0.03902\n0.06354\n0.03211\n0.02673\n0.01208\n0.0\n0.00802\n0.03680\n0.12355\n0.08125\n...\n0.017745\n0.021932\n-0.284451\n-0.151152\n-0.291706\n-0.144981\n0.023568\n-0.088461\n0.209291\n-0.154225\n\n\n\n\n368 rows × 1230 columns",
    "crumbs": [
      "kinase_domain",
      "Prepare data for training"
    ]
  },
  {
    "objectID": "kinase_domain/kd_08a_similarity_relationship.html",
    "href": "kinase_domain/kd_08a_similarity_relationship.html",
    "title": "KD similarity & PSSM similarity",
    "section": "",
    "text": "import pandas as pd, numpy as np\nimport matplotlib.pyplot as plt\nfrom numpy.linalg import norm\nfrom katlas.data import *\nfrom scipy.stats import spearmanr\nfrom katlas.plot import *\nfrom katlas.clustering import *\npspa_t5 = pd.read_parquet('train/pspa_t5.parquet')\ndf = pspa_t5.copy()\ndf['0pY'].value_counts()\n\n0pY\n0.0    290\n1.0     78\nName: count, dtype: int64\nst = df[df['0pY']==0].copy()\ntyr = df[df['0pY']==1].copy()\ndef euclidean_dist(u, v):\n    return norm(u - v)\ndef get_dist(df):\n    df =df.copy()\n    t5_cols = df.columns[df.columns.str.startswith('T5')]\n    pssm_cols = df.columns[~df.columns.str.startswith('T5')]\n    D_pssm = get_1d_js_parallel(df[pssm_cols])\n    D_t5 = get_1d_distance_parallel(df[t5_cols],func_flat=euclidean_dist)\n    return D_t5,D_pssm\nD_t5,D_pssm= get_dist(st)\nD_t5_y,D_pssm_y= get_dist(tyr)\ndef plot_scatter(x, y,line=None):\n    plt.figure(figsize=(4,3), dpi=300)\n    plt.scatter(x, y, s=3, alpha=0.3)\n\n    # labels\n    plt.xlabel(\"Euclidean distance in T5 embeddings of KDs\")\n    plt.ylabel(\"JS divergence in PSSMs\")\n\n    # calculate Spearman correlation\n    rho, pval = spearmanr(x, y)\n\n    # annotate Spearman correlation coefficient on the plot\n    plt.text(0.95, 0.95, f\"Spearman ρ = {rho:.3f}\", \n             ha=\"right\", va=\"top\", transform=plt.gca().transAxes,\n             fontsize=10, bbox=dict(facecolor=\"white\", alpha=0.6, edgecolor=\"none\"))\n\n    if line is not None: plt.axvline(x=line, color=\"darkred\", alpha=0.7,linestyle=\"--\", linewidth=1)\n    plt.tight_layout()\nplot_scatter(D_t5,D_pssm,line=0.25)\nplt.title('PSSM distance vs. KD distance')\nsave_svg('fig/JSD_PSSM_vs_KD_distance.svg')\nplot_scatter(D_t5_y,D_pssm_y,line=0.25)",
    "crumbs": [
      "kinase_domain",
      "KD similarity & PSSM similarity"
    ]
  },
  {
    "objectID": "kinase_domain/kd_08a_similarity_relationship.html#distance-in-all-kd",
    "href": "kinase_domain/kd_08a_similarity_relationship.html#distance-in-all-kd",
    "title": "KD similarity & PSSM similarity",
    "section": "Distance in all kd",
    "text": "Distance in all kd\n\ndf  = Data.get_kd_uniprot()\n\n\ndf = df[df.active_D1_D2==1].reset_index(drop=True)\n\n\ndf['in_pspa']  = df.kd_ID.isin(pspa_t5.index).astype(int)\n# df['in_cddm']  = df.kd_ID.isin(cddm_t5.index).astype(int)\n\n\ndf.in_pspa.value_counts()\n\nin_pspa\n0    3841\n1     368\nName: count, dtype: int64\n\n\n\n# from katlas.feature import *\n\n# t5 = get_t5(df,col='kd_seq')\n\n# t5.index=df.kd_ID\n\n# t5 = t5.astype('float64')\n\n# t5.to_parquet('out/uniprot_kd_t5.parquet')\n\n\nt5_df = pd.read_parquet('raw/t5_kd.parquet')\n\n\ndef find_close_negatives(df: pd.DataFrame,\n                         label_series,\n                         threshold: float = 0.25,\n                         return_all: bool = False) -&gt; pd.DataFrame:\n    \"\"\"\n    For each negative (label_col==0), find the nearest positive (label_col==1)\n    by Euclidean distance over `features`, and mark whether it's within `threshold`.\n\n    Returns a DataFrame indexed by the negatives' index with columns:\n      - closest_pos_index\n      - closest_dist\n      - within_threshold (bool)\n    If `return_all=False`, only rows within threshold are returned.\n    \"\"\"\n\n    # Extract arrays\n    mask_pos = label_series.eq(1).to_numpy()\n    mask_neg = ~mask_pos\n\n    X_pos = df.loc[mask_pos].to_numpy(dtype=float, copy=False)\n    X_neg = df.loc[mask_neg].to_numpy(dtype=float, copy=False)\n\n    # Handle edge cases\n    if X_pos.size == 0 or X_neg.size == 0:\n        out = pd.DataFrame(columns=[\"closest_pos_index\", \"closest_dist\", \"within_threshold\"],\n                           index=df.index[mask_neg])\n        return out if return_all else out.iloc[0:0]\n\n    # Pairwise squared distances: ||a-b||^2 = ||a||^2 + ||b||^2 - 2 a·b\n    sq_pos = np.einsum('ij,ij-&gt;i', X_pos, X_pos)            # (P,)\n    sq_neg = np.einsum('ij,ij-&gt;i', X_neg, X_neg)            # (N,)\n    D2 = sq_neg[:, None] + sq_pos[None, :] - 2.0 * (X_neg @ X_pos.T)\n    np.maximum(D2, 0.0, out=D2)                             # numerical safety\n    # Nearest positive for each negative\n    idx_min = D2.argmin(axis=1)                             # (N,)\n    dmin = np.sqrt(D2[np.arange(D2.shape[0]), idx_min])     # (N,)\n\n    # Map back to indices\n    pos_index = df.index[mask_pos].to_numpy()\n    neg_index = df.index[mask_neg].to_numpy()\n    closest_pos_index = pos_index[idx_min]\n\n    out = pd.DataFrame({\n        \"closest_pos_index\": closest_pos_index,\n        \"closest_dist\": dmin,\n        \"within_threshold\": dmin &lt;= threshold,\n    }, index=neg_index)\n\n    return out if return_all else out[out[\"within_threshold\"]]\n\n\nresults_pspa = find_close_negatives(t5_df, label_series=df.in_pspa,\n                                   threshold=0.25, return_all=True)\n\n\nresults_pspa.to_parquet('raw/kd_similar_pspa.parquet')\n\n\nresults_pspa[results_pspa.within_threshold].sort_values('closest_dist')\n\n\n\n\n\n\n\n\nclosest_pos_index\nclosest_dist\nwithin_threshold\n\n\n\n\nA4K2Y1_STK4_CHLAE_KD1\nQ13043_STK4_HUMAN_KD1\n0.000000\nTrue\n\n\nA4K2T0_STK4_MACMU_KD1\nQ13043_STK4_HUMAN_KD1\n0.000000\nTrue\n\n\nQ5RCY1_UHMK1_PONAB_KD1\nQ8TAS1_UHMK1_HUMAN_KD1\n0.000000\nTrue\n\n\nQ5RCC4_KCC2A_PONAB_KD1\nQ9UQM7_KCC2A_HUMAN_KD1\n0.000000\nTrue\n\n\nA2VDU3_M3K7_BOVIN_KD1\nO43318_M3K7_HUMAN_KD1\n0.000000\nTrue\n\n\n...\n...\n...\n...\n\n\nO08605_MKNK1_MOUSE_KD1\nQ9HBH9_MKNK2_HUMAN_KD1\n0.248701\nTrue\n\n\nP87253_KPC1_NEUCR_KD1\nQ04759_KPCT_HUMAN_KD1\n0.249016\nTrue\n\n\nQ9W739_CDK1_RANDY_KD1\nP06493_CDK1_HUMAN_KD1\n0.249479\nTrue\n\n\nQ99PW4_PRPKB_MOUSE_KD1\nQ96S44_PRPK_HUMAN_KD1\n0.249534\nTrue\n\n\nQ8AYG3_TTK_DANRE_KD1\nP33981_TTK_HUMAN_KD1\n0.249601\nTrue\n\n\n\n\n1230 rows × 3 columns",
    "crumbs": [
      "kinase_domain",
      "KD similarity & PSSM similarity"
    ]
  },
  {
    "objectID": "kinase_domain/kd_02_pseudo_alignment.html",
    "href": "kinase_domain/kd_02_pseudo_alignment.html",
    "title": "Alignment",
    "section": "",
    "text": "from Bio.Seq import Seq\nfrom Bio.SeqRecord import SeqRecord\nfrom Bio import SeqIO, AlignIO\nimport pandas as pd\n\nfrom katlas.utils import *\nfrom katlas.data import *",
    "crumbs": [
      "kinase_domain",
      "Alignment"
    ]
  },
  {
    "objectID": "kinase_domain/kd_02_pseudo_alignment.html#prepare-fasta-file-for-clustalo",
    "href": "kinase_domain/kd_02_pseudo_alignment.html#prepare-fasta-file-for-clustalo",
    "title": "Alignment",
    "section": "Prepare fasta file for clustalo",
    "text": "Prepare fasta file for clustalo\n\n# kd=pd.read_excel('out/uniprot_kd.xlsx')\n\n\nkd=Data.get_kd_uniprot()\n\n\nkd.columns\n\nIndex(['kd_ID', 'Uniprot', 'Entry Name', 'Protein names', 'Gene Names',\n       'Gene Names (primary)', 'Organism', 'kd_note', 'kd_evidence',\n       'kd_start', 'kd_end', 'kd_seq', 'Domain [FT]', 'Domain [CC]', 'Region',\n       'Motif', 'Protein families', 'Reactome', 'ComplexPortal',\n       'Subcellular location [CC]', 'Gene Ontology (biological process)',\n       'Tissue specificity', 'Interacts with', 'Subunit structure',\n       'Function [CC]', 'Activity regulation', 'full_seq', 'D1', 'D2', 'D3',\n       'N1', 'active_D1_D2'],\n      dtype='object')\n\n\n\nget_fasta(kd,\n          seq_col='kd_seq',\n          id_col='kd_ID',\n          path='raw/kinase_domains.fasta')\n\n5536\n\n\nFor human only:\n\n# human = kd[kd.Organism=='Homo sapiens (Human)']\n\n# get_fasta(human,path=\"raw/human_kinase_domains.fasta\")\n\nfor PI3K catalytic domain\n\n# pi3k = kd[kd.kd_note=='PI3K/PI4K catalytic']\n\n# get_fasta(pi3k,path=\"raw/pi3k_kinase_domains.fasta\")",
    "crumbs": [
      "kinase_domain",
      "Alignment"
    ]
  },
  {
    "objectID": "kinase_domain/kd_02_pseudo_alignment.html#run-clustalo",
    "href": "kinase_domain/kd_02_pseudo_alignment.html#run-clustalo",
    "title": "Alignment",
    "section": "Run clustalo",
    "text": "Run clustalo\nsudo apt-get update\nsudo apt-get install clustalo\nclustalo -i kinase_domains.fasta -o kinase_domains.aln --force --outfmt=clu\n\n# run_clustalo(input_fasta='raw/kinase_domains.fasta', \n#              output_aln = \"raw/kinase_domains.aln\")",
    "crumbs": [
      "kinase_domain",
      "Alignment"
    ]
  },
  {
    "objectID": "kinase_domain/kd_02_pseudo_alignment.html#analyze-alignment",
    "href": "kinase_domain/kd_02_pseudo_alignment.html#analyze-alignment",
    "title": "Alignment",
    "section": "Analyze alignment",
    "text": "Analyze alignment\n\ndf = aln2df(\"raw/kinase_domains.aln\")\n\n\ndf.head()\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n...\n3425\n3426\n3427\n3428\n3429\n3430\n3431\n3432\n3433\n3434\n\n\n\n\nA0A075F7E9_LERK1_ORYSI_KD1\n-\n-\n-\n-\n-\n-\n-\n-\n-\n-\n...\n-\n-\n-\n-\n-\n-\n-\n-\n-\n-\n\n\nA0A078BQP2_GCY25_CAEEL_KD1\n-\n-\n-\n-\n-\n-\n-\n-\n-\n-\n...\n-\n-\n-\n-\n-\n-\n-\n-\n-\n-\n\n\nA0A078CGE6_M3KE1_BRANA_KD1\n-\n-\n-\n-\n-\n-\n-\n-\n-\n-\n...\n-\n-\n-\n-\n-\n-\n-\n-\n-\n-\n\n\nA0A0G2K344_PK3CA_RAT_KD1\n-\n-\n-\n-\n-\n-\n-\n-\n-\n-\n...\n-\n-\n-\n-\n-\n-\n-\n-\n-\n-\n\n\nA0A0H2ZM62_HK06_STRP2_KD1\n-\n-\n-\n-\n-\n-\n-\n-\n-\n-\n...\n-\n-\n-\n-\n-\n-\n-\n-\n-\n-\n\n\n\n\n5 rows × 3434 columns\n\n\n\n\n# change type to str to save in parquet\ndf.columns = df.columns.astype(str)\n\n\ndf.to_parquet('raw/uniprot_kd_align.parquet')\n\n\n# reverse back\ndf.columns = df.columns.astype(int)",
    "crumbs": [
      "kinase_domain",
      "Alignment"
    ]
  },
  {
    "objectID": "kinase_domain/kd_02_pseudo_alignment.html#frequency-of-aa-at-position-1-3434",
    "href": "kinase_domain/kd_02_pseudo_alignment.html#frequency-of-aa-at-position-1-3434",
    "title": "Alignment",
    "section": "Frequency of aa at position 1-3434",
    "text": "Frequency of aa at position 1-3434\n\n# Compute residue frequency at each position\ncounts_df = df.apply(lambda col: col.value_counts(), axis=0).fillna(0)\nfreq_df = counts_df.div(counts_df.sum(axis=0), axis=1)\n\n\nfreq_df.head()\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n...\n3425\n3426\n3427\n3428\n3429\n3430\n3431\n3432\n3433\n3434\n\n\n\n\n-\n0.999819\n0.999819\n0.999819\n0.999819\n0.999819\n0.999819\n0.999819\n0.999819\n0.999819\n0.999819\n...\n0.999819\n0.999819\n0.999819\n0.999819\n0.999819\n0.999819\n0.999819\n0.999819\n0.999819\n0.999819\n\n\nA\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n...\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n\n\nC\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n...\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n\n\nD\n0.000000\n0.000181\n0.000000\n0.000000\n0.000181\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n...\n0.000000\n0.000181\n0.000181\n0.000000\n0.000000\n0.000000\n0.000181\n0.000000\n0.000000\n0.000000\n\n\nE\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n...\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.000181\n0.000000\n0.000000\n\n\n\n\n5 rows × 3434 columns\n\n\n\n\n# remove '-' first line\nmax_series=freq_df.iloc[1:,:]\n\n\nfreq_max = pd.concat([max_series.idxmax(),max_series.max()],axis=1)\n\n\nfreq_max.columns = ['aa','max_value']\n\n\nfreq_max = freq_max.sort_values('max_value',ascending=False).reset_index(names='position')\n\n\nout = freq_max[freq_max.max_value&gt;0.1]\n\n\nout\n\n\n\n\n\n\n\n\nposition\naa\nmax_value\n\n\n\n\n0\n1549\nN\n0.815390\n\n\n1\n2618\nD\n0.809429\n\n\n2\n1724\nD\n0.800759\n\n\n3\n1525\nD\n0.791004\n\n\n4\n1730\nG\n0.775470\n\n\n...\n...\n...\n...\n\n\n214\n640\nG\n0.101879\n\n\n215\n193\nE\n0.101879\n\n\n216\n922\nL\n0.101337\n\n\n217\n603\nR\n0.101156\n\n\n218\n2581\nG\n0.100614\n\n\n\n\n219 rows × 3 columns\n\n\n\n\n# out.to_csv('out/align_freq_max_aa.csv',index=False)",
    "crumbs": [
      "kinase_domain",
      "Alignment"
    ]
  },
  {
    "objectID": "kinase_domain/kd_02_pseudo_alignment.html#locate-active-motif-save",
    "href": "kinase_domain/kd_02_pseudo_alignment.html#locate-active-motif-save",
    "title": "Alignment",
    "section": "Locate active motif & save",
    "text": "Locate active motif & save\n\n1549 N is after HRD motif\n2618 D is around D[IV]WS motif\n1724 D is DFG motif\n1525 D is HRD motif\n\n\ndf=df.reset_index()\n\n\nkd['D1']=(df[1525]=='D').astype(int) # HRD\n\n\nkd['D2'] = (df[1724]=='D').astype(int) #DFG\n\n\nkd['D3']=(df[2618]=='D').astype(int)\n\n\nkd['N1'] = (df[1549]=='N').astype(int)\n\n\nactive_col = ['D1','D2']\n\n\nkd['active_D1_D2'] = (kd[active_col].sum(1)==len(active_col)).astype(int)\n\n\nkd['active_D1_D2'].value_counts()\n\nactive_D1_D2\n1    4209\n0    1327\nName: count, dtype: int64\n\n\n\nactive_all = kd[kd.active_D1_D2==1]\n\n\nactive_all.shape\n\n(4209, 32)\n\n\n\n# active_all.to_excel('out/uniprot_kd_active_D1_D2.xlsx',index=False)\n\n\n# kd.to_excel('out/uniprot_kd_motif_labeled.xlsx',index=False)\n\nTake a look of their identity:\n\nkd[kd.active_D1_D2==1].kd_note.value_counts()\n\nkd_note\nProtein kinase               4005\nPI3K/PI4K catalytic            71\nProtein kinase 2               61\nProtein kinase 1               37\nHistidine kinase               34\nAlpha-type protein kinase       1\nName: count, dtype: int64\n\n\n\nkd[kd.active_D1_D2==0].kd_note.value_counts()\n\nkd_note\nHistidine kinase                  591\nProtein kinase                    525\nPI3K/PI4K catalytic                97\nProtein kinase 1                   36\nAlpha-type protein kinase          21\nProtein kinase; inactive           13\nProtein kinase 2                   12\nHWE histidine kinase domain        11\nGuanylate kinase-like               5\nHistidine kinase 2                  4\nHistidine kinase 1                  4\nAmino-acid kinase domain (AAK)      3\nKinase domain                       2\nHistidine kinase; first part        1\nHistidine kinase; second part       1\nProtein kinase; truncated           1\nName: count, dtype: int64",
    "crumbs": [
      "kinase_domain",
      "Alignment"
    ]
  },
  {
    "objectID": "kinase_domain/kd_02_pseudo_alignment.html#add-kd-info-to-human-kinase-info",
    "href": "kinase_domain/kd_02_pseudo_alignment.html#add-kd-info-to-human-kinase-info",
    "title": "Alignment",
    "section": "Add KD info to human kinase info",
    "text": "Add KD info to human kinase info\n\nkd = pd.read_excel('out/uniprot_kd_motif_labeled.xlsx')\n\n\nhuman= kd[kd.Organism=='Homo sapiens (Human)']\n\n\nkd_id_uniprot_map = human.groupby('Uniprot').agg({'kd_ID': lambda x: ','.join(x.unique()),\n                                                  'active_D1_D2': lambda x: x,\n                                                 })\n\n\nkd_id_uniprot_map\n\n\n\n\n\n\n\n\nkd_ID\nactive_D1_D2\n\n\nUniprot\n\n\n\n\n\n\nA4D2B8\nA4D2B8_PM2P1_HUMAN_KD1\n0\n\n\nA4QPH2\nA4QPH2_PI4P2_HUMAN_KD1\n0\n\n\nO00141\nO00141_SGK1_HUMAN_KD1\n1\n\n\nO00238\nO00238_BMR1B_HUMAN_KD1\n1\n\n\nO00311\nO00311_CDC7_HUMAN_KD1\n1\n\n\n...\n...\n...\n\n\nQ9Y616\nQ9Y616_IRAK3_HUMAN_KD1\n0\n\n\nQ9Y6E0\nQ9Y6E0_STK24_HUMAN_KD1\n1\n\n\nQ9Y6M4\nQ9Y6M4_KC1G3_HUMAN_KD1\n1\n\n\nQ9Y6R4\nQ9Y6R4_M3K4_HUMAN_KD1\n1\n\n\nQ9Y6S9\nQ9Y6S9_RPKL1_HUMAN_KD1\n0\n\n\n\n\n523 rows × 2 columns\n\n\n\n\n# kd_id_uniprot_map.to_csv('raw/kd_ID_uniprot_map.csv')\n\nGet the csv merge with kinase info. Manually match KD1 and KD2 to the kinase info by considering active_D1_D2.\nThe data is updated on github.\n\nfrom katlas.data import *\n\n\nkd_info =Data.get_kd_uniprot()\n\n\nkd_info.head()\n\n\n\n\n\n\n\n\nkd_ID\nUniprot\nEntry Name\nProtein names\nGene Names\nGene Names (primary)\nOrganism\nkd_note\nkd_evidence\nkd_start\n...\nInteracts with\nSubunit structure\nFunction [CC]\nActivity regulation\nfull_seq\nD1\nD2\nD3\nN1\nactive_D1_D2\n\n\n\n\n0\nA0A075F7E9_LERK1_ORYSI_KD1\nA0A075F7E9\nLERK1_ORYSI\nG-type lectin S-receptor-like serine/threonine...\nLECRK1 LECRK OsI_14840\nLECRK1\nOryza sativa subsp. indica (Rice)\nProtein kinase\nECO:0000255|PROSITE-ProRule:PRU00159\n523\n...\nNone\nSUBUNIT: Interacts (via kinase domain) with AD...\nFUNCTION: Involved in innate immunity. Require...\nNone\nMVALLLFPMLLQLLSPTCAQTQKNITLGSTLAPQGPASSWLSPSGD...\n1\n1\n1\n1\n1\n\n\n1\nA0A078BQP2_GCY25_CAEEL_KD1\nA0A078BQP2\nGCY25_CAEEL\nReceptor-type guanylate cyclase gcy-25 (EC 4.6...\ngcy-25 Y105C5B.2\ngcy-25\nCaenorhabditis elegans\nProtein kinase\nECO:0000255|PROSITE-ProRule:PRU00159\n464\n...\nNone\nNone\nFUNCTION: Guanylate cyclase involved in the pr...\nNone\nMLLLLLLLKISTFVDSFQIGHLEFENSNETRILEICMKNAGSWRDH...\n0\n0\n1\n0\n0\n\n\n2\nA0A078CGE6_M3KE1_BRANA_KD1\nA0A078CGE6\nM3KE1_BRANA\nMAP3K epsilon protein kinase 1 (BnM3KE1) (EC 2...\nM3KE1 BnaA03g30290D GSBRNA2T00111755001\nM3KE1\nBrassica napus (Rape)\nProtein kinase\nECO:0000255|PROSITE-ProRule:PRU00159\n20\n...\nNone\nNone\nFUNCTION: Serine/threonine-protein kinase invo...\nNone\nMARQMTSSQFHKSKTLDNKYMLGDEIGKGAYGRVYIGLDLENGDFV...\n1\n1\n1\n1\n1\n\n\n3\nA0A0G2K344_PK3CA_RAT_KD1\nA0A0G2K344\nPK3CA_RAT\nPhosphatidylinositol 4,5-bisphosphate 3-kinase...\nPik3ca\nPik3ca\nRattus norvegicus (Rat)\nPI3K/PI4K catalytic\nECO:0000255|PROSITE-ProRule:PRU00269\n765\n...\nNone\nSUBUNIT: Heterodimer of a catalytic subunit PI...\nFUNCTION: Phosphoinositide-3-kinase (PI3K) pho...\nNone\nMPPRPSSGELWGIHLMPPRILVECLLPNGMIVTLECLREATLVTIK...\n0\n0\n0\n0\n0\n\n\n4\nA0A0H2ZM62_HK06_STRP2_KD1\nA0A0H2ZM62\nHK06_STRP2\nSensor histidine protein kinase HK06 (EC 2.7.1...\nhk06 SPD_2019\nhk06\nStreptococcus pneumoniae serotype 2 (strain D3...\nHistidine kinase\nECO:0000255|PROSITE-ProRule:PRU00107\n239\n...\nNone\nNone\nFUNCTION: Member of the two-component regulato...\nNone\nMIKNPKLLTKSFLRSFAILGGVGLVIHIAIYLTFPFYYIQLEGEKF...\n0\n0\n0\n0\n0\n\n\n\n\n5 rows × 32 columns\n\n\n\n\nkd_info.shape\n\n(5536, 32)\n\n\n\ninfo=Data.get_kinase_info()\n\n\ninfo.columns\n\nIndex(['kinase', 'ID_coral', 'uniprot', 'gene', 'modi_group', 'group',\n       'family', 'subfamily_coral', 'subfamily', 'in_pspa_st', 'in_pspa_tyr',\n       'in_pspa', 'in_cddm', 'kd_ID', 'active_D1_D2', 'active_kd_ID',\n       'pspa_ID', 'pseudo', 'pspa_category_small', 'pspa_category_big',\n       'cddm_big', 'cddm_small', 'length', 'human_uniprot_sequence',\n       'kinasecom_domain', 'nucleus', 'cytosol', 'cytoskeleton',\n       'plasma membrane', 'mitochondrion', 'Golgi apparatus',\n       'endoplasmic reticulum', 'vesicle', 'centrosome', 'aggresome',\n       'main_location'],\n      dtype='object')\n\n\n\ninfo.kd_ID\n\n0       Q2M2I8_AAK1_HUMAN_KD1\n1      Q6ZMQ8_LMTK1_HUMAN_KD1\n2       P00519_ABL1_HUMAN_KD1\n3       P42684_ABL2_HUMAN_KD1\n4      Q8NER5_ACV1C_HUMAN_KD1\n                ...          \n518      P07947_YES_HUMAN_KD1\n519    O00506_STK25_HUMAN_KD1\n520    Q56UN5_M3K19_HUMAN_KD1\n521    Q9NYL2_M3K20_HUMAN_KD1\n522    P43403_ZAP70_HUMAN_KD1\nName: kd_ID, Length: 523, dtype: object",
    "crumbs": [
      "kinase_domain",
      "Alignment"
    ]
  },
  {
    "objectID": "kinase_domain/kd_10_plot_umap_known_unk.html",
    "href": "kinase_domain/kd_10_plot_umap_known_unk.html",
    "title": "Plot UMAP of known & unknown KD",
    "section": "",
    "text": "import pandas as pd\nfrom katlas.train import *\nfrom katlas.dnn import *\nfrom fastai.vision.all import *\nfrom katlas.pssm import *\nfrom katlas.data import *\nkd = Data.get_kd_uniprot()\n\n⬇️ Downloading katlas_dataset.zip ...\n\n\nDownloading...\nFrom (original): https://drive.google.com/uc?id=17wIl0DbdoHV036Z3xgaT_0H3LlM_W47l\nFrom (redirected): https://drive.google.com/uc?id=17wIl0DbdoHV036Z3xgaT_0H3LlM_W47l&confirm=t&uuid=503c31e6-5e12-424b-86bf-185b223d5cf8\nTo: /home/sky1ove/git/katlas-raw/nbs/kinase_domain/katlas_datasets.zip\n100%|███████████████████████████████████████████████████████████████████████████████████████████| 209M/209M [00:07&lt;00:00, 26.4MB/s]\n\n\n📂 Extracting to /tmp/katlas_dataset ...\n🧹 Removing zip file: katlas_datasets.zip\n✅ Done! Extracted dataset is at: /tmp/katlas_dataset\n# filter out active motif\nkd = kd[kd.active_D1_D2==1].reset_index(drop=True)",
    "crumbs": [
      "kinase_domain",
      "Plot UMAP of known & unknown KD"
    ]
  },
  {
    "objectID": "kinase_domain/kd_10_plot_umap_known_unk.html#known-kd_id",
    "href": "kinase_domain/kd_10_plot_umap_known_unk.html#known-kd_id",
    "title": "Plot UMAP of known & unknown KD",
    "section": "Known kd_id",
    "text": "Known kd_id\n\ncddm_known = pd.read_parquet('train/cddm_t5.parquet')\npspa_known = pd.read_parquet('train/pspa_t5.parquet')\n\n\nknown_idx = set(cddm_known.index)|set(pspa_known.index)\n\n\nlen(known_idx)\n\n384",
    "crumbs": [
      "kinase_domain",
      "Plot UMAP of known & unknown KD"
    ]
  },
  {
    "objectID": "kinase_domain/kd_10_plot_umap_known_unk.html#predicted-kd_id",
    "href": "kinase_domain/kd_10_plot_umap_known_unk.html#predicted-kd_id",
    "title": "Plot UMAP of known & unknown KD",
    "section": "Predicted kd_id",
    "text": "Predicted kd_id\n\ncddm_pred = pd.read_parquet('raw/pred_new_cddm.parquet')\npspa_pred = pd.read_parquet('raw/pred_new_pspa.parquet')\n\n\nkd.shape\n\n(4209, 32)\n\n\n\ncddm_pred.shape,pspa_pred.shape\n\n((1195, 943), (1230, 230))\n\n\n\ncddm_pred.index.isin(kd.kd_ID).sum()\n\nnp.int64(1195)\n\n\n\npred_idx= set(cddm_pred.index)|set(pspa_pred.index)\n\n\nlen(pred_idx)\n\n1292",
    "crumbs": [
      "kinase_domain",
      "Plot UMAP of known & unknown KD"
    ]
  },
  {
    "objectID": "kinase_domain/kd_10_plot_umap_known_unk.html#get-umap-embedding",
    "href": "kinase_domain/kd_10_plot_umap_known_unk.html#get-umap-embedding",
    "title": "Plot UMAP of known & unknown KD",
    "section": "Get UMAP embedding",
    "text": "Get UMAP embedding\n\nfrom katlas.plot import *\n\n\nt5 = pd.read_parquet('raw/t5_kd.parquet')\n\n\numap_df = reduce_feature(t5,method='umap',complexity=30,min_dist=0.6)\n\n/home/sky1ove/git/katlas/.venv/lib/python3.11/site-packages/logomaker/../umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.\n  warn(\n\n\n\ninfo = pd.Series('Unknown', index=umap_df.index)\n\n\ninfo.loc[umap_df.index.isin(pred_idx)] = 'Predicted'\ninfo.loc[umap_df.index.isin(known_idx)] = 'Known'\n\n\ncnts = info.value_counts()\ninfo_labeled = info.map(lambda x: f\"{x} (n={cnts[x]:,})\")\n\n\ninfo_labeled\n\nkd_ID\nA0A075F7E9_LERK1_ORYSI_KD1      Unknown (n=2,555)\nA0A078CGE6_M3KE1_BRANA_KD1      Unknown (n=2,555)\nA0A0K3AV08_MLK1_CAEEL_KD1       Unknown (n=2,555)\nA0A0P0VIP0_LRSK7_ORYSJ_KD1      Unknown (n=2,555)\nA0A0P0XII1_CERK1_ORYSJ_KD1      Unknown (n=2,555)\n                                     ...         \nU4PR86_MELK_CAEEL_KD1           Unknown (n=2,555)\nW0LYS5_CAMKI_MACNP_KD1        Predicted (n=1,270)\nW0T9X4_ATG1_KLUMD_KD1           Unknown (n=2,555)\nW7JX98_KGP_PLAFO_KD1            Unknown (n=2,555)\nX5M5N0_WNK_CAEEL_KD1          Predicted (n=1,270)\nLength: 4209, dtype: object\n\n\nAlternatively, use np.select to do the same thing:\n\n# conditions = [\n#     umap_df.index.isin(known_idx),\n#     umap_df.index.isin(pred_idx),\n# ]\n# choices = ['Known', 'Predicted']\n# out =np.select(conditions, choices, default='Unknown')\n# pd.Series(out,index=umap_df.index)",
    "crumbs": [
      "kinase_domain",
      "Plot UMAP of known & unknown KD"
    ]
  },
  {
    "objectID": "kinase_domain/kd_10_plot_umap_known_unk.html#plot-2d",
    "href": "kinase_domain/kd_10_plot_umap_known_unk.html#plot-2d",
    "title": "Plot UMAP of known & unknown KD",
    "section": "Plot 2D",
    "text": "Plot 2D\n\nlen(umap_df)\n\n4209\n\n\n\nplot_2d(umap_df,hue=info_labeled,s=3,legend=True,palette='tab10',legend_title='')\nplt.title('UMAP plot of active KD across species \\n(n=4,209)')\nsave_svg('fig/umap_kd_known_unknown.svg')",
    "crumbs": [
      "kinase_domain",
      "Plot UMAP of known & unknown KD"
    ]
  },
  {
    "objectID": "kinase_domain/kd_06a_pspa_training_feature_comparison_cnn_group.html",
    "href": "kinase_domain/kd_06a_pspa_training_feature_comparison_cnn_group.html",
    "title": "DL training: Feature comparison on CNN model",
    "section": "",
    "text": "import numpy as np, pandas as pd\nimport os, random\nfrom katlas.data import *\nfrom katlas.train import *\nfrom fastai.vision.all import *\nfrom katlas.dnn import *\n\n\nseed_everything()\n\n\ndef_device\n\n'cuda'",
    "crumbs": [
      "kinase_domain",
      "DL training: Feature comparison on CNN model"
    ]
  },
  {
    "objectID": "kinase_domain/kd_06a_pspa_training_feature_comparison_cnn_group.html#setup",
    "href": "kinase_domain/kd_06a_pspa_training_feature_comparison_cnn_group.html#setup",
    "title": "DL training: Feature comparison on CNN model",
    "section": "",
    "text": "import numpy as np, pandas as pd\nimport os, random\nfrom katlas.data import *\nfrom katlas.train import *\nfrom fastai.vision.all import *\nfrom katlas.dnn import *\n\n\nseed_everything()\n\n\ndef_device\n\n'cuda'",
    "crumbs": [
      "kinase_domain",
      "DL training: Feature comparison on CNN model"
    ]
  },
  {
    "objectID": "kinase_domain/kd_06a_pspa_training_feature_comparison_cnn_group.html#data",
    "href": "kinase_domain/kd_06a_pspa_training_feature_comparison_cnn_group.html#data",
    "title": "DL training: Feature comparison on CNN model",
    "section": "Data",
    "text": "Data\n\ndf_t5=pd.read_parquet('train/pspa_t5.parquet').reset_index()\ndf_esm=pd.read_parquet('train/pspa_esm.parquet').reset_index()\ndf_onehot = pd.read_parquet('train/pspa_onehot.parquet').reset_index()\ndf_onehot_pca = pd.read_parquet('train/pspa_onehot_pca.parquet').reset_index()\n\n\n(df_onehot['index'] == df_esm['index']).value_counts()\n\nindex\nTrue    368\nName: count, dtype: int64\n\n\n\n(df_t5['index'] == df_esm['index']).value_counts()\n\nindex\nTrue    368\nName: count, dtype: int64\n\n\n\nt5_col = df_t5.columns[df_t5.columns.str.startswith('T5_')]\n\n\nt5_col\n\nIndex(['T5_0', 'T5_1', 'T5_2', 'T5_3', 'T5_4', 'T5_5', 'T5_6', 'T5_7', 'T5_8',\n       'T5_9',\n       ...\n       'T5_1014', 'T5_1015', 'T5_1016', 'T5_1017', 'T5_1018', 'T5_1019',\n       'T5_1020', 'T5_1021', 'T5_1022', 'T5_1023'],\n      dtype='object', length=1024)\n\n\n\nesm_col = df_esm.columns[df_esm.columns.str.startswith('esm_')]\n\n\nesm_col\n\nIndex(['esm_0', 'esm_1', 'esm_2', 'esm_3', 'esm_4', 'esm_5', 'esm_6', 'esm_7',\n       'esm_8', 'esm_9',\n       ...\n       'esm_1270', 'esm_1271', 'esm_1272', 'esm_1273', 'esm_1274', 'esm_1275',\n       'esm_1276', 'esm_1277', 'esm_1278', 'esm_1279'],\n      dtype='object', length=1280)\n\n\n\ntarget_col = df_t5.columns[~df_t5.columns.isin(t5_col)][1:]\n\n\ntarget_col\n\nIndex(['-5P', '-4P', '-3P', '-2P', '-1P', '0P', '1P', '2P', '3P', '4P',\n       ...\n       '-5pY', '-4pY', '-3pY', '-2pY', '-1pY', '0pY', '1pY', '2pY', '3pY',\n       '4pY'],\n      dtype='object', length=230)\n\n\n\nonehot_col = df_onehot.columns[~df_onehot.columns.isin(target_col)][1:]\n\n\nonehot_col\n\nIndex(['65_-', '65_A', '65_C', '65_D', '65_E', '65_F', '65_G', '65_H', '65_I',\n       '65_K',\n       ...\n       '3192_M', '3192_N', '3192_P', '3192_Q', '3192_R', '3192_S', '3192_T',\n       '3192_V', '3192_W', '3192_Y'],\n      dtype='object', length=6849)\n\n\n\nonehot_pca_col = df_onehot_pca.columns[df_onehot_pca.columns.str.startswith('PCA')]\n\n\nonehot_pca_col\n\nIndex(['PCA1', 'PCA2', 'PCA3', 'PCA4', 'PCA5', 'PCA6', 'PCA7', 'PCA8', 'PCA9',\n       'PCA10',\n       ...\n       'PCA991', 'PCA992', 'PCA993', 'PCA994', 'PCA995', 'PCA996', 'PCA997',\n       'PCA998', 'PCA999', 'PCA1000'],\n      dtype='object', length=1000)\n\n\n\ninfo=Data.get_kinase_info()\n\ninfo = info[info.pseudo=='0']\n\ninfo = info[info.kd_ID.notna()]\n\nsubfamily_map = info[['kd_ID','subfamily']].drop_duplicates().set_index('kd_ID')['subfamily']\nfamily_map = info[['kd_ID','family']].drop_duplicates().set_index('kd_ID')['family']\ngroup_map = info[['kd_ID','group']].drop_duplicates().set_index('kd_ID')['group']\n\npspa_info = pd.DataFrame(df_t5['index'].tolist(),columns=['kinase'])\n\npspa_info['subfamily'] = pspa_info.kinase.map(subfamily_map)\npspa_info['family'] = pspa_info.kinase.map(family_map)\npspa_info['group'] = pspa_info.kinase.map(group_map)",
    "crumbs": [
      "kinase_domain",
      "DL training: Feature comparison on CNN model"
    ]
  },
  {
    "objectID": "kinase_domain/kd_06a_pspa_training_feature_comparison_cnn_group.html#split",
    "href": "kinase_domain/kd_06a_pspa_training_feature_comparison_cnn_group.html#split",
    "title": "DL training: Feature comparison on CNN model",
    "section": "Split",
    "text": "Split\n\nsplits = get_splits(pspa_info, group='group',nfold=9)\n\nsplit0 = splits[0]\n\nGroupKFold(n_splits=9, random_state=None, shuffle=False)\n# group in train set: 8\n# group in test set: 1",
    "crumbs": [
      "kinase_domain",
      "DL training: Feature comparison on CNN model"
    ]
  },
  {
    "objectID": "kinase_domain/kd_06a_pspa_training_feature_comparison_cnn_group.html#dataset",
    "href": "kinase_domain/kd_06a_pspa_training_feature_comparison_cnn_group.html#dataset",
    "title": "DL training: Feature comparison on CNN model",
    "section": "Dataset",
    "text": "Dataset\n\n# dataset\nds_t5 = GeneralDataset(df_t5,t5_col,target_col)\nds_esm = GeneralDataset(df_esm,esm_col,target_col)\nds_onehot = GeneralDataset(df_onehot,onehot_col,target_col)\nds_onehot_pca = GeneralDataset(df_onehot_pca,onehot_pca_col,target_col)\n\n\nlen(ds_t5)\n\n368\n\n\n\ndl_t5 = DataLoader(ds_t5, batch_size=64, shuffle=True)\ndl_esm = DataLoader(ds_esm, batch_size=64, shuffle=True)\ndl_onehot = DataLoader(ds_onehot, batch_size=64, shuffle=True)\ndl_onehot_pca = DataLoader(ds_onehot_pca, batch_size=64, shuffle=True)\n\n\nxb,yb = next(iter(dl_t5))\n\nxb.shape,yb.shape\n\n(torch.Size([64, 1024]), torch.Size([64, 23, 10]))",
    "crumbs": [
      "kinase_domain",
      "DL training: Feature comparison on CNN model"
    ]
  },
  {
    "objectID": "kinase_domain/kd_06a_pspa_training_feature_comparison_cnn_group.html#model",
    "href": "kinase_domain/kd_06a_pspa_training_feature_comparison_cnn_group.html#model",
    "title": "DL training: Feature comparison on CNN model",
    "section": "Model",
    "text": "Model\n\nn_t5 = len(t5_col)\nn_esm = len(esm_col)\nn_onehot = len(onehot_col)\nn_onehot_pca = len(onehot_pca_col)\nn_target = len(target_col)\n\n\nn_t5,n_esm,n_onehot,n_onehot_pca\n\n(1024, 1280, 6849, 1000)\n\n\n\n# def get_cnn(): return PSSM_model(n_feature,n_target,model='CNN')\n\ndef get_cnn_t5(): return PSSM_model(n_t5,n_target,model='CNN')\ndef get_cnn_esm(): return PSSM_model(n_esm,n_target,model='CNN')\ndef get_cnn_onehot(): return PSSM_model(n_onehot,n_target,model='CNN')\ndef get_cnn_onehot_pca(): return PSSM_model(n_onehot_pca,n_target,model='CNN')\n\n\nmodel = get_cnn_t5()\n\n\nlogits= model(xb)\n\n\nlogits.shape\n\ntorch.Size([64, 23, 10])",
    "crumbs": [
      "kinase_domain",
      "DL training: Feature comparison on CNN model"
    ]
  },
  {
    "objectID": "kinase_domain/kd_06a_pspa_training_feature_comparison_cnn_group.html#loss",
    "href": "kinase_domain/kd_06a_pspa_training_feature_comparison_cnn_group.html#loss",
    "title": "DL training: Feature comparison on CNN model",
    "section": "Loss",
    "text": "Loss\n\nCE(logits,yb)\n\ntensor(3.3157, grad_fn=&lt;MeanBackward0&gt;)",
    "crumbs": [
      "kinase_domain",
      "DL training: Feature comparison on CNN model"
    ]
  },
  {
    "objectID": "kinase_domain/kd_06a_pspa_training_feature_comparison_cnn_group.html#metrics",
    "href": "kinase_domain/kd_06a_pspa_training_feature_comparison_cnn_group.html#metrics",
    "title": "DL training: Feature comparison on CNN model",
    "section": "Metrics",
    "text": "Metrics\n\nKLD(logits,yb)\n\ntensor(0.5744, grad_fn=&lt;MeanBackward0&gt;)\n\n\n\nJSD(logits,yb)\n\ntensor(0.1175, grad_fn=&lt;MeanBackward0&gt;)",
    "crumbs": [
      "kinase_domain",
      "DL training: Feature comparison on CNN model"
    ]
  },
  {
    "objectID": "kinase_domain/kd_06a_pspa_training_feature_comparison_cnn_group.html#cv-train",
    "href": "kinase_domain/kd_06a_pspa_training_feature_comparison_cnn_group.html#cv-train",
    "title": "DL training: Feature comparison on CNN model",
    "section": "CV train",
    "text": "CV train\n\ncross-validation\n\n\noof_t5 = train_dl_cv(df_t5,t5_col,target_col,\n                  splits = splits,\n                  model_func = get_cnn_t5,\n                  n_epoch=20,lr=3e-3)\n\n------fold0------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.265647\n3.142609\n0.404048\n0.081247\n00:01\n\n\n1\n3.223042\n3.159432\n0.420871\n0.084551\n00:00\n\n\n2\n3.185979\n3.188326\n0.449765\n0.093861\n00:00\n\n\n3\n3.161986\n3.216524\n0.477963\n0.093619\n00:00\n\n\n4\n3.139796\n3.263382\n0.524821\n0.094843\n00:00\n\n\n5\n3.121998\n3.365554\n0.626993\n0.100610\n00:00\n\n\n6\n3.081605\n3.490378\n0.751817\n0.110248\n00:00\n\n\n7\n3.036093\n3.435781\n0.697220\n0.096045\n00:00\n\n\n8\n2.995330\n3.547961\n0.809401\n0.095060\n00:00\n\n\n9\n2.961592\n3.593616\n0.855055\n0.096466\n00:00\n\n\n10\n2.933471\n3.600523\n0.861963\n0.094996\n00:00\n\n\n11\n2.909601\n3.590640\n0.852079\n0.094011\n00:00\n\n\n12\n2.890588\n3.624627\n0.886067\n0.095667\n00:00\n\n\n13\n2.874250\n3.621842\n0.883281\n0.093074\n00:00\n\n\n14\n2.860559\n3.642438\n0.903877\n0.094680\n00:00\n\n\n15\n2.849265\n3.640604\n0.902043\n0.093936\n00:00\n\n\n16\n2.839526\n3.647106\n0.908545\n0.094358\n00:00\n\n\n17\n2.830861\n3.654265\n0.915704\n0.094701\n00:00\n\n\n18\n2.823612\n3.653282\n0.914721\n0.094696\n00:00\n\n\n19\n2.817443\n3.651935\n0.913374\n0.094722\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold1------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.202563\n3.126681\n0.367288\n0.080953\n00:00\n\n\n1\n3.096495\n2.987177\n0.227784\n0.058128\n00:00\n\n\n2\n3.020704\n2.896720\n0.137328\n0.032520\n00:00\n\n\n3\n2.977764\n2.916249\n0.156856\n0.036941\n00:00\n\n\n4\n2.950588\n2.900061\n0.140669\n0.032257\n00:00\n\n\n5\n2.930088\n2.912244\n0.152851\n0.035243\n00:00\n\n\n6\n2.911221\n2.882244\n0.122852\n0.028578\n00:00\n\n\n7\n2.896883\n2.888497\n0.129105\n0.029880\n00:00\n\n\n8\n2.883235\n2.879527\n0.120135\n0.028295\n00:00\n\n\n9\n2.869442\n2.870536\n0.111143\n0.025767\n00:00\n\n\n10\n2.856844\n2.872699\n0.113306\n0.026387\n00:00\n\n\n11\n2.845950\n2.875445\n0.116052\n0.026841\n00:00\n\n\n12\n2.838449\n2.868856\n0.109463\n0.025458\n00:00\n\n\n13\n2.831044\n2.868054\n0.108661\n0.025295\n00:00\n\n\n14\n2.823496\n2.874786\n0.115393\n0.026861\n00:00\n\n\n15\n2.816517\n2.870229\n0.110837\n0.025839\n00:00\n\n\n16\n2.810994\n2.868846\n0.109454\n0.025484\n00:00\n\n\n17\n2.805729\n2.868922\n0.109530\n0.025440\n00:00\n\n\n18\n2.801781\n2.868556\n0.109163\n0.025403\n00:00\n\n\n19\n2.798228\n2.867560\n0.108168\n0.025145\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold2------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.193643\n3.129775\n0.413172\n0.088697\n00:00\n\n\n1\n3.091510\n2.970952\n0.254349\n0.061493\n00:00\n\n\n2\n3.019390\n2.939329\n0.222726\n0.047996\n00:00\n\n\n3\n2.979136\n2.997280\n0.280677\n0.057836\n00:00\n\n\n4\n2.955849\n2.856279\n0.139675\n0.032778\n00:00\n\n\n5\n2.937262\n2.881608\n0.165005\n0.037116\n00:00\n\n\n6\n2.919667\n2.847731\n0.131128\n0.030217\n00:00\n\n\n7\n2.905293\n2.839630\n0.123026\n0.028822\n00:00\n\n\n8\n2.891868\n2.834224\n0.117620\n0.027419\n-1:59:59\n\n\n9\n2.879336\n2.883239\n0.166636\n0.039591\n00:00\n\n\n10\n2.866813\n2.858723\n0.142120\n0.032910\n00:00\n\n\n11\n2.855484\n2.848410\n0.131807\n0.030241\n00:00\n\n\n12\n2.845427\n2.873513\n0.156910\n0.036242\n00:00\n\n\n13\n2.836359\n2.847939\n0.131335\n0.030619\n00:00\n\n\n14\n2.828688\n2.843345\n0.126741\n0.029227\n00:00\n\n\n15\n2.822182\n2.849235\n0.132632\n0.030728\n00:00\n\n\n16\n2.816315\n2.848452\n0.131849\n0.030454\n00:00\n\n\n17\n2.811537\n2.849880\n0.133277\n0.030673\n00:00\n\n\n18\n2.807543\n2.854661\n0.138057\n0.031727\n00:00\n\n\n19\n2.803862\n2.853885\n0.137282\n0.031627\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold3------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.207944\n3.141091\n0.449947\n0.093460\n00:00\n\n\n1\n3.110341\n3.029324\n0.338180\n0.076213\n00:00\n\n\n2\n3.034141\n2.932320\n0.241176\n0.049031\n00:00\n\n\n3\n2.993638\n2.946054\n0.254910\n0.050688\n00:00\n\n\n4\n2.968643\n2.946317\n0.255174\n0.049163\n00:00\n\n\n5\n2.946927\n2.940749\n0.249605\n0.046374\n00:00\n\n\n6\n2.926885\n2.924870\n0.233727\n0.044772\n00:00\n\n\n7\n2.909749\n2.939194\n0.248050\n0.045244\n00:00\n\n\n8\n2.893957\n2.910057\n0.218914\n0.042975\n00:00\n\n\n9\n2.879583\n2.939824\n0.248680\n0.046253\n00:00\n\n\n10\n2.866916\n2.941156\n0.250012\n0.047198\n00:00\n\n\n11\n2.856293\n2.933166\n0.242022\n0.045542\n00:00\n\n\n12\n2.847124\n2.937057\n0.245913\n0.046275\n00:00\n\n\n13\n2.838420\n2.938343\n0.247199\n0.046922\n00:00\n\n\n14\n2.831244\n2.940233\n0.249089\n0.047545\n00:00\n\n\n15\n2.825087\n2.944092\n0.252948\n0.047802\n00:00\n\n\n16\n2.819351\n2.945658\n0.254514\n0.047995\n00:00\n\n\n17\n2.814262\n2.940202\n0.249058\n0.046777\n00:00\n\n\n18\n2.810476\n2.940670\n0.249527\n0.046865\n00:00\n\n\n19\n2.806732\n2.938628\n0.247484\n0.046366\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold4------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.193083\n3.121557\n0.332112\n0.073863\n00:00\n\n\n1\n3.084162\n2.954197\n0.164753\n0.042711\n00:00\n\n\n2\n3.010259\n2.942940\n0.153495\n0.035771\n00:00\n\n\n3\n2.970550\n2.977695\n0.188250\n0.042826\n00:00\n\n\n4\n2.945946\n2.932550\n0.143106\n0.032621\n00:00\n\n\n5\n2.929771\n2.907203\n0.117758\n0.027932\n00:00\n\n\n6\n2.910526\n2.899911\n0.110467\n0.025754\n00:00\n\n\n7\n2.892773\n2.916562\n0.127117\n0.028903\n00:00\n\n\n8\n2.879743\n2.905592\n0.116148\n0.026998\n00:00\n\n\n9\n2.866278\n2.908514\n0.119069\n0.027786\n00:00\n\n\n10\n2.854042\n2.905393\n0.115948\n0.026859\n00:00\n\n\n11\n2.843414\n2.904994\n0.115549\n0.026965\n00:00\n\n\n12\n2.833833\n2.897970\n0.108525\n0.025182\n00:00\n\n\n13\n2.825915\n2.899413\n0.109969\n0.025357\n00:00\n\n\n14\n2.818082\n2.897056\n0.107612\n0.024913\n00:00\n\n\n15\n2.811066\n2.897897\n0.108452\n0.025036\n00:00\n\n\n16\n2.805139\n2.896160\n0.106715\n0.024646\n00:00\n\n\n17\n2.800325\n2.896326\n0.106882\n0.024691\n00:00\n\n\n18\n2.795776\n2.896716\n0.107271\n0.024781\n00:00\n\n\n19\n2.792595\n2.896498\n0.107053\n0.024761\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold5------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.191223\n3.125971\n0.337161\n0.074101\n00:00\n\n\n1\n3.084095\n2.968137\n0.179327\n0.046755\n00:00\n\n\n2\n3.009351\n2.993795\n0.204984\n0.046834\n00:00\n\n\n3\n2.975441\n2.935275\n0.146464\n0.035559\n00:00\n\n\n4\n2.952728\n2.906648\n0.117838\n0.029097\n00:00\n\n\n5\n2.933139\n2.887461\n0.098650\n0.024654\n00:00\n\n\n6\n2.914009\n2.891163\n0.102352\n0.025090\n00:00\n\n\n7\n2.896947\n2.894362\n0.105552\n0.025792\n00:00\n\n\n8\n2.880326\n2.898649\n0.109838\n0.026552\n00:00\n\n\n9\n2.865264\n2.895405\n0.106595\n0.026206\n-1:59:59\n\n\n10\n2.852518\n2.892293\n0.103482\n0.025411\n00:00\n\n\n11\n2.840988\n2.883369\n0.094558\n0.023256\n00:00\n\n\n12\n2.830953\n2.888999\n0.100188\n0.024492\n00:00\n\n\n13\n2.822403\n2.888226\n0.099416\n0.024353\n00:00\n\n\n14\n2.814830\n2.888407\n0.099596\n0.024432\n00:00\n\n\n15\n2.808502\n2.886997\n0.098186\n0.024032\n00:00\n\n\n16\n2.802773\n2.887533\n0.098723\n0.024249\n00:00\n\n\n17\n2.797982\n2.883697\n0.094887\n0.023295\n00:00\n\n\n18\n2.793947\n2.884220\n0.095410\n0.023388\n00:00\n\n\n19\n2.790855\n2.883040\n0.094230\n0.023095\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold6------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.203619\n3.121918\n0.306652\n0.069884\n00:00\n\n\n1\n3.089997\n2.956834\n0.141568\n0.037513\n00:00\n\n\n2\n3.015747\n2.923789\n0.108523\n0.025009\n00:00\n\n\n3\n2.973150\n2.941699\n0.126433\n0.029847\n00:00\n\n\n4\n2.948111\n2.920527\n0.105260\n0.024720\n00:00\n\n\n5\n2.928955\n2.909259\n0.093993\n0.021972\n00:00\n\n\n6\n2.909893\n2.905155\n0.089889\n0.021540\n00:00\n\n\n7\n2.892313\n2.922608\n0.107342\n0.024919\n00:00\n\n\n8\n2.876400\n2.927285\n0.112019\n0.026551\n00:00\n\n\n9\n2.861295\n2.911070\n0.095804\n0.022932\n00:00\n\n\n10\n2.848656\n2.917730\n0.102464\n0.024213\n00:00\n\n\n11\n2.838045\n2.910637\n0.095371\n0.022812\n00:00\n\n\n12\n2.828543\n2.917434\n0.102168\n0.024414\n00:00\n\n\n13\n2.820406\n2.916175\n0.100909\n0.023967\n00:00\n\n\n14\n2.813365\n2.916811\n0.101544\n0.024145\n00:00\n\n\n15\n2.806840\n2.910940\n0.095674\n0.022752\n00:00\n\n\n16\n2.801304\n2.911899\n0.096632\n0.022935\n00:00\n\n\n17\n2.796986\n2.920983\n0.105716\n0.024482\n00:00\n\n\n18\n2.793097\n2.911241\n0.095975\n0.022843\n00:00\n\n\n19\n2.789752\n2.909681\n0.094414\n0.022465\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold7------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.199715\n3.125819\n0.463774\n0.099700\n00:00\n\n\n1\n3.084667\n2.961773\n0.299728\n0.067936\n00:00\n\n\n2\n3.013755\n2.959561\n0.297516\n0.064850\n00:00\n\n\n3\n2.980244\n3.010867\n0.348822\n0.071755\n00:00\n\n\n4\n2.960497\n3.011438\n0.349393\n0.073356\n00:00\n\n\n5\n2.937192\n3.053991\n0.391946\n0.081665\n00:00\n\n\n6\n2.913795\n2.971227\n0.309182\n0.067685\n00:00\n\n\n7\n2.894401\n2.922726\n0.260681\n0.059278\n00:00\n\n\n8\n2.877291\n2.889860\n0.227814\n0.052599\n00:00\n\n\n9\n2.863354\n2.906056\n0.244011\n0.056762\n00:00\n\n\n10\n2.851456\n2.948015\n0.285970\n0.063813\n00:00\n\n\n11\n2.840680\n2.919197\n0.257152\n0.059050\n00:00\n\n\n12\n2.831073\n2.924233\n0.262188\n0.059024\n00:00\n\n\n13\n2.822868\n2.914097\n0.252052\n0.057968\n00:00\n\n\n14\n2.816051\n2.924426\n0.262381\n0.059423\n00:00\n\n\n15\n2.809698\n2.926474\n0.264429\n0.060345\n00:00\n\n\n16\n2.804873\n2.925350\n0.263305\n0.059481\n00:00\n\n\n17\n2.800674\n2.930919\n0.268874\n0.060678\n00:00\n\n\n18\n2.797033\n2.928454\n0.266409\n0.060319\n00:00\n\n\n19\n2.794031\n2.929961\n0.267916\n0.060498\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold8------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.204548\n3.130516\n0.332384\n0.072145\n00:00\n\n\n1\n3.086863\n2.963805\n0.165674\n0.039414\n00:00\n\n\n2\n3.013082\n2.931495\n0.133363\n0.028549\n00:00\n\n\n3\n2.972725\n2.921883\n0.123751\n0.026929\n00:00\n\n\n4\n2.949337\n2.924575\n0.126443\n0.027342\n00:00\n\n\n5\n2.929606\n2.938754\n0.140622\n0.029565\n00:00\n\n\n6\n2.907469\n2.928634\n0.130502\n0.028092\n00:00\n\n\n7\n2.891385\n2.991267\n0.193135\n0.042524\n00:00\n\n\n8\n2.875030\n2.937675\n0.139543\n0.031085\n00:00\n\n\n9\n2.861556\n3.244176\n0.446044\n0.061041\n-1:59:59\n\n\n10\n2.849376\n3.033440\n0.235308\n0.041062\n00:00\n\n\n11\n2.839188\n3.015007\n0.216875\n0.037495\n00:00\n\n\n12\n2.829741\n3.001976\n0.203844\n0.037402\n00:00\n\n\n13\n2.821286\n2.993891\n0.195759\n0.036398\n00:00\n\n\n14\n2.815274\n3.024797\n0.226665\n0.037667\n00:00\n\n\n15\n2.809055\n3.031073\n0.232941\n0.037450\n00:00\n\n\n16\n2.803440\n3.011022\n0.212890\n0.036360\n00:00\n\n\n17\n2.798656\n3.007020\n0.208888\n0.036344\n00:00\n\n\n18\n2.795232\n3.034969\n0.236837\n0.037165\n00:00\n\n\n19\n2.791856\n3.020481\n0.222349\n0.036640\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n\noof_esm = train_dl_cv(df_esm,esm_col,target_col,\n                  splits = splits,\n                  model_func = get_cnn_esm,\n                  n_epoch=20,lr=3e-3)\n\n------fold0------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.264869\n3.136897\n0.398337\n0.080906\n00:00\n\n\n1\n3.217183\n3.158689\n0.420129\n0.083298\n00:00\n\n\n2\n3.185448\n3.175242\n0.436681\n0.091017\n00:00\n\n\n3\n3.167979\n3.221153\n0.482592\n0.094919\n00:00\n\n\n4\n3.154100\n3.221832\n0.483271\n0.091278\n00:00\n\n\n5\n3.117338\n3.316915\n0.578354\n0.099876\n00:00\n\n\n6\n3.072603\n3.407976\n0.669415\n0.101000\n00:00\n\n\n7\n3.027419\n3.488302\n0.749741\n0.101484\n00:00\n\n\n8\n2.988770\n3.563498\n0.824937\n0.102865\n00:00\n\n\n9\n2.956225\n3.565761\n0.827200\n0.100375\n00:00\n\n\n10\n2.929342\n3.583453\n0.844892\n0.099281\n00:00\n\n\n11\n2.907108\n3.606526\n0.867965\n0.102185\n00:00\n\n\n12\n2.888310\n3.608578\n0.870016\n0.100652\n00:00\n\n\n13\n2.872570\n3.615547\n0.876986\n0.099283\n00:00\n\n\n14\n2.859529\n3.621958\n0.883397\n0.099150\n00:00\n\n\n15\n2.847852\n3.625345\n0.886784\n0.099454\n00:00\n\n\n16\n2.837972\n3.625224\n0.886664\n0.099652\n00:00\n\n\n17\n2.829673\n3.625283\n0.886722\n0.099333\n00:00\n\n\n18\n2.822563\n3.627709\n0.889148\n0.099345\n00:00\n\n\n19\n2.816700\n3.625107\n0.886546\n0.099251\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold1------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.193581\n3.120010\n0.360617\n0.080228\n00:00\n\n\n1\n3.084519\n2.978762\n0.219370\n0.055952\n00:00\n\n\n2\n3.013452\n2.900385\n0.140992\n0.033519\n00:00\n\n\n3\n2.977241\n2.921838\n0.162445\n0.038445\n00:00\n\n\n4\n2.955385\n2.901993\n0.142601\n0.033416\n00:00\n\n\n5\n2.934080\n2.874330\n0.114937\n0.027168\n00:00\n\n\n6\n2.914432\n2.875653\n0.116260\n0.027577\n00:00\n\n\n7\n2.898649\n2.873714\n0.114322\n0.026822\n00:00\n\n\n8\n2.884012\n2.866899\n0.107507\n0.025204\n00:00\n\n\n9\n2.872340\n2.869269\n0.109877\n0.025642\n00:00\n\n\n10\n2.859931\n2.878062\n0.118670\n0.027873\n00:00\n\n\n11\n2.849241\n2.868064\n0.108672\n0.025247\n00:00\n\n\n12\n2.839279\n2.862002\n0.102609\n0.024077\n00:00\n\n\n13\n2.830748\n2.858560\n0.099167\n0.023196\n00:00\n\n\n14\n2.824155\n2.868220\n0.108827\n0.025510\n00:00\n\n\n15\n2.817403\n2.866775\n0.107382\n0.025029\n00:00\n\n\n16\n2.811302\n2.861741\n0.102348\n0.023998\n00:00\n\n\n17\n2.806031\n2.860055\n0.100662\n0.023584\n00:00\n\n\n18\n2.802316\n2.859905\n0.100513\n0.023591\n00:00\n\n\n19\n2.798471\n2.860417\n0.101025\n0.023671\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold2------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.202004\n3.115519\n0.398916\n0.087196\n00:00\n\n\n1\n3.087065\n2.949936\n0.233333\n0.057611\n00:00\n\n\n2\n3.018293\n2.917029\n0.200425\n0.044855\n00:00\n\n\n3\n2.982141\n2.866996\n0.150393\n0.034669\n00:00\n\n\n4\n2.967630\n2.867355\n0.150751\n0.034402\n00:00\n\n\n5\n2.947072\n2.836027\n0.119424\n0.027516\n00:00\n\n\n6\n2.927675\n2.837569\n0.120966\n0.027518\n00:00\n\n\n7\n2.910500\n2.843097\n0.126494\n0.028759\n00:00\n\n\n8\n2.894355\n2.836293\n0.119690\n0.027306\n00:00\n\n\n9\n2.880376\n2.854691\n0.138088\n0.030649\n00:00\n\n\n10\n2.867968\n2.848921\n0.132318\n0.029835\n00:00\n\n\n11\n2.857406\n2.853977\n0.137374\n0.030709\n-1:59:59\n\n\n12\n2.847581\n2.839761\n0.123158\n0.027789\n00:00\n\n\n13\n2.839229\n2.837915\n0.121312\n0.026970\n00:00\n\n\n14\n2.832961\n2.846002\n0.129399\n0.028907\n00:00\n\n\n15\n2.826205\n2.841858\n0.125255\n0.027834\n00:00\n\n\n16\n2.820190\n2.847916\n0.131313\n0.029319\n00:00\n\n\n17\n2.814878\n2.847655\n0.131052\n0.029191\n00:00\n\n\n18\n2.810926\n2.846968\n0.130365\n0.029018\n00:00\n\n\n19\n2.807157\n2.847460\n0.130857\n0.029080\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold3------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.202962\n3.118910\n0.427766\n0.090941\n00:00\n\n\n1\n3.089748\n2.952767\n0.261623\n0.059470\n00:00\n\n\n2\n3.022268\n2.934290\n0.243146\n0.048406\n00:00\n\n\n3\n2.988155\n2.941152\n0.250008\n0.050903\n00:00\n\n\n4\n2.967207\n2.961673\n0.270530\n0.051580\n00:00\n\n\n5\n2.951866\n2.943200\n0.252056\n0.047716\n00:00\n\n\n6\n2.932044\n2.940075\n0.248931\n0.046150\n00:00\n\n\n7\n2.913869\n2.947825\n0.256681\n0.047069\n00:00\n\n\n8\n2.898216\n2.935129\n0.243985\n0.044736\n00:00\n\n\n9\n2.884012\n2.921401\n0.230257\n0.044297\n00:00\n\n\n10\n2.873033\n2.932486\n0.241342\n0.044664\n00:00\n\n\n11\n2.862779\n2.934337\n0.243193\n0.042859\n00:00\n\n\n12\n2.855475\n2.928978\n0.237835\n0.043229\n00:00\n\n\n13\n2.846623\n2.926791\n0.235647\n0.043191\n00:00\n\n\n14\n2.838845\n2.932529\n0.241386\n0.043511\n00:00\n\n\n15\n2.831529\n2.926085\n0.234941\n0.042803\n00:00\n\n\n16\n2.825729\n2.924322\n0.233178\n0.042513\n00:00\n\n\n17\n2.820391\n2.927167\n0.236023\n0.042804\n00:00\n\n\n18\n2.816059\n2.926176\n0.235032\n0.042715\n00:00\n\n\n19\n2.812433\n2.925177\n0.234033\n0.042523\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold4------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.206472\n3.133298\n0.343854\n0.075123\n00:00\n\n\n1\n3.087475\n2.981167\n0.191722\n0.049670\n00:00\n\n\n2\n3.015009\n2.916325\n0.126880\n0.029111\n00:00\n\n\n3\n2.975545\n2.920883\n0.131439\n0.031650\n00:00\n\n\n4\n2.957316\n2.924036\n0.134591\n0.031509\n00:00\n\n\n5\n2.939080\n2.909500\n0.120055\n0.028545\n00:00\n\n\n6\n2.919973\n2.902207\n0.112762\n0.026220\n00:00\n\n\n7\n2.901022\n2.903212\n0.113767\n0.026729\n00:00\n\n\n8\n2.884898\n2.912332\n0.122887\n0.028784\n00:00\n\n\n9\n2.869776\n2.908447\n0.119002\n0.027865\n00:00\n\n\n10\n2.857329\n2.902042\n0.112598\n0.026547\n00:00\n\n\n11\n2.845674\n2.895880\n0.106435\n0.024948\n00:00\n\n\n12\n2.835716\n2.890357\n0.100912\n0.023719\n00:00\n\n\n13\n2.827060\n2.893576\n0.104131\n0.024594\n00:00\n\n\n14\n2.819177\n2.892577\n0.103132\n0.024245\n00:00\n\n\n15\n2.812434\n2.892262\n0.102817\n0.024129\n00:00\n\n\n16\n2.806125\n2.891998\n0.102553\n0.023941\n00:00\n\n\n17\n2.800571\n2.890348\n0.100904\n0.023638\n00:00\n\n\n18\n2.796558\n2.890913\n0.101468\n0.023817\n00:00\n\n\n19\n2.793637\n2.890676\n0.101231\n0.023790\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold5------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.187245\n3.128074\n0.339263\n0.073991\n00:00\n\n\n1\n3.071628\n2.986283\n0.197472\n0.051019\n00:00\n\n\n2\n3.001887\n2.903810\n0.114999\n0.027137\n00:00\n\n\n3\n2.964702\n2.911484\n0.122673\n0.029126\n00:00\n\n\n4\n2.946854\n2.900443\n0.111632\n0.027561\n00:00\n\n\n5\n2.930545\n2.896069\n0.107258\n0.026062\n00:00\n\n\n6\n2.911004\n2.905382\n0.116571\n0.028297\n00:00\n\n\n7\n2.894996\n2.917508\n0.128697\n0.030506\n00:00\n\n\n8\n2.880330\n2.887178\n0.098368\n0.024039\n00:00\n\n\n9\n2.869907\n2.887413\n0.098603\n0.023499\n00:00\n\n\n10\n2.860607\n2.886769\n0.097958\n0.024129\n00:00\n\n\n11\n2.851118\n2.878669\n0.089859\n0.022112\n00:00\n\n\n12\n2.841549\n2.873977\n0.085166\n0.020676\n00:00\n\n\n13\n2.832706\n2.876251\n0.087440\n0.021426\n-1:59:59\n\n\n14\n2.824652\n2.870506\n0.081696\n0.019807\n00:00\n\n\n15\n2.818056\n2.870589\n0.081778\n0.019995\n00:00\n\n\n16\n2.811975\n2.870715\n0.081905\n0.020023\n00:00\n\n\n17\n2.806576\n2.869968\n0.081157\n0.019824\n00:00\n\n\n18\n2.802316\n2.869475\n0.080664\n0.019710\n00:00\n\n\n19\n2.798843\n2.869548\n0.080738\n0.019745\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold6------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.188190\n3.114348\n0.299082\n0.069039\n00:00\n\n\n1\n3.063660\n2.943110\n0.127844\n0.033852\n00:00\n\n\n2\n2.997336\n2.917790\n0.102524\n0.024700\n00:00\n\n\n3\n2.964889\n2.925680\n0.110414\n0.026368\n00:00\n\n\n4\n2.947123\n3.018301\n0.203035\n0.039962\n00:00\n\n\n5\n2.928940\n2.961387\n0.146121\n0.031864\n00:00\n\n\n6\n2.911475\n2.932888\n0.117622\n0.027504\n00:00\n\n\n7\n2.892783\n2.941010\n0.125743\n0.028919\n00:00\n\n\n8\n2.877175\n2.932807\n0.117541\n0.027764\n00:00\n\n\n9\n2.863183\n2.920175\n0.104909\n0.024967\n00:00\n\n\n10\n2.850916\n2.919358\n0.104092\n0.025017\n00:00\n\n\n11\n2.840048\n2.917005\n0.101738\n0.024471\n00:00\n\n\n12\n2.830450\n2.918196\n0.102930\n0.024451\n00:00\n\n\n13\n2.822036\n2.934537\n0.119270\n0.028025\n00:00\n\n\n14\n2.814883\n2.968319\n0.153053\n0.034001\n00:00\n\n\n15\n2.808351\n2.918659\n0.103393\n0.024519\n00:00\n\n\n16\n2.802855\n2.918992\n0.103726\n0.024673\n00:00\n\n\n17\n2.797942\n2.933373\n0.118107\n0.027699\n00:00\n\n\n18\n2.793902\n2.963440\n0.148174\n0.033079\n00:00\n\n\n19\n2.790388\n3.046306\n0.231040\n0.043707\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold7------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.187940\n3.132055\n0.470010\n0.100920\n00:00\n\n\n1\n3.072927\n2.944816\n0.282771\n0.063020\n00:00\n\n\n2\n3.001055\n2.929518\n0.267473\n0.059566\n00:00\n\n\n3\n2.969772\n2.948422\n0.286377\n0.063104\n00:00\n\n\n4\n2.948040\n2.926207\n0.264161\n0.057537\n00:00\n\n\n5\n2.931400\n2.963588\n0.301542\n0.064320\n00:00\n\n\n6\n2.909764\n2.960949\n0.298904\n0.064112\n00:00\n\n\n7\n2.895195\n3.003662\n0.341618\n0.070389\n00:00\n\n\n8\n2.879205\n3.000879\n0.338834\n0.070586\n00:00\n\n\n9\n2.865099\n3.004148\n0.342102\n0.070332\n00:00\n\n\n10\n2.852739\n2.982781\n0.320736\n0.066774\n00:00\n\n\n11\n2.842682\n3.000234\n0.338189\n0.069315\n00:00\n\n\n12\n2.833195\n3.006765\n0.344720\n0.070025\n00:00\n\n\n13\n2.825611\n2.998246\n0.336202\n0.068579\n00:00\n\n\n14\n2.818143\n3.008426\n0.346380\n0.071066\n00:00\n\n\n15\n2.811678\n3.001043\n0.338998\n0.069956\n00:00\n\n\n16\n2.806150\n3.001681\n0.339636\n0.070011\n00:00\n\n\n17\n2.801808\n3.003881\n0.341836\n0.070656\n00:00\n\n\n18\n2.798122\n3.011680\n0.349635\n0.072094\n00:00\n\n\n19\n2.794909\n3.004551\n0.342506\n0.070596\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold8------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.191767\n3.127610\n0.329479\n0.072123\n00:00\n\n\n1\n3.075926\n2.944713\n0.146582\n0.036049\n00:00\n\n\n2\n3.003580\n2.945038\n0.146907\n0.032734\n00:00\n\n\n3\n2.966146\n2.948486\n0.150355\n0.031666\n00:00\n\n\n4\n2.945253\n2.926992\n0.128860\n0.028842\n00:00\n\n\n5\n2.926334\n2.911107\n0.112976\n0.024992\n00:00\n\n\n6\n2.906564\n2.908641\n0.110509\n0.024338\n00:00\n\n\n7\n2.889611\n2.914251\n0.116119\n0.025042\n00:00\n\n\n8\n2.875487\n2.905566\n0.107434\n0.023223\n00:00\n\n\n9\n2.862854\n2.904928\n0.106797\n0.023156\n00:00\n\n\n10\n2.850500\n2.917810\n0.119679\n0.026055\n00:00\n\n\n11\n2.840436\n2.902700\n0.104568\n0.023097\n00:00\n\n\n12\n2.831009\n2.902440\n0.104309\n0.022983\n-1:59:59\n\n\n13\n2.822627\n2.904006\n0.105875\n0.023260\n00:00\n\n\n14\n2.815531\n2.908263\n0.110131\n0.023731\n00:00\n\n\n15\n2.809269\n2.905061\n0.106929\n0.023299\n00:00\n\n\n16\n2.804316\n2.906749\n0.108617\n0.023572\n00:00\n\n\n17\n2.799786\n2.906028\n0.107896\n0.023450\n00:00\n\n\n18\n2.796355\n2.905400\n0.107269\n0.023268\n00:00\n\n\n19\n2.793621\n2.904385\n0.106253\n0.023061\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n\noof_onehot = train_dl_cv(df_onehot,onehot_col,target_col,\n                  splits = splits,\n                  model_func = get_cnn_onehot,\n                  n_epoch=20,lr=3e-3)\n\n------fold0------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.277120\n3.133921\n0.395361\n0.080811\n00:00\n\n\n1\n3.220052\n3.143938\n0.405378\n0.082488\n00:00\n\n\n2\n3.172967\n3.197285\n0.458724\n0.086042\n00:00\n\n\n3\n3.142990\n3.197540\n0.458979\n0.088806\n00:00\n\n\n4\n3.120064\n3.194893\n0.456332\n0.089937\n00:00\n\n\n5\n3.082074\n3.265694\n0.527133\n0.094442\n00:00\n\n\n6\n3.037489\n3.350454\n0.611893\n0.096622\n00:00\n\n\n7\n2.994622\n3.459473\n0.720912\n0.097649\n00:00\n\n\n8\n2.958157\n3.513486\n0.774925\n0.095750\n00:00\n\n\n9\n2.927430\n3.566482\n0.827921\n0.097972\n00:00\n\n\n10\n2.902424\n3.635440\n0.896879\n0.101687\n00:00\n\n\n11\n2.881415\n3.707916\n0.969355\n0.106543\n00:00\n\n\n12\n2.864123\n3.819097\n1.080537\n0.124386\n00:00\n\n\n13\n2.849641\n3.935453\n1.196892\n0.135377\n00:00\n\n\n14\n2.837691\n3.968906\n1.230345\n0.146021\n00:00\n\n\n15\n2.827890\n4.076715\n1.338154\n0.155096\n00:00\n\n\n16\n2.819179\n4.027257\n1.288697\n0.148987\n00:00\n\n\n17\n2.811810\n4.020642\n1.282081\n0.148653\n00:00\n\n\n18\n2.805801\n3.952586\n1.214025\n0.138949\n00:00\n\n\n19\n2.800838\n3.988277\n1.249717\n0.146054\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold1------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.210148\n3.139912\n0.380520\n0.082572\n00:00\n\n\n1\n3.076796\n3.013317\n0.253924\n0.063400\n00:00\n\n\n2\n3.000978\n2.891074\n0.131682\n0.031530\n00:00\n\n\n3\n2.960962\n2.920046\n0.160653\n0.037774\n00:00\n\n\n4\n2.935330\n2.882944\n0.123551\n0.028969\n00:00\n\n\n5\n2.912577\n2.878306\n0.118913\n0.027573\n00:00\n\n\n6\n2.891449\n2.862408\n0.103015\n0.024382\n00:00\n\n\n7\n2.874047\n2.857084\n0.097691\n0.023248\n00:00\n\n\n8\n2.859166\n2.862403\n0.103011\n0.024601\n00:00\n\n\n9\n2.845874\n2.874232\n0.114840\n0.027831\n00:00\n\n\n10\n2.834624\n2.888659\n0.129267\n0.031689\n00:00\n\n\n11\n2.825206\n2.899465\n0.140072\n0.034201\n00:00\n\n\n12\n2.817001\n2.916462\n0.157069\n0.038561\n00:00\n\n\n13\n2.809952\n2.905925\n0.146533\n0.035555\n00:00\n\n\n14\n2.803583\n2.906608\n0.147216\n0.035711\n00:00\n\n\n15\n2.798075\n2.908471\n0.149078\n0.036318\n00:00\n\n\n16\n2.793313\n2.905267\n0.145874\n0.035303\n00:00\n\n\n17\n2.789165\n2.905819\n0.146426\n0.035438\n00:00\n\n\n18\n2.785420\n2.905159\n0.145767\n0.035352\n00:00\n\n\n19\n2.782227\n2.905472\n0.146079\n0.035462\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold2------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.203027\n3.133307\n0.416704\n0.088837\n00:00\n\n\n1\n3.081909\n2.938727\n0.222124\n0.055139\n00:00\n\n\n2\n3.011248\n2.851364\n0.134761\n0.030517\n00:00\n\n\n3\n2.967336\n2.879799\n0.163196\n0.037787\n00:00\n\n\n4\n2.942564\n2.865221\n0.148617\n0.033606\n-1:59:59\n\n\n5\n2.921736\n2.856464\n0.139861\n0.031637\n00:00\n\n\n6\n2.902239\n2.856883\n0.140280\n0.031034\n00:00\n\n\n7\n2.883385\n2.848513\n0.131910\n0.029322\n00:00\n\n\n8\n2.867899\n2.851038\n0.134435\n0.030472\n00:00\n\n\n9\n2.854214\n2.868535\n0.151931\n0.034805\n00:00\n\n\n10\n2.841882\n2.876914\n0.160311\n0.036888\n00:00\n\n\n11\n2.831786\n2.883744\n0.167141\n0.038587\n00:00\n\n\n12\n2.823037\n2.896835\n0.180232\n0.042036\n00:00\n\n\n13\n2.815647\n2.907049\n0.190445\n0.044805\n00:00\n\n\n14\n2.809287\n2.923750\n0.207147\n0.048721\n00:00\n\n\n15\n2.804163\n2.922053\n0.205449\n0.048186\n00:00\n\n\n16\n2.799402\n2.926703\n0.210099\n0.049234\n00:00\n\n\n17\n2.795474\n2.927454\n0.210851\n0.049211\n00:00\n\n\n18\n2.791993\n2.922887\n0.206284\n0.048067\n00:00\n\n\n19\n2.788906\n2.934660\n0.218057\n0.050382\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold3------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.217360\n3.135256\n0.444112\n0.093500\n00:00\n\n\n1\n3.089197\n3.000559\n0.309415\n0.071229\n00:00\n\n\n2\n3.013406\n2.909544\n0.218400\n0.043400\n00:00\n\n\n3\n2.973763\n3.000403\n0.309258\n0.058953\n00:00\n\n\n4\n2.950085\n2.952441\n0.261297\n0.050864\n00:00\n\n\n5\n2.926956\n2.932818\n0.241674\n0.046230\n00:00\n\n\n6\n2.905373\n2.913712\n0.222568\n0.043278\n00:00\n\n\n7\n2.886523\n2.899899\n0.208755\n0.041040\n00:00\n\n\n8\n2.871984\n2.899730\n0.208587\n0.040406\n00:00\n\n\n9\n2.859025\n2.895478\n0.204334\n0.040991\n00:00\n\n\n10\n2.847441\n2.900883\n0.209739\n0.041914\n00:00\n\n\n11\n2.837836\n2.938530\n0.247386\n0.050021\n00:00\n\n\n12\n2.829586\n3.007871\n0.316727\n0.066030\n00:00\n\n\n13\n2.821911\n3.130609\n0.439465\n0.090029\n00:00\n\n\n14\n2.815553\n3.205676\n0.514532\n0.097538\n00:00\n\n\n15\n2.809974\n3.894821\n1.203677\n0.142054\n00:00\n\n\n16\n2.804972\n4.875163\n2.184019\n0.172196\n00:00\n\n\n17\n2.800660\n4.489316\n1.798172\n0.166581\n00:00\n\n\n18\n2.797134\n3.734024\n1.042881\n0.139437\n00:00\n\n\n19\n2.794170\n3.943503\n1.252359\n0.143880\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold4------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.221777\n3.120676\n0.331231\n0.073846\n00:01\n\n\n1\n3.079224\n2.961355\n0.171910\n0.044981\n00:00\n\n\n2\n3.000947\n2.920985\n0.131540\n0.031555\n00:00\n\n\n3\n2.962647\n2.964863\n0.175418\n0.040005\n00:00\n\n\n4\n2.940489\n2.948510\n0.159065\n0.037153\n00:00\n\n\n5\n2.917177\n2.914334\n0.124890\n0.029468\n00:00\n\n\n6\n2.894965\n2.901642\n0.112197\n0.026065\n00:00\n\n\n7\n2.875778\n2.897019\n0.107574\n0.025436\n00:00\n\n\n8\n2.859513\n2.893893\n0.104448\n0.024652\n00:00\n\n\n9\n2.845501\n2.900487\n0.111043\n0.026683\n00:00\n\n\n10\n2.833211\n2.911707\n0.122262\n0.029087\n00:00\n\n\n11\n2.823061\n2.918646\n0.129201\n0.030911\n00:00\n\n\n12\n2.814080\n2.962426\n0.172982\n0.039040\n00:00\n\n\n13\n2.806450\n3.012691\n0.223246\n0.045578\n-1:59:59\n\n\n14\n2.799661\n3.095942\n0.306497\n0.056741\n00:00\n\n\n15\n2.794147\n3.186306\n0.396861\n0.066668\n00:00\n\n\n16\n2.789003\n3.146222\n0.356777\n0.061604\n00:00\n\n\n17\n2.784820\n3.192040\n0.402595\n0.064867\n00:00\n\n\n18\n2.781168\n3.251970\n0.462525\n0.068339\n00:00\n\n\n19\n2.778569\n3.470715\n0.681270\n0.079629\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold5------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.199647\n3.140137\n0.351326\n0.075517\n00:00\n\n\n1\n3.064764\n2.972414\n0.183604\n0.047527\n00:00\n\n\n2\n2.991076\n2.917917\n0.129106\n0.031017\n00:00\n\n\n3\n2.949582\n2.947464\n0.158653\n0.038191\n00:00\n\n\n4\n2.925140\n2.909489\n0.120679\n0.028941\n00:00\n\n\n5\n2.902952\n2.904005\n0.115195\n0.027851\n00:00\n\n\n6\n2.882324\n2.890948\n0.102137\n0.024815\n00:00\n\n\n7\n2.863699\n2.894485\n0.105674\n0.025504\n00:00\n\n\n8\n2.848049\n2.904008\n0.115198\n0.028467\n00:00\n\n\n9\n2.834757\n2.911851\n0.123041\n0.030428\n00:00\n\n\n10\n2.823938\n2.918086\n0.129275\n0.032054\n00:00\n\n\n11\n2.814502\n2.924456\n0.135646\n0.033397\n00:00\n\n\n12\n2.806381\n2.936222\n0.147411\n0.035624\n00:00\n\n\n13\n2.799514\n2.932553\n0.143742\n0.035170\n00:00\n\n\n14\n2.793619\n2.931933\n0.143122\n0.035091\n00:00\n\n\n15\n2.788580\n2.929070\n0.140260\n0.034507\n00:00\n\n\n16\n2.784421\n2.931773\n0.142962\n0.035119\n00:00\n\n\n17\n2.780766\n2.931452\n0.142641\n0.035091\n00:00\n\n\n18\n2.777678\n2.929527\n0.140717\n0.034653\n00:00\n\n\n19\n2.775166\n2.930931\n0.142120\n0.034841\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold6------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.211345\n3.139642\n0.324376\n0.071962\n00:00\n\n\n1\n3.079162\n2.969423\n0.154157\n0.040900\n00:00\n\n\n2\n3.002954\n2.927417\n0.112150\n0.026776\n00:00\n\n\n3\n2.957990\n2.980102\n0.164836\n0.037336\n00:00\n\n\n4\n2.934710\n2.942456\n0.127189\n0.029204\n00:00\n\n\n5\n2.913644\n2.923435\n0.108169\n0.025080\n00:00\n\n\n6\n2.891332\n2.929808\n0.114542\n0.025729\n00:00\n\n\n7\n2.871521\n2.914588\n0.099322\n0.023127\n00:00\n\n\n8\n2.854944\n2.909274\n0.094008\n0.022614\n00:00\n\n\n9\n2.840556\n2.923026\n0.107760\n0.026119\n00:00\n\n\n10\n2.828343\n2.958011\n0.142744\n0.033875\n00:00\n\n\n11\n2.818299\n3.014986\n0.199720\n0.046344\n00:00\n\n\n12\n2.809941\n3.028631\n0.213364\n0.049657\n00:00\n\n\n13\n2.802525\n3.000083\n0.184817\n0.043963\n00:00\n\n\n14\n2.796725\n2.989132\n0.173866\n0.041270\n00:00\n\n\n15\n2.791409\n2.996987\n0.181720\n0.042921\n00:00\n\n\n16\n2.786753\n3.003397\n0.188131\n0.044358\n00:00\n\n\n17\n2.782986\n3.002526\n0.187259\n0.044141\n00:00\n\n\n18\n2.779207\n2.997455\n0.182189\n0.042945\n00:00\n\n\n19\n2.776644\n2.999060\n0.183793\n0.043442\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold7------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.207157\n3.116577\n0.454532\n0.098201\n00:21\n\n\n1\n3.068383\n2.942939\n0.280893\n0.065497\n00:00\n\n\n2\n2.993331\n2.967219\n0.305173\n0.066856\n00:02\n\n\n3\n2.952425\n2.931577\n0.269531\n0.058940\n07:28\n\n\n4\n2.924765\n2.894598\n0.232553\n0.052688\n00:00\n\n\n5\n2.902512\n2.898267\n0.236222\n0.051465\n00:00\n\n\n6\n2.884839\n2.890331\n0.228286\n0.050490\n00:00\n\n\n7\n2.869885\n2.894372\n0.232327\n0.051913\n00:00\n\n\n8\n2.855418\n2.942313\n0.280268\n0.060312\n00:00\n\n\n9\n2.841797\n3.203032\n0.540987\n0.111459\n00:00\n\n\n10\n2.830229\n3.292855\n0.630810\n0.123641\n00:00\n\n\n11\n2.820735\n3.266531\n0.604486\n0.119290\n00:00\n\n\n12\n2.812273\n3.308702\n0.646657\n0.129931\n00:00\n\n\n13\n2.805096\n3.256686\n0.594641\n0.118864\n00:00\n\n\n14\n2.799061\n3.193116\n0.531071\n0.108449\n00:00\n\n\n15\n2.793950\n3.204517\n0.542472\n0.109433\n00:00\n\n\n16\n2.789811\n3.160384\n0.498339\n0.103601\n00:01\n\n\n17\n2.786062\n3.193079\n0.531034\n0.109163\n00:00\n\n\n18\n2.782929\n3.141123\n0.479077\n0.098941\n00:01\n\n\n19\n2.780393\n3.178627\n0.516582\n0.106204\n00:01\n\n\n\n\n\n\n\n\n\n\n\n\n------fold8------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.218322\n3.154627\n0.356495\n0.075715\n00:00\n\n\n1\n3.082187\n2.948062\n0.149931\n0.037856\n00:00\n\n\n2\n3.001617\n3.049119\n0.250988\n0.055764\n00:00\n\n\n3\n2.959477\n3.161151\n0.363019\n0.079681\n00:00\n\n\n4\n2.930529\n3.053700\n0.255568\n0.054616\n00:00\n\n\n5\n2.905670\n2.989527\n0.191395\n0.042046\n00:00\n\n\n6\n2.883381\n2.934242\n0.136111\n0.030624\n00:00\n\n\n7\n2.864315\n2.923664\n0.125532\n0.027720\n00:00\n\n\n8\n2.848774\n2.965591\n0.167460\n0.039490\n00:00\n\n\n9\n2.835498\n3.717572\n0.919440\n0.118789\n00:00\n\n\n10\n2.824239\n4.831798\n2.033666\n0.155769\n00:00\n\n\n11\n2.814907\n5.116006\n2.317875\n0.170461\n00:00\n\n\n12\n2.806855\n5.010515\n2.212383\n0.169534\n00:00\n\n\n13\n2.800228\n5.589930\n2.791799\n0.186263\n00:00\n\n\n14\n2.794528\n5.756356\n2.958225\n0.184530\n00:00\n\n\n15\n2.789591\n5.471392\n2.673260\n0.172984\n00:00\n\n\n16\n2.785285\n5.211399\n2.413267\n0.165043\n00:00\n\n\n17\n2.781870\n5.124030\n2.325897\n0.165491\n00:00\n\n\n18\n2.779195\n5.127772\n2.329640\n0.169457\n00:00\n\n\n19\n2.777070\n5.340095\n2.541963\n0.172145\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n\noof_onehot_pca = train_dl_cv(df_onehot_pca,onehot_pca_col,target_col,\n                  splits = splits,\n                  model_func = get_cnn_onehot_pca,\n                  n_epoch=20,lr=3e-3)\n\n------fold0------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.294691\n3.137259\n0.398698\n0.080640\n00:00\n\n\n1\n3.263470\n3.141515\n0.402954\n0.082747\n00:00\n\n\n2\n3.223175\n3.177219\n0.438658\n0.089337\n00:00\n\n\n3\n3.183045\n3.227620\n0.489059\n0.093476\n00:00\n\n\n4\n3.142418\n3.287463\n0.548902\n0.100686\n00:00\n\n\n5\n3.100256\n3.341402\n0.602841\n0.100119\n00:00\n\n\n6\n3.054611\n3.505619\n0.767058\n0.101345\n00:00\n\n\n7\n3.011055\n3.471998\n0.733437\n0.097002\n00:00\n\n\n8\n2.974147\n3.588242\n0.849681\n0.097573\n00:00\n\n\n9\n2.943142\n3.605361\n0.866801\n0.097618\n00:00\n\n\n10\n2.917536\n3.611651\n0.873091\n0.095335\n00:00\n\n\n11\n2.895584\n3.629502\n0.890941\n0.094714\n00:00\n\n\n12\n2.876624\n3.649335\n0.910774\n0.096127\n00:00\n\n\n13\n2.860609\n3.660701\n0.922140\n0.097082\n00:00\n\n\n14\n2.847290\n3.664461\n0.925900\n0.096590\n00:00\n\n\n15\n2.836029\n3.668696\n0.930135\n0.096939\n00:00\n\n\n16\n2.826384\n3.669010\n0.930449\n0.096871\n00:00\n\n\n17\n2.818100\n3.676537\n0.937977\n0.096779\n00:00\n\n\n18\n2.811651\n3.676708\n0.938147\n0.096693\n00:00\n\n\n19\n2.805929\n3.677161\n0.938600\n0.096341\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold1------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.301871\n3.113387\n0.353994\n0.080182\n00:00\n\n\n1\n3.251986\n3.055797\n0.296404\n0.072427\n00:00\n\n\n2\n3.180077\n2.946853\n0.187460\n0.049313\n00:00\n\n\n3\n3.106059\n3.159497\n0.400104\n0.067071\n00:00\n\n\n4\n3.053151\n3.082665\n0.323272\n0.055897\n00:00\n\n\n5\n3.016690\n2.961791\n0.202398\n0.045059\n00:00\n\n\n6\n2.985151\n2.949506\n0.190114\n0.043004\n00:00\n\n\n7\n2.956095\n2.933504\n0.174111\n0.039649\n00:00\n\n\n8\n2.929397\n2.934963\n0.175571\n0.040043\n00:00\n\n\n9\n2.907381\n2.915690\n0.156297\n0.036116\n00:00\n\n\n10\n2.887776\n2.903538\n0.144146\n0.033489\n00:00\n\n\n11\n2.870944\n2.926418\n0.167025\n0.037351\n00:00\n\n\n12\n2.856064\n2.917785\n0.158392\n0.035572\n00:00\n\n\n13\n2.843407\n2.906300\n0.146907\n0.033587\n00:00\n\n\n14\n2.832056\n2.907512\n0.148120\n0.033845\n00:00\n\n\n15\n2.822417\n2.906131\n0.146738\n0.033671\n00:00\n\n\n16\n2.814583\n2.909864\n0.150471\n0.034348\n00:00\n\n\n17\n2.807935\n2.911995\n0.152602\n0.034596\n00:00\n\n\n18\n2.802130\n2.910291\n0.150898\n0.034142\n00:00\n\n\n19\n2.797422\n2.898971\n0.139578\n0.032354\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold2------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.302217\n3.133570\n0.416967\n0.090089\n00:00\n\n\n1\n3.256617\n3.091846\n0.375242\n0.085063\n00:00\n\n\n2\n3.185585\n3.058449\n0.341846\n0.079717\n00:00\n\n\n3\n3.108964\n3.085640\n0.369037\n0.067483\n00:00\n\n\n4\n3.053280\n3.206532\n0.489929\n0.074658\n-1:59:59\n\n\n5\n3.018560\n2.920109\n0.203505\n0.045472\n00:00\n\n\n6\n2.989412\n2.938208\n0.221605\n0.049293\n00:00\n\n\n7\n2.959617\n2.946715\n0.230112\n0.051988\n00:00\n\n\n8\n2.932363\n2.911540\n0.194936\n0.044599\n00:00\n\n\n9\n2.910704\n2.981530\n0.264927\n0.059324\n00:00\n\n\n10\n2.891130\n2.962162\n0.245558\n0.055606\n00:00\n\n\n11\n2.874626\n2.913973\n0.197370\n0.045975\n00:00\n\n\n12\n2.860034\n2.902319\n0.185716\n0.042663\n00:00\n\n\n13\n2.847568\n2.893028\n0.176425\n0.039844\n00:00\n\n\n14\n2.836598\n2.884434\n0.167830\n0.038216\n00:00\n\n\n15\n2.827027\n2.886871\n0.170268\n0.038664\n00:00\n\n\n16\n2.819156\n2.886121\n0.169518\n0.038627\n00:00\n\n\n17\n2.812171\n2.888980\n0.172377\n0.039150\n00:00\n\n\n18\n2.806926\n2.890533\n0.173930\n0.039448\n00:00\n\n\n19\n2.802097\n2.891819\n0.175215\n0.039755\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold3------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.299308\n3.112815\n0.421671\n0.090712\n00:00\n\n\n1\n3.251778\n3.073382\n0.382238\n0.085915\n00:00\n\n\n2\n3.179465\n3.053364\n0.362220\n0.081255\n00:00\n\n\n3\n3.106511\n3.319328\n0.628184\n0.080552\n00:00\n\n\n4\n3.065808\n3.112725\n0.421581\n0.075182\n00:00\n\n\n5\n3.036750\n2.988638\n0.297494\n0.060457\n00:00\n\n\n6\n3.005094\n3.020451\n0.329307\n0.067131\n00:00\n\n\n7\n2.974625\n3.095387\n0.404244\n0.073515\n00:00\n\n\n8\n2.946579\n3.052358\n0.361214\n0.066235\n00:00\n\n\n9\n2.923277\n2.994418\n0.303274\n0.058904\n00:00\n\n\n10\n2.901995\n2.960744\n0.269600\n0.052277\n00:00\n\n\n11\n2.885334\n2.939471\n0.248327\n0.047824\n00:00\n\n\n12\n2.869542\n2.938663\n0.247519\n0.048670\n00:00\n\n\n13\n2.856085\n2.969018\n0.277874\n0.053620\n00:00\n\n\n14\n2.845040\n2.986923\n0.295779\n0.055922\n00:00\n\n\n15\n2.835549\n2.976436\n0.285293\n0.054313\n00:00\n\n\n16\n2.827210\n2.959410\n0.268266\n0.051559\n00:00\n\n\n17\n2.820472\n2.949389\n0.258245\n0.049625\n00:00\n\n\n18\n2.815124\n2.947890\n0.256747\n0.049296\n00:00\n\n\n19\n2.810766\n2.956153\n0.265009\n0.050701\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold4------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.299725\n3.117021\n0.327577\n0.073398\n00:00\n\n\n1\n3.250774\n3.064939\n0.275494\n0.066268\n00:00\n\n\n2\n3.174958\n2.958110\n0.168665\n0.043510\n00:00\n\n\n3\n3.099215\n2.961793\n0.172348\n0.040971\n00:00\n\n\n4\n3.051188\n2.934969\n0.145524\n0.034921\n00:00\n\n\n5\n3.018962\n2.951272\n0.161827\n0.039013\n00:00\n\n\n6\n2.988851\n2.930847\n0.141403\n0.034108\n00:00\n\n\n7\n2.959735\n2.912599\n0.123154\n0.029397\n00:00\n\n\n8\n2.932398\n2.916482\n0.127037\n0.030873\n00:00\n\n\n9\n2.908323\n2.909319\n0.119874\n0.029153\n00:00\n\n\n10\n2.887608\n2.903954\n0.114509\n0.027146\n00:00\n\n\n11\n2.870060\n2.906731\n0.117286\n0.027781\n00:00\n\n\n12\n2.854917\n2.909138\n0.119693\n0.028750\n00:00\n\n\n13\n2.842772\n2.904670\n0.115226\n0.027538\n00:00\n\n\n14\n2.831243\n2.906233\n0.116789\n0.028013\n00:00\n\n\n15\n2.821458\n2.905252\n0.115808\n0.027734\n00:00\n\n\n16\n2.813246\n2.905241\n0.115796\n0.027731\n00:00\n\n\n17\n2.805741\n2.905666\n0.116221\n0.027847\n00:00\n\n\n18\n2.799681\n2.908188\n0.118743\n0.028527\n00:00\n\n\n19\n2.794784\n2.903374\n0.113929\n0.027207\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold5------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.294465\n3.135190\n0.346380\n0.075028\n00:00\n\n\n1\n3.248152\n3.124927\n0.336117\n0.073005\n00:00\n\n\n2\n3.168731\n3.020002\n0.231191\n0.056880\n00:00\n\n\n3\n3.091349\n3.233966\n0.445156\n0.074591\n00:00\n\n\n4\n3.042989\n2.996500\n0.207690\n0.044531\n00:00\n\n\n5\n3.000945\n2.983008\n0.194198\n0.045271\n00:00\n\n\n6\n2.966819\n2.952210\n0.163400\n0.038246\n00:00\n\n\n7\n2.936022\n2.951103\n0.162293\n0.035806\n00:00\n\n\n8\n2.910291\n2.929545\n0.140735\n0.031989\n00:00\n\n\n9\n2.887657\n2.920960\n0.132150\n0.031165\n00:00\n\n\n10\n2.868363\n2.915508\n0.126698\n0.030763\n00:00\n\n\n11\n2.853660\n2.912930\n0.124119\n0.030236\n00:00\n\n\n12\n2.841366\n2.928237\n0.139426\n0.033478\n00:00\n\n\n13\n2.830123\n2.908879\n0.120069\n0.029083\n00:00\n\n\n14\n2.819822\n2.919453\n0.130642\n0.031378\n00:00\n\n\n15\n2.811538\n2.906948\n0.118138\n0.028666\n00:00\n\n\n16\n2.804413\n2.911311\n0.122500\n0.029665\n00:00\n\n\n17\n2.798424\n2.909667\n0.120857\n0.029286\n00:00\n\n\n18\n2.793306\n2.913197\n0.124386\n0.030075\n00:00\n\n\n19\n2.788728\n2.912609\n0.123799\n0.029961\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold6------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.297189\n3.136102\n0.320835\n0.071463\n00:00\n\n\n1\n3.249536\n3.097304\n0.282038\n0.066755\n00:00\n\n\n2\n3.176144\n2.978935\n0.163668\n0.041619\n00:00\n\n\n3\n3.096929\n3.038055\n0.222788\n0.047839\n00:00\n\n\n4\n3.042613\n2.930212\n0.114946\n0.027027\n00:00\n\n\n5\n3.009720\n2.961850\n0.146584\n0.036113\n00:00\n\n\n6\n2.980234\n2.934232\n0.118966\n0.028464\n00:00\n\n\n7\n2.950530\n2.916851\n0.101585\n0.024648\n00:00\n\n\n8\n2.923650\n2.914764\n0.099498\n0.023798\n00:00\n\n\n9\n2.900300\n2.905350\n0.090084\n0.021675\n00:00\n\n\n10\n2.879807\n2.909664\n0.094397\n0.022672\n00:00\n\n\n11\n2.862369\n2.905931\n0.090665\n0.021678\n00:00\n\n\n12\n2.847067\n2.908035\n0.092769\n0.022000\n00:00\n\n\n13\n2.834576\n2.909927\n0.094661\n0.022350\n00:00\n\n\n14\n2.824375\n2.908078\n0.092811\n0.022187\n00:00\n\n\n15\n2.815225\n2.909920\n0.094654\n0.022545\n00:00\n\n\n16\n2.807965\n2.908288\n0.093022\n0.022114\n00:00\n\n\n17\n2.801108\n2.906668\n0.091402\n0.021692\n00:00\n\n\n18\n2.795465\n2.906262\n0.090996\n0.021677\n00:00\n\n\n19\n2.791303\n2.905522\n0.090256\n0.021500\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold7------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.299562\n3.121898\n0.459853\n0.099220\n00:00\n\n\n1\n3.243594\n3.062286\n0.400241\n0.091881\n00:00\n\n\n2\n3.159332\n2.971716\n0.309671\n0.068669\n00:00\n\n\n3\n3.089763\n3.351497\n0.689452\n0.103349\n00:00\n\n\n4\n3.045304\n2.918247\n0.256202\n0.056467\n00:00\n\n\n5\n3.008193\n2.911331\n0.249286\n0.055545\n00:00\n\n\n6\n2.972661\n2.913930\n0.251885\n0.056160\n00:00\n\n\n7\n2.941783\n2.896349\n0.234304\n0.051629\n00:00\n\n\n8\n2.915963\n2.914812\n0.252767\n0.053871\n00:00\n\n\n9\n2.893497\n2.888577\n0.226532\n0.049996\n00:00\n\n\n10\n2.875000\n2.886438\n0.224393\n0.049796\n00:00\n\n\n11\n2.858765\n2.898579\n0.236534\n0.051343\n00:00\n\n\n12\n2.844424\n2.893336\n0.231291\n0.050411\n00:00\n\n\n13\n2.832489\n2.895736\n0.233691\n0.050632\n00:00\n\n\n14\n2.822521\n2.893903\n0.231857\n0.050457\n-1:59:59\n\n\n15\n2.814178\n2.891891\n0.229846\n0.050070\n00:00\n\n\n16\n2.807404\n2.898021\n0.235976\n0.051179\n00:00\n\n\n17\n2.801465\n2.896371\n0.234326\n0.050828\n00:00\n\n\n18\n2.796492\n2.893707\n0.231662\n0.050206\n00:00\n\n\n19\n2.792389\n2.893404\n0.231358\n0.050177\n00:00\n\n\n\n\n\n\n\n\n\n\n\n\n------fold8------\nlr in training is 0.003\n\n\n\n\n\n\n\n\n\nepoch\ntrain_loss\nvalid_loss\nKLD\nJSD\ntime\n\n\n\n\n0\n3.291689\n3.126647\n0.328515\n0.072071\n00:00\n\n\n1\n3.247692\n3.070245\n0.272114\n0.064862\n00:00\n\n\n2\n3.171447\n3.193789\n0.395657\n0.082534\n00:00\n\n\n3\n3.087097\n3.136495\n0.338363\n0.060231\n00:00\n\n\n4\n3.034902\n3.407114\n0.608982\n0.063098\n00:00\n\n\n5\n2.998126\n2.938519\n0.140387\n0.032685\n00:00\n\n\n6\n2.965282\n2.934006\n0.135874\n0.031751\n00:00\n\n\n7\n2.936001\n2.920478\n0.122346\n0.028373\n00:00\n\n\n8\n2.909675\n2.920455\n0.122323\n0.028210\n00:00\n\n\n9\n2.887431\n2.947639\n0.149508\n0.034510\n00:00\n\n\n10\n2.868375\n2.975793\n0.177661\n0.038532\n00:00\n\n\n11\n2.851671\n2.975747\n0.177615\n0.039114\n00:00\n\n\n12\n2.838888\n2.943917\n0.145786\n0.032903\n00:00\n\n\n13\n2.827868\n2.999522\n0.201391\n0.037109\n00:00\n\n\n14\n2.817961\n3.014208\n0.216076\n0.037690\n00:00\n\n\n15\n2.810466\n3.005015\n0.206883\n0.036385\n00:00\n\n\n16\n2.803423\n3.015611\n0.217480\n0.037107\n00:00\n\n\n17\n2.797695\n3.024181\n0.226050\n0.037952\n00:00\n\n\n18\n2.792915\n3.014269\n0.216138\n0.037182\n00:00\n\n\n19\n2.789497\n3.015017\n0.216886\n0.037778\n00:00",
    "crumbs": [
      "kinase_domain",
      "DL training: Feature comparison on CNN model"
    ]
  },
  {
    "objectID": "kinase_domain/kd_06a_pspa_training_feature_comparison_cnn_group.html#score",
    "href": "kinase_domain/kd_06a_pspa_training_feature_comparison_cnn_group.html#score",
    "title": "DL training: Feature comparison on CNN model",
    "section": "Score",
    "text": "Score\n\nfrom katlas.pssm import *\n\nfrom functools import partial\n\n\ndef score_df(target,pred,func):\n    distance = [func(target.loc[i],pred.loc[i,target.columns]) for i in target.index]\n    return pd.Series(distance,index=target.index)\n\n\njsd_df = partial(score_df,func=js_divergence_flat)\njss_df = partial(score_df,func=js_similarity_flat)\n\nkld_df = partial(score_df,func=kl_divergence_flat)\n\n\ntarget=df_t5[target_col].copy()\n\n\n(oof_t5.nfold == oof_esm.nfold).value_counts()\n\nnfold\nTrue    368\nName: count, dtype: int64\n\n\n\npspa_info['split'] = oof_t5.nfold\n\n\npspa_info['t5'] =jsd_df(target,oof_t5)\npspa_info['esm'] =jsd_df(target,oof_esm)\npspa_info['onehot'] =jsd_df(target,oof_onehot)\npspa_info['onehot_pca'] =jsd_df(target,oof_onehot_pca)\n\n\nimport pandas as pd\n\nfrom katlas.plot import *\nfrom matplotlib import pyplot as plt\n\n\nset_sns()\n\n\n# pspa_info.to_parquet('raw/CNN_feature_compare_group.parquet')\n\n\npspa_info=pd.read_parquet('raw/CNN_feature_compare_group.parquet')\n\n\npspa_info = pspa_info.rename(columns={'t5':'T5(n=1,024)','esm':'ESM2(n=1,280)','onehot':'OneHot(n=6,849)','onehot_pca':'OneHot+PCA(n=1,000)'})\n\ncols=['OneHot(n=6,849)',\n      'OneHot+PCA(n=1,000)',\n      'ESM2(n=1,280)',\n      'T5(n=1,024)']\n\n\nplot_group_bar(pspa_info,cols,group='group')\nplt.ylabel('JS divergence')\nsave_svg('fig/CNN_feature_comparison_group.svg')\n\n\n\n\n\n\n\n\n\nFor JS similarity (less differentiated)\n\npspa_info['t5'] =jss_df(target,oof_t5)\npspa_info['esm'] =jss_df(target,oof_esm)\npspa_info['onehot'] =jss_df(target,oof_onehot)\npspa_info['onehot_pca'] =jss_df(target,oof_onehot_pca)\n\n\nplot_group_bar(pspa_info,['t5','esm','onehot','onehot_pca'],group='group')\nplt.ylabel('JS divergence')",
    "crumbs": [
      "kinase_domain",
      "DL training: Feature comparison on CNN model"
    ]
  },
  {
    "objectID": "kinase_domain/kd_01_get_all_kd.html",
    "href": "kinase_domain/kd_01_get_all_kd.html",
    "title": "Get all kinase domain sequences",
    "section": "",
    "text": "from katlas.data import *\nfrom katlas.utils import *\nimport pandas as pd\nfrom fastcore.all import L\nimport re\n\npd.set_option('display.max_rows', 20)\npd.set_option('display.max_columns', 100)",
    "crumbs": [
      "kinase_domain",
      "Get all kinase domain sequences"
    ]
  },
  {
    "objectID": "kinase_domain/kd_01_get_all_kd.html#setup",
    "href": "kinase_domain/kd_01_get_all_kd.html#setup",
    "title": "Get all kinase domain sequences",
    "section": "",
    "text": "from katlas.data import *\nfrom katlas.utils import *\nimport pandas as pd\nfrom fastcore.all import L\nimport re\n\npd.set_option('display.max_rows', 20)\npd.set_option('display.max_columns', 100)",
    "crumbs": [
      "kinase_domain",
      "Get all kinase domain sequences"
    ]
  },
  {
    "objectID": "kinase_domain/kd_01_get_all_kd.html#kinase-domain-info-of-current-human-kinome",
    "href": "kinase_domain/kd_01_get_all_kd.html#kinase-domain-info-of-current-human-kinome",
    "title": "Get all kinase domain sequences",
    "section": "Kinase domain info of current human kinome",
    "text": "Kinase domain info of current human kinome\n\ndf = Data.get_kinase_info()\n\n\ndf.kinasecom_domain.notna().sum()\n\nnp.int64(516)\n\n\n\n# df.uniprot.to_csv('kinase_uniprot.csv')\n\nQuery the uniprot id in ID mapping in uniprot. Add domain [FT] and region in the columns\n\nuniprot=pd.read_excel('raw/idmapping_kinase_info_2025_05_27.xlsx')\n\n\nuniprot['Domain [FT]'].head()\n\n0    DOMAIN 46..315; /note=\"Protein kinase\"; /evide...\n1    DOMAIN 61..121; /note=\"SH3\"; /evidence=\"ECO:00...\n2    DOMAIN 107..167; /note=\"SH3\"; /evidence=\"ECO:0...\n3    DOMAIN 126..385; /note=\"Protein kinase\"; /evid...\n4    DOMAIN 192..485; /note=\"Protein kinase\"; /evid...\nName: Domain [FT], dtype: object\n\n\nFAM20C does not have Domain[FT] but contains Region to indicate kinase domain\n\nuniprot[uniprot['Domain [FT]'].isna()].Region.tolist()\n\n['REGION 62..81; /note=\"Disordered\"; /evidence=\"ECO:0000256|SAM:MobiDB-lite\"; REGION 94..159; /note=\"Disordered\"; /evidence=\"ECO:0000256|SAM:MobiDB-lite\"; REGION 354..565; /note=\"Kinase domain\"; /evidence=\"ECO:0000305|PubMed:22582013\"']\n\n\n\nuniprot = uniprot.dropna(subset='Domain [FT]')\n\n\ndef extract_kinase_domains1(text):\n    \"\"\"\n    Extracts domain or region annotations from text using regex.\n    Includes entries where the note contains either 'kinase' or 'PI3K/PI4K catalytic'.\n    Returns a list of [note, region, evidence] where evidence is set to 'nan' if not present.\n    \"\"\"\n    pattern = r'(?:REGION|DOMAIN) [&lt;&gt;]?(\\d+)\\.\\.[&lt;&gt;]?(\\d+); /note=\"([^\"]*?(?:kinase|PI3K/PI4K catalytic)[^\"]*?)\"(?:; /evidence=\"([^\"]*?)\")?'\n    matches = re.findall(pattern, text, flags=re.IGNORECASE)\n    \n    return [[note.strip(), evidence if evidence else 'nan']\n            for start, end, note, evidence in matches]\n\n\nout = uniprot['Domain [FT]'].apply(extract_kinase_domains1)\n\nThe rest of the kinases have domain info:\n\nout.explode().value_counts()\n\nDomain [FT]\n[Protein kinase, ECO:0000255|PROSITE-ProRule:PRU00159]                                  454\n[AGC-kinase C-terminal, ECO:0000255|PROSITE-ProRule:PRU00618]                            55\n[Protein kinase 2, ECO:0000255|PROSITE-ProRule:PRU00159]                                 14\n[Protein kinase 1, ECO:0000255|PROSITE-ProRule:PRU00159]                                 14\n[Protein kinase, nan]                                                                     7\n[Alpha-type protein kinase, ECO:0000255|PROSITE-ProRule:PRU00501]                         6\n[PI3K/PI4K catalytic, ECO:0000255|PROSITE-ProRule:PRU00269]                               6\n[Histidine kinase, ECO:0000255|PROSITE-ProRule:PRU00107]                                  4\n[Protein kinase, ECO:0000255|PROSITE-ProRule:PRU00159, ECO:0000305]                       4\n[Guanylate kinase-like, ECO:0000255|PROSITE-ProRule:PRU00100]                             1\n[Protein kinase; inactive, ECO:0000255|PROSITE-ProRule:PRU00159]                          1\n[Protein kinase, ECO:0000255|PROSITE-ProRule:PRU00159, ECO:0000269|PubMed:15194684]       1\n[Protein kinase, ECO:0000255|PROSITE-ProRule:PRU00159, ECO:0000269|PubMed:9092543]        1\n[Protein kinase, ECO:0000250|UniProtKB:Q5VT25, ECO:0000255|PROSITE-ProRule:PRU00159]      1\n[Protein kinase, ECO:0000255|PROSITE-ProRule:PRU00159, ECO:0000312|EMBL:CAA84485.1]       1\n[Protein kinase, ECO:0000305]                                                             1\nName: count, dtype: int64\n\n\nWe’ll search uniprot across species based on the info above to get all kinases and their kinase domains.",
    "crumbs": [
      "kinase_domain",
      "Get all kinase domain sequences"
    ]
  },
  {
    "objectID": "kinase_domain/kd_01_get_all_kd.html#download-kinase-domain-info-from-uniprot",
    "href": "kinase_domain/kd_01_get_all_kd.html#download-kinase-domain-info-from-uniprot",
    "title": "Get all kinase domain sequences",
    "section": "Download kinase domain info from Uniprot",
    "text": "Download kinase domain info from Uniprot\nUniprot reviewed –&gt; search advanced\n–&gt; domain: “Protein kinase”, or “PI3K PI4K catalytic” or “Histidine kinase”\nor –&gt; region: “Kinase domain”\n\nkd1=pd.read_excel('raw/uniprotkb_ft_domain_Protein_kinase_AND_2025_05_25.xlsx')\nkd2=pd.read_excel('raw/uniprotkb_ft_domain_PI3K_PI4K_catalytic_2025_05_25.xlsx')\nkd3=pd.read_excel('raw/uniprotkb_ft_domain_Histidine_kinase_AN_2025_05_25.xlsx')\nkd4=pd.read_excel('raw/uniprotkb_ft_region_Kinase_domain_2025_05_26.xlsx')\n\n\nkd_all = pd.concat([kd1,kd2,kd3,kd4],ignore_index=True)\n\n\nkd_human = kd_all[kd_all.Organism.str.contains('Homo')]",
    "crumbs": [
      "kinase_domain",
      "Get all kinase domain sequences"
    ]
  },
  {
    "objectID": "kinase_domain/kd_01_get_all_kd.html#check-if-how-it-overlap-with-current-kinome",
    "href": "kinase_domain/kd_01_get_all_kd.html#check-if-how-it-overlap-with-current-kinome",
    "title": "Get all kinase domain sequences",
    "section": "Check if how it overlap with current kinome",
    "text": "Check if how it overlap with current kinome\n\nkinase domain query vs. kinome tree kinases\n\nkinase_info = Data.get_kinase_info()\n\n\na,b = get_diff(kd_human,kinase_info,'Uniprot','uniprot')\n\n\nb.iloc[:,:5] # special for kinome tree\n\n\n\n\n\n\n\n\nkinase\nID_coral\nuniprot\ngene\nmodi_group\n\n\n\n\n41\nBRD2\nBRD2\nP25440\nBRD2\nAtypical\n\n\n42\nBRD3\nBRD3\nQ15059\nBRD3\nAtypical\n\n\n43\nBRD4\nBRD4\nO60885\nBRD4\nAtypical\n\n\n44\nBRDT\nBRDT\nQ58F21\nBRDT\nAtypical\n\n\n486\nTRIM24\nTIF1a\nO15164\nTRIM24\nAtypical\n\n\n487\nTRIM28\nTIF1b\nQ13263\nTRIM28\nAtypical\n\n\n488\nTRIM33\nTIF1g\nQ9UPN9\nTRIM33\nAtypical\n\n\n\n\n\n\n\nThese kinases does not have clear boundary of kinase domain in the domain[FT] column.\n\na.iloc[:,:5] # special for kinase domain query\n\n\n\n\n\n\n\n\nUniprot\nReviewed\nEntry Name\nProtein names\nGene Names\n\n\n\n\n895\nP21675\nreviewed\nTAF1_HUMAN\nTranscription initiation factor TFIID subunit ...\nTAF1 BA2R CCG1 CCGS TAF2A\n\n\n1982\nQ496M5\nreviewed\nPLK5_HUMAN\nInactive serine/threonine-protein kinase PLK5 ...\nPLK5 PLK5P FG060302\n\n\n2448\nQ6A1A2\nreviewed\nPDPK2_HUMAN\nPutative 3-phosphoinositide-dependent protein ...\nPDPK2P PDPK2\n\n\n2894\nQ8NEV1\nreviewed\nCSK23_HUMAN\nCasein kinase II subunit alpha 3 (CK II alpha ...\nCSNK2A3 CSNK2A1P\n\n\n3624\nQ9UQ88\nreviewed\nCD11A_HUMAN\nCyclin-dependent kinase 11A (EC 2.7.11.22) (Ce...\nCDK11A CDC2L2 CDC2L3 PITSLREB\n\n\n...\n...\n...\n...\n...\n...\n\n\n4761\nQ9UBF8\nreviewed\nPI4KB_HUMAN\nPhosphatidylinositol 4-kinase beta (PI4K-beta)...\nPI4KB PIK4CB\n\n\n4790\nA4QPH2\nreviewed\nPI4P2_HUMAN\nPutative phosphatidylinositol 4-kinase alpha-l...\nPI4KAP2\n\n\n4812\nA4D2B8\nreviewed\nPM2P1_HUMAN\nPutative postmeiotic segregation increased 2-l...\nPMS2P1 PMS2L1 PMS2L13 PMS2L6 PMS2L8 PMS3 PMS8 ...\n\n\n4878\nQ15119\nreviewed\nPDK2_HUMAN\n[Pyruvate dehydrogenase (acetyl-transferring)]...\nPDK2 PDHK2\n\n\n5441\nQ8N159\nreviewed\nNAGS_HUMAN\nN-acetylglutamate synthase, mitochondrial (EC ...\nNAGS\n\n\n\n\n21 rows × 5 columns\n\n\n\nKinase keyword query contains a lot of non-serine/thronine/tyrosine kinases.\n\n\nkinase domain query vs. kinase keyword query\n\nall_kinase = pd.read_excel('raw/uniprot_human_keyword_kinase.xlsx').rename(columns={'Entry':'Uniprot'})\n\n\na,b = get_diff(kd_human,all_kinase,'Uniprot')\n\n\na.iloc[:,:5] # special for kd domain query\n\n\n\n\n\n\n\n\nUniprot\nReviewed\nEntry Name\nProtein names\nGene Names\n\n\n\n\n1982\nQ496M5\nreviewed\nPLK5_HUMAN\nInactive serine/threonine-protein kinase PLK5 ...\nPLK5 PLK5P FG060302\n\n\n5441\nQ8N159\nreviewed\nNAGS_HUMAN\nN-acetylglutamate synthase, mitochondrial (EC ...\nNAGS\n\n\n\n\n\n\n\nkd domain query also include inactive kinase (PLK5), which is not marked with ‘kinase’ in the keywords.\nAnother one is NAGS, which contains Amino-acid kinase domain (AAK), and not marked with ‘kinase’ in the keywords.\n\nb.iloc[:,:5] # special for kinase keyword query\n\n\n\n\n\n\n\n\nUniprot\nEntry Name\nProtein names\nGene Names\nuniprot_keyword_kinase\n\n\n\n\n0\nA2RU49\nHYKK_HUMAN\nHydroxylysine kinase (5-hydroxy-L-lysine kinas...\nHYKK AGPHD1\n1\n\n\n3\nO00142\nKITM_HUMAN\nThymidine kinase 2, mitochondrial (EC 2.7.1.21...\nTK2\n1\n\n\n11\nO00746\nNDKM_HUMAN\nNucleoside diphosphate kinase, mitochondrial (...\nNME4 NM23D\n1\n\n\n13\nO00764\nPDXK_HUMAN\nPyridoxal kinase (EC 2.7.1.35) (Pyridoxine kin...\nPDXK C21orf124 C21orf97 PKH PNK PRED79\n1\n\n\n23\nO14986\nPI51B_HUMAN\nPhosphatidylinositol 4-phosphate 5-kinase type...\nPIP5K1B STM7\n1\n\n\n...\n...\n...\n...\n...\n...\n\n\n638\nO60885\nBRD4_HUMAN\nBromodomain-containing protein 4 (Protein HUNK1)\nBRD4 HUNK1\n0\n\n\n639\nQ58F21\nBRDT_HUMAN\nBromodomain testis-specific protein (Cancer/te...\nBRDT\n0\n\n\n663\nO15164\nTIF1A_HUMAN\nTranscription intermediary factor 1-alpha (TIF...\nTRIM24 RNF82 TIF1 TIF1A\n0\n\n\n664\nQ13263\nTIF1B_HUMAN\nTranscription intermediary factor 1-beta (TIF1...\nTRIM28 KAP1 RNF96 TIF1B\n0\n\n\n665\nQ9UPN9\nTRI33_HUMAN\nE3 ubiquitin-protein ligase TRIM33 (EC 2.3.2.2...\nTRIM33 KIAA1113 RFG7 TIF1G\n0\n\n\n\n\n151 rows × 5 columns\n\n\n\nKinase keyword query contains a lot of non-serine/thronine/tyrosine kinases.",
    "crumbs": [
      "kinase_domain",
      "Get all kinase domain sequences"
    ]
  },
  {
    "objectID": "kinase_domain/kd_01_get_all_kd.html#extract-kinase-domain-info",
    "href": "kinase_domain/kd_01_get_all_kd.html#extract-kinase-domain-info",
    "title": "Get all kinase domain sequences",
    "section": "Extract kinase domain info",
    "text": "Extract kinase domain info\nGet residue start, end, and evidence info.\n\ndef extract_kinase_domains(text):\n    \"\"\"\n    Extracts domain or region annotations from text using regex.\n    Includes entries where the note contains either 'kinase' or 'PI3K/PI4K catalytic'.\n    Returns a list of [note, region, evidence] where evidence is set to 'nan' if not present.\n    \"\"\"\n    pattern = r'(?:REGION|DOMAIN) [&lt;&gt;]?(\\d+)\\.\\.[&lt;&gt;]?(\\d+); /note=\"([^\"]*?(?:kinase|PI3K/PI4K catalytic)[^\"]*?)\"(?:; /evidence=\"([^\"]*?)\")?'\n    matches = re.findall(pattern, text, flags=re.IGNORECASE)\n    \n    return [[note.strip(),int(start),int(end), evidence if evidence else 'nan']\n            for start, end, note, evidence in matches]\n\n\nRegion column\nSpecific for kd4, without domain info but with region info\n\nkd4['kd_info'] = kd4['Region'].apply(extract_kinase_domains)\n\n\nkd4['kd_info']\n\n0     [[Amino-acid kinase domain (AAK), 40, 361, ECO...\n1     [[Kinase domain, 349, 560, ECO:0000250|UniProt...\n2     [[Kinase domain, 354, 565, ECO:0000305|PubMed:...\n3      [[Amino-acid kinase domain (AAK), 19, 376, nan]]\n4     [[Amino-acid kinase domain (AAK), 19, 369, ECO...\n5        [[HWE histidine kinase domain, 160, 236, nan]]\n6        [[HWE histidine kinase domain, 285, 367, nan]]\n7        [[HWE histidine kinase domain, 260, 303, nan]]\n8        [[HWE histidine kinase domain, 259, 341, nan]]\n9        [[HWE histidine kinase domain, 259, 341, nan]]\n10       [[HWE histidine kinase domain, 286, 368, nan]]\n11       [[HWE histidine kinase domain, 285, 367, nan]]\n12       [[HWE histidine kinase domain, 285, 367, nan]]\n13       [[HWE histidine kinase domain, 285, 367, nan]]\n14       [[HWE histidine kinase domain, 254, 336, nan]]\n15       [[HWE histidine kinase domain, 259, 341, nan]]\nName: kd_info, dtype: object\n\n\n\n\nDomain\nMost kinases contain domain info for kinase domain.\n\nkd = pd.concat([kd1,kd2,kd3])\n\n\nkd = kd.drop_duplicates('Uniprot').reset_index(drop=True)\n\n\nkd['kd_info'] = kd['Domain [FT]'].apply(extract_kinase_domains)\n\n\nkd['kd_info'].str.len().value_counts() # check non-zero\n\nkd_info\n1    5015\n2     397\n3      22\nName: count, dtype: int64\n\n\nSome kinase contain 3 kinase domains\n\nkd[kd['kd_info'].str.len()==3]['Domain [FT]'].tolist()[0]\n\n'DOMAIN 49..318; /note=\"Protein kinase 1\"; /evidence=\"ECO:0000255|PROSITE-ProRule:PRU00159\"; DOMAIN 319..387; /note=\"AGC-kinase C-terminal\"; /evidence=\"ECO:0000255|PROSITE-ProRule:PRU00618\"; DOMAIN 426..687; /note=\"Protein kinase 2\"; /evidence=\"ECO:0000255|PROSITE-ProRule:PRU00159\"'\n\n\nAfter check, it seems it includes C-terminal domain. We will later remove them\n\nkd_final = pd.concat([kd,kd4])\n\n\ndf = kd_final.explode('kd_info', ignore_index=True)\n\n\ndf[['domain_note', 'domain_start','domain_end', 'domain_evidence']] = df.kd_info.apply(pd.Series)\n\n\ndf = df.drop(columns=['kd_info'])\n\nRemove non kinase domains:\n\ndf.columns\n\nIndex(['Uniprot', 'Reviewed', 'Entry Name', 'Protein names', 'Gene Names',\n       'Gene Names (primary)', 'Organism', 'Length', 'Domain [FT]',\n       'Domain [CC]', 'Motif', 'Protein families', 'Reactome', 'ComplexPortal',\n       'Subcellular location [CC]', 'Gene Ontology (biological process)',\n       'Tissue specificity', 'Interacts with', 'Subunit structure',\n       'Function [CC]', 'Activity regulation', 'Mass', 'Sequence', 'Region',\n       'domain_note', 'domain_start', 'domain_end', 'domain_evidence'],\n      dtype='object')\n\n\n\ndf = df[df.domain_note!='AGC-kinase C-terminal'].reset_index(drop=True)\n\n\ndf.domain_note.value_counts()\n\ndomain_note\nProtein kinase                    4530\nHistidine kinase                   625\nPI3K/PI4K catalytic                168\nProtein kinase 2                    73\nProtein kinase 1                    73\nAlpha-type protein kinase           22\nProtein kinase; inactive            13\nHWE histidine kinase domain         11\nGuanylate kinase-like                5\nHistidine kinase 2                   4\nHistidine kinase 1                   4\nAmino-acid kinase domain (AAK)       3\nKinase domain                        2\nProtein kinase; truncated            1\nHistidine kinase; first part         1\nHistidine kinase; second part        1\nName: count, dtype: int64",
    "crumbs": [
      "kinase_domain",
      "Get all kinase domain sequences"
    ]
  },
  {
    "objectID": "kinase_domain/kd_01_get_all_kd.html#download-uniprot-sequence",
    "href": "kinase_domain/kd_01_get_all_kd.html#download-uniprot-sequence",
    "title": "Get all kinase domain sequences",
    "section": "Download uniprot sequence",
    "text": "Download uniprot sequence\nThe big TITIN proteins (A2ASS6 for mouse, and Q8WZ42 for human) is truncated when downloaded online.\n\nfrom tqdm.contrib.concurrent import thread_map\nfrom kdock.core.protein import get_uniprot_seq\n\n\ndf = df.rename(columns={'Sequence':'full_protein_seq'})\n\n\nfull_seq = thread_map(get_uniprot_seq,df.Uniprot, max_workers=5)\n\n\ndf['full_seq']=full_seq\n\n\ndf[df['full_seq']!=df['full_protein_seq']]\n\nSeems the uniprot online download have limits length in downloading.\n\ndf['full_seq'] = df['full_protein_seq']",
    "crumbs": [
      "kinase_domain",
      "Get all kinase domain sequences"
    ]
  },
  {
    "objectID": "kinase_domain/kd_01_get_all_kd.html#get-domain-sequence",
    "href": "kinase_domain/kd_01_get_all_kd.html#get-domain-sequence",
    "title": "Get all kinase domain sequences",
    "section": "Get domain sequence",
    "text": "Get domain sequence\n\ndef get_region(seq,start,end): return seq[start-1:end]\n\n\ndf['domain_seq'] = df.apply(lambda r: get_region(r['full_seq'],r['domain_start'],r['domain_end']),axis=1)\n\n\ndf['domain_seq']\n\n0       AGFHEILGAGASGVVYKGQLEDELKTNIAVKTIHKLQPETEKEFMV...\n1       YMLGDEIGKGAYGRVYIGLDLENGDFVAIKQVSLENIVQEDLNTIM...\n2       YKVIAELGHGLWSRDVLAEHRFIKKRYILKILPSELSSSENFMRVF...\n3       TLSDCQIGHGATATVFKMDIKIKKELQNGRMGEAVGDQMKAALKRF...\n4       FDSGNVIGVGGSGATVYEGVLPSGSRVAVKRFQAIGSCTKAFDSEL...\n                              ...                        \n5531    EIAHRFKNSMAMVQSIANQTLRNTYDPEQANRLFSERLRALSQAHD...\n5532    EIAHRFKNSMAMVQSIANQTLRNTYDPEQANRLFSERLRALSQAHD...\n5533    EIAHRFKNSMAMVQSIVNQTLRNTYDPEQANRLFSERLRALSQAHD...\n5534    ALTGENPLVLGIVQDVTERKKAEANKALVSREIAHRFKNSMAMVQS...\n5535    NPLVLGIVQDVTERKKAEANKALVSREIAHRFKNSMAMVQSIANQT...\nName: domain_seq, Length: 5536, dtype: object\n\n\n\ndf['domain_seq'].isna().sum()\n\nnp.int64(0)",
    "crumbs": [
      "kinase_domain",
      "Get all kinase domain sequences"
    ]
  },
  {
    "objectID": "kinase_domain/kd_01_get_all_kd.html#arrange-columns-save",
    "href": "kinase_domain/kd_01_get_all_kd.html#arrange-columns-save",
    "title": "Get all kinase domain sequences",
    "section": "Arrange columns & save",
    "text": "Arrange columns & save\n\ndf = df.sort_values(['Uniprot','domain_start']).reset_index(drop=True)\n\n\ndf['KD_ID']=df['Uniprot']+'_'+df['Entry Name']+'_KD'+(df.Uniprot.duplicated().astype(int)+1).astype(str)\n\n\ncol = ['KD_ID','Uniprot',  'Entry Name', 'Protein names', 'Gene Names','Gene Names (primary)',\n     'Organism', 'domain_note','domain_evidence', 'domain_start', 'domain_end','domain_seq' , 'Domain [FT]',\n       'Domain [CC]', 'Region', 'Motif', 'Protein families', 'Reactome', 'ComplexPortal',\n       'Subcellular location [CC]', 'Gene Ontology (biological process)',\n       'Tissue specificity', 'Interacts with', 'Subunit structure',\n       'Function [CC]', 'Activity regulation',  'full_seq', \n       ]\n\n\ndf = df[col]\n\n\n# df[df.KD_ID.str.contains('JAK1')] # check JAK1 to see if KD1 and KD2 is assigned correctly\n\n\nnew_colname=['kd_ID','Uniprot',  'Entry Name', 'Protein names', 'Gene Names','Gene Names (primary)',\n     'Organism', 'kd_note','kd_evidence', 'kd_start', 'kd_end','kd_seq' , 'Domain [FT]',\n       'Domain [CC]', 'Region', 'Motif', 'Protein families', 'Reactome', 'ComplexPortal',\n       'Subcellular location [CC]', 'Gene Ontology (biological process)',\n       'Tissue specificity', 'Interacts with', 'Subunit structure',\n       'Function [CC]', 'Activity regulation',  'full_seq', \n       ]\n\n\ndf.columns=new_colname\n\n\n# df.to_excel('out/uniprot_kd.xlsx',index=False)\n\n\ndf.shape\n\n(5536, 27)\n\n\nIt can be acquired through Data.get_kd_uniprot()\nfrom katlas.data import *\ndf = Data.get_kd_uniprot()",
    "crumbs": [
      "kinase_domain",
      "Get all kinase domain sequences"
    ]
  },
  {
    "objectID": "kinase_domain/kd_01_get_all_kd.html#kinases-with-1-2-kinase-domains",
    "href": "kinase_domain/kd_01_get_all_kd.html#kinases-with-1-2-kinase-domains",
    "title": "Get all kinase domain sequences",
    "section": "Kinases with 1-2 kinase domains",
    "text": "Kinases with 1-2 kinase domains\n\ndf.columns\n\nIndex(['kd_ID', 'Uniprot', 'Entry Name', 'Protein names', 'Gene Names',\n       'Gene Names (primary)', 'Organism', 'kd_note', 'kd_evidence',\n       'kd_start', 'kd_end', 'kd_seq', 'Domain [FT]', 'Domain [CC]', 'Region',\n       'Motif', 'Protein families', 'Reactome', 'ComplexPortal',\n       'Subcellular location [CC]', 'Gene Ontology (biological process)',\n       'Tissue specificity', 'Interacts with', 'Subunit structure',\n       'Function [CC]', 'Activity regulation', 'full_seq'],\n      dtype='object')\n\n\n\nout = df.groupby('Uniprot').agg({'kd_note':list})\n\n\nout.kd_note.value_counts()\n\nkd_note\n[Protein kinase]                            4521\n[Histidine kinase]                           621\n[PI3K/PI4K catalytic]                        168\n[Protein kinase 1, Protein kinase 2]          73\n[Alpha-type protein kinase]                   22\n[Protein kinase; inactive]                    13\n[HWE histidine kinase domain]                 11\n[Protein kinase, Guanylate kinase-like]        5\n[Histidine kinase 1, Histidine kinase 2]       4\n[Protein kinase, Histidine kinase]             4\n[Amino-acid kinase domain (AAK)]               3\n[Kinase domain]                                2\n[Histidine kinase; first part]                 1\n[Histidine kinase; second part]                1\n[Protein kinase; truncated]                    1\nName: count, dtype: int64\n\n\nSome kinases contain two kinase domains. Some are both protein kinase domains, while some have the first to be protein kinase and the second to be histidine kinase.",
    "crumbs": [
      "kinase_domain",
      "Get all kinase domain sequences"
    ]
  },
  {
    "objectID": "kinase_domain/kd_01_get_all_kd.html#duplicates-among-kinase-domains",
    "href": "kinase_domain/kd_01_get_all_kd.html#duplicates-among-kinase-domains",
    "title": "Get all kinase domain sequences",
    "section": "Duplicates among kinase domains",
    "text": "Duplicates among kinase domains\nAcross species\n\ndef get_dup(df):\n    dup = df[df.kd_seq.duplicated(keep=False)].sort_values('kd_seq')\n    return dup.groupby('kd_seq').agg({'kd_ID':lambda x: ','.join(x)}).reset_index()\n\n\ndup_unique = get_dup(df)\n\n\ndup_unique[dup_unique.kd_ID.str.contains(\"HUMAN\")]\n\n\n\n\n\n\n\n\nkd_seq\nkd_ID\n\n\n\n\n26\nEPWQEKVRRIREGSPYGHLPNWRLLSVIVKCGDDLRQELLAFQVLK...\nB4UT09_PI4KB_OTOGA_KD1,A9X1A0_PI4KB_PAPAN_KD1,...\n\n\n30\nEYEGCKVGRGTYGHVYKARRKDGKDEKEYALKQIEGTGISMSACRE...\nQ8BWD8_CDK19_MOUSE_KD1,Q9BWU1_CDK19_HUMAN_KD1\n\n\n31\nFDFLKVIGKGSFGKVLLAKRKLDGKFYAVKVLQKKIVLNRKEQKHI...\nQ96BR1_SGK3_HUMAN_KD1,Q5R7A7_SGK3_PONAB_KD1\n\n\n33\nFDIIGIIGEGTYGQVYKARDKDTGEMVALKKVRLDNEKEGFPITAI...\nE1BB52_CDK13_BOVIN_KD1,Q14004_CDK13_HUMAN_KD1,...\n\n\n34\nFDLIRVIGRGSYAKVLLVRLKKNDQIYAMKVVKKELVHDDEDIDWV...\nP09217_KPCZ_RAT_KD1,Q05513_KPCZ_HUMAN_KD1,Q029...\n\n\n...\n...\n...\n\n\n271\nYTLKDEIGKGSYGVVKLAYNENDNTYYAMKVLSKKKLIRQAGFPRR...\nQ96RR4_KKCC2_HUMAN_KD1,O88831_KKCC2_RAT_KD1\n\n\n274\nYTNLSYIGEGAYGMVCSAYDNVNKVRVAIKKISPFEHQTYCQRTLR...\nP46196_MK01_BOVIN_KD1,P28482_MK01_HUMAN_KD1\n\n\n276\nYTRFEKIGQGASGTVYTALDIATGQEVAIKQMNLQQQPKKELIINE...\nQ7YQL4_PAK3_PANTR_KD1,Q7YQL3_PAK3_PONPY_KD1,O7...\n\n\n277\nYTRFEKIGQGASGTVYTAMDVATGQEVAIKQMNLQQQPKKELIINE...\nQ13153_PAK1_HUMAN_KD1,P35465_PAK1_RAT_KD1,Q08E...\n\n\n278\nYTRYEKIGQGASGTVFTATDVALGQEVAIKQINLQKQPKKELIINE...\nQ13177_PAK2_HUMAN_KD1,Q8CIN4_PAK2_MOUSE_KD1\n\n\n\n\n90 rows × 2 columns\n\n\n\nDuplicates within human\n\nhuman=df[df.Organism=='Homo sapiens (Human)']\n\ndup_human = get_dup(human)\n\n\ndup_human\n\n\n\n\n\n\n\n\nkd_seq\nkd_ID\n\n\n\n\n\n\n\n\n\nCheck duplicates within other species\n\nspecies = df.Organism.value_counts().head().index\n\n\nfor s in species:\n    df_species=df[df.Organism==s]\n    print(s)\n    print(get_dup(df_species))\n\nArabidopsis thaliana (Mouse-ear cress)\nEmpty DataFrame\nColumns: [kd_seq, kd_ID]\nIndex: []\nMus musculus (Mouse)\n                                              kd_seq  \\\n0  YVMLETIGHGGCATVKLAQHRLTGTHVAVKTIRKREYWCNRVISEV...   \n\n                                           kd_ID  \n0  C0HKC8_SMK3A_MOUSE_KD1,C0HKC9_SMK3B_MOUSE_KD1  \nHomo sapiens (Human)\nEmpty DataFrame\nColumns: [kd_seq, kd_ID]\nIndex: []\nDictyostelium discoideum (Social amoeba)\nEmpty DataFrame\nColumns: [kd_seq, kd_ID]\nIndex: []\nRattus norvegicus (Rat)\nEmpty DataFrame\nColumns: [kd_seq, kd_ID]\nIndex: []\n\n\nonly mouse SMK3A/3B duplicates in the top 5 species",
    "crumbs": [
      "kinase_domain",
      "Get all kinase domain sequences"
    ]
  },
  {
    "objectID": "pspa_cddm_heatmap_compare.html",
    "href": "pspa_cddm_heatmap_compare.html",
    "title": "Heatmap/ST/JSD/cosine comparison",
    "section": "",
    "text": "import pandas as pd\nfrom katlas.data import *\nfrom katlas.plot import *\nfrom katlas.pssm import *\n\n\ncddm = pd.read_parquet('out/CDDM_pssms.parquet')\n\n\ncddm.index = cddm.index.str.split('_').str[1]\n\n\npspa = Data.get_pspa_all_scale()\n\n\ncddm = cddm[pspa.columns].copy()\n\n\npssm_df = recover_pssm(pspa.loc['PKACA'])\n\n\ndef plot_heatmap_simple(matrix, # a matrix of values\n                 title: str='heatmap', # title of the heatmap\n                 figsize: tuple=(6,7), # (width, height)\n                 cmap: str='binary', # color map, default is dark&white\n                 **kwargs, # arguments for sns.heatmap()\n                 ):\n    \n    \"Plot heatmap based on a matrix of values\"\n    \n    plt.figure(figsize=figsize)\n    sns.heatmap(matrix, square=True,cmap=cmap, annot=False,**kwargs)\n    plt.title(title)\n    plt.ylabel('')\n    plt.xlabel('')\n    plt.yticks(rotation=0)\n\n\nplot_heatmap_simple(pssm_df)\n\n\n\n\n\n\n\n\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom matplotlib.patches import Rectangle\n\ndef plot_two_heatmaps(matrix1, matrix2, \n                      kinase_name=\"Kinase\", \n                      figsize=(4,4.5), \n                      **kwargs):\n    \"\"\"\n    Plot two side-by-side heatmaps with black rectangle borders,\n    titles on top, shared kinase label below, and only left plot showing y-axis labels.\n    \"\"\"\n    fig, axes = plt.subplots(1, 2, figsize=figsize, gridspec_kw={'wspace': 0.05})\n    matrix1 = matrix1.drop(columns=0)\n    matrix2 = matrix2.drop(columns=0)\n    \n    title1=\"CDDM\"\n    title2=\"PSPA\"\n    # Left heatmap (with y labels)\n    sns.heatmap(matrix1, square=False, cmap=\"Reds\", \n                # vmin=0, vmax=1,\n                annot=False, cbar=False, ax=axes[0], **kwargs)\n    axes[0].set_title(title1, fontsize=12, pad=10)\n    axes[0].set_xlabel(\"\")\n    axes[0].set_ylabel(\"\")\n    axes[0].tick_params(left=True, bottom=True)\n    axes[0].tick_params(axis=\"y\", rotation=0) \n\n    # Add rectangle border to left heatmap\n    axes[0].add_patch(Rectangle((0,0), matrix1.shape[1], matrix1.shape[0], \n                                fill=False, edgecolor='black', lw=1.5))\n\n    # Right heatmap (no y labels)\n    sns.heatmap(matrix2, square=False, cmap=\"Blues\", \n                # vmin=0, vmax=1,\n                annot=False, cbar=False, ax=axes[1], **kwargs)\n    axes[1].set_title(title2, fontsize=12, pad=10)\n    axes[1].set_xlabel(\"\")\n    axes[1].set_ylabel(\"\")\n    axes[1].tick_params(left=False, labelleft=False, bottom=True)\n    axes[1].tick_params(axis=\"y\", rotation=0) \n\n    # Add rectangle border to right heatmap\n    axes[1].add_patch(Rectangle((0,0), matrix2.shape[1], matrix2.shape[0], \n                                fill=False, edgecolor='black', lw=1.5))\n\n    # Make y tick horizontal\n    axes[0].set_title(title1, fontsize=12, pad=0)\n    axes[1].set_title(title2, fontsize=12, pad=0)\n\n    # force display every position\n    # n_positions = matrix1.shape[1]\n    # axes[0].set_xticks(np.arange(n_positions) + 0.5)   # center of each cell\n    # axes[0].set_xticklabels(range(-5, 5), rotation=0)  # or your custom labels\n    \n    # axes[1].set_xticks(np.arange(n_positions) + 0.5)\n    # axes[1].set_xticklabels(range(-5, 5), rotation=0)\n\n    xpos = (list(matrix1.columns).index(-1) + list(matrix1.columns).index(1)) / 2 + 0.5\n    axes[0].axvline(xpos, color='black', lw=0.75)\n    axes[1].axvline(xpos, color='black', lw=0.75)\n\n    # set empty xticks\n    axes[0].set_xticks([])\n    axes[1].set_xticks([])\n\n    # Shared kinase label below\n    fig.suptitle(kinase_name, fontsize=14, x=0.52,y=0.95)\n\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport numpy as np\n\n\nplot_two_heatmaps(pssm_df,pssm_df,figsize=(4,4))\n\n\n\n\n\n\n\n\n\ndef plot_compare(cddm_df,pspa_df,kinase,**kwargs):\n    cddm_pssm = recover_pssm(cddm_df.loc[kinase])\n    pspa_pssm = recover_pssm(pspa_df.loc[kinase])\n    plot_two_heatmaps(cddm_pssm,pspa_pssm,kinase_name=kinase,**kwargs)\n\n\nk_list = ['PKACA','AMPKA1','DYRK2','ATR','CK1A','EGFR']\n\n\nfor k in k_list:\n    plot_compare(cddm,pspa,k,figsize=(4,4))\n    # plt.show()\n    save_svg(f'fig/compare_{k}.svg')\n    # plt.close()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nplot_compare(cddm,pspa,'EGFR')",
    "crumbs": [
      "Heatmap/ST/JSD/cosine comparison"
    ]
  },
  {
    "objectID": "pspa_cddm_heatmap_compare.html#compare-two-heatmaps",
    "href": "pspa_cddm_heatmap_compare.html#compare-two-heatmaps",
    "title": "Heatmap/ST/JSD/cosine comparison",
    "section": "",
    "text": "import pandas as pd\nfrom katlas.data import *\nfrom katlas.plot import *\nfrom katlas.pssm import *\n\n\ncddm = pd.read_parquet('out/CDDM_pssms.parquet')\n\n\ncddm.index = cddm.index.str.split('_').str[1]\n\n\npspa = Data.get_pspa_all_scale()\n\n\ncddm = cddm[pspa.columns].copy()\n\n\npssm_df = recover_pssm(pspa.loc['PKACA'])\n\n\ndef plot_heatmap_simple(matrix, # a matrix of values\n                 title: str='heatmap', # title of the heatmap\n                 figsize: tuple=(6,7), # (width, height)\n                 cmap: str='binary', # color map, default is dark&white\n                 **kwargs, # arguments for sns.heatmap()\n                 ):\n    \n    \"Plot heatmap based on a matrix of values\"\n    \n    plt.figure(figsize=figsize)\n    sns.heatmap(matrix, square=True,cmap=cmap, annot=False,**kwargs)\n    plt.title(title)\n    plt.ylabel('')\n    plt.xlabel('')\n    plt.yticks(rotation=0)\n\n\nplot_heatmap_simple(pssm_df)\n\n\n\n\n\n\n\n\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom matplotlib.patches import Rectangle\n\ndef plot_two_heatmaps(matrix1, matrix2, \n                      kinase_name=\"Kinase\", \n                      figsize=(4,4.5), \n                      **kwargs):\n    \"\"\"\n    Plot two side-by-side heatmaps with black rectangle borders,\n    titles on top, shared kinase label below, and only left plot showing y-axis labels.\n    \"\"\"\n    fig, axes = plt.subplots(1, 2, figsize=figsize, gridspec_kw={'wspace': 0.05})\n    matrix1 = matrix1.drop(columns=0)\n    matrix2 = matrix2.drop(columns=0)\n    \n    title1=\"CDDM\"\n    title2=\"PSPA\"\n    # Left heatmap (with y labels)\n    sns.heatmap(matrix1, square=False, cmap=\"Reds\", \n                # vmin=0, vmax=1,\n                annot=False, cbar=False, ax=axes[0], **kwargs)\n    axes[0].set_title(title1, fontsize=12, pad=10)\n    axes[0].set_xlabel(\"\")\n    axes[0].set_ylabel(\"\")\n    axes[0].tick_params(left=True, bottom=True)\n    axes[0].tick_params(axis=\"y\", rotation=0) \n\n    # Add rectangle border to left heatmap\n    axes[0].add_patch(Rectangle((0,0), matrix1.shape[1], matrix1.shape[0], \n                                fill=False, edgecolor='black', lw=1.5))\n\n    # Right heatmap (no y labels)\n    sns.heatmap(matrix2, square=False, cmap=\"Blues\", \n                # vmin=0, vmax=1,\n                annot=False, cbar=False, ax=axes[1], **kwargs)\n    axes[1].set_title(title2, fontsize=12, pad=10)\n    axes[1].set_xlabel(\"\")\n    axes[1].set_ylabel(\"\")\n    axes[1].tick_params(left=False, labelleft=False, bottom=True)\n    axes[1].tick_params(axis=\"y\", rotation=0) \n\n    # Add rectangle border to right heatmap\n    axes[1].add_patch(Rectangle((0,0), matrix2.shape[1], matrix2.shape[0], \n                                fill=False, edgecolor='black', lw=1.5))\n\n    # Make y tick horizontal\n    axes[0].set_title(title1, fontsize=12, pad=0)\n    axes[1].set_title(title2, fontsize=12, pad=0)\n\n    # force display every position\n    # n_positions = matrix1.shape[1]\n    # axes[0].set_xticks(np.arange(n_positions) + 0.5)   # center of each cell\n    # axes[0].set_xticklabels(range(-5, 5), rotation=0)  # or your custom labels\n    \n    # axes[1].set_xticks(np.arange(n_positions) + 0.5)\n    # axes[1].set_xticklabels(range(-5, 5), rotation=0)\n\n    xpos = (list(matrix1.columns).index(-1) + list(matrix1.columns).index(1)) / 2 + 0.5\n    axes[0].axvline(xpos, color='black', lw=0.75)\n    axes[1].axvline(xpos, color='black', lw=0.75)\n\n    # set empty xticks\n    axes[0].set_xticks([])\n    axes[1].set_xticks([])\n\n    # Shared kinase label below\n    fig.suptitle(kinase_name, fontsize=14, x=0.52,y=0.95)\n\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport numpy as np\n\n\nplot_two_heatmaps(pssm_df,pssm_df,figsize=(4,4))\n\n\n\n\n\n\n\n\n\ndef plot_compare(cddm_df,pspa_df,kinase,**kwargs):\n    cddm_pssm = recover_pssm(cddm_df.loc[kinase])\n    pspa_pssm = recover_pssm(pspa_df.loc[kinase])\n    plot_two_heatmaps(cddm_pssm,pspa_pssm,kinase_name=kinase,**kwargs)\n\n\nk_list = ['PKACA','AMPKA1','DYRK2','ATR','CK1A','EGFR']\n\n\nfor k in k_list:\n    plot_compare(cddm,pspa,k,figsize=(4,4))\n    # plt.show()\n    save_svg(f'fig/compare_{k}.svg')\n    # plt.close()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nplot_compare(cddm,pspa,'EGFR')",
    "crumbs": [
      "Heatmap/ST/JSD/cosine comparison"
    ]
  },
  {
    "objectID": "pspa_cddm_heatmap_compare.html#cbar",
    "href": "pspa_cddm_heatmap_compare.html#cbar",
    "title": "Heatmap/ST/JSD/cosine comparison",
    "section": "Cbar",
    "text": "Cbar\n\nimport matplotlib as mpl\n\n\ndef plot_cbar(figsize=(5,0.3)):\n    fig, axes = plt.subplots(1, 2, figsize=figsize)\n\n    # Shared normalization [0,1]\n    norm = mpl.colors.Normalize(vmin=0, vmax=1)\n\n    # Red probability bar\n    cmap_red = plt.cm.Reds\n    cb1 = mpl.colorbar.ColorbarBase(\n        axes[0], cmap=cmap_red, norm=norm,\n        orientation='horizontal'\n    )\n    # cb1.set_label(\"Probability\")\n    cb1.set_ticks([0, 0.5, 1])\n\n    # Blue probability bar\n    cmap_blue = plt.cm.Blues\n    cb2 = mpl.colorbar.ColorbarBase(\n        axes[1], cmap=cmap_blue, norm=norm,\n        orientation='horizontal'\n    )\n    # cb2.set_label(\"Probability\")\n    cb2.set_ticks([0, 0.5, 1])\n\n\nplot_cbar()\nsave_svg('fig/cbar.svg')",
    "crumbs": [
      "Heatmap/ST/JSD/cosine comparison"
    ]
  },
  {
    "objectID": "pspa_cddm_heatmap_compare.html#st-ratio-comparison",
    "href": "pspa_cddm_heatmap_compare.html#st-ratio-comparison",
    "title": "Heatmap/ST/JSD/cosine comparison",
    "section": "ST ratio comparison",
    "text": "ST ratio comparison\n\npspa_st = pspa[pspa['0pY']==0]\n\n\npspa_st_ratio = np.log2(pspa_st['0pS']/pspa_st['0pT'])\n\n\ncddm_st_ratio = np.log2(cddm['0pS']/cddm['0pT'])\n\n\nst_ratio = pd.concat([pspa_st_ratio,cddm_st_ratio],axis=1)\n\n\nst_ratio.columns=['pspa','cddm']\n\n\ninfo = Data.get_kinase_info()\n\ninfo = info[info.pseudo=='0'].copy()\n\nhue_group = info.set_index('kinase')['modi_group']\n\n\nst_ratio['group'] = st_ratio.index.map(hue_group)\n\n\nst_ratio = st_ratio.dropna()\n\n\nfrom katlas.plot import *\n\n\nplt.figure(figsize=(2.5,3))\nplot_corr(st_ratio,y='cddm',x='pspa',hue='group',s=12,\n          text_location=(0.4,0.85),\n          palette=group_color,legend=False)\nplt.ylabel('Log2(S/T) ratio from CDDM')\nplt.xlabel('Log2(S/T) ratio from PSPA')\nplt.tight_layout()\nsave_svg('fig/ST_ratio.svg')\n\n/Users/icai/git/katlas/katlas/plot.py:653: UserWarning: No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.\n  if hue is not None:",
    "crumbs": [
      "Heatmap/ST/JSD/cosine comparison"
    ]
  },
  {
    "objectID": "pspa_cddm_heatmap_compare.html#js-divergence",
    "href": "pspa_cddm_heatmap_compare.html#js-divergence",
    "title": "Heatmap/ST/JSD/cosine comparison",
    "section": "JS divergence",
    "text": "JS divergence\n\nfrom katlas.clustering import *\n\nfrom functools import partial\n\n\n((cddm_overlap==0).sum(1)/cddm_overlap.shape[1]).sort_values()\n\nindex\nYES1        0.086957\nGSK3B       0.086957\nEPHB3       0.086957\nBMX         0.086957\nMAPKAPK3    0.086957\n              ...   \nCAMK1B      0.360870\nSMMLCK      0.360870\nBRAF        0.360870\nVRK1        0.365217\nGAK         0.365217\nLength: 311, dtype: float64\n\n\n\nimport numpy as np\ndef js_divergence(p1, # pssm \n                  p2, # pssm\n                 ):\n    \"p1 and p2 are two arrays (df or np) with index as aa and column as position\"\n    assert p1.shape==p2.shape\n    valid = (p1 + p2) &gt; 0\n    p1 = np.where(valid, p1, 0.0)\n    p2 = np.where(valid, p2, 0.0)\n    \n    m = 0.5 * (p1 + p2)\n    \n    js = 0.5 * np.sum(p1 * np.log((p1+ EPSILON) / (m + EPSILON)), axis=0) + \\\n         0.5 * np.sum(p2 * np.log((p2+ EPSILON) / (m + EPSILON)), axis=0)\n    return js\n\n\ncommon_k = list(set(pspa.index)&set(cddm.index))\n\n\nscore = pd.DataFrame(index=common_k)\n\n\nscore['pspa_speci'] = pspa_overlap.apply(get_specificity_flat,axis=1)\n\nscore['group'] = score.index.map(hue_group)\n\n\npspa_overlap = pspa.loc[common_k].copy()\ncddm_overlap = cddm.loc[common_k].copy()\n\n\ndef cosine_similarity_position(pssm1: pd.DataFrame, pssm2: pd.DataFrame):\n    \"\"\"Compute cosine similarity per position between two PSSMs, no sklearn.\"\"\"\n    assert pssm1.shape == pssm2.shape, \"PSSMs must have same shape\"\n    sims = {}\n    for pos in pssm1.columns:\n        v1 = pssm1[pos].values\n        v2 = pssm2[pos].values\n        dot = np.dot(v1, v2)\n        norm1 = np.linalg.norm(v1)\n        norm2 = np.linalg.norm(v2)\n        sims[pos] = dot / (norm1 * norm2) if norm1 &gt; 0 and norm2 &gt; 0 else 0.0\n    return pd.Series(sims)\n\n\n# def euclidean_distance_position(pssm1: pd.DataFrame, pssm2: pd.DataFrame):\n#     \"\"\"Compute Euclidean distance per position between two PSSMs, no sklearn.\"\"\"\n#     assert pssm1.shape == pssm2.shape, \"PSSMs must have same shape\"\n#     dists = {}\n#     for pos in pssm1.columns:\n#         v1 = pssm1[pos].values\n#         v2 = pssm2[pos].values\n#         diff = v1 - v2\n#         dists[pos] = np.linalg.norm(diff)  # sqrt(sum((v1 - v2)^2))\n#     return pd.Series(dists)\n\n\ndef cosine_mean(cddm_pssm,pspa_pssm): return cosine_similarity_position(cddm_pssm,pspa_pssm).mean()\n# def cosine_min(cddm_pssm,pspa_pssm): return cosine_similarity_position(cddm_pssm,pspa_pssm).min()\n# def euclidean_mean(cddm_pssm,pspa_pssm): return euclidean_distance_position(cddm_pssm,pspa_pssm).mean()\n\n\n# score_list = []\n# for k in common_k:\n#     pspa_pssm = recover_pssm(pspa.loc[k])\n#     cddm_pssm = recover_pssm(cddm.loc[k])\n#     score_list.append(euclidean_mean(pspa_pssm,cddm_pssm))\n# score['euclidean_mean'] = score_list\n\n\nscore_list = []\nfor k in common_k:\n    pspa_pssm = recover_pssm(pspa.loc[k])\n    cddm_pssm = recover_pssm(cddm.loc[k])\n    score_list.append(cosine_mean(pspa_pssm,cddm_pssm))\nscore['cosine_mean'] = score_list\n\n\nscore_list = []\nfor k in common_k:\n    pspa_pssm = recover_pssm(pspa.loc[k])\n    cddm_pssm = recover_pssm(cddm.loc[k])\n    score_list.append(js_divergence(pspa_pssm,cddm_pssm).mean())\nscore['JSD_mean'] = score_list\n\n\n# score_list = []\n# for k in common_k:\n#     pspa_pssm = recover_pssm(pspa.loc[k])\n#     cddm_pssm = recover_pssm(cddm.loc[k])\n#     score_list.append(cosine_min(pspa_pssm,cddm_pssm))\n# score['cosine_min'] = score_list\n\n\nfrom adjustText import adjust_text\nfrom matplotlib import pyplot as plt\nimport seaborn as sns\nfrom scipy.stats import spearmanr, pearsonr\n\n\ndef plot_corr(\n    df,  # dataframe that contains data\n    x,  # x axis values, or colname of x axis\n    y,  # y axis values, or colname of y axis\n    text_location=(0.8, 0.1),  # relative coords in Axes (0–1)\n    method=\"spearman\",  # correlation method: 'pearson' or 'spearman'\n    index_list=None,  # list of indices to annotate\n    hue=None,\n    reg_line=True,\n    **kwargs\n):\n    \"\"\"\n    Given a dataframe and the name of two columns, \n    plot the two columns' correlation with either Pearson or Spearman.\n    Annotate points if their index is in index_list.\n    \"\"\"\n    x_vals = df[x]\n    y_vals = df[y]\n\n    # Compute correlation\n    if method.lower() == \"spearman\":\n        corr_val, pvalue = spearmanr(x_vals, y_vals)\n        corr_label = f\"Spearman ρ = {corr_val:.2f}\\n p = {pvalue:.2e}\"\n    else:\n        corr_val, pvalue = pearsonr(x_vals, y_vals)\n        corr_label = f\"Pearson r = {corr_val:.2f}\\n p = {pvalue:.2e}\"\n\n    # Plot regression line + scatter\n    if hue is not None:\n        sns.scatterplot(data=df, x=x, y=y, hue=hue, **kwargs)\n        if reg_line: sns.regplot(x=x_vals, y=y_vals, scatter=False, line_kws={'color': 'gray','alpha': 0.5})\n        plt.legend(\n            bbox_to_anchor=(1.05, 1),   # (x, y) anchor relative to axes\n            loc=\"upper left\",           # where to attach the legend box\n            borderaxespad=0.\n        )\n    else:\n        sns.regplot(x=x_vals, y=y_vals, line_kws={'color': 'gray'}, **kwargs)\n\n\n    # # Add correlation text\n    # plt.text(\n    #     x=text_location[0],\n    #     y=text_location[1],\n    #     s=corr_label,\n    #     transform=plt.gca().transAxes,\n    #     ha=\"center\",\n    #     va=\"center\"\n    # )\n\n    # Annotate selected points if index_list is given\n    texts = []\n    if index_list is not None:\n        for idx in index_list:\n            if idx in df.index:  # make sure index exists\n                texts.append(\n                    plt.text(\n                        x_vals.loc[idx], \n                        y_vals.loc[idx], \n                        str(idx),\n                        fontsize=9,\n                        ha=\"center\",\n                        va=\"center\"\n                    )\n                )\n        if texts:\n            adjust_text(texts, arrowprops=dict(arrowstyle=\"-&gt;\", color=\"black\", lw=0.5))\n\n\ndef plot_bar(df, \n             value, # colname of value\n             group, # colname of group\n             title = None,\n             figsize = (12,5),\n             fontsize=14,\n             dots = True, # whether or not add dots in the graph\n             rotation=90,\n             ascending=False,\n             ymin=None,\n             **kwargs\n              ):\n    \n    \"Plot bar graph from unstacked dataframe; need to indicate columns of values and categories\"\n    \n    plt.figure(figsize=figsize)\n    \n    idx = df.groupby(group)[value].mean().sort_values(ascending=ascending).index\n    \n    sns.barplot(data=df, x=group, y=value, order=idx,hue=group, legend=False, **kwargs)\n    \n    if dots:\n        marker = {'marker': 'o', \n                  'color': 'white', \n                  'edgecolor': 'black', \n                  'linewidth': 1.5, \n                  'jitter':True,\n                  's': 5}\n\n        sns.stripplot(data=df, \n                      x=group, \n                      y=value,\n                      order=idx,\n                      alpha=0.8,\n                      # ax=g.ax,\n                      **marker)\n        \n    # Increase font size for the x-axis and y-axis tick labels\n    plt.tick_params(axis='x', labelsize=fontsize)  # Increase x-axis label size\n    plt.tick_params(axis='y', labelsize=fontsize)  # Increase y-axis label size\n    \n    # Modify x and y label and increase font size\n    plt.xlabel('', fontsize=fontsize)\n    plt.ylabel(value, fontsize=fontsize)\n    \n    # Rotate X labels\n    plt.xticks(rotation=rotation)\n    \n    # Plot titles\n    if title is not None:\n        plt.title(title,fontsize=fontsize)\n\n    if ymin is not None: plt.ylim(bottom=ymin)\n    plt.gca().spines[['right', 'top']].set_visible(False)\n\n\nhue_subfamily=info.set_index('kinase')['subfamily']\n\n\ngroup_color2 = pd.DataFrame(group_color).T\n\n\ngroup_color2 = group_color2.reset_index(names='modi_group')\n\n\nsubfamily_color = info[['modi_group','subfamily']].merge(group_color2).drop(columns=['modi_group']).set_index('subfamily')\n\n\nsubfamily_color = subfamily_color.apply(tuple, axis=1).to_dict()\n\n\nscore['subfamily'] = score.index.map(hue_subfamily)\n\n\nplot_bar(score,'cosine_mean','subfamily',\n         palette=subfamily_color,\n         ymin=0.5,figsize=(25,5)\n        )\nplt.ylabel('Mean cosine similarity (↑)')\n\nText(0, 0.5, 'Mean cosine similarity (↑)')\n\n\n\n\n\n\n\n\n\n\nplot_bar(score,'cosine_mean','group',palette=group_color,ymin=0.5,figsize=(7,3))\nplt.ylabel('Mean cosine similarity (↑)')\nsave_svg('fig/cosine.svg')\n\n\n\n\n\n\n\n\n\nplot_bar(score,'JSD_mean','group',palette=group_color,figsize=(7,3),ascending=True)\nplt.ylabel('Mean JSD distance (↓)')\nsave_svg('fig/JSD.svg')\n\n\n\n\n\n\n\n\n\nplot_bar\n\n&lt;function katlas.plot.plot_bar(df, value, group, title=None, figsize=(12, 5), fontsize=14, dots=True, rotation=90, ascending=False, *, data=None, x=None, y=None, hue=None, order=None, hue_order=None, estimator='mean', errorbar=('ci', 95), n_boot=1000, seed=None, units=None, weights=None, orient=None, color=None, palette=None, saturation=0.75, fill=True, hue_norm=None, width=0.8, dodge='auto', gap=0, log_scale=None, native_scale=False, formatter=None, legend='auto', capsize=0, err_kws=None, ci=&lt;deprecated&gt;, errcolor=&lt;deprecated&gt;, errwidth=&lt;deprecated&gt;, ax=None)&gt;\n\n\n\nplot_bar(score,'JSD_mean','group',ascending=True,palette=group_color,)\n\n\n\n\n\n\n\n\n\nplot_bar(score,'JSD_mean','group',palette=group_color)\n\n\n\n\n\n\n\n\n\nk_list = score['cosine_mean'].sort_values().head(40).index\n# k_list = score[score['cosine_mean']&lt;0.75].index\nplot_corr(score,'pspa_speci','cosine_mean',\n          text_location=(0.8,0.9),\n          index_list=k_list,\n          reg_line=False,\n          hue='group',palette=group_color)\nplt.ylabel('Mean cosine similarity')\nplt.xlabel('PSPA specificity score')\nsave_svg('fig/cosine_similarity_specificity.svg')\n# plt.axhline(y=0.75,color='r', linestyle='--', linewidth=2,alpha=0.2)",
    "crumbs": [
      "Heatmap/ST/JSD/cosine comparison"
    ]
  },
  {
    "objectID": "pspa_cddm_heatmap_compare.html#experiment",
    "href": "pspa_cddm_heatmap_compare.html#experiment",
    "title": "Heatmap/ST/JSD/cosine comparison",
    "section": "Experiment",
    "text": "Experiment\n\nk='ATR'\npspa_pssm = recover_pssm(pspa.loc[k])\ncddm_pssm = recover_pssm(cddm.loc[k])\njs_divergence(pspa_pssm,cddm_pssm)\n\narray([0.14273914, 0.12959633, 0.08697435, 0.05695579, 0.05958804,\n       0.02867595, 0.2633553 , 0.10621596, 0.0445805 , 0.08671556])\n\n\n\ncddm_pssm = recover_pssm(cddm.loc['GSK3B'])\npspa_pssm = recover_pssm(pspa.loc['GSK3B'])\n\n\ncddm_pssm[1]\n\naa\nP     0.420290\nG     0.075362\nA     0.039130\nC     0.007246\nS     0.015942\nT     0.018841\nV     0.063768\nI     0.031884\nL     0.046377\nM     0.007246\nF     0.013043\nY     0.007246\nW     0.002899\nH     0.008696\nK     0.014493\nR     0.057971\nQ     0.024638\nN     0.007246\nD     0.034783\nE     0.023188\npS    0.037681\npT    0.021739\npY    0.020290\nName: 1, dtype: float64\n\n\n\npspa_pssm[1]\n\naa\nP     0.03262\nG     0.03084\nA     0.03382\nC     0.03616\nS     0.03246\nT     0.03246\nV     0.03149\nI     0.03544\nL     0.03455\nM     0.03246\nF     0.03358\nY     0.03173\nW     0.02931\nH     0.02956\nK     0.03076\nR     0.03930\nQ     0.28018\nN     0.04421\nD     0.02762\nE     0.02778\npS    0.03213\npT    0.03213\npY    0.02940\nName: 1, dtype: float64\n\n\nBoth PSPA and CDDM have Q as max in position 1.\nLet’s test which distance/similarity metric makes sense most\n\neuclidean_distance_position(cddm_pssm,pspa_pssm)\n\n-5    0.117948\n-4    0.209271\n-3    0.141432\n-2    0.155427\n-1    0.159968\n 0    0.229537\n 1    0.363615\n 2    0.165754\n 3    0.155656\n 4    0.397584\ndtype: float64\n\n\n\npd.Series(js_divergence(cddm_pssm,pspa_pssm),index=list(range(-5,5)))\n\n-5    0.046637\n-4    0.086952\n-3    0.063191\n-2    0.062703\n-1    0.072525\n 0    0.027765\n 1    0.132643\n 2    0.075066\n 3    0.062533\n 4    0.172927\ndtype: float64\n\n\n\ncosine_similarity_position(cddm_pssm,pspa_pssm)\n\n-5    0.868829\n-4    0.713273\n-3    0.843677\n-2    0.808220\n-1    0.790774\n 0    0.950192\n 1    0.596159\n 2    0.774477\n 3    0.795978\n 4    0.793016\ndtype: float64\n\n\n\ncosine_similarity_position(cddm_pssm,pspa_pssm).mean()\n\nnp.float64(0.7934594439218537)\n\n\nOnly cosine shows position 1 similar, while JS divergence and euclidean distance emphasize the difference in position 1.",
    "crumbs": [
      "Heatmap/ST/JSD/cosine comparison"
    ]
  },
  {
    "objectID": "specificity.html",
    "href": "specificity.html",
    "title": "Specificity comparison",
    "section": "",
    "text": "import pandas as pd\nfrom katlas.data import *\nfrom katlas.plot import *\npssms= pd.read_parquet('out/CDDM_pssms.parquet')\npssms.index = pssms.index.str.split('_').str[1]\nspec = pssms.apply(get_specificity_flat , axis=1)\nspec\n\nindex\nSRC       0.663547\nEPHA3     0.911340\nFES       0.766754\nNTRK3     0.720888\nALK       0.795550\n            ...   \nSMMLCK    2.784532\nROR1      2.815438\nBRAF      2.292233\nGAK       4.387741\nMAST2     2.504381\nLength: 329, dtype: float64\ninfo = Data.get_kinase_info()\n\ninfo = info[info.pseudo=='0'].copy()\n\nhue_group = info.set_index('kinase')['modi_group']\ndf = pd.DataFrame(spec,columns=['specificity_cddm'])\ndf['group'] = df.index.map(hue_group)\ndf=df.reset_index(names='kinase_id')\ndf\n\n\n\n\n\n\n\n\nkinase_id\nspecificity_cddm\ngroup\n\n\n\n\n0\nSRC\n0.663547\nTK\n\n\n1\nEPHA3\n0.911340\nTK\n\n\n2\nFES\n0.766754\nTK\n\n\n3\nNTRK3\n0.720888\nTK\n\n\n4\nALK\n0.795550\nTK\n\n\n...\n...\n...\n...\n\n\n324\nSMMLCK\n2.784532\nCAMK\n\n\n325\nROR1\n2.815438\nTK\n\n\n326\nBRAF\n2.292233\nTKL\n\n\n327\nGAK\n4.387741\nOther\n\n\n328\nMAST2\n2.504381\nAGC\n\n\n\n\n329 rows × 3 columns\nplot_bar(df,value='specificity_cddm',group='group',palette=group_color,figsize=(10,5))\nsave_svg('fig/cddm_specificity.svg')\n# plot_rank(df.sort_values('specificity_cddm'),x='kinase_id',y='specificity_cddm',hue='group',palette=group_color)",
    "crumbs": [
      "Specificity comparison"
    ]
  },
  {
    "objectID": "specificity.html#pspa",
    "href": "specificity.html#pspa",
    "title": "Specificity comparison",
    "section": "PSPA",
    "text": "PSPA\n\npspa = Data.get_pspa_all_scale()\n\n\nspec = pspa.apply(get_specificity_flat , axis=1)\n\n\ndf2 = pd.DataFrame(spec,columns=['specificity_pspa'])\n\n\ndf2['group'] = df2.index.map(hue_group)\n\n\ndf2 = df2.reset_index(names=['kinase_id'])\n\n\ndf2\n\n\n\n\n\n\n\n\nkinase_id\nspecificity_pspa\ngroup\n\n\n\n\n0\nAAK1\n4.776913\nOther\n\n\n1\nACVR2A\n1.398751\nTKL\n\n\n2\nACVR2B\n1.213098\nTKL\n\n\n3\nAKT1\n2.981665\nAGC\n\n\n4\nAKT2\n3.363335\nAGC\n\n\n...\n...\n...\n...\n\n\n391\nKDR\n0.752196\nTK\n\n\n392\nFLT4\n0.755710\nTK\n\n\n393\nWEE1_TYR\n0.887054\nNaN\n\n\n394\nYES1\n0.507455\nTK\n\n\n395\nZAP70\n2.218516\nTK\n\n\n\n\n396 rows × 3 columns\n\n\n\n\nplot_bar(df2,value='specificity_pspa',group='group',palette=group_color,figsize=(10,5))\nsave_svg('fig/pspa_specificity.svg')",
    "crumbs": [
      "Specificity comparison"
    ]
  },
  {
    "objectID": "specificity.html#combine",
    "href": "specificity.html#combine",
    "title": "Specificity comparison",
    "section": "Combine",
    "text": "Combine\n\ndf_comb = df.merge(df2,on='kinase_id')\n\n\ndf_comb['group'] = df_comb.kinase_id.map(hue_group)\n\n\ndf_comb\n\n\n\n\n\n\n\n\nkinase_id\nspecificity_cddm\ngroup_x\nspecificity_pspa\ngroup_y\ngroup\n\n\n\n\n0\nSRC\n0.663547\nTK\n0.942494\nTK\nTK\n\n\n1\nEPHA3\n0.911340\nTK\n0.952877\nTK\nTK\n\n\n2\nFES\n0.766754\nTK\n1.569350\nTK\nTK\n\n\n3\nNTRK3\n0.720888\nTK\n1.074483\nTK\nTK\n\n\n4\nALK\n0.795550\nTK\n0.875102\nTK\nTK\n\n\n...\n...\n...\n...\n...\n...\n...\n\n\n307\nCDC7\n2.791146\nOther\n0.978796\nOther\nOther\n\n\n308\nCDK12\n5.479276\nCMGC\n4.386190\nCMGC\nCMGC\n\n\n309\nSMMLCK\n2.784532\nCAMK\n1.057586\nCAMK\nCAMK\n\n\n310\nBRAF\n2.292233\nTKL\n0.467151\nTKL\nTKL\n\n\n311\nGAK\n4.387741\nOther\n0.835448\nOther\nOther\n\n\n\n\n312 rows × 6 columns\n\n\n\n\ndf_comb=df_comb.set_index('kinase_id')\n\n\nidx1 = df_comb.specificity_cddm.sort_values(ascending=False).head(20).index\n\n\nidx2 = df_comb.specificity_pspa.sort_values(ascending=False).head(20).index\n\n\nidxs = set(idx1)|set(idx2)\n\n\nplot_corr(df_comb, \n          y='specificity_cddm', \n          x='specificity_pspa',\n         index_list = idxs,\n          text_location=(0.8,0.9),\n          hue='group',\n          palette=group_color,\n         )\nplt.xlabel('PSPA specificity score')\nplt.ylabel('CDDM specificity score')\nsave_svg('fig/specificity.svg')",
    "crumbs": [
      "Specificity comparison"
    ]
  },
  {
    "objectID": "eda_fig1.html",
    "href": "eda_fig1.html",
    "title": "Exploratory data analysis",
    "section": "",
    "text": "import pandas as pd\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport seaborn as sns\nfrom matplotlib.colors import LogNorm\nfrom katlas.core import *",
    "crumbs": [
      "Exploratory data analysis"
    ]
  },
  {
    "objectID": "eda_fig1.html#setup",
    "href": "eda_fig1.html#setup",
    "title": "Exploratory data analysis",
    "section": "",
    "text": "import pandas as pd\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport seaborn as sns\nfrom matplotlib.colors import LogNorm\nfrom katlas.core import *",
    "crumbs": [
      "Exploratory data analysis"
    ]
  },
  {
    "objectID": "eda_fig1.html#overlap-between-sources",
    "href": "eda_fig1.html#overlap-between-sources",
    "title": "Exploratory data analysis",
    "section": "Overlap between sources",
    "text": "Overlap between sources\n\n# direct concatenate of all source sequence\ndf=pd.read_parquet('raw/combine_source.parquet')\n\n\n# unique substrate site with source split by | \n# df_group=pd.read_parquet('raw/combine_source_grouped.parquet')\ndf_group=Data.get_ks_dataset()\n\n\ndef plot_overlap(df_concat,source_col='source',id_col='kin_sub_site',figsize=(7,5),title=\"Overlap of Unique KS Pairs Between Sources\"):\n    source_ids = df_concat.groupby(source_col)[id_col].apply(set).to_dict()\n    sources = list(source_ids.keys())\n    \n    overlap_matrix = pd.DataFrame(index=sources, columns=sources, dtype=int)\n    for src1 in sources:\n        for src2 in sources:\n            if src1 == src2:\n                overlap_matrix.loc[src1, src2] = len(source_ids[src1])\n            else:\n                overlap_matrix.loc[src1, src2] = len(source_ids[src1].intersection(source_ids[src2]))\n    \n    mask = np.triu(np.ones_like(overlap_matrix, dtype=bool), k=1)\n\n    overlap_matrix = overlap_matrix.astype(int)\n    \n    vmin = np.min(overlap_matrix[overlap_matrix &gt; 0])  # Smallest nonzero value\n    vmax = np.max(overlap_matrix)\n    \n    plt.figure(figsize=figsize)\n    sns.heatmap(overlap_matrix, \n                annot=True, \n                mask=mask, \n                fmt=\",\", \n                # vmin=1, vmax=1,\n                norm=LogNorm(vmin=vmin, vmax=vmax),\n                cmap=\"Blues\", \n                cbar=False, \n                linewidths=1, \n                linecolor='white')\n\n    plt.title(title)\n\n\nfrom katlas.plot import *\n\n\nset_sns(100)\n\n\nplot_overlap(df)\nsave_pdf('../../fig/EDA_overlap.pdf')\n\n\n\n\n\n\n\n\n\ndf.site.str[0].value_counts()\n\nsite\nY    92088\nS    84341\nT    35243\nName: count, dtype: int64\n\n\n\ndf_st = df[df.site.str[0]!='Y']\ndf_y = df[df.site.str[0]=='Y']\n\n\nplot_overlap(df_st,title=\"Overlap of KS Pairs in S/T sites Between Sources\")\nsave_pdf('../../fig/EDA_overlap_ST.pdf')\n\n\n\n\n\n\n\n\n\nplot_overlap(df_y,title=\"Overlap of KS Pairs in Y sites Between Sources\")\nsave_pdf('../../fig/EDA_overlap_Y.pdf')",
    "crumbs": [
      "Exploratory data analysis"
    ]
  },
  {
    "objectID": "eda_fig1.html#overlap-of-phosphosites-with-human-phosphoproteome",
    "href": "eda_fig1.html#overlap-of-phosphosites-with-human-phosphoproteome",
    "title": "Exploratory data analysis",
    "section": "Overlap of phosphosites with human phosphoproteome",
    "text": "Overlap of phosphosites with human phosphoproteome\n\nimport pandas as pd\nfrom katlas.data import *\n\n\ndf=pd.read_parquet('raw/combine_source.parquet')\ndata = pd.read_parquet('raw/human_phosphoproteome.parquet')\n# data=Data.get_human_site()\n\n\ndata = data.rename(columns={'uniprot':'substrate_uniprot'})\n\n\ndef get_key(df):\n    df = df.copy()\n    print('original shape:',df.shape)\n    df['sub_site']=df['substrate_uniprot']+'_'+df['site']\n    df = df.drop_duplicates(subset='sub_site')\n    print('after removing duplicates',df.shape)\n    return df\n\n\ndata_site = get_key(data)\ndf_site=get_key(df)\n\noriginal shape: (119955, 11)\nafter removing duplicates (119955, 11)\noriginal shape: (211672, 7)\nafter removing duplicates (29811, 8)\n\n\n\ndata_site = data_site[['sub_site']].copy()\ndf_site = df_site[['sub_site']].copy()\n\ndata_site['source']='Human Phosphoprotome'\ndf_site['source']='KS Datasets'\n\ndf_concat = pd.concat([data_site,df_site],ignore_index=True)\n\n\ndf_concat_group = df_concat.groupby('sub_site')['source'].agg(lambda x: '|'.join(x)).reset_index()\n\n\ndf_concat_group.source.value_counts()\n\nsource\nHuman Phosphoprotome                102032\nHuman Phosphoprotome|KS Datasets     17923\nKS Datasets                          11888\nName: count, dtype: int64\n\n\n\n# plot_overlap(df_concat,source_col='source',id_col='sub_site',figsize=(4,2),\n#              title=\"Overlap of Unique Substrate Sites Between Datasets\")\n\nVenn diagram:\n\n# pip install matplotlib_venn\n\n\nfrom matplotlib_venn import venn2\n\nset_human = set(data_site['sub_site'])\nset_ks = set(df_site['sub_site'])\n\nplt.figure(figsize=(5,5))\nvenn = venn2([set_human, set_ks], \n             # set_labels=('Human Phosphoproteome', 'KS Datasets')\n             set_labels=('', '')\n            )\n\nfor label in venn.subset_labels:\n    if label:  # Check if the label exists (not empty subset)\n        label.set_text(f\"{int(label.get_text()):,}\")  # Add comma formatting\nplt.gca().set_aspect(0.8)\nplt.title(\"Overlap of Unique Substrate Sites Between Datasets\")\nsave_pdf('fig/EDA_venn_ks_human_overlap.pdf')",
    "crumbs": [
      "Exploratory data analysis"
    ]
  },
  {
    "objectID": "eda_fig1.html#stacked-plot-of-sty-compositions",
    "href": "eda_fig1.html#stacked-plot-of-sty-compositions",
    "title": "Exploratory data analysis",
    "section": "Stacked plot of S/T/Y compositions",
    "text": "Stacked plot of S/T/Y compositions\n\ndf=pd.read_parquet('raw/combine_source.parquet')\n\n\ndf['acceptor']=df['site'].str[0]\n\n\ndf_sugi = df[df.source=='Sugiyama'].reset_index(drop=True)\ndf_rest = df[df.source!='Sugiyama'].reset_index(drop=True)\n\n\ndf_sugi.acceptor.value_counts()\n\nacceptor\nY    84457\nS    57728\nT    26157\nName: count, dtype: int64\n\n\n\ndf_rest.acceptor.value_counts()\n\nacceptor\nS    26613\nT     9086\nY     7631\nName: count, dtype: int64\n\n\n\nimport matplotlib.ticker as mticker\nfrom matplotlib import pyplot as plt\nimport seaborn as sns\n\n\nfrom katlas.plot import *\n\n\ndef plot_stacked(df,figsize=(6,4)):\n    plt.figure(figsize=figsize)\n    sns.histplot(data=df, \n                 x='source', \n                 hue='acceptor', \n                 multiple='stack', \n                 discrete=True, \n                 shrink=0.8, \n                 alpha=1,\n                 palette=get_color_dict(['S','T','Y'],'tab20'),hue_order=['S','T','Y'])\n    \n    plt.xlabel('')\n    plt.ylabel('Number of KS Pairs')\n    plt.title('Total Number of Unique KS Pairs per Source')\n    plt.gca().yaxis.set_major_formatter(mticker.FuncFormatter(lambda x, _: f'{int(x):,}')) # show number with comma\n    plt.xticks(rotation=45)\n\n\nset_sns(100)\n\n\nplot_stacked(df_rest)\nsave_pdf('../../fig/EDA_stacked_KS_per_source.pdf')\n\n\n\n\n\n\n\n\n\ndef plot_stacked2(df,figsize=(6,4)):\n    plt.figure(figsize=figsize)\n    sns.histplot(data=df, \n                 x='source', \n                 hue='acceptor', \n                 multiple='stack', \n                 discrete=True, \n                 shrink=0.8, \n                 alpha=1,\n                 palette=get_color_dict(['S','T','Y'],'tab20'),hue_order=['S','T','Y'])\n    \n    plt.xlabel('')\n    plt.ylabel('')\n    plt.xticks(rotation=45)\n    plt.legend([],frameon=False)\n    plt.gca().yaxis.set_major_formatter(mticker.FuncFormatter(lambda x, _: f'{int(x):,}'))\n    plt.tick_params(axis='y', labelright=True, labelleft=False, right=True, left=False)\n\nUncomment below to plot the sugiyama site number:\n\nplot_stacked2(df_sugi,(0.7,4))\nsave_pdf('../../fig/EDA_stacked_KS_per_source_part2.pdf')",
    "crumbs": [
      "Exploratory data analysis"
    ]
  },
  {
    "objectID": "eda_fig1.html#recovery-rate",
    "href": "eda_fig1.html#recovery-rate",
    "title": "Exploratory data analysis",
    "section": "Recovery rate",
    "text": "Recovery rate\nCheck raw/recovery_rate.xlsx for more info.\nThe data is collected by: - Filter only human first, get dataframe shape - After kinase & substrate mapping, get the shape - After sites validation, get the shape",
    "crumbs": [
      "Exploratory data analysis"
    ]
  },
  {
    "objectID": "eda_fig1.html#available-on-data",
    "href": "eda_fig1.html#available-on-data",
    "title": "Exploratory data analysis",
    "section": "Available on Data",
    "text": "Available on Data\n\nfrom katlas.data import *\n\n\ndf = Data.get_ks_dataset()\n\n\ndf.head()\n\n\n\n\n\n\n\n\nkin_sub_site\nkinase_uniprot\nsubstrate_uniprot\nsite\nsource\nsubstrate_genes\nsubstrate_phosphoseq\nposition\nsite_seq\nsub_site\nsubstrate_sequence\nkinase_on_tree\nkinase_genes\nkinase_group\nkinase_family\nkinase_pspa_big\nkinase_pspa_small\nkinase_coral_ID\nnum_kin\n\n\n\n\n0\nO00141_A4FU28_S140\nO00141\nA4FU28\nS140\nSugiyama\nCTAGE9\nMEEPGATPQPYLGLVLEELGRVVAALPESMRPDENPYGFPSELVVC...\n140\nAAAEEARSLEATCEKLSRsNsELEDEILCLEKDLKEEKSKH\nA4FU28_S140\nMEEPGATPQPYLGLVLEELGRVVAALPESMRPDENPYGFPSELVVC...\n1\nSGK1 SGK\nAGC\nSGK\nBasophilic\nAkt/rock\nSGK1\n22\n\n\n1\nO00141_O00141_S252\nO00141\nO00141\nS252\nSugiyama\nSGK1 SGK\nMTVKTEAAKGTLTYSRMRGMVAILIAFMKQRRMGLNDFIQKIANNS...\n252\nSQGHIVLTDFGLCKENIEHNsTtstFCGtPEyLAPEVLHKQ\nO00141_S252\nMTVKTEAAKGTLTYSRMRGMVAILIAFMKQRRMGLNDFIQKIANNS...\n1\nSGK1 SGK\nAGC\nSGK\nBasophilic\nAkt/rock\nSGK1\n1\n\n\n2\nO00141_O00141_S255\nO00141\nO00141\nS255\nSugiyama\nSGK1 SGK\nMTVKTEAAKGTLTYSRMRGMVAILIAFMKQRRMGLNDFIQKIANNS...\n255\nHIVLTDFGLCKENIEHNsTtstFCGtPEyLAPEVLHKQPYD\nO00141_S255\nMTVKTEAAKGTLTYSRMRGMVAILIAFMKQRRMGLNDFIQKIANNS...\n1\nSGK1 SGK\nAGC\nSGK\nBasophilic\nAkt/rock\nSGK1\n1\n\n\n3\nO00141_O00141_S397\nO00141\nO00141\nS397\nSugiyama\nSGK1 SGK\nMTVKTEAAKGTLTYSRMRGMVAILIAFMKQRRMGLNDFIQKIANNS...\n397\nsGPNDLRHFDPEFTEEPVPNsIGKsPDsVLVTAsVKEAAEA\nO00141_S397\nMTVKTEAAKGTLTYSRMRGMVAILIAFMKQRRMGLNDFIQKIANNS...\n1\nSGK1 SGK\nAGC\nSGK\nBasophilic\nAkt/rock\nSGK1\n1\n\n\n4\nO00141_O00141_S404\nO00141\nO00141\nS404\nSugiyama\nSGK1 SGK\nMTVKTEAAKGTLTYSRMRGMVAILIAFMKQRRMGLNDFIQKIANNS...\n404\nHFDPEFTEEPVPNsIGKsPDsVLVTAsVKEAAEAFLGFsYA\nO00141_S404\nMTVKTEAAKGTLTYSRMRGMVAILIAFMKQRRMGLNDFIQKIANNS...\n1\nSGK1 SGK\nAGC\nSGK\nBasophilic\nAkt/rock\nSGK1\n1\n\n\n\n\n\n\n\n\ndf.shape\n\n(187066, 19)",
    "crumbs": [
      "Exploratory data analysis"
    ]
  },
  {
    "objectID": "eda_fig1.html#sites-distribution",
    "href": "eda_fig1.html#sites-distribution",
    "title": "Exploratory data analysis",
    "section": "Sites distribution",
    "text": "Sites distribution\n\ndf['acceptor'] = df.site.str[0]\n\n\ndef plot_pie(value_counts, # value counts\n             hue_order=None, # list of strings\n             labeldistance=0.8,\n             fontsize=12,\n             fontcolor='black',\n             palette='tab20' \n            ):\n    if hue_order is not None: value_counts = value_counts.reindex(hue_order)\n    colors = sns.color_palette(palette, n_colors=len(value_counts))\n    value_counts.plot.pie(\n        autopct='%1.1f%%',    # Show percentage inside slices\n        labeldistance=labeldistance,    # Move labels closer to center\n        textprops={'fontsize': fontsize, 'color': fontcolor} ,\n        colors=colors,\n    )\n    plt.ylabel('')\n    plt.title(f'n={value_counts.sum():,}')\n\n\ndef plot_pie(value_counts, \n             hue_order=None,\n             labeldistance=0.8,\n             fontsize=9,\n             fontcolor='black',\n             palette='tab20'):\n    # Sort value_counts by size for better pie layout\n    value_counts_sorted = value_counts.sort_values(ascending=False)\n\n    # Map colors based on hue_order (if provided) or sorted labels\n    labels = value_counts_sorted.index.tolist()\n    if hue_order is not None:\n        # Assign fixed colors based on hue_order\n        palette_colors = sns.color_palette(palette, n_colors=len(hue_order))\n        color_map = dict(zip(hue_order, palette_colors))\n        colors = [color_map.get(label, 'grey') for label in labels]\n    else:\n        colors = sns.color_palette(palette, n_colors=len(labels))\n\n    # Plot pie\n    value_counts_sorted.plot.pie(\n        autopct='%1.1f%%',\n        labeldistance=labeldistance,\n        textprops={'fontsize': fontsize, 'color': fontcolor},\n        colors=colors\n    )\n\n    plt.ylabel('')\n    plt.title(f'n={value_counts.sum():,}')\n\n\ncnt = df['acceptor'].value_counts()\n\n\nplot_pie(cnt,['S','T','Y'])\nsave_pdf('../../fig/EDA_pie_STY.pdf')",
    "crumbs": [
      "Exploratory data analysis"
    ]
  },
  {
    "objectID": "eda_fig1.html#most-frequent-kinases",
    "href": "eda_fig1.html#most-frequent-kinases",
    "title": "Exploratory data analysis",
    "section": "Most frequent kinases",
    "text": "Most frequent kinases\n\nPie chart\n\ncnt = df.kinase_group.value_counts()\n\n\ninfo = Data.get_kinase_info()\n\n\ninfo.modi_group.value_counts().index\n\nIndex(['TK', 'CAMK', 'Other', 'CMGC', 'AGC', 'STE', 'TKL', 'Atypical', 'CK1',\n       'NEK', 'RGC'],\n      dtype='object', name='modi_group')\n\n\n\ngroup_color=get_color_dict(\n            ['CMGC','AGC', # blue\n             'TK','TKL', # orange\n             'CAMK','STE', # green\n             'CK1', 'NEK', # red\n             'Atypical','Other', # purple\n             'RGC'\n            ]\n)\n\n\nplot_pie(cnt,hue_order=group_color.keys(),\n         fontsize=9,\n         # labeldistance=1.1\n        )\nsave_pdf('../../fig/EDA_pie_group.pdf')\n\n\n\n\n\n\n\n\n\n\nKinome tree\nCoral:\n\nimport numpy as np\n\n\ndf=Data.get_ks_dataset()\n\n\ncnt = df.groupby('kinase_coral_ID')['kin_sub_site'].apply(lambda x: len(x.unique())).sort_values(ascending=False)\n\n\n# cnt.apply(np.log10).round(2).to_csv('raw/kinome_tree_cnt.csv')\n\nGo to Coral. Follow the setting below:\n\nNode color –&gt; Color Scheme: quantitative\npaste csv context (without heading) in “Kinases & Value”\nidentifier: coralID\nmin:0 max:3.5\nmanual 2-color. Low: #E0E0E0, High: #FA6958\n\nTo disable node label: advanced setting –&gt; labels font size to 0\n\n\n\nimage.png",
    "crumbs": [
      "Exploratory data analysis"
    ]
  },
  {
    "objectID": "eda_fig1.html#old",
    "href": "eda_fig1.html#old",
    "title": "Exploratory data analysis",
    "section": "Old",
    "text": "Old",
    "crumbs": [
      "Exploratory data analysis"
    ]
  },
  {
    "objectID": "eda_fig1.html#co-occured-kinase",
    "href": "eda_fig1.html#co-occured-kinase",
    "title": "Exploratory data analysis",
    "section": "Co-occured kinase",
    "text": "Co-occured kinase\n\ndf_group['substrate_uniprot_site']=df_group['substrate_uniprot']+'_'+df_group['site']\n\n\nfrom itertools import combinations\nfrom collections import Counter\n\n\ndf_group.groupby('substrate_uniprot_site')['kinase_uniprot'].apply(list)\n\nsubstrate_uniprot_site\nA0A2R8Y4L2_S158                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      [P48730]\nA0A2R8Y4L2_S22                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       [O14757, O95819, Q13557]\nA0A2R8Y4L2_S6                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        [O15264, P06493, Q9NR20]\nA0A2R8Y4L2_S95     [O00238, O14920, O15075, O43318, O75676, O94806, O96017, P05771-2, P05771, P15735, P17252, P23443, P24723, P24941, P36507, P36896, P36897, P41743, P42679, P49137, P49759, P49761, P50750, P51812, P51955, P51957, P52333, P57059, P78362, P80192, Q02156, Q02779, Q04759, Q04771, Q05513, Q06187, Q13131, Q13554, Q13555, Q13557, Q14012, Q14680, Q15139, Q15349, Q16512, Q16513, Q16566, Q16584, Q16644, Q16816, Q86UE8, Q8IU85, Q8IW41, Q8N568, Q8TD19, Q8TDX7, Q96GD4, Q9BYT3, Q9BZL6, Q9NYL2, Q9UKI8, Q9UPE1, Q9UQM7, Q9Y2U5, Q9Y4K4]\nA0A2R8Y4L2_T25                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       [O14757, O95819, Q13557]\n                                                                                                                                                                                                                                                                                      ...                                                                                                                                                                                                                                                                    \nQ9Y6Y8_S894                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  [Q96PF2, Q9BXA7]\nQ9Y6Y8_T893                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  [P27448, Q7KZI7, Q96L34, Q9P0L2]\nQ9Y6Y8_Y935                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  [P43405, P52333]\nQ9Y6Y9_Y131                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          [P07948]\nQ9Y6Y9_Y22                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           [P07948]\nName: kinase_uniprot, Length: 29811, dtype: object\n\n\n\n# Count co-occurring kinase pairs\nco_occurrence = Counter()\nfor kinases in grouped:\n    for pair in combinations(sorted(set(kinases)), 2):  # remove duplicates and sort for consistency\n        co_occurrence[pair] += 1\n\n# print(co_occurrence)\n\n\nkinases = set()\nfor pair in co_occurrence.keys():\n    kinases.update(pair)\nkinases = sorted(kinases)\n\n# Initialize the co-occurrence matrix with zeros\nmatrix = pd.DataFrame(0, index=kinases, columns=kinases)\n\n# Fill in the counts (matrix is symmetric)\nfor (k1, k2), count in co_occurrence.items():\n    matrix.loc[k1, k2] = count\n    matrix.loc[k2, k1] = count\n\n\nmatrix['P00533'].sort_values()\n\nP31152      0\nQ16659      0\nQ16654      0\nP37173      0\nP35790      0\n         ... \nP36888    478\nP11362    480\nP07949    480\nP06213    481\nQ15303    497\nName: P00533, Length: 433, dtype: int64\n\n\n\ncounts = df_group.groupby('kinase_uniprot').agg({'substrate_uniprot_site':'size'})\n\nJaccard\n\ncounts_series = counts['substrate_uniprot_site']\n\n# Create a copy for normalized values\nnorm_matrix = matrix.copy().astype(float)\n\nfor k1 in matrix.index:\n    for k2 in matrix.columns:\n        intersection = matrix.loc[k1, k2]\n        union = counts_series[k1] + counts_series[k2] - intersection\n        norm_matrix.loc[k1, k2] = intersection / union if union != 0 else 0\n    norm_matrix.loc[k1, k1] = 1 # diaganol to be 1\n\n\n# Create a boolean mask for the upper triangle (k=1 excludes the diagonal)\nmask = np.triu(np.ones(norm_matrix.shape), k=1).astype(bool)\nnorm_matrix = norm_matrix.where(mask)\n\n\nmatrix['P00533'].sort_values(ascending=False).head()\n\nQ15303    497\nP06213    481\nP07949    480\nP11362    480\nP36888    478\nName: P00533, dtype: int64\n\n\n\nnorm_matrix['P00533'].sort_values(ascending=False).head()\n\nO60674    0.253078\nO15146    0.213529\nP00519    0.203051\nO43318    0.122415\nO75676    0.023234\nName: P00533, dtype: float64\n\n\n\nkin_info = Data.get_kinase_info()\n\n\nst=kin_info[kin_info.group!='TK'].uniprot.tolist()\n\n\nst_col =norm_matrix.columns[norm_matrix.columns.isin(st)]\n\n\nst_matrix = norm_matrix[st_col]\n\n\ndef get_max_jaccard(matrix):   \n    a = matrix.max()\n    b = matrix.idxmax()\n    \n    matrix = pd.concat([a, b], axis=1)\n    matrix.columns = ['jaccard', 'kinase_uniprot']\n    \n    return matrix.sort_values('jaccard', ascending=False)\n\n\nget_max_jaccard(st_matrix)\n\n/tmp/ipykernel_169440/3714721923.py:3: FutureWarning: The behavior of DataFrame.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n  b = matrix.idxmax()\n\n\n\n\n\n\n\n\n\njaccard\nkinase_uniprot\n\n\n\n\nQ9NYV4\n0.509804\nQ14004\n\n\nQ96QP1\n0.500000\nQ96L96\n\n\nQ9Y6E0\n0.465691\nQ9P289\n\n\nP28482\n0.450737\nP27361\n\n\nP31751\n0.437574\nP31749\n\n\n...\n...\n...\n\n\nO76039\n0.000000\nO00141\n\n\nQ2M2I8\n0.000000\nO00141\n\n\nO60885\n0.000000\nO00141\n\n\nO00311\n0.000000\nO00141\n\n\nO00141\nNaN\nNaN\n\n\n\n\n323 rows × 2 columns\n\n\n\n\ntyr=kin_info[kin_info.group=='TK'].uniprot.tolist()\ntyr_col =norm_matrix.columns[norm_matrix.columns.isin(tyr)]\ntyr_matrix = norm_matrix[tyr_col]\n\n\nget_max_jaccard(tyr_matrix)\n\n\n\n\n\n\n\n\njaccard\nkinase_uniprot\n\n\n\n\nP54762\n0.554638\nP54760\n\n\nQ15375\n0.539118\nP21709\n\n\nP54753\n0.531496\nP29320\n\n\nQ06418\n0.526057\nP54762\n\n\nP54760\n0.521168\nP54753\n\n\n...\n...\n...\n\n\nP04626\n0.046957\nO43318\n\n\nO15146\n0.044005\nO00506\n\n\nQ6J9G0\n0.016393\nO43293\n\n\nQ6ZMQ8\n0.004348\nO96017\n\n\nQ8IWU2\n0.003676\nQ13976\n\n\n\n\n83 rows × 2 columns\n\n\n\n\nkin_info_uniprot = pd.read_excel('raw/uniprot_human_keyword_kinase.xlsx')\n\n\nkin_map = kin_info_uniprot.set_index('Entry')['Entry Name'].str.split('_').str[0]\n\n\nnames = norm_matrix.index.map(kin_map)\n\ntodo: Use filter to only select kinase &gt;30 counts\n\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom scipy.cluster.hierarchy import linkage, dendrogram\nfrom sklearn.manifold import MDS\nimport networkx as nx\n\n# Assuming norm_matrix is your pre-computed Jaccard similarity matrix\n\n# ---------------------------\n# 1. Clustering & Heatmap\n\n# Alternatively, using hierarchical clustering with scipy:\n# Z = linkage(norm_matrix, method='average')\n# plt.figure(figsize=(10, 5))\n# dendrogram(Z, labels=norm_matrix.index)\n# plt.title(\"Hierarchical Clustering Dendrogram\")\n# plt.xlabel(\"Kinase\")\n# plt.ylabel(\"Distance\")\n# plt.show()\n\nZ = linkage(norm_matrix, method='average')\nplt.figure(figsize=(4,50))\ndendrogram(Z,orientation='left',leaf_font_size=7,labels=names,color_threshold=1.3)\nplt.title('Hierarchical Clustering Dendrogram')\nplt.ylabel('Distance')\nplt.show()",
    "crumbs": [
      "Exploratory data analysis"
    ]
  },
  {
    "objectID": "eda_fig1.html#old-1",
    "href": "eda_fig1.html#old-1",
    "title": "Exploratory data analysis",
    "section": "Old",
    "text": "Old\n\n# 2. Network Analysis\n# ---------------------------\n# Build a graph from norm_matrix (using a threshold to filter weak links)\nthreshold = 0.2  # adjust threshold as needed\nG = nx.Graph()\nfor i, kinase1 in enumerate(norm_matrix.index):\n    for j, kinase2 in enumerate(norm_matrix.columns):\n        if i &lt; j and norm_matrix.loc[kinase1, kinase2] &gt; threshold:\n            G.add_edge(kinase1, kinase2, weight=norm_matrix.loc[kinase1, kinase2])\n\n# Draw the network\nplt.figure(figsize=(10, 10))\npos = nx.spring_layout(G, weight='weight')\nnx.draw(G, pos, with_labels=True, node_size=500, font_size=8)\nplt.title(\"Kinase Similarity Network\")\nplt.show()",
    "crumbs": [
      "Exploratory data analysis"
    ]
  },
  {
    "objectID": "eda_fig1.html#frequency-of-kinase",
    "href": "eda_fig1.html#frequency-of-kinase",
    "title": "Exploratory data analysis",
    "section": "Frequency of kinase",
    "text": "Frequency of kinase\nInstead of showing PSSM, we can show the neigboring kinase",
    "crumbs": [
      "Exploratory data analysis"
    ]
  },
  {
    "objectID": "eda_fig1.html#kinase-count",
    "href": "eda_fig1.html#kinase-count",
    "title": "Exploratory data analysis",
    "section": "Kinase count",
    "text": "Kinase count\n\ndf_group['substrate_uniprot_site']=df_group['substrate_uniprot']+df_group['site']\n\n\ncounts = df_group.groupby('kinase_uniprot').agg({'substrate_uniprot_site':'size'}).reset_index()\n\n\ncounts\n\n\n\n\n\n\n\n\nkinase_uniprot\nsubstrate_uniprot_site\n\n\n\n\n0\nO00141\n387\n\n\n1\nO00238\n356\n\n\n2\nO00311\n50\n\n\n3\nO00329\n6\n\n\n4\nO00418\n202\n\n\n...\n...\n...\n\n\n450\nQ9Y572\n10\n\n\n451\nQ9Y5S2\n109\n\n\n452\nQ9Y6E0\n846\n\n\n453\nQ9Y6M4\n224\n\n\n454\nQ9Y6R4\n15\n\n\n\n\n455 rows × 2 columns\n\n\n\n\nkin_info = pd.read_excel('raw/uniprot_human_keyword_kinase.xlsx')\n\n\nkin_info = kin_info.rename(columns={'Entry':'kinase_uniprot'})\n\n\nkin_info2 = Data.get_kinase_info()\n\n\n(kin_info2.in_ST_paper==1).sum()\n\n303\n\n\n\n(kin_info2.in_Tyr_paper==1).sum()\n\n93\n\n\n\nin_pspa=(kin_info2.in_ST_paper==1)|(kin_info2.in_Tyr_paper==1)\n\n\nkin_info2[in_pspa]\n\n\n\n\n\n\n\n\nkinase\nID_coral\nuniprot\nID_HGNC\ngroup\nfamily\nsubfamily_coral\nsubfamily\nin_ST_paper\nin_Tyr_paper\n...\ncytosol\ncytoskeleton\nplasma membrane\nmitochondrion\nGolgi apparatus\nendoplasmic reticulum\nvesicle\ncentrosome\naggresome\nmain_location\n\n\n\n\n0\nAAK1\nAAK1\nQ2M2I8\nAAK1\nOther\nNAK\nNaN\nNAK\n1\n0\n...\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\n\n\n1\nABL1\nABL1\nP00519\nABL1\nTK\nAbl\nNaN\nAbl\n0\n1\n...\n6.0\nNaN\n4.0\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\ncytosol\n\n\n2\nABL2\nABL2\nP42684\nABL2\nTK\nAbl\nNaN\nAbl\n0\n1\n...\n4.0\n6.0\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\ncytoskeleton\n\n\n3\nTNK2\nACK\nQ07912\nTNK2\nTK\nAck\nNaN\nAck\n0\n1\n...\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\n8.0\nNaN\n2.0\nvesicle\n\n\n4\nACVR2A\nACTR2\nP27037\nACVR2A\nTKL\nSTKR\nSTKR2\nSTKR2\n1\n0\n...\n5.0\nNaN\nNaN\nNaN\nNaN\n5.0\nNaN\nNaN\nNaN\ncytosol\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\n518\nYSK1\nYSK1\nO00506\nSTK25\nSTE\nSTE20\nYSK\nYSK\n1\n0\n...\n6.0\nNaN\nNaN\nNaN\n4.0\nNaN\nNaN\nNaN\nNaN\ncytosol\n\n\n519\nZAK\nZAK\nQ9NYL2\nMAP3K20\nTKL\nMLK\nZAK\nZAK\n1\n0\n...\n5.0\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nnucleus\n\n\n520\nZAP70\nZAP70\nP43403\nZAP70\nTK\nSyk\nNaN\nSyk\n0\n1\n...\n5.0\nNaN\n2.0\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\ncytosol\n\n\n521\nEEF2K\neEF2K\nO00418\nEEF2K\nAtypical\nAlpha\neEF2K\neEF2K\n1\n0\n...\n9.0\nNaN\n1.0\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\ncytosol\n\n\n522\nFAM20C\nFAM20C\nQ8IXL6\nFAM20C\nAtypical\nFAM20C\nNaN\nFAM20C\n1\n0\n...\n2.0\nNaN\nNaN\nNaN\n7.0\n1.0\nNaN\nNaN\nNaN\nGolgi apparatus\n\n\n\n\n392 rows × 30 columns\n\n\n\n\nkin_info2[\n\nIndex(['kinase', 'ID_coral', 'uniprot', 'ID_HGNC', 'group', 'family',\n       'subfamily_coral', 'subfamily', 'in_ST_paper', 'in_Tyr_paper',\n       'in_cddm', 'pseudo', 'pspa_category_small', 'pspa_category_big',\n       'cddm_big', 'cddm_small', 'length', 'human_uniprot_sequence',\n       'kinasecom_domain', 'nucleus', 'cytosol', 'cytoskeleton',\n       'plasma membrane', 'mitochondrion', 'Golgi apparatus',\n       'endoplasmic reticulum', 'vesicle', 'centrosome', 'aggresome',\n       'main_location'],\n      dtype='object')\n\n\n\ndf_group[df_group.kinase_uniprot=='P07948-2']\n\n\n\n\n\n\n\n\nkin_sub_site\nkinase_uniprot\nsubstrate_uniprot\nsite\nsource\nsubstrate_genes\nsubstrate_sequence\nsubstrate_phosphoseq\nsubstrate_uniprot_site\n\n\n\n\n30312\nP07948-2_A0MZ66_Y24\nP07948-2\nA0MZ66\nY24\nSugiyama\nSHTN1 KIAA1598\nMNSSDEEKQLQLITSLKEQAIGEYEDLRAENQKTKEKCDKIRQERD...\nMNSSDEEKQLQLITSLKEQAIGEyEDLRAENQKTKEKCDKIRQERD...\nA0MZ66Y24\n\n\n30313\nP07948-2_A1L429_Y10\nP07948-2\nA1L429\nY10\nSugiyama\nGAGE12B; GAGE12C; GAGE12D; GAGE12E\nMSWRGRSTYYWPRPRRYVQPPEMIGPMRPEQFSDEVEPATPEEGEP...\nMSWRGRsTyyWPRPRRYVQPPEMIGPMRPEQFSDEVEPATPEEGEP...\nA1L429Y10\n\n\n30314\nP07948-2_A1L429_Y9\nP07948-2\nA1L429\nY9\nSugiyama\nGAGE12B; GAGE12C; GAGE12D; GAGE12E\nMSWRGRSTYYWPRPRRYVQPPEMIGPMRPEQFSDEVEPATPEEGEP...\nMSWRGRsTyyWPRPRRYVQPPEMIGPMRPEQFSDEVEPATPEEGEP...\nA1L429Y9\n\n\n30315\nP07948-2_A1X283_Y855\nP07948-2\nA1X283\nY855\nSugiyama\nSH3PXD2B FAD49 KIAA1295 TKS4\nMPPRRSIVEVKVLDVQKRRVPNKHYVYIIRVTWSSGSTEAIYRRYS...\nMPPRRSIVEVKVLDVQKRRVPNKHYVYIIRVTWSSGSTEAIYRRYS...\nA1X283Y855\n\n\n30316\nP07948-2_A5A3E0_S939\nP07948-2\nA5A3E0\nS939\nSugiyama\nPOTEF A26C1B\nMVVEVDSMPAASSVKKPFGLRSKMGKWCCRCFPCCRESGKSNVGTS...\nMVVEVDSMPAASSVKKPFGLRSKMGKWCCRCFPCCRESGKSNVGTS...\nA5A3E0S939\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\n31872\nP07948-2_Q9Y5S9_Y54\nP07948-2\nQ9Y5S9\nY54\nSugiyama\nRBM8A RBM8 HSPC114 MDS014\nMADVLDLHEAGGEDFAMDEDGDESIHKLKEKAKKRKGRGFGSEEGS...\nMADVLDLHEAGGEDFAMDEDGDESIHKLKEKAKKRKGRGFGSEEGS...\nQ9Y5S9Y54\n\n\n31873\nP07948-2_Q9Y639_Y216\nP07948-2\nQ9Y639\nY216\nSugiyama\nNPTN SDFR1 SDR1\nMSGSSLPSALALSLLLVSGSLLPGPGAAQNAGFVKSPMSETKLTGD...\nMSGSSLPSALALSLLLVSGSLLPGPGAAQNAGFVKSPMSETKLTGD...\nQ9Y639Y216\n\n\n31874\nP07948-2_Q9Y639_Y220\nP07948-2\nQ9Y639\nY220\nSugiyama\nNPTN SDFR1 SDR1\nMSGSSLPSALALSLLLVSGSLLPGPGAAQNAGFVKSPMSETKLTGD...\nMSGSSLPSALALSLLLVSGSLLPGPGAAQNAGFVKSPMSETKLTGD...\nQ9Y639Y220\n\n\n31875\nP07948-2_Q9Y696_S245\nP07948-2\nQ9Y696\nS245\nSugiyama\nCLIC4\nMALSMPLNGLKEEDKEPLIELFVKAGSDGESIGNCPFSQRLFMILW...\nMALSMPLNGLKEEDKEPLIELFVKAGsDGEsIGNCPFSQRLFMILW...\nQ9Y696S245\n\n\n31876\nP07948-2_Q9Y696_Y244\nP07948-2\nQ9Y696\nY244\nSugiyama\nCLIC4\nMALSMPLNGLKEEDKEPLIELFVKAGSDGESIGNCPFSQRLFMILW...\nMALSMPLNGLKEEDKEPLIELFVKAGsDGEsIGNCPFSQRLFMILW...\nQ9Y696Y244\n\n\n\n\n1565 rows × 9 columns\n\n\n\n\ncounts\n\n\n\n\n\n\n\n\nkinase_uniprot\nsubstrate_uniprot_site\n\n\n\n\n0\nO00141\n387\n\n\n1\nO00238\n356\n\n\n2\nO00311\n50\n\n\n3\nO00329\n6\n\n\n4\nO00418\n202\n\n\n...\n...\n...\n\n\n450\nQ9Y572\n10\n\n\n451\nQ9Y5S2\n109\n\n\n452\nQ9Y6E0\n846\n\n\n453\nQ9Y6M4\n224\n\n\n454\nQ9Y6R4\n15\n\n\n\n\n455 rows × 2 columns\n\n\n\n\ncounts.merge(kin_info)\n\n\n\n\n\n\n\n\nkinase_uniprot\nsubstrate_uniprot_site\nEntry Name\nProtein names\nGene Names\nuniprot_keyword_kinase\non_tree\nOrganism\nKeywords\nSequence\n\n\n\n\n0\nO00141\n387\nSGK1_HUMAN\nSerine/threonine-protein kinase Sgk1 (EC 2.7.1...\nSGK1 SGK\n1\n1\nHomo sapiens (Human)\n3D-structure;Alternative promoter usage;Altern...\nMTVKTEAAKGTLTYSRMRGMVAILIAFMKQRRMGLNDFIQKIANNS...\n\n\n1\nO00238\n356\nBMR1B_HUMAN\nBone morphogenetic protein receptor type-1B (B...\nBMPR1B\n1\n1\nHomo sapiens (Human)\n3D-structure;Alternative splicing;ATP-binding;...\nMLLRSAGKLNVGTKKEDGESTAPTPRPKVLRCKCHHHCPEDSVNNI...\n\n\n2\nO00311\n50\nCDC7_HUMAN\nCell division cycle 7-related protein kinase (...\nCDC7 CDC7L1\n1\n1\nHomo sapiens (Human)\n3D-structure;Alternative splicing;ATP-binding;...\nMEASLGIQMDEPMAFSPQRDRFQAEGSLKKNEQNFKLAGVKKDIEK...\n\n\n3\nO00329\n6\nPK3CD_HUMAN\nPhosphatidylinositol 4,5-bisphosphate 3-kinase...\nPIK3CD\n1\n0\nHomo sapiens (Human)\n3D-structure;Adaptive immunity;Alternative spl...\nMPPGVDCPMEFWTKEENQSVVVDFLLPTGVYLNFPVSRNANLSTIK...\n\n\n4\nO00418\n202\nEF2K_HUMAN\nEukaryotic elongation factor 2 kinase (eEF-2 k...\nEEF2K\n1\n1\nHomo sapiens (Human)\n3D-structure;Acetylation;ATP-binding;Calcium;C...\nMADEDLIFRLEGVDGGQSPRAGHDGDSDGDSDDEEGYFICPITDDP...\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\n447\nQ9Y572\n10\nRIPK3_HUMAN\nReceptor-interacting serine/threonine-protein ...\nRIPK3 RIP3\n1\n1\nHomo sapiens (Human)\n3D-structure;Alternative splicing;Apoptosis;AT...\nMSCVKLWPSGAPAPLVSIEELENQELVGKGGFGTVFRAQHRKWGYD...\n\n\n448\nQ9Y5S2\n109\nMRCKB_HUMAN\nSerine/threonine-protein kinase MRCK beta (EC ...\nCDC42BPB KIAA1124\n1\n1\nHomo sapiens (Human)\n3D-structure;ATP-binding;Cell junction;Cell me...\nMSAKVRLKKLEQLLLDGPWRNESALSVETLLDVLVCLYTECSHSAL...\n\n\n449\nQ9Y6E0\n846\nSTK24_HUMAN\nSerine/threonine-protein kinase 24 (EC 2.7.11....\nSTK24 MST3 STK3\n1\n1\nHomo sapiens (Human)\n3D-structure;Acetylation;Alternative splicing;...\nMDSRAQLWGLALNKRRATLPHPGGSTNLKADPEELFTKLEKIGKGS...\n\n\n450\nQ9Y6M4\n224\nKC1G3_HUMAN\nCasein kinase I isoform gamma-3 (CKI-gamma 3) ...\nCSNK1G3\n1\n1\nHomo sapiens (Human)\n3D-structure;Acetylation;Alternative splicing;...\nMENKKKDKDKSDDRMARPSGRSGHNTRGTGSSSSGVLMVGPNFRVG...\n\n\n451\nQ9Y6R4\n15\nM3K4_HUMAN\nMitogen-activated protein kinase kinase kinase...\nMAP3K4 KIAA0213 MAPKKK4 MEKK4 MTK1\n1\n1\nHomo sapiens (Human)\nAlternative splicing;ATP-binding;Cytoplasm;Kin...\nMREAAAALVPPPAFAVTPAAAMEEPPPPPPPPPPPPEPETESEPEC...\n\n\n\n\n452 rows × 10 columns",
    "crumbs": [
      "Exploratory data analysis"
    ]
  },
  {
    "objectID": "eda_fig1.html#source-confidence",
    "href": "eda_fig1.html#source-confidence",
    "title": "Exploratory data analysis",
    "section": "Source confidence",
    "text": "Source confidence\n\ndf_group.source.str.split('|').str.len().value_counts()\n\nsource\n1    174536\n2      6123\n3      3352\n4      1312\n5       923\n6       770\n7        50\nName: count, dtype: int64",
    "crumbs": [
      "Exploratory data analysis"
    ]
  },
  {
    "objectID": "eda_fig1.html#self-phosphorylate",
    "href": "eda_fig1.html#self-phosphorylate",
    "title": "Exploratory data analysis",
    "section": "Self-phosphorylate",
    "text": "Self-phosphorylate\n\ndf_group[df_group['kinase_uniprot']==df_group['substrate_uniprot']].substrate_genes.value_counts().head(20)\n\nsubstrate_genes\nLRRK2 PARK8                  57\nTRPM7 CHAK1 LTRPC7           46\nMARK2 EMK1                   35\nBMX                          34\nTTK MPS1 MPS1L1              34\nNEK4 STK2                    33\nDCLK2 DCAMKL2 DCDC3B DCK2    32\nERBB4 HER4                   32\nABL1 ABL JTK7                32\nMARK1 KIAA1477 MARK          31\nHIPK2                        31\nRPS6KA2 MAPKAPK1C RSK3       29\nBTK AGMX1 ATK BPK            29\nSTK4 KRS2 MST1               28\nBUB1B BUBR1 MAD3L SSK1       28\nPDGFRA PDGFR2 RHEPDGFRA      28\nITK EMT LYK                  28\nRPS6KA6 RSK4                 28\nPRKD2 PKD2 HSPC187           28\nABL2 ABLL ARG                27\nName: count, dtype: int64\n\n\n\ndf_group.source\n\nsource\nSugiyama                     167633\nEPSD|PSP                       3346\nPSP                            2932\nSIGNOR                         1984\nSIGNOR|EPSD|PSP                1878\n                              ...  \nGPS6|SIGNOR|ELM|Sugiyama          1\nELM|iPTMNet|Sugiyama              1\nELM|iPTMNet|EPSD|Sugiyama         1\niPTMNet|PSP|Sugiyama              1\nSIGNOR|ELM|EPSD|Sugiyama          1\nName: count, Length: 111, dtype: int64\n\n\n\nNearby co-occured kinase\nTODO",
    "crumbs": [
      "Exploratory data analysis"
    ]
  },
  {
    "objectID": "motif_plot.html",
    "href": "motif_plot.html",
    "title": "Motif plot",
    "section": "",
    "text": "import pandas as pd\npssms = pd.read_parquet('out/all_site_pssms_filter.parquet')\ndf = pd.read_parquet('raw/kmeans_site_long_cluster_new.parquet')\npssms.shape\n\n(1169, 943)\ndf.shape\n\n(843252, 6)\ndf.columns\n\nIndex(['sub_site', 'site_seq', 'cluster_info', 'cluster', 'cluster_id',\n       'cluster_new'],\n      dtype='object')\ncols=['sub_site','cluster_new']\ndf = df[cols]\ninfo=pd.read_parquet('raw/kmeans_site.parquet')\ninfo = info[['substrate_uniprot', 'substrate_genes', 'site', 'source','sub_site','site_seq']]\ndf = df.merge(info,on='sub_site')\ndf.columns\n\nIndex(['sub_site', 'cluster_new', 'substrate_uniprot', 'substrate_genes',\n       'site', 'source', 'site_seq'],\n      dtype='object')\nnew_colname = ['sub_site', 'cluster', 'uniprot', 'genes',\n       'site', 'source', 'site_seq']\ndf.columns = new_colname\ndf = df[df.cluster.isin(pssms.index)]\ndf.shape\n\n(751513, 7)\ndf = df.reset_index(drop=True)\ndf.to_parquet('out/web_motif_df.parquet')\ndf = pd.read_parquet('out/web_motif_df.parquet')",
    "crumbs": [
      "Motif plot"
    ]
  },
  {
    "objectID": "motif_plot.html#hierarchical-clustering-of-merged-pssms",
    "href": "motif_plot.html#hierarchical-clustering-of-merged-pssms",
    "title": "Motif plot",
    "section": "Hierarchical clustering of merged pssms",
    "text": "Hierarchical clustering of merged pssms\n\nfrom katlas.clustering import *\n\n\nZ = get_Z(pssms)\n\n\n\n\n\ncount_map = df.cluster.value_counts()\n\n\nlabels= get_pssm_seq_labels(pssms,count_map = count_map , thr=0.3)\n\n\nlabels[:4]\n\n['29 (n=8,243): ....................s*P...................',\n '369 (n=6,453): ....................s*.s..................',\n '1054 (n=6,368): ....................t*P...................',\n '338 (n=6,182): .................R..s*....................']\n\n\n\nfrom katlas.plot import *\nfrom matplotlib import pyplot as plt\nfrom scipy.cluster.hierarchy import dendrogram\n\n\ndef plot_dendrogram(Z,\n                    color_thr=0.07,\n                    dense=7, # the higher the more dense for each row\n                    line_width=1,\n                    # title='Hierarchical Clustering Dendrogram',\n                    scale=1,\n                    **kwargs):\n    length = (len(Z) + 1) // dense\n    \n    plt.figure(figsize=(5*scale,length*scale))\n    with plt.rc_context({'lines.linewidth': line_width}):\n        dendrogram(\n            Z,\n            orientation='left',\n            leaf_font_size=18, #7\n            color_threshold=color_thr,\n            **kwargs\n        )\n\n    ax = plt.gca()\n    for spine in ['top', 'right', 'left', 'bottom']:\n        ax.spines[spine].set_visible(False)\n\n\nplot_dendrogram(Z,labels=labels,color_thr=0.07,scale=2.5)\n# save_pdf('out/dendrogram.pdf')\nsave_svg('out/human_motif_dendrogram.svg')\nplt.close()",
    "crumbs": [
      "Motif plot"
    ]
  },
  {
    "objectID": "motif_plot.html#all-motif",
    "href": "motif_plot.html#all-motif",
    "title": "Motif plot",
    "section": "All motif",
    "text": "All motif\n\nimport pandas as pd\nfrom katlas.plot import *\nfrom katlas.pssm import *\nfrom katlas.utils import *\nfrom tqdm import tqdm\nimport gc\nfrom matplotlib import pyplot as plt\n\n\npssms = pd.read_parquet('out/all_site_pssms_filter.parquet')\n\n\ndf = pd.read_parquet('out/web_motif_df.parquet')\n\n\ncnt = df.cluster.value_counts()\n\n\n# cnt.index.get_loc(1198)\n\n1146\n\n\n\ndef save_show(path=None, # image path, e.g., img.svg, if not None, will save, else plt.show()\n              show_only=False,\n             ):\n    \"Show plot or save path\"\n    if show_only: plt.show()\n    elif path is not None: plt.savefig(path, bbox_inches='tight', pad_inches=0.05,transparent=True)\n    else: plt.show()\n    plt.close('all')\n\n\nfor idx,row in tqdm(pssms.iterrows(),total=len(pssms)):\n    plot_logo_heatmap(recover_pssm(row),title=f'Motif #{idx} (n={cnt[idx]})')\n    path=prepare_path(f'fig/motif/{idx}/pssm.svg')\n    save_show(path,show_only=False)\n\n  2%|█▊                                                                                          | 23/1169 [01:07&lt;56:28,  2.96s/it]",
    "crumbs": [
      "Motif plot"
    ]
  },
  {
    "objectID": "motif_plot.html#pathway-for-each-motif",
    "href": "motif_plot.html#pathway-for-each-motif",
    "title": "Motif plot",
    "section": "Pathway for each motif",
    "text": "Pathway for each motif\n\nfrom katlas.pathway import *\nfrom katlas.utils import *\n\n\ncnt = df.cluster.value_counts()\n\n\n# for idx in [545,\n#             1058,\n#             913,\n#             597,\n#             1231]:\n#     df_motif = df[df.cluster==idx].copy()\n#     gene_list = df_motif.genes.str.split(' ').str[0].dropna().drop_duplicates().tolist()\n#     try:\n#         df_path = get_reactome(gene_list,p_type='p')\n#         df_path = df_path[~df_path.name.str.contains('GTPase|SUMO',case=False,na=False)].copy()\n#         path = prepare_path(f'fig/motif/{idx}/path.parquet')\n#         df_path.to_parquet(path)\n#     except Exception as e:\n#         print(f\"Failed for {idx}: {e}\")\n\nRunning pathway anlysis\nDone\nFailed for 1231: \"None of [Index(['name', 'stId', 'entities.pValue'], dtype='object')] are in the [columns]\"\n\n\n\nfor idx in cnt.index:\n    df_motif = df[df.cluster==idx].copy()\n    gene_list = df_motif.genes.str.split(' ').str[0].dropna().drop_duplicates().tolist()\n    try:\n        df_path = get_reactome(gene_list,p_type='p')\n        df_path = df_path[~df_path.name.str.contains('GTPase|SUMO',case=False,na=False)].copy()\n        path = prepare_path(f'fig/motif/{idx}/path.parquet')\n        df_path.to_parquet(path)\n    except Exception as e:\n        print(f\"Failed for {idx}: {e}\")\n    # break\n\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\n('Connection aborted.', ConnectionResetError(104, 'Connection reset by peer'))\nFailed for 545: cannot access local variable 'response' where it is not associated with a value\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\n('Connection aborted.', ConnectionResetError(104, 'Connection reset by peer'))\nFailed for 1058: cannot access local variable 'response' where it is not associated with a value\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nFailed for 913: ('Connection broken: IncompleteRead(6474 bytes read, 1718 more expected)', IncompleteRead(6474 bytes read, 1718 more expected))\nRunning pathway anlysis\n('Connection aborted.', ConnectionResetError(104, 'Connection reset by peer'))\nFailed for 597: cannot access local variable 'response' where it is not associated with a value\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nFailed for 1231: \"None of [Index(['name', 'stId', 'entities.pValue'], dtype='object')] are in the [columns]\"\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\nRunning pathway anlysis\nDone\n\n\n\npssms\n\n\n\n\n\n\n\n\n-20P\n-20G\n-20A\n-20C\n-20S\n-20T\n-20V\n-20I\n-20L\n-20M\n...\n20H\n20K\n20R\n20Q\n20N\n20D\n20E\n20pS\n20pT\n20pY\n\n\ncluster_new\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n29\n0.068293\n0.056220\n0.061707\n0.018293\n0.064512\n0.043171\n0.049878\n0.039756\n0.092317\n0.021463\n...\n0.025225\n0.067633\n0.054838\n0.047161\n0.038874\n0.058250\n0.083841\n0.028516\n0.007677\n0.002315\n\n\n369\n0.077786\n0.067810\n0.065004\n0.012783\n0.071551\n0.039439\n0.046610\n0.033359\n0.083087\n0.015900\n...\n0.026542\n0.064012\n0.069945\n0.046214\n0.036222\n0.049180\n0.084309\n0.052771\n0.017018\n0.002342\n\n\n1054\n0.088742\n0.063003\n0.074057\n0.011843\n0.064424\n0.045476\n0.055582\n0.033633\n0.075162\n0.021159\n...\n0.022461\n0.074185\n0.059633\n0.050775\n0.027365\n0.051882\n0.071813\n0.043499\n0.017083\n0.004587\n\n\n338\n0.076785\n0.070604\n0.071254\n0.012201\n0.072718\n0.043273\n0.052546\n0.035627\n0.088661\n0.019847\n...\n0.022975\n0.062082\n0.069741\n0.047091\n0.034382\n0.040574\n0.074466\n0.042529\n0.010754\n0.002933\n\n\n427\n0.076803\n0.062933\n0.069868\n0.010749\n0.071255\n0.046637\n0.047330\n0.033807\n0.076456\n0.019071\n...\n0.023582\n0.060864\n0.063465\n0.050460\n0.035200\n0.055141\n0.081498\n0.052540\n0.013005\n0.003468\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\n539\n0.022727\n0.000000\n0.000000\n0.000000\n0.068182\n0.000000\n0.068182\n0.295455\n0.090909\n0.022727\n...\n0.022727\n0.090909\n0.000000\n0.000000\n0.000000\n0.000000\n0.045455\n0.000000\n0.000000\n0.000000\n\n\n131\n0.000000\n0.136364\n0.045455\n0.068182\n0.022727\n0.045455\n0.022727\n0.000000\n0.000000\n0.000000\n...\n0.000000\n0.068182\n0.090909\n0.000000\n0.022727\n0.272727\n0.045455\n0.045455\n0.022727\n0.000000\n\n\n538\n0.071429\n0.000000\n0.023810\n0.000000\n0.023810\n0.047619\n0.047619\n0.023810\n0.476190\n0.000000\n...\n0.000000\n0.071429\n0.119048\n0.095238\n0.214286\n0.023810\n0.119048\n0.047619\n0.000000\n0.023810\n\n\n1207\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n...\n0.000000\n0.000000\n0.047619\n0.119048\n0.000000\n0.047619\n0.071429\n0.047619\n0.000000\n0.023810\n\n\n1224\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n...\n0.023810\n0.023810\n0.000000\n0.000000\n0.023810\n0.047619\n0.166667\n0.023810\n0.000000\n0.000000\n\n\n\n\n1169 rows × 943 columns",
    "crumbs": [
      "Motif plot"
    ]
  },
  {
    "objectID": "motif_plot.html#special-motifs",
    "href": "motif_plot.html#special-motifs",
    "title": "Motif plot",
    "section": "Special motifs",
    "text": "Special motifs\n\nCustomized\n\nfrom katlas.pssm import *\n\n\nplot_logos_idx(pssms,412)\n\n\n\n\n\n\n\n\n\n\nMost common\n\ncluster_cnt = df.cluster.value_counts()\n\n\nplot_logos(pssms.head(10),count_dict=cluster_cnt)\n\n\n\n\n\n\n\n\n\n\nMost common y\n\npssms_y = pssms[pssms['0pY']&gt;0.3].copy()\n\n\nidxs_y = pssms_y.index\n\n\nlen(idxs_y)\n\n19\n\n\n\nplot_logos(pssms.loc[idxs_y],count_dict=cluster_cnt)\n\n\n\n\n\n\n\n\n\n\nHighest IC sum\n\nICs = pssms.apply(lambda r: sum(get_IC_flat(r)) ,axis=1)\n\n\nidxs=ICs.sort_values(ascending=False).head(20).index\n\nThe first one is mostly Zinc finger protein\n\nplot_logos(pssms.loc[idxs],count_dict=cluster_cnt)\n\n\n\n\n\n\n\n\n\n\nC-terminal motifs\n\nzeros_right = pssms.apply(lambda r: (recover_pssm(r).loc[:,1:].sum()==0).sum() , axis=1)\n\n\nzeros_right_idxs = zeros_right[zeros_right&gt;0].index\n\n\nzeros_right_idxs\n\nIndex([1150, 1164, 1160, 1134, 1161, 1137, 1140, 1159, 1163, 1155, 1141, 1158,\n       1136, 1165],\n      dtype='int64', name='cluster_new')\n\n\n\nplot_logos(pssms.loc[zeros_right_idxs],count_dict=cluster_cnt)\n\n\n\n\n\n\n\n\n\n\nN-Terminal motifs:\n\nzeros_left = pssms.apply(lambda r: (recover_pssm(r).loc[:,:0].sum()==0).sum() , axis=1)\n\n\nzeros_left_idxs = zeros_left[zeros_left&gt;0].index\n\n\nidxs = zeros_left_idxs[:10]\n\n\n# zeros = pssms.apply(lambda r: (recover_pssm(r).sum()==0).sum() , axis=1)\n\n# idxs = zeros.sort_values(ascending=False).head(10).index\n\n\nplot_logos(pssms.loc[idxs],count_dict=cluster_cnt)",
    "crumbs": [
      "Motif plot"
    ]
  },
  {
    "objectID": "pssms_split_test_psp_02.html",
    "href": "pssms_split_test_psp_02.html",
    "title": "Get kinase-specific PSSMs",
    "section": "",
    "text": "from katlas.core import *\nimport pandas as pd\ndf = Data.get_ks_dataset()\n\nCPU times: user 878 ms, sys: 338 ms, total: 1.22 s\nWall time: 5.63 s\ndf['kinase_id'] = df['kinase_uniprot'] + '_' + df['kinase_protein'].str.split().str[0]\ncnt = df['kinase_id'].value_counts()\nidx = cnt[cnt&gt;=40].index\nidx\n\nIndex(['P12931_SRC', 'P29320_EPHA3', 'P07332_FES', 'Q16288_NTRK3',\n       'Q9UM73_ALK', 'P00519_ABL1', 'P36888_FLT3', 'P29322_EPHA8',\n       'P29323_EPHB2', 'P54762_EPHB1',\n       ...\n       'P35626_GRK3', 'Q99640_PKMYT1', 'Q6P2M8_CAMK1B', 'O00311_CDC7',\n       'Q9NYV4_CDK12', 'Q15746_SMMLCK', 'Q01973_ROR1', 'P15056_BRAF',\n       'Q6P0Q8_MAST2', 'O14976_GAK'],\n      dtype='object', name='kinase_id', length=333)\ndf.shape\n\n(187066, 22)\nWe only evaluate those on kinome tree\ndf = df[df['kinase_id'].isin(idx)].copy()\ndf.shape\n\n(185883, 22)\ndf['site_seq_upper']=df.site_seq.str.upper()\ndf['source_len'] = df.source.str.split('|').str.len()\ndef get_LO_all(pssms,site_type='STY'):\n    out=[]\n    for idx, flat_pssm in pssms.iterrows():\n        out.append(flatten_pssm(get_pssm_LO_flat(flat_pssm,site_type)))\n    return pd.DataFrame(out,index=pssms.index)",
    "crumbs": [
      "Get kinase-specific PSSMs"
    ]
  },
  {
    "objectID": "pssms_split_test_psp_02.html#take-out-20-of-psp-as-test",
    "href": "pssms_split_test_psp_02.html#take-out-20-of-psp-as-test",
    "title": "Get kinase-specific PSSMs",
    "section": "Take out 20% of PSP as test",
    "text": "Take out 20% of PSP as test\n\npsp = df[df.source.str.contains('PSP')].copy()\n\n\ndef sample(group):\n    n = max(1, int(len(group) * 0.2))  # At least 1 row if group is small\n    # weights = group['source_len'].values\n    # weights = weights / weights.sum()  # normalize\n\n    sampled = group.sample(\n        n=n, replace=False, random_state=42\n    )\n\n    # Add back the group key as a column\n    sampled['kinase_uniprot'] = group.name\n    return sampled\n\n\ntest = psp.groupby('kinase_uniprot', group_keys=False)\\\n    .apply(sample,include_groups=False)\n\n\ntest.kinase_group.value_counts()\n\nkinase_group\nCMGC        777\nAGC         511\nTK          387\nCAMK        357\nAtypical    148\nOther       108\nSTE          89\nCK1          63\nTKL          44\nNEK          16\nName: count, dtype: int64\n\n\n\ntest\n\n\n\n\n\n\n\n\nkin_sub_site\nsubstrate_uniprot\nsite\nsource\nsubstrate_genes\nsubstrate_phosphoseq\nposition\nsite_seq\nsub_site\nsubstrate_sequence\n...\nkinase_family\nkinase_subfamily\nkinase_pspa_big\nkinase_pspa_small\nkinase_coral_ID\nnum_kin\nkinase_id\nsite_seq_upper\nsource_len\nkinase_uniprot\n\n\n\n\n160\nO00141_P46527_T157\nP46527\nT157\nSIGNOR|EPSD|PSP\nCDKN1B KIP1 p27\nMSNVRVSNGsPsLERMDARQAEHPKPSACRNLFGPVDHEELTRDLE...\n157\nPsDsQTGLAEQCAGIRKRPAtDDSSTQNKRANRTEENVsDG\nP46527_T157\nMSNVRVSNGSPSLERMDARQAEHPKPSACRNLFGPVDHEELTRDLE...\n...\nSGK\nSGK\nBasophilic\nAkt/rock\nSGK1\n6\nO00141_SGK1\nPSDSQTGLAEQCAGIRKRPATDDSSTQNKRANRTEENVSDG\n3\nO00141\n\n\n309\nO00141_Q96J92_S1217\nQ96J92\nS1217\nEPSD|PSP\nWNK4 PRKWNK4\nMLASPATETTVLMSQTEADLALRPPPPLGTAGQPRLGPPPRRARRF...\n1217\nSRRNsLQRSEPPGPGIMRRNsLsGsSTGSQEQRASKGVTFA\nQ96J92_S1217\nMLASPATETTVLMSQTEADLALRPPPPLGTAGQPRLGPPPRRARRF...\n...\nSGK\nSGK\nBasophilic\nAkt/rock\nSGK1\n1\nO00141_SGK1\nSRRNSLQRSEPPGPGIMRRNSLSGSSTGSQEQRASKGVTFA\n2\nO00141\n\n\n369\nO00141_Q9UN36_S346\nQ9UN36\nS346\nEPSD|PSP\nNDRG2 KIAA1248 SYLD\nMAELQEVQITEEKPLLPGQTPEAAKEAELAARILLDQGQTHSVETP...\n346\nsRsRtAsLtsAAsVDGNRsRsRtLsQssEsGtLsSGPPGHT\nQ9UN36_S346\nMAELQEVQITEEKPLLPGQTPEAAKEAELAARILLDQGQTHSVETP...\n...\nSGK\nSGK\nBasophilic\nAkt/rock\nSGK1\n1\nO00141_SGK1\nSRSRTASLTSAASVDGNRSRSRTLSQSSESGTLSSGPPGHT\n2\nO00141\n\n\n39\nO00141_O60343_T642\nO60343\nT642\nGPS6|PSP\nTBC1D4 AS160 KIAA0603\nMEPPSCIQDEPFPHPLEPEPGVSAQPGPGKPSDKRFRLWYVGGSCL...\n642\nAWQTFPEEDSDSPQFRRRAHtFsHPPsstKRKLNLQDGRAQ\nO60343_T642\nMEPPSCIQDEPFPHPLEPEPGVSAQPGPGKPSDKRFRLWYVGGSCL...\n...\nSGK\nSGK\nBasophilic\nAkt/rock\nSGK1\n4\nO00141_SGK1\nAWQTFPEEDSDSPQFRRRAHTFSHPPSSTKRKLNLQDGRAQ\n2\nO00141\n\n\n314\nO00141_Q96PU5_S448\nQ96PU5\nS448\nGPS6|SIGNOR|ELM|EPSD|PSP\nNEDD4L KIAA0439 NEDL3\nMATGLGEPVYGLsEDEGESRILRVKVVSGIDLAKKDIFGASDPYVK...\n448\nsATNSNNHLIEPQIRRPRsLssPtVTLSAPLEGAKDsPVRR\nQ96PU5_S448\nMATGLGEPVYGLSEDEGESRILRVKVVSGIDLAKKDIFGASDPYVK...\n...\nSGK\nSGK\nBasophilic\nAkt/rock\nSGK1\n4\nO00141_SGK1\nSATNSNNHLIEPQIRRPRSLSSPTVTLSAPLEGAKDSPVRR\n5\nO00141\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\n185492\nQ9Y4K4_P49841_S9\nP49841\nS9\nSIGNOR|EPSD|PSP\nGSK3B\nMSGRPRttsFAEsCKPVQQPsAFGsMKVSRDKDGSKVTTVVAtPGQ...\n9\n____________MSGRPRttsFAEsCKPVQQPsAFGsMKVS\nP49841_S9\nMSGRPRTTSFAESCKPVQQPSAFGSMKVSRDKDGSKVTTVVATPGQ...\n...\nSTE20\nKHS\nMap4k\nMap4k\nKHS1\n25\nQ9Y4K4_KHS1\n____________MSGRPRTTSFAESCKPVQQPSAFGSMKVS\n3\nQ9Y4K4\n\n\n185874\nQ9Y5S2_O43255_S6\nO43255\nS6\nPSP\nSIAH2\nMSRPsstGPsANKPCsKQPPPQPQHtPsPAAPPAAATISAAGPGSS...\n6\n_______________MSRPsstGPsANKPCsKQPPPQPQHt\nO43255_S6\nMSRPSSTGPSANKPCSKQPPPQPQHTPSPAAPPAAATISAAGPGSS...\n...\nDMPK\nGEK\nBasophilic\nAkt/rock\nMRCKb\n1\nQ9Y5S2_MRCKB\n_______________MSRPSSTGPSANKPCSKQPPPQPQHT\n1\nQ9Y5S2\n\n\n186807\nQ9Y6E0_Q9Y2K2_T221\nQ9Y2K2\nT221\nPSP\nSIK3 KIAA0999 QSK L19\nMAAAAASGAGGAAGAGTGGAGPAGRLLPPPAPGSPAAPAAVSPAAG...\n221\nNIKIADFGFSNLFTPGQLLKtWCGSPPYAAPELFEGKEYDG\nQ9Y2K2_T221\nMAAAAASGAGGAAGAGTGGAGPAGRLLPPPAPGSPAAPAAVSPAAG...\n...\nSTE20\nYSK\nMap4k\nMap4k\nMST3\n5\nQ9Y6E0_MST3\nNIKIADFGFSNLFTPGQLLKTWCGSPPYAAPELFEGKEYDG\n1\nQ9Y6E0\n\n\n186392\nQ9Y6E0_P57059_T182\nP57059\nT182\nPSP\nSIK1 SIK SNF1LK\nMVIMSEFSADPAGQGQGQQKPLRVGFYDIERTLGKGNFAVVKLARH...\n182\nDIKLADFGFGNFYKSGEPLStWCGsPPYAAPEVFEGKEYEG\nP57059_T182\nMVIMSEFSADPAGQGQGQQKPLRVGFYDIERTLGKGNFAVVKLARH...\n...\nSTE20\nYSK\nMap4k\nMap4k\nMST3\n3\nQ9Y6E0_MST3\nDIKLADFGFGNFYKSGEPLSTWCGSPPYAAPEVFEGKEYEG\n1\nQ9Y6E0\n\n\n186845\nQ9Y6M4_O75581_S1490\nO75581\nS1490\nPSP\nLRP6\nMGAVLRSLLACSFCVLLRAAPLLLYANRRDLRLVDATNGKENATIV...\n1490\nSSSSssTKGtYFPAILNPPPsPAtERsHYTMEFGYSsNsPs\nO75581_S1490\nMGAVLRSLLACSFCVLLRAAPLLLYANRRDLRLVDATNGKENATIV...\n...\nCK1\nCK1\nAcidophilic\nCk1\nCK1g3\n12\nQ9Y6M4_CK1G3\nSSSSSSTKGTYFPAILNPPPSPATERSHYTMEFGYSSNSPS\n1\nQ9Y6M4\n\n\n\n\n2500 rows × 24 columns\n\n\n\n\ntest.to_parquet('out/CDDM_test_set.parquet')\n\n\ntest.head()\n\n\n\n\n\n\n\n\nkin_sub_site\nsubstrate_uniprot\nsite\nsource\nsubstrate_genes\nsubstrate_phosphoseq\nposition\nsite_seq\nsub_site\nsubstrate_sequence\n...\nkinase_family\nkinase_subfamily\nkinase_pspa_big\nkinase_pspa_small\nkinase_coral_ID\nnum_kin\nkinase_id\nsite_seq_upper\nsource_len\nkinase_uniprot\n\n\n\n\n160\nO00141_P46527_T157\nP46527\nT157\nSIGNOR|EPSD|PSP\nCDKN1B KIP1 p27\nMSNVRVSNGsPsLERMDARQAEHPKPSACRNLFGPVDHEELTRDLE...\n157\nPsDsQTGLAEQCAGIRKRPAtDDSSTQNKRANRTEENVsDG\nP46527_T157\nMSNVRVSNGSPSLERMDARQAEHPKPSACRNLFGPVDHEELTRDLE...\n...\nSGK\nSGK\nBasophilic\nAkt/rock\nSGK1\n6\nO00141_SGK1\nPSDSQTGLAEQCAGIRKRPATDDSSTQNKRANRTEENVSDG\n3\nO00141\n\n\n309\nO00141_Q96J92_S1217\nQ96J92\nS1217\nEPSD|PSP\nWNK4 PRKWNK4\nMLASPATETTVLMSQTEADLALRPPPPLGTAGQPRLGPPPRRARRF...\n1217\nSRRNsLQRSEPPGPGIMRRNsLsGsSTGSQEQRASKGVTFA\nQ96J92_S1217\nMLASPATETTVLMSQTEADLALRPPPPLGTAGQPRLGPPPRRARRF...\n...\nSGK\nSGK\nBasophilic\nAkt/rock\nSGK1\n1\nO00141_SGK1\nSRRNSLQRSEPPGPGIMRRNSLSGSSTGSQEQRASKGVTFA\n2\nO00141\n\n\n369\nO00141_Q9UN36_S346\nQ9UN36\nS346\nEPSD|PSP\nNDRG2 KIAA1248 SYLD\nMAELQEVQITEEKPLLPGQTPEAAKEAELAARILLDQGQTHSVETP...\n346\nsRsRtAsLtsAAsVDGNRsRsRtLsQssEsGtLsSGPPGHT\nQ9UN36_S346\nMAELQEVQITEEKPLLPGQTPEAAKEAELAARILLDQGQTHSVETP...\n...\nSGK\nSGK\nBasophilic\nAkt/rock\nSGK1\n1\nO00141_SGK1\nSRSRTASLTSAASVDGNRSRSRTLSQSSESGTLSSGPPGHT\n2\nO00141\n\n\n39\nO00141_O60343_T642\nO60343\nT642\nGPS6|PSP\nTBC1D4 AS160 KIAA0603\nMEPPSCIQDEPFPHPLEPEPGVSAQPGPGKPSDKRFRLWYVGGSCL...\n642\nAWQTFPEEDSDSPQFRRRAHtFsHPPsstKRKLNLQDGRAQ\nO60343_T642\nMEPPSCIQDEPFPHPLEPEPGVSAQPGPGKPSDKRFRLWYVGGSCL...\n...\nSGK\nSGK\nBasophilic\nAkt/rock\nSGK1\n4\nO00141_SGK1\nAWQTFPEEDSDSPQFRRRAHTFSHPPSSTKRKLNLQDGRAQ\n2\nO00141\n\n\n314\nO00141_Q96PU5_S448\nQ96PU5\nS448\nGPS6|SIGNOR|ELM|EPSD|PSP\nNEDD4L KIAA0439 NEDL3\nMATGLGEPVYGLsEDEGESRILRVKVVSGIDLAKKDIFGASDPYVK...\n448\nsATNSNNHLIEPQIRRPRsLssPtVTLSAPLEGAKDsPVRR\nQ96PU5_S448\nMATGLGEPVYGLSEDEGESRILRVKVVSGIDLAKKDIFGASDPYVK...\n...\nSGK\nSGK\nBasophilic\nAkt/rock\nSGK1\n4\nO00141_SGK1\nSATNSNNHLIEPQIRRPRSLSSPTVTLSAPLEGAKDSPVRR\n5\nO00141\n\n\n\n\n5 rows × 24 columns\n\n\n\n\ndf.shape\n\n(185883, 24)\n\n\n\ndf_eval = df[~df.index.isin(test.index)]\n\n\ndf_eval.shape\n\n(183383, 24)\n\n\n\nGet eval PSSMs\n\npssms = get_cluster_pssms(df_eval,\n                          cluster_col = 'kinase_id',\n                          count_thr=None, # since we already filtered, we set None here\n                          valid_thr=None)\n\n100%|███████████████████████████████████████████████████████████████████████████| 333/333 [00:11&lt;00:00, 30.25it/s]\n\n\n\npssms.shape\n\n(333, 943)\n\n\n\npssms_upper = get_cluster_pssms(df_eval,\n                                     seq_col='site_seq_upper',\n                          cluster_col = 'kinase_id',\n                          count_thr=None, # since we already filtered, we set None here\n                          valid_thr=None)\n\n100%|███████████████████████████████████████████████████████████████████████████| 333/333 [00:11&lt;00:00, 29.50it/s]\n\n\n\n\nLO of eval PSSMs\n\nLO = get_LO_all(pssms)\n\n\nLO_upper = get_LO_all(pssms_upper,'STY_upper')\n\n\nLO.shape\n\n(333, 943)",
    "crumbs": [
      "Get kinase-specific PSSMs"
    ]
  },
  {
    "objectID": "pssms_split_test_psp_02.html#remove-isoform-and-pseudo-gene",
    "href": "pssms_split_test_psp_02.html#remove-isoform-and-pseudo-gene",
    "title": "Get kinase-specific PSSMs",
    "section": "Remove isoform and pseudo gene",
    "text": "Remove isoform and pseudo gene\n\ninfo= Data.get_kinase_info()\n\n\ninfo = info[info.pseudo=='0'].copy()\n\n\ninfo['id'] = info.uniprot+'_'+info.kinase\n\n\nLO[~LO.index.isin(info.id)]\n\n\n\n\n\n\n\n\n-20P\n-20G\n-20A\n-20C\n-20S\n-20T\n-20V\n-20I\n-20L\n-20M\n...\n20H\n20K\n20R\n20Q\n20N\n20D\n20E\n20pS\n20pT\n20pY\n\n\n\n\nP07948-2_LYN\n-0.695061\n0.248942\n-0.181606\n-0.523522\n-0.241880\n-0.087184\n0.270835\n0.248626\n-0.177055\n0.151905\n...\n-1.002663\n0.187090\n-0.131176\n-0.477873\n0.089392\n-0.069890\n0.272381\n-0.624875\n-0.293957\n0.686397\n\n\nO60566_BUB1B\n-0.098063\n0.177522\n0.006417\n-2.364642\n-0.336759\n-0.656228\n0.622357\n0.285512\n-1.214575\n-1.313708\n...\n0.538365\n0.313082\n-0.184508\n-1.521805\n0.314920\n0.267606\n0.993983\n-0.586346\n-0.015962\n-0.647041\n\n\nP05771-2_PKCB\n-0.513296\n0.082197\n-0.419347\n0.153007\n0.387344\n0.446387\n1.033094\n1.359558\n-0.959957\n-0.059090\n...\n1.086193\n-0.296631\n-0.264711\n-1.710942\n0.415289\n0.443465\n0.117313\n0.283410\n-0.205099\n-0.099214\n\n\nQ13976-2_PKG1\n0.267160\n-0.880855\n0.326552\n-20.552054\n-0.980098\n-0.599127\n0.959565\n-0.422922\n-0.420509\n-0.841570\n...\n0.565165\n0.388792\n0.076757\n0.183066\n-0.243242\n-0.843097\n-0.192211\n0.440454\n-1.311089\n1.379757\n\n\n\n\n4 rows × 943 columns\n\n\n\n\nLO = LO[LO.index.isin(info.id)]\nLO_upper =LO_upper[LO_upper.index.isin(info.id)]\n\n\npssms= pssms[pssms.index.isin(info.id)]\npssms_upper = pssms_upper[pssms_upper.index.isin(info.id)]\n\n\nLO.shape,pssms.shape\n\n((329, 943), (329, 943))\n\n\n\npssms.to_parquet('out/CDDM_pssms_eval_psp_02.parquet')\npssms_upper.to_parquet('out/CDDM_pssms_eval_upper_psp_02.parquet')\n\nLO.to_parquet('out/CDDM_pssms_LO_eval_psp_02.parquet')\nLO_upper.to_parquet('out/CDDM_pssms_LO_eval_upper_psp_02.parquet')",
    "crumbs": [
      "Get kinase-specific PSSMs"
    ]
  },
  {
    "objectID": "pssms_split_test_no_psp.html",
    "href": "pssms_split_test_no_psp.html",
    "title": "Get kinase-specific PSSMs",
    "section": "",
    "text": "from katlas.core import *\nimport pandas as pd\ndf = Data.get_ks_dataset()\n\nCPU times: user 871 ms, sys: 369 ms, total: 1.24 s\nWall time: 5.33 s\ndf['kinase_id'] = df['kinase_uniprot'] + '_' + df['kinase_protein'].str.split().str[0]\ncnt = df['kinase_id'].value_counts()\nidx = cnt[cnt&gt;=40].index\nidx\n\nIndex(['P12931_SRC', 'P29320_EPHA3', 'P07332_FES', 'Q16288_NTRK3',\n       'Q9UM73_ALK', 'P00519_ABL1', 'P36888_FLT3', 'P29322_EPHA8',\n       'P29323_EPHB2', 'P54762_EPHB1',\n       ...\n       'P35626_GRK3', 'Q99640_PKMYT1', 'Q6P2M8_CAMK1B', 'O00311_CDC7',\n       'Q9NYV4_CDK12', 'Q15746_SMMLCK', 'Q01973_ROR1', 'P15056_BRAF',\n       'Q6P0Q8_MAST2', 'O14976_GAK'],\n      dtype='object', name='kinase_id', length=333)\ndf.shape\n\n(187066, 22)\ndf = df[df['kinase_id'].isin(idx)].copy()\ndf['site_seq_upper'] = df.site_seq.str.upper()\ntest = df[df.source.str.contains('PSP')].copy()\ndf_eval = df[~df.source.str.contains('PSP')].copy()",
    "crumbs": [
      "Get kinase-specific PSSMs"
    ]
  },
  {
    "objectID": "pssms_split_test_no_psp.html#drop-isoform-and-pseudokinase",
    "href": "pssms_split_test_no_psp.html#drop-isoform-and-pseudokinase",
    "title": "Get kinase-specific PSSMs",
    "section": "Drop isoform and pseudokinase",
    "text": "Drop isoform and pseudokinase\n\ninfo= Data.get_kinase_info()\n\n\ninfo = info[info.pseudo=='0'].copy()\n\n\ninfo['id'] = info.uniprot+'_'+info.kinase\n\n\nLO[~LO.index.isin(info.id)]\n\n\n\n\n\n\n\n\n-20P\n-20G\n-20A\n-20C\n-20S\n-20T\n-20V\n-20I\n-20L\n-20M\n...\n20H\n20K\n20R\n20Q\n20N\n20D\n20E\n20pS\n20pT\n20pY\n\n\n\n\nP07948-2_LYN\n-0.695061\n0.248942\n-0.181606\n-0.523522\n-0.241880\n-0.087184\n0.270835\n0.248626\n-0.177055\n0.151905\n...\n-1.002663\n0.187090\n-0.131176\n-0.477873\n0.089392\n-0.069890\n0.272381\n-0.624875\n-0.293957\n0.686397\n\n\nO60566_BUB1B\n-0.098063\n0.177522\n0.006417\n-2.364642\n-0.336759\n-0.656228\n0.622357\n0.285512\n-1.214575\n-1.313708\n...\n0.538365\n0.313082\n-0.184508\n-1.521805\n0.314920\n0.267606\n0.993983\n-0.586346\n-0.015962\n-0.647041\n\n\nP05771-2_PKCB\n-0.513296\n0.082197\n-0.419347\n0.153007\n0.387344\n0.446387\n1.033094\n1.359558\n-0.959957\n-0.059090\n...\n1.086193\n-0.296631\n-0.264711\n-1.710942\n0.415289\n0.443465\n0.117313\n0.283410\n-0.205099\n-0.099214\n\n\nQ13976-2_PKG1\n0.267160\n-0.880855\n0.326552\n-20.552054\n-0.980098\n-0.599127\n0.959565\n-0.422922\n-0.420509\n-0.841570\n...\n0.565165\n0.388792\n0.076757\n0.183066\n-0.243242\n-0.843097\n-0.192211\n0.440454\n-1.311089\n1.379757\n\n\n\n\n4 rows × 943 columns\n\n\n\n\nLO = LO[LO.index.isin(info.id)]\nLO_upper =LO_upper[LO_upper.index.isin(info.id)]\n\n\npssms= pssms[pssms.index.isin(info.id)]\npssms_upper = pssms_upper[pssms_upper.index.isin(info.id)]\n\n\nLO.shape,pssms.shape\n\n((328, 943), (328, 943))\n\n\n\npssms.to_parquet('out/CDDM_pssms_eval_no_psp.parquet')\npssms_upper.to_parquet('out/CDDM_pssms_eval_upper_no_psp.parquet')\n\nLO.to_parquet('out/CDDM_pssms_LO_eval_no_psp.parquet')\nLO_upper.to_parquet('out/CDDM_pssms_LO_eval_upper_no_psp.parquet')",
    "crumbs": [
      "Get kinase-specific PSSMs"
    ]
  },
  {
    "objectID": "reactome_path_plot_cddm.html",
    "href": "reactome_path_plot_cddm.html",
    "title": "Plot reactome pathways: CDDM",
    "section": "",
    "text": "from katlas.pssm import *\nfrom katlas.score import *\nfrom katlas.data import *\nfrom katlas.plot import *\nfrom katlas.pathway import *\nfrom katlas.utils import *\nimport pandas as pd,seaborn as sns\nfrom matplotlib import pyplot as plt\nfrom tqdm import tqdm\nimport time, random",
    "crumbs": [
      "Plot reactome pathways: CDDM"
    ]
  },
  {
    "objectID": "reactome_path_plot_cddm.html#data",
    "href": "reactome_path_plot_cddm.html#data",
    "title": "Plot reactome pathways: CDDM",
    "section": "Data",
    "text": "Data\n\ncddm_info=pd.read_parquet('raw/cddm_path_info.parquet')\ndf=pd.read_parquet('raw/cddm_score_df.parquet')\n\n\nthr_cols = ['S_thr','T_thr','Y_thr']\ngene_cols = ['S_genes','T_genes','Y_genes']\ncnt_cols = ['S_cnt','T_cnt','Y_cnt']\nsite_cols = ['S_sites','T_sites','Y_sites']",
    "crumbs": [
      "Plot reactome pathways: CDDM"
    ]
  },
  {
    "objectID": "reactome_path_plot_cddm.html#site-pssms",
    "href": "reactome_path_plot_cddm.html#site-pssms",
    "title": "Plot reactome pathways: CDDM",
    "section": "Site pssms",
    "text": "Site pssms\n\nhuman_site= Data.get_human_site()\nseq_map = human_site.set_index('sub_site')['site_seq']\n\n\nseries=cddm_info.iloc[0]\n\n\ndef get_site_pssm(series):\n    pssm_dict = {}\n    count_dict={}\n    for acceptor, sites in zip(['S','T','Y'],series[site_cols]):\n        sites=list(sites)\n        if sites:\n            pssm = get_prob(seq_map[sites])\n            key = series.name+'_'+acceptor\n            pssm_dict[key] = pd.Series(flatten_pssm(pssm))\n            count_dict[key]=len(sites)\n    return pssm_dict,count_dict\n\n\npssm_out = {}\ncount_out = {}\nfor i,r in cddm_info.iterrows():\n    pssms,counts = get_site_pssm(r)\n    pssm_out.update(pssms)\n    count_out.update(counts)\n    # break\n\n\nsite_pssms = pd.DataFrame(pssm_out).T\n\n\nfor k in tqdm(cddm_info.index,total=len(cddm_info)):\n    k_pssms = site_pssms[site_pssms.index.str.contains(f'{k}_')]\n    plot_logos(k_pssms,count_dict=count_out)\n    path = prepare_path(f'fig/cddm/{k}/path/logo.svg')\n    save_show(path,show_only=False)\n    plt.close('all')\n    # break\n\n100%|█████████████████████████████████████████████████████████| 328/328 [43:05&lt;00:00,  7.88s/it]\n\n\n\nsite_pssms.to_parquet('raw/cddm_site_pssm.parquet')",
    "crumbs": [
      "Plot reactome pathways: CDDM"
    ]
  },
  {
    "objectID": "reactome_path_plot_cddm.html#plot-distribution",
    "href": "reactome_path_plot_cddm.html#plot-distribution",
    "title": "Plot reactome pathways: CDDM",
    "section": "Plot distribution",
    "text": "Plot distribution\n\ndef plot_hist(df,\n              kinase,\n              sty_thr=None, # dict of thresholds per acceptor\n              hue='acceptor'):\n    \n    \"Plot histogram of a column (kinase). \"\n    \n    plt.figure(figsize=(6,2))\n\n    hist_params = {'element':'poly',\n              'edgecolor': None,\n              'alpha':0.5,\n              'bins':100,\n              'kde':True,\n              'palette':sty_color}\n    \n    sns.histplot(data=df,x=kinase,hue=hue,**hist_params)\n    \n    plt.xlabel('')\n    plt.title(f'{kinase} score distribution')\n\n    if sty_thr:\n        for acceptor,thr in sty_thr.items():\n            if thr is not None:\n                plt.axvline(thr,color=sty_color[acceptor])\n\n\nplot_hist(df,'AKT1')\n\n\n\n\n\n\n\n\n\nfor k,r in tqdm(cddm_info.iterrows(),total=len(cddm_info)):\n    sty_thr=r[thr_cols].rename(index={'S_thr':'S','T_thr':'T','Y_thr':'Y'})[lambda x: x!=0].to_dict()\n    plot_hist(df,k,sty_thr=sty_thr)\n    save_show(f'fig/cddm/{k}/path/hist.svg',show_only=False)\nplt.close('all')\n\n100%|█████████████████████████████████████████████████████████| 328/328 [03:14&lt;00:00,  1.68it/s]",
    "crumbs": [
      "Plot reactome pathways: CDDM"
    ]
  },
  {
    "objectID": "reactome_path_plot_cddm.html#plot-reactome-pathway",
    "href": "reactome_path_plot_cddm.html#plot-reactome-pathway",
    "title": "Plot reactome pathways: CDDM",
    "section": "Plot reactome pathway",
    "text": "Plot reactome pathway\n\ninfo = Data.get_kinase_info()\n\n\ninfo = info[info.pseudo=='0']\n\n\ninfo.uniprot.duplicated().sum()\n\nnp.int64(0)\n\n\n\nkinase_map = info.set_index('kinase')['uniprot']\n\n\ndef get_path(series):\n    out = get_reactome(series['genes'],p_type='p')\n    kinase=series.name.split('_')[0] # for those with _TRY, need to remove that\n    uniprot = kinase_map[kinase]\n    out = add_reactome_ref(out,uniprot)\n    exclude=['GTPase','SUMO']\n    out = out[~out.name.str.contains('|'.join(exclude))]\n    return out\n\n\nshow_only=False\n\n\ncddm_info.index.get_loc('YSK1')\n\n96\n\n\n\nlen(cddm_info)\n\n328\n\n\n\nfor i,(k,r) in enumerate(cddm_info.iterrows()):\n    print(i,':',k)\n    save_dir = f'fig/cddm/{k}/path'\n    \n    path_df = get_path(r)\n    path_df.to_parquet(f'{save_dir}/path.parquet')\n\n    plot_path(path_df,p_type='p',ref_col='ref_path',top_n=15,max_label_length=55)\n    plt.title('Reactome pathways of substrates based on scores')\n    save_show(f'{save_dir}/path.svg',show_only=show_only)\n\n    if path_df.ref_path.sum()!=0:\n        accuracy = get_overlap(path_df, ref_col='ref_path',plot=True,p_type='p',figsize=(5,3))\n        plt.title(f'Distribution of –log₁₀(p) for reference pathways')\n        save_show(f'{save_dir}/overlap.svg',show_only=show_only)\n\n    if path_df.ref_path_lowest.sum()!=0:\n        accuracy_lo = get_overlap(path_df, ref_col='ref_path_lowest',plot=True,p_type='p',figsize=(5,3))\n        plt.title(f'Distribution of –log₁₀(p) for reference pathways \\n(lowest-level)')\n        save_show(f'{save_dir}/overlap_lo.svg',show_only=show_only)\n    plt.close('all')\n    # break\n    \n    # ✅ polite delay to avoid API throttling\n    delay = random.uniform(1.5, 4)\n    print(f\"Sleeping {delay:.2f}s before next kinase...\")\n    time.sleep(delay)\n\n0 : SRC\nRunning pathway anlysis\nDone\nSleeping 3.98s before next kinase...\n1 : EPHA3\nRunning pathway anlysis\nDone\nSleeping 1.77s before next kinase...\n2 : FES\nRunning pathway anlysis\nDone\nSleeping 2.18s before next kinase...\n3 : NTRK3\nRunning pathway anlysis\nDone\nSleeping 3.29s before next kinase...\n4 : ALK\nRunning pathway anlysis\nDone\nSleeping 3.96s before next kinase...\n5 : ABL1\nRunning pathway anlysis\nDone\nSleeping 2.73s before next kinase...\n6 : FLT3\nRunning pathway anlysis\nDone\nSleeping 2.95s before next kinase...\n7 : EPHA8\nRunning pathway anlysis\nDone\nSleeping 1.94s before next kinase...\n8 : EPHB2\nRunning pathway anlysis\nDone\nSleeping 3.69s before next kinase...\n9 : EPHB1\nRunning pathway anlysis\nDone\nSleeping 2.95s before next kinase...\n10 : RET\nRunning pathway anlysis\nDone\nSleeping 2.36s before next kinase...\n11 : FYN\nRunning pathway anlysis\nDone\nSleeping 3.14s before next kinase...\n12 : FER\nRunning pathway anlysis\nDone\nSleeping 1.84s before next kinase...\n13 : INSR\nRunning pathway anlysis\nDone\nSleeping 3.89s before next kinase...\n14 : MUSK\nRunning pathway anlysis\nDone\nSleeping 2.47s before next kinase...\n15 : EPHB3\nRunning pathway anlysis\nDone\nSleeping 1.56s before next kinase...\n16 : EPHB4\nRunning pathway anlysis\nDone\nSleeping 3.63s before next kinase...\n17 : NTRK1\nRunning pathway anlysis\nDone\nSleeping 3.03s before next kinase...\n18 : TYRO3\nRunning pathway anlysis\nDone\nSleeping 3.11s before next kinase...\n19 : ROS1\nRunning pathway anlysis\nDone\nSleeping 3.30s before next kinase...\n20 : MET\nRunning pathway anlysis\nDone\nSleeping 2.40s before next kinase...\n21 : SYK\nRunning pathway anlysis\nDone\nSleeping 2.55s before next kinase...\n22 : TNK1\nRunning pathway anlysis\nDone\nSleeping 2.43s before next kinase...\n23 : FLT4\nRunning pathway anlysis\nDone\nSleeping 1.53s before next kinase...\n24 : YES1\nRunning pathway anlysis\nDone\nSleeping 2.50s before next kinase...\n25 : BMX\nRunning pathway anlysis\nDone\nSleeping 3.36s before next kinase...\n26 : ERK2\nRunning pathway anlysis\nDone\nSleeping 2.63s before next kinase...\n27 : PKACA\nRunning pathway anlysis\nDone\nSleeping 3.91s before next kinase...\n28 : LTK\nRunning pathway anlysis\nDone\nSleeping 2.90s before next kinase...\n29 : FGFR1\nRunning pathway anlysis\nDone\nSleeping 3.38s before next kinase...\n30 : FRK\nRunning pathway anlysis\nDone\nSleeping 2.72s before next kinase...\n31 : EPHA5\nRunning pathway anlysis\nDone\nSleeping 2.92s before next kinase...\n32 : TEK\nRunning pathway anlysis\nDone\nSleeping 3.88s before next kinase...\n33 : LCK\nRunning pathway anlysis\nDone\nSleeping 1.94s before next kinase...\n34 : CDK1\nRunning pathway anlysis\nDone\nSleeping 1.60s before next kinase...\n35 : LYN\nRunning pathway anlysis\nDone\nSleeping 2.90s before next kinase...\n36 : MST1R\nRunning pathway anlysis\nDone\nSleeping 3.27s before next kinase...\n37 : IKKB\nRunning pathway anlysis\nDone\nSleeping 3.81s before next kinase...\n38 : FGFR2\nRunning pathway anlysis\nDone\nSleeping 3.32s before next kinase...\n39 : CDK2\nRunning pathway anlysis\nDone\nSleeping 2.22s before next kinase...\n40 : FGR\nRunning pathway anlysis\nDone\nSleeping 3.88s before next kinase...\n41 : SRMS\nRunning pathway anlysis\nDone\nSleeping 1.81s before next kinase...\n42 : JAK3\nRunning pathway anlysis\nDone\nSleeping 1.75s before next kinase...\n43 : TEC\nRunning pathway anlysis\nDone\nSleeping 2.32s before next kinase...\n44 : PDGFRA\nRunning pathway anlysis\nDone\nSleeping 1.66s before next kinase...\n45 : EPHA1\nRunning pathway anlysis\nDone\nSleeping 3.39s before next kinase...\n46 : ERK1\nRunning pathway anlysis\nDone\nSleeping 2.55s before next kinase...\n47 : IGF1R\nRunning pathway anlysis\nDone\nSleeping 2.01s before next kinase...\n48 : EPHA2\nRunning pathway anlysis\nDone\nSleeping 1.53s before next kinase...\n49 : AXL\nRunning pathway anlysis\nDone\nSleeping 2.36s before next kinase...\n50 : INSRR\nRunning pathway anlysis\nDone\nSleeping 3.09s before next kinase...\n51 : PKCA\nRunning pathway anlysis\nDone\nSleeping 2.38s before next kinase...\n52 : BTK\nRunning pathway anlysis\nDone\nSleeping 2.88s before next kinase...\n53 : BLK\nRunning pathway anlysis\nDone\nSleeping 3.56s before next kinase...\n54 : MERTK\nRunning pathway anlysis\nDone\nSleeping 1.66s before next kinase...\n55 : ERBB4\nRunning pathway anlysis\nDone\nSleeping 3.64s before next kinase...\n56 : EPHA7\nRunning pathway anlysis\nDone\nSleeping 1.72s before next kinase...\n57 : JAK2\nRunning pathway anlysis\nDone\nSleeping 2.83s before next kinase...\n58 : HCK\nRunning pathway anlysis\nDone\nSleeping 2.63s before next kinase...\n59 : PTK6\nRunning pathway anlysis\nDone\nSleeping 2.23s before next kinase...\n60 : PDGFRB\nRunning pathway anlysis\nDone\nSleeping 3.30s before next kinase...\n61 : MLK1\nRunning pathway anlysis\nDone\nSleeping 3.62s before next kinase...\n62 : JNK1\nRunning pathway anlysis\nDone\nSleeping 3.77s before next kinase...\n63 : ABL2\nRunning pathway anlysis\nDone\nSleeping 3.98s before next kinase...\n64 : P38A\nRunning pathway anlysis\nDone\nSleeping 3.98s before next kinase...\n65 : KDR\nRunning pathway anlysis\nDone\nSleeping 3.05s before next kinase...\n66 : NEK6\nRunning pathway anlysis\nDone\nSleeping 3.35s before next kinase...\n67 : EPHA6\nRunning pathway anlysis\nDone\nSleeping 3.38s before next kinase...\n68 : PLK1\nRunning pathway anlysis\nDone\nSleeping 3.46s before next kinase...\n69 : PTK2B\nRunning pathway anlysis\nDone\nSleeping 3.93s before next kinase...\n70 : HGK\nRunning pathway anlysis\nDone\nSleeping 2.89s before next kinase...\n71 : MST1\nRunning pathway anlysis\nDone\nSleeping 1.87s before next kinase...\n72 : CK2A1\nRunning pathway anlysis\nDone\nSleeping 3.12s before next kinase...\n73 : MST3\nRunning pathway anlysis\nDone\nSleeping 3.50s before next kinase...\n74 : TTBK1\nRunning pathway anlysis\nDone\nSleeping 3.65s before next kinase...\n75 : NTRK2\nRunning pathway anlysis\nDone\nSleeping 3.24s before next kinase...\n76 : IKKE\nRunning pathway anlysis\nDone\nSleeping 2.24s before next kinase...\n77 : DDR2\nRunning pathway anlysis\nDone\nSleeping 3.92s before next kinase...\n78 : MST2\nRunning pathway anlysis\nDone\nSleeping 1.59s before next kinase...\n79 : NEK2\nRunning pathway anlysis\nDone\nSleeping 1.64s before next kinase...\n80 : P38D\nRunning pathway anlysis\nDone\nSleeping 3.94s before next kinase...\n81 : EGFR\nRunning pathway anlysis\nDone\nSleeping 1.71s before next kinase...\n82 : NEK7\nRunning pathway anlysis\nDone\nSleeping 2.05s before next kinase...\n83 : DYRK2\nRunning pathway anlysis\nDone\nSleeping 3.52s before next kinase...\n84 : MINK\nRunning pathway anlysis\nDone\nSleeping 2.54s before next kinase...\n85 : TXK\nRunning pathway anlysis\nDone\nSleeping 3.38s before next kinase...\n86 : CSF1R\nRunning pathway anlysis\nDone\nSleeping 2.40s before next kinase...\n87 : NEK1\nRunning pathway anlysis\nDone\nSleeping 3.38s before next kinase...\n88 : ZAP70\nRunning pathway anlysis\nDone\nSleeping 1.60s before next kinase...\n89 : MST4\nRunning pathway anlysis\nDone\nSleeping 2.67s before next kinase...\n90 : RSK3\nRunning pathway anlysis\nDone\nSleeping 2.14s before next kinase...\n91 : KHS1\nRunning pathway anlysis\nDone\nSleeping 2.08s before next kinase...\n92 : CHK1\nRunning pathway anlysis\nDone\nSleeping 2.58s before next kinase...\n93 : QIK\nRunning pathway anlysis\nDone\nSleeping 2.27s before next kinase...\n94 : CK1D\nRunning pathway anlysis\nDone\nSleeping 2.55s before next kinase...\n95 : FGFR3\nRunning pathway anlysis\nDone\nSleeping 1.61s before next kinase...\n96 : YSK1\nRunning pathway anlysis\nDone\nSleeping 1.86s before next kinase...\n97 : KIT\nRunning pathway anlysis\nDone\nSleeping 3.24s before next kinase...\n98 : P38G\nRunning pathway anlysis\nDone\nSleeping 1.86s before next kinase...\n99 : TNIK\nRunning pathway anlysis\nDone\nSleeping 3.95s before next kinase...\n100 : NEK4\nRunning pathway anlysis\nDone\nSleeping 2.65s before next kinase...\n101 : ITK\nRunning pathway anlysis\nDone\nSleeping 2.22s before next kinase...\n102 : CDK5\nRunning pathway anlysis\nDone\nSleeping 1.59s before next kinase...\n103 : PKACB\nRunning pathway anlysis\nDone\nSleeping 3.71s before next kinase...\n104 : GSK3B\nRunning pathway anlysis\nDone\nSleeping 3.77s before next kinase...\n105 : AKT1\nRunning pathway anlysis\nDone\nSleeping 2.62s before next kinase...\n106 : AURB\nRunning pathway anlysis\nDone\nSleeping 2.63s before next kinase...\n107 : TAO2\nRunning pathway anlysis\nDone\nSleeping 1.69s before next kinase...\n108 : MAPKAPK3\nRunning pathway anlysis\nDone\nSleeping 1.84s before next kinase...\n109 : NIM1\nRunning pathway anlysis\nDone\nSleeping 3.43s before next kinase...\n110 : FGFR4\nRunning pathway anlysis\nDone\nSleeping 2.84s before next kinase...\n111 : AURA\nRunning pathway anlysis\nDone\nSleeping 3.15s before next kinase...\n112 : FLT1\nRunning pathway anlysis\nDone\nSleeping 2.50s before next kinase...\n113 : PAK3\nRunning pathway anlysis\nDone\nSleeping 2.53s before next kinase...\n114 : EPHA4\nRunning pathway anlysis\nDone\nSleeping 1.83s before next kinase...\n115 : MLK3\nRunning pathway anlysis\nDone\nSleeping 2.17s before next kinase...\n116 : CAMK2A\nRunning pathway anlysis\nDone\nSleeping 2.36s before next kinase...\n117 : PIM1\nRunning pathway anlysis\nDone\nSleeping 2.78s before next kinase...\n118 : AURC\nRunning pathway anlysis\nDone\nSleeping 2.92s before next kinase...\n119 : CK2A2\nRunning pathway anlysis\nDone\nSleeping 2.36s before next kinase...\n120 : CAMK2G\nRunning pathway anlysis\nDone\nSleeping 2.12s before next kinase...\n121 : MSK1\nRunning pathway anlysis\nDone\nSleeping 1.56s before next kinase...\n122 : PLK3\nRunning pathway anlysis\nDone\nSleeping 2.92s before next kinase...\n123 : MARK4\nRunning pathway anlysis\nDone\nSleeping 3.63s before next kinase...\n124 : NEK9\nRunning pathway anlysis\nDone\nSleeping 2.95s before next kinase...\n125 : MEKK1\nRunning pathway anlysis\nDone\nSleeping 1.64s before next kinase...\n126 : P70S6K\nRunning pathway anlysis\nDone\nSleeping 2.51s before next kinase...\n127 : IKKA\nRunning pathway anlysis\nDone\nSleeping 3.15s before next kinase...\n128 : ZAK\nRunning pathway anlysis\nDone\nSleeping 2.71s before next kinase...\n129 : GCK\nRunning pathway anlysis\nDone\nSleeping 3.23s before next kinase...\n130 : PAK2\nRunning pathway anlysis\nDone\nSleeping 2.40s before next kinase...\n131 : P38B\nRunning pathway anlysis\nDone\nSleeping 3.01s before next kinase...\n132 : MARK2\nRunning pathway anlysis\nDone\nSleeping 3.34s before next kinase...\n133 : MLK2\nRunning pathway anlysis\nDone\nSleeping 2.19s before next kinase...\n134 : PAK1\nRunning pathway anlysis\nDone\nSleeping 3.37s before next kinase...\n135 : PKCB\nRunning pathway anlysis\nDone\nSleeping 1.73s before next kinase...\n136 : SGK3\nRunning pathway anlysis\nDone\nSleeping 1.74s before next kinase...\n137 : JNK2\nRunning pathway anlysis\nDone\nSleeping 3.29s before next kinase...\n138 : CAMK2D\nRunning pathway anlysis\nDone\nSleeping 1.84s before next kinase...\n139 : TAK1\nRunning pathway anlysis\nDone\nSleeping 1.83s before next kinase...\n140 : PHKG2\nRunning pathway anlysis\nDone\nSleeping 2.46s before next kinase...\n141 : ERK5\nRunning pathway anlysis\nDone\nSleeping 3.75s before next kinase...\n142 : AKT2\nRunning pathway anlysis\nDone\nSleeping 1.57s before next kinase...\n143 : TBK1\nRunning pathway anlysis\nDone\nSleeping 2.26s before next kinase...\n144 : DYRK3\nRunning pathway anlysis\nDone\nSleeping 1.89s before next kinase...\n145 : LIMK1\nRunning pathway anlysis\nDone\nSleeping 1.93s before next kinase...\n146 : PIM3\nRunning pathway anlysis\nDone\nSleeping 3.99s before next kinase...\n147 : P90RSK\nRunning pathway anlysis\nDone\nSleeping 3.55s before next kinase...\n148 : NLK\nRunning pathway anlysis\nDone\nSleeping 2.52s before next kinase...\n149 : MAPKAPK5\nRunning pathway anlysis\nDone\nSleeping 1.73s before next kinase...\n150 : TSSK1\nRunning pathway anlysis\nDone\nSleeping 2.12s before next kinase...\n151 : TLK1\nRunning pathway anlysis\nDone\nSleeping 3.08s before next kinase...\n152 : DCAMKL2\nRunning pathway anlysis\nDone\nSleeping 3.20s before next kinase...\n153 : SIK\nRunning pathway anlysis\nDone\nSleeping 2.24s before next kinase...\n154 : MATK\nRunning pathway anlysis\nDone\nSleeping 3.98s before next kinase...\n155 : CAMK2B\nRunning pathway anlysis\nDone\nSleeping 3.81s before next kinase...\n156 : MAPKAPK2\nRunning pathway anlysis\nDone\nSleeping 1.51s before next kinase...\n157 : ALK4\nRunning pathway anlysis\nDone\nSleeping 3.21s before next kinase...\n158 : JNK3\nRunning pathway anlysis\nDone\nSleeping 3.60s before next kinase...\n159 : IRAK1\nRunning pathway anlysis\nDone\nSleeping 3.96s before next kinase...\n160 : AMPKA1\nRunning pathway anlysis\nDone\nSleeping 1.83s before next kinase...\n161 : TNK2\nRunning pathway anlysis\nDone\nSleeping 3.85s before next kinase...\n162 : DSTYK\nRunning pathway anlysis\nDone\nSleeping 2.99s before next kinase...\n163 : PRKD3\nRunning pathway anlysis\nDone\nSleeping 3.16s before next kinase...\n164 : IRAK4\nRunning pathway anlysis\nDone\nSleeping 2.21s before next kinase...\n165 : MNK2\nRunning pathway anlysis\nDone\nSleeping 2.77s before next kinase...\n166 : MARK1\nRunning pathway anlysis\nDone\nSleeping 2.51s before next kinase...\n167 : RSK4\nRunning pathway anlysis\nDone\nSleeping 2.29s before next kinase...\n168 : CDK9\nRunning pathway anlysis\nDone\nSleeping 2.41s before next kinase...\n169 : TAO1\nRunning pathway anlysis\nDone\nSleeping 2.63s before next kinase...\n170 : CK1E\nRunning pathway anlysis\nDone\nSleeping 2.23s before next kinase...\n171 : PKCT\nRunning pathway anlysis\nDone\nSleeping 3.84s before next kinase...\n172 : SGK1\nRunning pathway anlysis\nDone\nSleeping 2.06s before next kinase...\n173 : TSSK2\nRunning pathway anlysis\nDone\nSleeping 2.85s before next kinase...\n174 : TLK2\nRunning pathway anlysis\nDone\nSleeping 3.16s before next kinase...\n175 : PKG2\nRunning pathway anlysis\nDone\nSleeping 3.40s before next kinase...\n176 : DYRK4\nRunning pathway anlysis\nDone\nSleeping 2.46s before next kinase...\n177 : MARK3\nRunning pathway anlysis\nDone\nSleeping 3.80s before next kinase...\n178 : RSK2\nRunning pathway anlysis\nDone\nSleeping 3.94s before next kinase...\n179 : DAPK1\nRunning pathway anlysis\nDone\nSleeping 2.39s before next kinase...\n180 : PRKD1\nRunning pathway anlysis\nDone\nSleeping 1.72s before next kinase...\n181 : PKN1\nRunning pathway anlysis\nDone\nSleeping 2.21s before next kinase...\n182 : ULK3\nRunning pathway anlysis\nDone\nSleeping 2.13s before next kinase...\n183 : GRK2\nRunning pathway anlysis\nDone\nSleeping 2.33s before next kinase...\n184 : BMPR1B\nRunning pathway anlysis\nDone\nSleeping 1.76s before next kinase...\n185 : AMPKA2\nRunning pathway anlysis\nDone\nSleeping 1.72s before next kinase...\n186 : CSK\nRunning pathway anlysis\nDone\nSleeping 2.94s before next kinase...\n187 : NEK11\nRunning pathway anlysis\nDone\nSleeping 2.23s before next kinase...\n188 : PTK2\nRunning pathway anlysis\nDone\nSleeping 2.27s before next kinase...\n189 : ATM\nRunning pathway anlysis\nDone\nSleeping 3.24s before next kinase...\n190 : ROCK1\nRunning pathway anlysis\nDone\nSleeping 2.44s before next kinase...\n191 : LATS2\nRunning pathway anlysis\nDone\nSleeping 1.74s before next kinase...\n192 : DYRK1A\nRunning pathway anlysis\nDone\nSleeping 1.66s before next kinase...\n193 : CK1G2\nRunning pathway anlysis\nDone\nSleeping 3.13s before next kinase...\n194 : GRK5\nRunning pathway anlysis\nDone\nSleeping 1.84s before next kinase...\n195 : PKCZ\nRunning pathway anlysis\nDone\nSleeping 3.92s before next kinase...\n196 : CK1A\nRunning pathway anlysis\nDone\nSleeping 2.19s before next kinase...\n197 : ALK2\nRunning pathway anlysis\nDone\nSleeping 3.81s before next kinase...\n198 : ROCK2\nRunning pathway anlysis\nDone\nSleeping 3.17s before next kinase...\n199 : CAMKK1\nRunning pathway anlysis\nDone\nSleeping 3.09s before next kinase...\n200 : WNK3\nRunning pathway anlysis\nDone\nSleeping 2.84s before next kinase...\n201 : TGFBR1\nRunning pathway anlysis\nDone\nSleeping 1.63s before next kinase...\n202 : PKCG\nRunning pathway anlysis\nDone\nSleeping 3.68s before next kinase...\n203 : JAK1\nRunning pathway anlysis\nDone\nSleeping 3.40s before next kinase...\n204 : CDK6\nRunning pathway anlysis\nDone\nSleeping 2.73s before next kinase...\n205 : TYK2\nRunning pathway anlysis\nDone\nSleeping 2.05s before next kinase...\n206 : MSK2\nRunning pathway anlysis\nDone\nSleeping 2.37s before next kinase...\n207 : PKCD\nRunning pathway anlysis\nDone\nSleeping 3.88s before next kinase...\n208 : PKG1\nRunning pathway anlysis\nDone\nSleeping 3.47s before next kinase...\n209 : GRK7\nRunning pathway anlysis\nDone\nSleeping 2.30s before next kinase...\n210 : NUAK2\nRunning pathway anlysis\nDone\nSleeping 1.71s before next kinase...\n211 : AKT3\nRunning pathway anlysis\nDone\nSleeping 2.86s before next kinase...\n212 : WNK1\nRunning pathway anlysis\nDone\nSleeping 3.41s before next kinase...\n213 : LKB1\nRunning pathway anlysis\nDone\nSleeping 3.17s before next kinase...\n214 : PBK\nRunning pathway anlysis\nDone\nSleeping 2.27s before next kinase...\n215 : SKMLCK\nRunning pathway anlysis\nDone\nSleeping 2.63s before next kinase...\n216 : WNK2\nRunning pathway anlysis\nDone\nSleeping 1.95s before next kinase...\n217 : SGK2\nRunning pathway anlysis\nDone\nSleeping 2.16s before next kinase...\n218 : PRKD2\nRunning pathway anlysis\nDone\nSleeping 1.97s before next kinase...\n219 : PLK4\nRunning pathway anlysis\nDone\nSleeping 3.44s before next kinase...\n220 : CAMK4\nRunning pathway anlysis\nDone\nSleeping 2.99s before next kinase...\n221 : LATS1\nRunning pathway anlysis\nDone\nSleeping 3.05s before next kinase...\n222 : ICK\nRunning pathway anlysis\nDone\nSleeping 3.25s before next kinase...\n223 : CK1G1\nRunning pathway anlysis\nDone\nSleeping 2.92s before next kinase...\n224 : CDK7\nRunning pathway anlysis\nDone\nSleeping 3.19s before next kinase...\n225 : PKCH\nRunning pathway anlysis\nDone\nSleeping 2.85s before next kinase...\n226 : WEE1\nRunning pathway anlysis\nDone\nSleeping 2.81s before next kinase...\n227 : CHK2\nRunning pathway anlysis\nDone\nSleeping 2.06s before next kinase...\n228 : CDK3\nRunning pathway anlysis\nDone\nSleeping 2.75s before next kinase...\n229 : CK1G3\nRunning pathway anlysis\nDone\nSleeping 3.98s before next kinase...\n230 : SLK\nRunning pathway anlysis\nDone\nSleeping 1.70s before next kinase...\n231 : MEK2\nRunning pathway anlysis\nDone\nSleeping 1.55s before next kinase...\n232 : PKCI\nRunning pathway anlysis\nDone\nSleeping 1.85s before next kinase...\n233 : PRKX\nRunning pathway anlysis\nDone\nSleeping 1.90s before next kinase...\n234 : PKCE\nRunning pathway anlysis\nDone\nSleeping 2.39s before next kinase...\n235 : CAMKK2\nRunning pathway anlysis\nDone\nSleeping 1.77s before next kinase...\n236 : MTOR\nRunning pathway anlysis\nDone\nSleeping 2.74s before next kinase...\n237 : DCAMKL1\nRunning pathway anlysis\nDone\nSleeping 3.26s before next kinase...\n238 : EEF2K\nRunning pathway anlysis\nDone\nSleeping 1.87s before next kinase...\n239 : MELK\nRunning pathway anlysis\nDone\nSleeping 3.00s before next kinase...\n240 : HIPK2\nRunning pathway anlysis\nDone\nSleeping 2.25s before next kinase...\n241 : CDK4\nRunning pathway anlysis\nDone\nSleeping 3.08s before next kinase...\n242 : GSK3A\nRunning pathway anlysis\nDone\nSleeping 2.70s before next kinase...\n243 : NDR1\nRunning pathway anlysis\nDone\nSleeping 1.67s before next kinase...\n244 : PIM2\nRunning pathway anlysis\nDone\nSleeping 3.44s before next kinase...\n245 : P70S6KB\nRunning pathway anlysis\nDone\nSleeping 2.46s before next kinase...\n246 : MEK1\nRunning pathway anlysis\nDone\nSleeping 2.71s before next kinase...\n247 : NUAK1\nRunning pathway anlysis\nDone\nSleeping 2.65s before next kinase...\n248 : TESK1\nRunning pathway anlysis\nDone\nSleeping 2.11s before next kinase...\n249 : MOK\nRunning pathway anlysis\nDone\nSleeping 2.11s before next kinase...\n250 : OSR1\nRunning pathway anlysis\nDone\nSleeping 1.96s before next kinase...\n251 : PAK6\nRunning pathway anlysis\nDone\nSleeping 2.83s before next kinase...\n252 : NDR2\nRunning pathway anlysis\nDone\nSleeping 2.80s before next kinase...\n253 : CLK1\nRunning pathway anlysis\nDone\nSleeping 1.70s before next kinase...\n254 : ERK7\nRunning pathway anlysis\nDone\nSleeping 3.15s before next kinase...\n255 : COT\nRunning pathway anlysis\nDone\nSleeping 2.41s before next kinase...\n256 : PHKG1\nRunning pathway anlysis\nDone\nSleeping 2.69s before next kinase...\n257 : ACVR2A\nRunning pathway anlysis\nDone\nSleeping 1.62s before next kinase...\n258 : DNAPK\nRunning pathway anlysis\nDone\nSleeping 3.98s before next kinase...\n259 : HIPK4\nRunning pathway anlysis\nDone\nSleeping 1.86s before next kinase...\n260 : MEKK2\nRunning pathway anlysis\nDone\nSleeping 3.13s before next kinase...\n261 : MAP2K4\nRunning pathway anlysis\nDone\nSleeping 3.36s before next kinase...\n262 : PERK\nRunning pathway anlysis\nDone\nSleeping 2.42s before next kinase...\n263 : MOS\nRunning pathway anlysis\nDone\nSleeping 3.51s before next kinase...\n264 : PAK5\nRunning pathway anlysis\nDone\nSleeping 2.23s before next kinase...\n265 : LIMK2\nRunning pathway anlysis\nDone\nSleeping 3.76s before next kinase...\n266 : LRRK2\nRunning pathway anlysis\nDone\nSleeping 2.08s before next kinase...\n267 : BRSK2\nRunning pathway anlysis\nDone\nSleeping 2.61s before next kinase...\n268 : PAK4\nRunning pathway anlysis\nDone\nSleeping 3.44s before next kinase...\n269 : HASPIN\nRunning pathway anlysis\nDone\nSleeping 2.04s before next kinase...\n270 : ATR\nRunning pathway anlysis\nDone\nSleeping 3.19s before next kinase...\n271 : CAMK1D\nRunning pathway anlysis\nDone\nSleeping 1.99s before next kinase...\n272 : STLK3\nRunning pathway anlysis\nDone\nSleeping 1.70s before next kinase...\n273 : CLK3\nRunning pathway anlysis\nDone\nSleeping 2.34s before next kinase...\n274 : ASK1\nRunning pathway anlysis\nDone\nSleeping 3.90s before next kinase...\n275 : CAMK1A\nRunning pathway anlysis\nDone\nSleeping 2.40s before next kinase...\n276 : HIPK1\nRunning pathway anlysis\nDone\nSleeping 1.76s before next kinase...\n277 : PKN2\nRunning pathway anlysis\nDone\nSleeping 3.38s before next kinase...\n278 : MEK5\nRunning pathway anlysis\nDone\nSleeping 1.68s before next kinase...\n279 : MRCKB\nRunning pathway anlysis\nDone\nSleeping 2.98s before next kinase...\n280 : MAP2K7\nRunning pathway anlysis\nDone\nSleeping 1.83s before next kinase...\n281 : MPSK1\nRunning pathway anlysis\nDone\nSleeping 1.82s before next kinase...\n282 : CDK8\nRunning pathway anlysis\nDone\nSleeping 1.83s before next kinase...\n283 : BUB1\nRunning pathway anlysis\nDone\nSleeping 2.51s before next kinase...\n284 : MEKK3\nRunning pathway anlysis\nDone\nSleeping 3.58s before next kinase...\n285 : PDHK1\nRunning pathway anlysis\nDone\nSleeping 1.98s before next kinase...\n286 : HIPK3\nRunning pathway anlysis\nDone\nSleeping 2.48s before next kinase...\n287 : MAP2K3\nRunning pathway anlysis\nDone\nSleeping 2.21s before next kinase...\n288 : TTK\nRunning pathway anlysis\nDone\nSleeping 2.92s before next kinase...\n289 : GRK1\nRunning pathway anlysis\nDone\nSleeping 2.51s before next kinase...\n290 : PLK2\nRunning pathway anlysis\nDone\nSleeping 3.79s before next kinase...\n291 : STK33\nRunning pathway anlysis\nDone\nSleeping 3.36s before next kinase...\n292 : HRI\nRunning pathway anlysis\nDone\nSleeping 3.23s before next kinase...\n293 : MAP2K6\nRunning pathway anlysis\nDone\nSleeping 3.20s before next kinase...\n294 : BMPR2\nRunning pathway anlysis\nDone\nSleeping 3.90s before next kinase...\n295 : RIPK2\nRunning pathway anlysis\nDone\nSleeping 3.93s before next kinase...\n296 : DYRK1B\nRunning pathway anlysis\nDone\nSleeping 2.54s before next kinase...\n297 : LOK\nRunning pathway anlysis\nDone\nSleeping 3.39s before next kinase...\n298 : DDR1\nRunning pathway anlysis\nDone\nSleeping 2.49s before next kinase...\n299 : PASK\nRunning pathway anlysis\nDone\nSleeping 3.63s before next kinase...\n300 : ULK1\nRunning pathway anlysis\nDone\nSleeping 3.31s before next kinase...\n301 : PDK1\nRunning pathway anlysis\nDone\nSleeping 3.06s before next kinase...\n302 : PKACG\nRunning pathway anlysis\nDone\nSleeping 1.64s before next kinase...\n303 : BMPR1A\nRunning pathway anlysis\nDone\nSleeping 3.76s before next kinase...\n304 : TNNI3K\nRunning pathway anlysis\nDone\nSleeping 2.95s before next kinase...\n305 : BRSK1\nRunning pathway anlysis\nDone\nSleeping 2.36s before next kinase...\n306 : PDHK3\nRunning pathway anlysis\nDone\nSleeping 2.71s before next kinase...\n307 : ERBB2\nRunning pathway anlysis\nDone\nSleeping 1.91s before next kinase...\n308 : CLK2\nRunning pathway anlysis\nDone\nSleeping 2.07s before next kinase...\n309 : SRPK3\nRunning pathway anlysis\nDone\nSleeping 3.05s before next kinase...\n310 : DAPK3\nRunning pathway anlysis\nDone\nSleeping 3.62s before next kinase...\n311 : ROR2\nRunning pathway anlysis\nDone\nSleeping 1.66s before next kinase...\n312 : CHAK1\nRunning pathway anlysis\nDone\nSleeping 1.68s before next kinase...\n313 : PKR\nRunning pathway anlysis\nDone\nSleeping 2.78s before next kinase...\n314 : NIK\nRunning pathway anlysis\nDone\nSleeping 3.63s before next kinase...\n315 : GCN2\nRunning pathway anlysis\nDone\nSleeping 2.24s before next kinase...\n316 : SRPK2\nRunning pathway anlysis\nDone\nSleeping 1.80s before next kinase...\n317 : VRK2\nRunning pathway anlysis\nDone\nSleeping 2.59s before next kinase...\n318 : VRK1\nRunning pathway anlysis\nDone\nSleeping 2.52s before next kinase...\n319 : PKMYT1\nRunning pathway anlysis\nDone\nSleeping 2.25s before next kinase...\n320 : GRK3\nRunning pathway anlysis\nDone\nSleeping 3.80s before next kinase...\n321 : CAMK1B\nRunning pathway anlysis\nDone\nSleeping 2.92s before next kinase...\n322 : CDC7\nRunning pathway anlysis\nDone\nSleeping 3.70s before next kinase...\n323 : SMMLCK\nRunning pathway anlysis\nDone\nSleeping 3.90s before next kinase...\n324 : ROR1\nRunning pathway anlysis\nDone\nSleeping 2.98s before next kinase...\n325 : GAK\nRunning pathway anlysis\nDone\nSleeping 2.75s before next kinase...\n326 : MAST2\nRunning pathway anlysis\nDone\nSleeping 2.68s before next kinase...\n327 : BRAF\nRunning pathway anlysis\nDone\nSleeping 2.51s before next kinase...",
    "crumbs": [
      "Plot reactome pathways: CDDM"
    ]
  },
  {
    "objectID": "reactome_path_plot_cddm.html#get-accuracy-for-overlap-pathways",
    "href": "reactome_path_plot_cddm.html#get-accuracy-for-overlap-pathways",
    "title": "Plot reactome pathways: CDDM",
    "section": "Get accuracy for overlap pathways",
    "text": "Get accuracy for overlap pathways\n\nacc_dict, num_dict = {}, {}\nacc_lo_dict, num_lo_dict = {}, {}\n\nfor k,r in tqdm(cddm_info.iterrows(),total=len(cddm_info)):\n    save_dir = f'fig/cddm/{k}/path'\n    \n    path_df=pd.read_parquet(f'{save_dir}/path.parquet')\n\n    if path_df.ref_path.sum()!=0:\n        accuracy = get_overlap(path_df, ref_col='ref_path',plot=False,p_type='p')\n        acc_dict[k] = accuracy\n        num_dict[k] =path_df.ref_path.sum()\n\n    if path_df.ref_path_lowest.sum()!=0:\n        accuracy_lo = get_overlap(path_df, ref_col='ref_path_lowest',plot=False,p_type='p')\n        acc_lo_dict[k] = accuracy_lo\n        num_lo_dict[k] = path_df.ref_path_lowest.sum()\n    # break\n\n100%|███████████████████████████████████████████████████████████████████████████████████████████| 328/328 [00:01&lt;00:00, 214.60it/s]\n\n\n\ncddm_info['accuracy'] = acc_dict\ncddm_info['path_num'] = num_dict\ncddm_info['accuracy_lowest'] = acc_lo_dict\ncddm_info['path_lowest_num'] = num_lo_dict\n\n\ncddm_info['path_num'] = cddm_info['path_num'].fillna(0).astype(int)\ncddm_info['path_lowest_num'] = cddm_info['path_lowest_num'].fillna(0).astype(int)\n\n\ncddm_info.to_parquet('raw/cddm_path_info.parquet')",
    "crumbs": [
      "Plot reactome pathways: CDDM"
    ]
  },
  {
    "objectID": "reactome_path_plot_cddm.html#analysis",
    "href": "reactome_path_plot_cddm.html#analysis",
    "title": "Plot reactome pathways: CDDM",
    "section": "Analysis",
    "text": "Analysis\n\ndef plot_path_hist(df,\n              colname,\n              **kwargs,\n              ):\n    \n    \"Plot histogram of a column (kinase). \"\n    \n    plt.figure(figsize=(6,2))\n\n    hist_params = {'element':'poly',\n              'edgecolor': None,\n              'alpha':0.5,\n              'bins':100,\n              'kde':True,\n              }\n    \n    sns.histplot(data=df,x=colname,**kwargs, **hist_params)\n    \n    plt.xlabel('')\n    plt.title(f'Accuracy score distribution')\n\n\nq75, q50 = cddm_info.path_num[lambda x: x!=0].quantile([0.75,0.5])\nq75, q50\n\n(37.5, 14.0)\n\n\n\ndef categorize_path_num(x):\n    if x &gt;= q75: return f'well known (≥{q75:.0f})'\n    elif x &lt;= q50: return f'less known (≤{q50:.0f})'\n    else: return f'middle ({q50:.0f}–{q75:.0f})'\n\n\ncddm_info['category'] = cddm_info['path_num'].apply(categorize_path_num)\n\n\ncddm_info['category'].value_counts()\n\ncategory\nless known (≤14)    188\nwell known (≥38)     62\nmiddle (14–38)       61\nName: count, dtype: int64\n\n\n\ncddm_info.hist(column='accuracy', by='category', bins=50, figsize=(8,6));\n\n\n\n\n\n\n\n\n\ncddm_info[cddm_info.path_num&gt;q50].accuracy.mean()\n\nnp.float64(0.5057438274707422)\n\n\n\ncddm_info[cddm_info.path_num&gt;q50].accuracy.hist(bins=50,figsize=(5,3))\nplt.xlabel('Accuracy')\nplt.ylabel('Number of kinases')\nplt.title('CDDM accuracy distribution');\n\n\n\n\n\n\n\n\n\nLowest\n\ncddm_info.path_lowest_num[lambda x: x!=0].quantile([0.75])\n\n0.75    11.5\nName: path_lowest_num, dtype: float64\n\n\n\ncddm_info[cddm_info.path_lowest_num&gt;12].accuracy.hist(bins=50,figsize=(5,3))\nplt.xlabel('Accuracy')\nplt.ylabel('Number of kinases')\nplt.title('CDDM accuracy distribution (lowest-level)');",
    "crumbs": [
      "Plot reactome pathways: CDDM"
    ]
  },
  {
    "objectID": "reactome_path_plot_cddm.html#compare-with-pspa",
    "href": "reactome_path_plot_cddm.html#compare-with-pspa",
    "title": "Plot reactome pathways: CDDM",
    "section": "Compare with PSPA",
    "text": "Compare with PSPA\n\npspa_info=pd.read_parquet('raw/pspa_path_info.parquet')\ncddm_info = pd.read_parquet('raw/cddm_path_info.parquet')\n\n\nidx = list(set(pspa_info.index)&set(cddm_info.index))\n\n\n# make sure total path number are same among the two\n(cddm_info.loc[idx].path_num==pspa_info.loc[idx].path_num).value_counts()\n\npath_num\nTrue    311\nName: count, dtype: int64\n\n\n\npspa_info = pspa_info.loc[idx][pspa_info.path_num&gt;14]\ncddm_info = cddm_info.loc[idx][cddm_info.path_num&gt;14]\n\n\npspa_info['cddm_accuracy'] = cddm_info.accuracy\n\n\npspa_info['cddm_accuracy'].isna().sum()\n\nnp.int64(0)\n\n\n\ndata = pspa_info[['accuracy','cddm_accuracy']].melt()\n\n\ndata.head()\n\n\n\n\n\n\n\n\nvariable\nvalue\n\n\n\n\n0\naccuracy\n0.580645\n\n\n1\naccuracy\n0.200000\n\n\n2\naccuracy\n0.345679\n\n\n3\naccuracy\n0.129032\n\n\n4\naccuracy\n0.500000\n\n\n\n\n\n\n\n\ndata = data.replace({\n    'accuracy': 'PSPA',\n    'cddm_accuracy': 'CDDM'\n})\n\n\ndef plot_violin(\n    data, \n    value='value',\n    group='variable', \n    ylabel=None, \n    dots=True, \n    figsize=(5,3),\n    **kwargs\n):\n    \"Plot violin plots (with optional strip dots) for long-form data.\"\n\n    plt.figure(figsize=figsize)\n\n    ax=sns.violinplot(\n        data=data, x=group, y=value,\n        inner='box', linewidth=1,\n        cut=0,         # prevents tails extending beyond data range\n        bw_adjust=0.7,  # the smaller, the shape have more curves that fit to the data\n        hue=group,**kwargs\n    )\n\n    if dots:\n        sns.stripplot(\n            data=data, x=group, y=value,\n            color='k', size=2, jitter=0.1, alpha=0.6\n        )\n\n    plt.xlabel('')\n    if ylabel is not None: plt.ylabel(ylabel)\n    plt.tight_layout()\n    return ax\n\n\nfrom statannotations.Annotator import Annotator\nimport itertools\n\n\ndef add_stats(ax,data,value='value',group='variable',pairs=None,test='t-test_ind',loc='inside',text_format='star',**kwargs):\n    group_items = data[group].unique()\n    if pairs is None: pairs = list(itertools.combinations(group_items, 2))\n    annotator = Annotator(ax, pairs, data=data, x=group, y=value)\n    annotator.configure(test=test, text_format=text_format, loc=loc,verbose=False,**kwargs)\n    annotator.apply_and_annotate()\n\n\nwide = pspa_info[['accuracy','cddm_accuracy']]\n\nwide.columns=['PSPA','CDDM']\n\n\nax = plot_violin(data,ylabel='Accuracy',figsize=(4,3))\nplt.title('Accuracy of pathway prediction')\nadd_stats(ax,data,test='t-test_paired')\nsave_svg('fig/pathway_compare.svg')\n\n\n\n\n\n\n\n\n\n(pspa_info['cddm_accuracy']-pspa_info['accuracy']).sort_values(ascending=False)\n\nkinase\nMEKK1     0.789474\nABL1      0.755102\nPKCG      0.629630\nTBK1      0.617021\nCAMKK1    0.600000\n            ...   \nIRAK4    -0.366667\nFGFR4    -0.393939\nNTRK1    -0.437500\nNTRK2    -0.600000\nPDGFRB   -0.733333\nLength: 123, dtype: float64",
    "crumbs": [
      "Plot reactome pathways: CDDM"
    ]
  },
  {
    "objectID": "pssms_split_test_all.html",
    "href": "pssms_split_test_all.html",
    "title": "Get kinase-specific PSSMs",
    "section": "",
    "text": "from katlas.core import *\nimport pandas as pd\n\n⬇️ Downloading katlas_dataset.zip ...\n\n\nDownloading...\nFrom (original): https://drive.google.com/uc?id=17wIl0DbdoHV036Z3xgaT_0H3LlM_W47l\nFrom (redirected): https://drive.google.com/uc?id=17wIl0DbdoHV036Z3xgaT_0H3LlM_W47l&confirm=t&uuid=6f78ec0e-01e1-4e97-a38a-2d6664051c95\nTo: /home/sky1ove/git/katlas-raw/nbs/katlas_datasets.zip\n100%|███████████████████████████████████████████████████████████████████████████████████████████| 208M/208M [00:07&lt;00:00, 27.6MB/s]\n\n\n📂 Extracting to /tmp/katlas_dataset ...\n🧹 Removing zip file: katlas_datasets.zip\n✅ Done! Extracted dataset is at: /tmp/katlas_dataset\ndf = Data.get_ks_dataset()\n\nCPU times: user 761 ms, sys: 249 ms, total: 1.01 s\nWall time: 1.65 s\ndf['kinase_id'] = df['kinase_uniprot'] + '_' + df['kinase_protein'].str.split().str[0]\ncnt = df['kinase_id'].value_counts()\nidx = cnt[cnt&gt;=40].index\nidx\n\nIndex(['P12931_SRC', 'P29320_EPHA3', 'P07332_FES', 'Q16288_NTRK3',\n       'Q9UM73_ALK', 'P00519_ABL1', 'P36888_FLT3', 'P29322_EPHA8',\n       'P29323_EPHB2', 'P54762_EPHB1',\n       ...\n       'P35626_GRK3', 'Q99640_PKMYT1', 'Q6P2M8_CAMK1B', 'O00311_CDC7',\n       'Q9NYV4_CDK12', 'Q15746_SMMLCK', 'Q01973_ROR1', 'P15056_BRAF',\n       'Q6P0Q8_MAST2', 'O14976_GAK'],\n      dtype='object', name='kinase_id', length=333)\ndf.shape\n\n(187066, 22)",
    "crumbs": [
      "Get kinase-specific PSSMs"
    ]
  },
  {
    "objectID": "pssms_split_test_all.html#all-pssms",
    "href": "pssms_split_test_all.html#all-pssms",
    "title": "Get kinase-specific PSSMs",
    "section": "All PSSMs",
    "text": "All PSSMs\n\n# we only keep those on kinome tree\ndf = df[df['kinase_id'].isin(idx)].copy()\n\n\npssms_all = get_cluster_pssms(df,\n                          cluster_col = 'kinase_id',\n                          count_thr=None, # since we already filtered, we set None here\n                          valid_thr=0.6)\n\n100%|████████████████████████████████████████████████████████████████████████████████████████████| 333/333 [00:09&lt;00:00, 36.58it/s]\n\n\n\npssms_all.shape\n\n(332, 943)\n\n\n\npssms_all.to_parquet('out/CDDM_pssms.parquet')\n\n\npssms_all[pssms_all.index.str.contains('CDK')]\n\n\n\n\n\n\n\n\n-20P\n-20G\n-20A\n-20C\n-20S\n-20T\n-20V\n-20I\n-20L\n-20M\n...\n20H\n20K\n20R\n20Q\n20N\n20D\n20E\n20pS\n20pT\n20pY\n\n\n\n\nP06493_CDK1\n0.100762\n0.069433\n0.075360\n0.013548\n0.041490\n0.040644\n0.039797\n0.026249\n0.079594\n0.025402\n...\n0.016115\n0.073791\n0.061917\n0.038168\n0.028838\n0.051739\n0.076336\n0.047498\n0.018660\n0.008482\n\n\nP24941_CDK2\n0.070191\n0.067591\n0.104853\n0.014731\n0.051993\n0.045927\n0.038128\n0.028596\n0.073657\n0.023397\n...\n0.023519\n0.082753\n0.058362\n0.043554\n0.038328\n0.055749\n0.075784\n0.045296\n0.017422\n0.006098\n\n\nQ00535_CDK5\n0.073314\n0.067449\n0.077713\n0.020528\n0.051320\n0.036657\n0.064516\n0.035191\n0.073314\n0.027859\n...\n0.022624\n0.070890\n0.042232\n0.046757\n0.052790\n0.075415\n0.072398\n0.040724\n0.009050\n0.007541\n\n\nP50750_CDK9\n0.124031\n0.090439\n0.062016\n0.012920\n0.049096\n0.046512\n0.036176\n0.043928\n0.051680\n0.018088\n...\n0.005464\n0.062842\n0.035519\n0.054645\n0.057377\n0.038251\n0.076503\n0.051913\n0.021858\n0.027322\n\n\nQ00534_CDK6\n0.105455\n0.080000\n0.069091\n0.010909\n0.029091\n0.021818\n0.072727\n0.047273\n0.058182\n0.014545\n...\n0.015326\n0.072797\n0.049808\n0.049808\n0.045977\n0.049808\n0.072797\n0.053640\n0.026820\n0.019157\n\n\nP50613_CDK7\n0.131004\n0.078603\n0.069869\n0.008734\n0.021834\n0.052402\n0.043668\n0.039301\n0.056769\n0.013100\n...\n0.019704\n0.073892\n0.034483\n0.034483\n0.024631\n0.068966\n0.064039\n0.014778\n0.054187\n0.014778\n\n\nQ00526_CDK3\n0.046512\n0.069767\n0.065116\n0.009302\n0.065116\n0.018605\n0.046512\n0.051163\n0.083721\n0.037209\n...\n0.042857\n0.042857\n0.042857\n0.042857\n0.057143\n0.104762\n0.071429\n0.038095\n0.014286\n0.019048\n\n\nP11802_CDK4\n0.077778\n0.072222\n0.066667\n0.022222\n0.066667\n0.027778\n0.044444\n0.033333\n0.105556\n0.005556\n...\n0.000000\n0.045714\n0.080000\n0.051429\n0.068571\n0.034286\n0.051429\n0.017143\n0.011429\n0.005714\n\n\nP49336_CDK8\n0.091837\n0.061224\n0.112245\n0.020408\n0.071429\n0.020408\n0.051020\n0.051020\n0.051020\n0.040816\n...\n0.030612\n0.081633\n0.020408\n0.020408\n0.061224\n0.142857\n0.091837\n0.040816\n0.010204\n0.020408\n\n\n\n\n9 rows × 943 columns\n\n\n\n\nUpper\n\ndf['site_seq_upper'] = df.site_seq.str.upper()\n\n\npssms_all_upper = get_cluster_pssms(df,\n                              seq_col='site_seq_upper',\n                          cluster_col = 'kinase_id',\n                          count_thr=None, # since we already filtered, we set None here\n                          valid_thr=0.6)\n\n100%|████████████████████████████████████████████████████████████████████████████████████████████| 333/333 [00:11&lt;00:00, 29.50it/s]\n\n\n\npssms_all_upper.to_parquet('out/CDDM_pssms_upper.parquet')",
    "crumbs": [
      "Get kinase-specific PSSMs"
    ]
  },
  {
    "objectID": "pssms_split_test_all.html#all-log-odds",
    "href": "pssms_split_test_all.html#all-log-odds",
    "title": "Get kinase-specific PSSMs",
    "section": "All log-odds",
    "text": "All log-odds\n\ndef get_LO_all(pssms,site_type='STY'):\n    out=[]\n    for idx, flat_pssm in pssms.iterrows():\n        out.append(flatten_pssm(get_pssm_LO_flat(flat_pssm,site_type)))\n    return pd.DataFrame(out,index=pssms.index)\n\n\nLO_all = get_LO_all(pssms_all)\n\n\nLO_all.to_parquet('out/CDDM_pssms_LO.parquet')\n\n\nLO_all_upper = get_LO_all(pssms_all_upper,site_type='STY_upper')\n\n\nLO_all_upper.to_parquet('out/CDDM_pssms_LO_upper.parquet')",
    "crumbs": [
      "Get kinase-specific PSSMs"
    ]
  },
  {
    "objectID": "pssms_split_test_all.html#remove-isoform-and-pseudo-gene",
    "href": "pssms_split_test_all.html#remove-isoform-and-pseudo-gene",
    "title": "Get kinase-specific PSSMs",
    "section": "Remove isoform and pseudo gene",
    "text": "Remove isoform and pseudo gene\n\nLO = pd.read_parquet('out/CDDM_pssms_LO.parquet')\nLO_upper = pd.read_parquet('out/CDDM_pssms_LO_upper.parquet')\n\n\npssms = pd.read_parquet('out/CDDM_pssms.parquet')\npssms_upper = pd.read_parquet('out/CDDM_pssms_upper.parquet')\n\n\nLO.shape,pssms.shape\n\n((332, 943), (332, 943))\n\n\n\ninfo= Data.get_kinase_info()\n\n\ninfo = info[info.pseudo=='0'].copy()\n\n\ninfo['id'] = info.uniprot+'_'+info.kinase\n\n\nLO[~LO.index.isin(info.id)]\n\n\n\n\n\n\n\n\n-20P\n-20G\n-20A\n-20C\n-20S\n-20T\n-20V\n-20I\n-20L\n-20M\n...\n20H\n20K\n20R\n20Q\n20N\n20D\n20E\n20pS\n20pT\n20pY\n\n\n\n\nP07948-2_LYN\n-0.695061\n0.248942\n-0.181606\n-0.523522\n-0.241880\n-0.087184\n0.270835\n0.248626\n-0.177055\n0.151905\n...\n-1.002663\n0.187090\n-0.131176\n-0.477873\n0.089392\n-0.069890\n0.272381\n-0.624875\n-0.293957\n0.686397\n\n\nO60566_BUB1B\n-0.098063\n0.177522\n0.006417\n-2.364642\n-0.336759\n-0.656228\n0.622357\n0.285512\n-1.214575\n-1.313708\n...\n0.538365\n0.313082\n-0.184508\n-1.521805\n0.314920\n0.267606\n0.993983\n-0.586346\n-0.015962\n-0.647041\n\n\nP05771-2_PKCB\n-0.513296\n0.082197\n-0.419347\n0.153007\n0.387344\n0.446387\n1.033094\n1.359558\n-0.959957\n-0.059090\n...\n1.086193\n-0.296631\n-0.264711\n-1.710942\n0.415289\n0.443465\n0.117313\n0.283410\n-0.205099\n-0.099214\n\n\nQ13976-2_PKG1\n0.267160\n-0.880855\n0.326552\n-20.552054\n-0.980098\n-0.599127\n0.959565\n-0.422922\n-0.420509\n-0.841570\n...\n0.565165\n0.388792\n0.076757\n0.183066\n-0.243242\n-0.843097\n-0.192211\n0.440454\n-1.311089\n1.379757\n\n\n\n\n4 rows × 943 columns\n\n\n\n\nLO = LO[LO.index.isin(info.id)]\nLO_upper =LO_upper[LO_upper.index.isin(info.id)]\n\n\npssms= pssms[pssms.index.isin(info.id)]\npssms_upper = pssms_upper[pssms_upper.index.isin(info.id)]\n\n\nLO.shape,pssms.shape\n\n((328, 943), (328, 943))\n\n\n\nLO.to_parquet('out/CDDM_pssms_LO.parquet')\nLO_upper.to_parquet('out/CDDM_pssms_LO_upper.parquet')\n\n\npssms.to_parquet('out/CDDM_pssms.parquet')\npssms_upper.to_parquet('out/CDDM_pssms_upper.parquet')",
    "crumbs": [
      "Get kinase-specific PSSMs"
    ]
  },
  {
    "objectID": "pssms_split_test_all.html#only-use-protein-name-as-index",
    "href": "pssms_split_test_all.html#only-use-protein-name-as-index",
    "title": "Get kinase-specific PSSMs",
    "section": "Only use protein name as index",
    "text": "Only use protein name as index\n\nimport pandas as pd\n\n\npssms = pd.read_parquet('out/CDDM_pssms.parquet')\npssms_upper = pd.read_parquet('out/CDDM_pssms_upper.parquet')\n\n\nLO = pd.read_parquet('out/CDDM_pssms_LO.parquet')\nLO_upper = pd.read_parquet('out/CDDM_pssms_LO_upper.parquet')\n\n\npssms.index.str.split('_').str[1].duplicated().sum()\n\nnp.int64(0)\n\n\n\ndef convert_index(df): df.index=df.index.str.split('_').str[1]\n\n\nfor df in [pssms,pssms_upper,LO,LO_upper]: convert_index(df)\n\n\npssms.to_parquet('out/CDDM_pssms.parquet')\npssms_upper.to_parquet('out/CDDM_pssms_upper.parquet')\n\nLO.to_parquet('out/CDDM_pssms_LO.parquet')\nLO_upper.to_parquet('out/CDDM_pssms_LO_upper.parquet')\n\n\nfrom katlas.data import *\n\n\ninfo = Data.get_kinase_info()\n\n\n(~pssms.index.isin(info.kinase)).sum()\n\nnp.int64(0)",
    "crumbs": [
      "Get kinase-specific PSSMs"
    ]
  },
  {
    "objectID": "get_aa_relationship.html",
    "href": "get_aa_relationship.html",
    "title": "Get AA relationship",
    "section": "",
    "text": "from katlas.plot import *\nfrom katlas.pssm import *\nfrom matplotlib import pyplot as plt\nimport pandas as pd,numpy as np, seaborn as sns\n# load raw PSPA data\nst = pd.read_csv('https://github.com/sky1ove/katlas_raw/raw/refs/heads/main/nbs/raw/pspa_st_raw.csv').set_index('kinase')\ntyr = pd.read_csv('https://github.com/sky1ove/katlas_raw/raw/refs/heads/main/nbs/raw/pspa_tyr_raw.csv').set_index('kinase')\nst.shape,tyr.shape # tyr have position 5 while st only have -5 to 4\n\n((303, 207), (93, 230))\nst.columns.isin(tyr.columns).sum() # all st columns are in tyr\n\nnp.int64(207)\ntyr = tyr[st.columns]\ndf = pd.concat([st,tyr])\n# df.to_parquet('pspa_raw_all.parquet')",
    "crumbs": [
      "Get AA relationship"
    ]
  },
  {
    "objectID": "get_aa_relationship.html#normalize",
    "href": "get_aa_relationship.html#normalize",
    "title": "Get AA relationship",
    "section": "Normalize",
    "text": "Normalize\nFor each pssm, the value is divided by the sum of position to get probability.\nHere we remove pS (or s) column because it is a duplicate of pT.\n\nout=[]\nfor i,r in df.iterrows():\n    pssm = recover_pssm(r).drop(index=['pS']) # drop pS as it is a duplicate of pT\n    pssm_norm = pssm/pssm.sum()\n    r_norm=flatten_pssm(pssm_norm)\n    out.append(r_norm)\n    # break\n\n\ndf_norm = pd.DataFrame(out,index=df.index)\n\n\ndf_norm.max().sort_values()\n\n-4V     0.054906\n-5Q     0.055054\n-3Q     0.060396\n-4I     0.061281\n4N      0.061402\n          ...   \n2R      0.647505\n-3R     0.659110\n4pT     0.744287\n2pY     0.756693\n-3pT    0.819808\nLength: 198, dtype: float64\n\n\n\n# Z score normalization: (x-median)/std\n# df_norm = df_log.div(df_log.sum(1), axis=0) # normalize per row\n\n# df_norm.max().sort_values()\n\n# df_centered = df_log.sub(df_log.median(axis=1), axis=0) #Median is more robust to outliers than mean\n\n# row_std = df_centered.std(axis=1)\n\n# df_norm = df_centered.div(row_std, axis=0)",
    "crumbs": [
      "Get AA relationship"
    ]
  },
  {
    "objectID": "get_aa_relationship.html#get-aa-relationship",
    "href": "get_aa_relationship.html#get-aa-relationship",
    "title": "Get AA relationship",
    "section": "Get aa relationship",
    "text": "Get aa relationship\nGet a pivot table where index are each row in PSSM (flattened) and column as aa\n\ndef get_aa_pivot(df):\n    df2 = df.unstack().reset_index()\n    df2.columns = ['substrate', 'kinase', 'target']\n    df2['aa'] = df2.substrate.str.extract(r'-?\\d+(.*)')\n    df2['enum'] = df2.groupby('aa').cumcount()\n    df_pivot = df2.pivot(index='enum', columns='aa', values='target') #(303+93)*207/23=3564 data points per aa\n    return df_pivot\n\n\nget_aa_pivot(df_norm)\n\n\n\n\n\n\n\naa\nA\nC\nD\nE\nF\nG\nH\nI\nK\nL\n...\nP\nQ\nR\nS\nT\nV\nW\nY\npT\npY\n\n\nenum\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n0\n0.022689\n0.035505\n0.012815\n0.012230\n0.033966\n0.019584\n0.026494\n0.124227\n0.020920\n0.079374\n...\n0.057560\n0.044781\n0.076395\n0.037377\n0.062864\n0.076023\n0.025154\n0.076070\n0.016092\n0.048843\n\n\n1\n0.043352\n0.051706\n0.065975\n0.058643\n0.044600\n0.035740\n0.042359\n0.046430\n0.037911\n0.044243\n...\n0.030841\n0.031974\n0.035314\n0.043700\n0.046971\n0.044418\n0.059664\n0.042913\n0.058193\n0.056499\n\n\n2\n0.041163\n0.066089\n0.077450\n0.065475\n0.043931\n0.037582\n0.037661\n0.032179\n0.031404\n0.034251\n...\n0.038739\n0.036231\n0.034316\n0.048096\n0.049033\n0.039515\n0.052463\n0.044140\n0.055400\n0.054025\n\n\n3\n0.043296\n0.044366\n0.029489\n0.029495\n0.042885\n0.046571\n0.051207\n0.034139\n0.074510\n0.036415\n...\n0.047329\n0.038554\n0.119120\n0.058256\n0.045790\n0.033537\n0.041228\n0.040494\n0.033407\n0.033597\n\n\n4\n0.050553\n0.054868\n0.024011\n0.024790\n0.043062\n0.048498\n0.047918\n0.032888\n0.077033\n0.038753\n...\n0.047364\n0.038891\n0.116091\n0.043582\n0.041902\n0.034020\n0.041962\n0.042862\n0.035884\n0.037412\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\n3559\n0.039978\n0.044084\n0.032095\n0.029349\n0.053046\n0.048620\n0.045832\n0.035368\n0.073535\n0.043720\n...\n0.062438\n0.049294\n0.077132\n0.047354\n0.047700\n0.040578\n0.052726\n0.036062\n0.026070\n0.025366\n\n\n3560\n0.034813\n0.042381\n0.042421\n0.041581\n0.049883\n0.046789\n0.061897\n0.033611\n0.054107\n0.039796\n...\n0.054190\n0.050606\n0.063522\n0.042759\n0.039404\n0.034896\n0.060530\n0.041920\n0.037194\n0.041829\n\n\n3561\n0.037825\n0.045142\n0.028175\n0.032509\n0.038069\n0.042975\n0.043249\n0.036433\n0.093387\n0.035088\n...\n0.035362\n0.045697\n0.105032\n0.045549\n0.040374\n0.035008\n0.057392\n0.045191\n0.031294\n0.038903\n\n\n3562\n0.037995\n0.055100\n0.034531\n0.040293\n0.056445\n0.045908\n0.051045\n0.037029\n0.048096\n0.039411\n...\n0.035743\n0.053430\n0.062044\n0.042712\n0.045983\n0.038328\n0.050737\n0.056981\n0.030374\n0.038266\n\n\n3563\n0.041597\n0.056824\n0.050548\n0.047306\n0.033267\n0.053435\n0.056838\n0.025781\n0.047579\n0.035959\n...\n0.083373\n0.060340\n0.047234\n0.049425\n0.044927\n0.042672\n0.045638\n0.031662\n0.037280\n0.026980\n\n\n\n\n3564 rows × 22 columns\n\n\n\n\ncorr = get_aa_pivot(df_norm).corr('pearson')\nplot_corr(corr)\n\n\n\n\n\n\n\n\n\ncorr = get_aa_pivot(df_norm).corr('spearman')\nplot_corr(corr)\nsave_svg('fig/aa_relationship_spearman.svg')\n\n\n\n\n\n\n\n\nAlthough K and R shows high spearman correlation, its PSSM, for example in AKT is not that highly correlated.\nIn that case, pearson correlation seems to be much related for this set.\n\ndef get_corr_pairs(corr):\n    out = corr.unstack().sort_values()[lambda x: x&lt;1][::2].sort_values(ascending=False)\n    out.index = out.index.map(lambda x: x[0] + '_' + x[1])\n    return out\n\n\nout = get_corr_pairs(corr)\nout\n\nR_K     0.871058\nD_E     0.870359\nV_I     0.837880\nL_M     0.741193\nI_L     0.726308\n          ...   \nD_R    -0.460727\nK_pY   -0.467009\nR_pT   -0.473405\nE_R    -0.498652\npY_R   -0.527158\nLength: 231, dtype: float64\n\n\n\nout[lambda x: x&gt;0.5]\n\nR_K      0.871058\nD_E      0.870359\nV_I      0.837880\nL_M      0.741193\nI_L      0.726308\nF_W      0.702524\npT_E     0.696542\npY_E     0.692582\npT_pY    0.688888\nD_pT     0.625288\nD_pY     0.608323\nL_V      0.598209\nF_Y      0.588376\nF_L      0.587369\nM_F      0.580984\nM_I      0.566043\nG_A      0.555320\nI_F      0.553406\nN_Q      0.515099\nG_P      0.511684\nS_T      0.506195\nY_W      0.504759\ndtype: float64",
    "crumbs": [
      "Get AA relationship"
    ]
  },
  {
    "objectID": "get_aa_relationship.html#relationship-of-positionaa",
    "href": "get_aa_relationship.html#relationship-of-positionaa",
    "title": "Get AA relationship",
    "section": "Relationship of position+aa",
    "text": "Relationship of position+aa\n\ncorr_all = df_norm.corr('spearman')\n\n\nout2 = get_corr_pairs(corr_all)\n\n\nout2\n\n-5D_-5E    0.950029\n-3D_-3E    0.948908\n3D_3E      0.931132\n2R_2K      0.925424\n-2E_-2D    0.913798\n             ...   \n-5D_-4K   -0.753715\n-4R_-3E   -0.756394\n-3E_-1K   -0.761640\n-3E_-3R   -0.768508\n-1R_-3E   -0.768611\nLength: 19503, dtype: float64\n\n\n\nout2[out2.index.str.contains('pY')].head(15)\n\n-2pY_-3pY    0.846232\n-3pY_-4pY    0.837161\n-3pT_-3pY    0.830329\n-3E_-3pY     0.818490\n-3pY_-3D     0.817421\n-4pY_-5pY    0.811867\n-3pY_-2pT    0.803611\n4pY_4E       0.785561\n4pT_3pY      0.785136\n-5pT_-5pY    0.784180\n-4pY_-2pY    0.783532\n3pT_3pY      0.782812\n4pT_4pY      0.767439\n-2pY_-2pT    0.764788\n-3pT_-2pY    0.762138\ndtype: float64",
    "crumbs": [
      "Get AA relationship"
    ]
  },
  {
    "objectID": "reactome_path_data.html",
    "href": "reactome_path_data.html",
    "title": "Reactome pathway for each PSSM",
    "section": "",
    "text": "from katlas.pssm import *\nfrom katlas.score import *\nfrom katlas.data import *\nfrom katlas.plot import *\nfrom katlas.pathway import *\n\nimport pandas as pd,seaborn as sns\nfrom matplotlib import pyplot as plt",
    "crumbs": [
      "Reactome pathway for each PSSM"
    ]
  },
  {
    "objectID": "reactome_path_data.html#data-processing",
    "href": "reactome_path_data.html#data-processing",
    "title": "Reactome pathway for each PSSM",
    "section": "Data processing",
    "text": "Data processing\n\ndf = Data.get_human_site()\n\n\ndf.site_seq.duplicated().sum()\n\nnp.int64(2219)\n\n\n\ndf['sub_gene'] = df.substrate_genes.str.split(' ').str[0]\n\n\n# check duplicates\ndf.site_seq.duplicated().sum()\n\nnp.int64(2219)\n\n\nWe want to avoid that because it will give duplicated scores\n\ndf2 = df.groupby('site_seq').agg(\n    {'sub_site': lambda x: set(x.dropna()),\n     'sub_gene': lambda x: set(x.dropna()),\n     }).reset_index()\n\n\ndf2.site_seq.str[20].value_counts()\n\n\ndf2['acceptor'] = df2.site_seq.str[20].str.upper()\n\n\ndf2.head()\n\n\ndf2.shape",
    "crumbs": [
      "Reactome pathway for each PSSM"
    ]
  },
  {
    "objectID": "reactome_path_data.html#scoring",
    "href": "reactome_path_data.html#scoring",
    "title": "Reactome pathway for each PSSM",
    "section": "Scoring",
    "text": "Scoring\n\nout = predict_kinase_df(df2,seq_col='site_seq',**Params('PSPA'))\n\ninput dataframe has a length 117736\nPreprocessing\nFinish preprocessing\nMerging reference\nFinish merging\n\n\n100%|██████████| 396/396 [00:43&lt;00:00,  9.17it/s]\n\n\n\nresult_df = pd.concat([df2,out],axis=1)\n\n\ndf=result_df.copy()\n\n\ndel out,result_df\n\n\n# df.to_parquet('raw/pspa_score_df.parquet')",
    "crumbs": [
      "Reactome pathway for each PSSM"
    ]
  },
  {
    "objectID": "reactome_path_data.html#decide-ratio",
    "href": "reactome_path_data.html#decide-ratio",
    "title": "Reactome pathway for each PSSM",
    "section": "Decide ratio",
    "text": "Decide ratio\n\nStep1: Locate the max phosphoacceptor in the STY ratio of a kinase\nStep2: Get top 2% sites for that phosphoacceptor, and get the number of sites.\nStep3: Use the number and STY ratio to calculate the number of sites for other phosphoacceptor.\n\n\npspa=Data.get_pspa_all_scale() \n# both two have ['0pS','0pT','0pY'] columns as STY ratio\n\n\ndef get_sty_ratio(series):\n    \"\"\"Return normalized S/T/Y ratio for a given kinase based on ref table.\"\"\"\n    s, t, y = series\n    if y &gt;= 0.8:  # tyrosine kinase\n        return pd.Series({'S': 0, 'T': 0, 'Y': 1})\n\n    elif 0.1 &lt; y &lt; 0.8:  # mixed S/T/Y kinase, only occur in CDDM.\n        total = s + t + y\n        return pd.Series({'S': s / total, 'T': t / total, 'Y': y / total})\n    else:  # ser/thr kinase\n        total = s + t\n        return pd.Series({'S': s / total if total else 0, 'T': t / total if total else 0, 'Y': 0})\n\n\npspa_sty = pspa[['0pS','0pT','0pY']].apply(get_sty_ratio,axis=1)\n\n\npspa_sty['acceptors'] = pspa_sty.apply(lambda x: x[x!=0].index.tolist(),axis=1)\n\n\npspa_sty['max_acceptor'] = pspa_sty.iloc[:,:3].idxmax(axis=1)\n\n\ndef get_sty_thr_count(series,df,kinase):\n    max_acceptor = series.max_acceptor\n    scores = df[df.acceptor==max_acceptor][kinase]\n    max_thr = scores.quantile(0.98)\n    sty_dict={f'{max_acceptor}_thr':max_thr}\n\n    count = int(scores[lambda x: x&gt;=max_thr].count())\n    sty_dict[f'{max_acceptor}_cnt'] = count\n\n    for acceptor in series.acceptors:\n        if acceptor != max_acceptor:\n            acceptor_count = int((count/series[max_acceptor])*series[acceptor])\n            sty_dict[f'{acceptor}_cnt'] = acceptor_count\n            thr = df[df.acceptor==acceptor][kinase].nlargest(acceptor_count).min()\n            sty_dict[f'{acceptor}_thr'] = thr\n            \n    return pd.Series(sty_dict)\n\n\npspa_info = pspa_sty.apply(lambda x: get_sty_thr_count(x,df, x.name),axis=1)\n\n\npspa_info=pspa_info.fillna(0)\n\n\ncnt_cols = ['S_cnt','T_cnt','Y_cnt']\n\n\npspa_info[cnt_cols] = pspa_info[cnt_cols].astype(int)\n\n\ndef get_genes(series,df,kinase):\n    series = series[cnt_cols].astype(int)\n    keys = series.index.str.split('_').str[0]\n    vals = series.values\n    site_dict={}\n    for acceptor, cnt in zip(keys, vals):\n        if cnt!=0:\n            df_k = df[df.acceptor==acceptor].nlargest(cnt,columns=kinase)\n            genes = set().union(*df_k.sub_gene)\n            sites = set().union(*df_k.sub_site)\n            site_dict[f'{acceptor}_genes'] = genes\n            site_dict[f'{acceptor}_sites'] = sites\n        else:\n            site_dict[f'{acceptor}_genes'] = set()\n            site_dict[f'{acceptor}_sites'] = set()\n    return pd.Series(site_dict)\n\n\npspa_genes = pspa_info.apply(lambda x: get_genes(x,df,x.name),axis=1)\n\n\nthr_cols = ['S_thr','T_thr','Y_thr']\ngene_cols = ['S_genes','T_genes','Y_genes']\n\n\npspa_genes['genes']=pspa_genes[gene_cols].apply(lambda x: set().union(*x),axis=1)\n\n\npspa_info =pd.concat([pspa_info,pspa_genes],axis=1)\n\n\npspa_info.to_parquet('raw/pspa_path_info.parquet')",
    "crumbs": [
      "Reactome pathway for each PSSM"
    ]
  },
  {
    "objectID": "reactome_path_data.html#repeat-the-same-for-cddm",
    "href": "reactome_path_data.html#repeat-the-same-for-cddm",
    "title": "Reactome pathway for each PSSM",
    "section": "repeat the same for cddm",
    "text": "repeat the same for cddm\nScoring first:\n\ndf = Data.get_human_site()\ndf['sub_gene'] = df.substrate_genes.str.split(' ').str[0]\ndf2 = df.groupby('site_seq').agg(\n    {'sub_site': lambda x: set(x.dropna()),\n     'sub_gene': lambda x: set(x.dropna()),\n     }).reset_index()\ndf2['acceptor'] = df2.site_seq.str[20].str.upper()\ndel df\nout = predict_kinase_df(df2,seq_col='site_seq',**Params('CDDM'))\nresult_df = pd.concat([df2,out],axis=1)\ndf=result_df.copy()\ndel out,result_df\n\nInput dataframe has 117736 rows\nPreprocessing...\nPreprocessing done. Expanding sequences...\nMerging reference...\nMerge complete.\n\n\n\ndf.to_parquet('raw/cddm_score_df.parquet')\n\n\ndef plot_hist(df,\n              kinase,\n              sty_thr=None, # dict of thresholds per acceptor\n              hue='acceptor'):\n    \n    \"Plot histogram of a column (kinase). \"\n    \n    plt.figure(figsize=(6,2))\n\n    hist_params = {'element':'poly',\n              'edgecolor': None,\n              'alpha':0.5,\n              'bins':100,\n              'kde':True,\n              'palette':sty_color}\n    \n    sns.histplot(data=df,x=kinase,hue=hue,**hist_params)\n    \n    plt.xlabel('')\n    plt.title(f'{kinase} score distribution')\n\n    if sty_thr:\n        for acceptor,thr in sty_thr.items():\n            if thr is not None:\n                plt.axvline(thr,color=sty_color[acceptor])\n\n\nplot_hist(df,'AKT1')\n\n\n\n\n\n\n\n\nGet the path info:\n\ncnt_cols = ['S_cnt','T_cnt','Y_cnt']\nthr_cols = ['S_thr','T_thr','Y_thr']\ngene_cols = ['S_genes','T_genes','Y_genes']\n\n\ncddm=Data.get_cddm()\ncddm_sty = cddm[['0pS','0pT','0pY']].apply(get_sty_ratio,axis=1)\ncddm_sty['acceptors'] = cddm_sty.apply(lambda x: x[x!=0].index.tolist(),axis=1)\ncddm_sty['max_acceptor'] = cddm_sty.iloc[:,:3].idxmax(axis=1)\ncddm_info = cddm_sty.apply(lambda x: get_sty_thr_count(x,df, x.name),axis=1)\ncddm_info=cddm_info.fillna(0)\ncddm_info[cnt_cols] = cddm_info[cnt_cols].astype(int)\ncddm_genes = cddm_info.apply(lambda x: get_genes(x,df,x.name),axis=1)\ncddm_genes['genes']=cddm_genes[gene_cols].apply(lambda x: set().union(*x),axis=1)\ncddm_info =pd.concat([cddm_info,cddm_genes],axis=1)\ncddm_info.to_parquet('raw/cddm_path_info.parquet')",
    "crumbs": [
      "Reactome pathway for each PSSM"
    ]
  },
  {
    "objectID": "preprocess_dataset.html",
    "href": "preprocess_dataset.html",
    "title": "Preprocess kinase-substrate datasets",
    "section": "",
    "text": "Poll [Sugiyama & Douglass]: https://biosignaling.biomedcentral.com/articles/10.1186/s12964-023-01436-2\nPoll web motif: https://esbl.nhlbi.nih.gov/Databases/Kinase_Logos/KinaseTree.html; https://esbl.nhlbi.nih.gov/Databases/Kinase_Logos/GeneSymbol.html\nSugiyama: https://pmc.ncbi.nlm.nih.gov/articles/PMC6642169/\nDouglass: https://journals.physiology.org/doi/full/10.1152/ajpcell.00166.2012\nRegPhos: Supplementary Table S4: motifs grouped by kinase family\nPhosphoNetwork, logos of 300 motifs: https://pmc.ncbi.nlm.nih.gov/articles/PMC3658267/; web app: https://phosphonetworks.org/\nGPS: https://gps.biocuckoo.cn/links.php#l1",
    "crumbs": [
      "Preprocess kinase-substrate datasets"
    ]
  },
  {
    "objectID": "preprocess_dataset.html#motif",
    "href": "preprocess_dataset.html#motif",
    "title": "Preprocess kinase-substrate datasets",
    "section": "",
    "text": "Poll [Sugiyama & Douglass]: https://biosignaling.biomedcentral.com/articles/10.1186/s12964-023-01436-2\nPoll web motif: https://esbl.nhlbi.nih.gov/Databases/Kinase_Logos/KinaseTree.html; https://esbl.nhlbi.nih.gov/Databases/Kinase_Logos/GeneSymbol.html\nSugiyama: https://pmc.ncbi.nlm.nih.gov/articles/PMC6642169/\nDouglass: https://journals.physiology.org/doi/full/10.1152/ajpcell.00166.2012\nRegPhos: Supplementary Table S4: motifs grouped by kinase family\nPhosphoNetwork, logos of 300 motifs: https://pmc.ncbi.nlm.nih.gov/articles/PMC3658267/; web app: https://phosphonetworks.org/\nGPS: https://gps.biocuckoo.cn/links.php#l1",
    "crumbs": [
      "Preprocess kinase-substrate datasets"
    ]
  },
  {
    "objectID": "preprocess_dataset.html#review-of-database",
    "href": "preprocess_dataset.html#review-of-database",
    "title": "Preprocess kinase-substrate datasets",
    "section": "Review of database",
    "text": "Review of database\nWilson, AACR cancer research: https://aacrjournals.org/cancerres/article/78/1/15/625062/New-Perspectives-Opportunities-and-Challenges-in\nGPS 6.0, List of database: https://gps.biocuckoo.cn/links.php\npaper: https://academic.oup.com/nar/article/51/W1/W243/7157529\nphospho.ELM links: http://phospho.elm.eu.org/links.html\nGPS, https://gps.biocuckoo.cn/links.php#l1",
    "crumbs": [
      "Preprocess kinase-substrate datasets"
    ]
  },
  {
    "objectID": "preprocess_dataset.html#set-up",
    "href": "preprocess_dataset.html#set-up",
    "title": "Preprocess kinase-substrate datasets",
    "section": "Set up",
    "text": "Set up\n\nfrom katlas.data import *\nimport pandas as pd\n\n\ndef map_substrate(idmapping_fname, ori_df, sub_col,remove_nonhuman=True):\n    \"Map uniprot id with uniprot info\"\n\n    substrate_id = pd.read_excel(idmapping_fname)\n    substrate_id = substrate_id.drop_duplicates('From')\n    substrate_id = substrate_id[['From', 'Entry', 'Gene Names', 'Sequence','Organism']]\n    ori_df = ori_df.copy()\n\n    # prevent name conflict\n    if sub_col == 'substrate_uniprot':\n        sub_col = 'substrate_uniprot_tmp'\n        ori_df = ori_df.rename(columns={'substrate_uniprot':'substrate_uniprot_tmp'})\n\n    substrate_id.columns = [sub_col, 'substrate_uniprot', 'substrate_genes', 'substrate_sequence','substrate_species']\n\n    print('Shape before processing', ori_df.shape)\n\n    ori_df = ori_df.merge(substrate_id, on=sub_col)\n\n    print('Species counts:',ori_df.substrate_species.value_counts())\n\n    if remove_nonhuman:\n        print('Removing non-human substrates')\n        ori_df = ori_df[ori_df.substrate_species=='Homo sapiens (Human)']\n\n    ori_df = ori_df.drop(columns=[sub_col])  # Drop temp column after merging\n    ori_df = ori_df.dropna(subset=['substrate_sequence'])\n    print('Shape after processing', ori_df.shape)\n\n    return ori_df.reset_index(drop=True)\n\n\n# kinase_uniprot=pd.read_excel('raw/uniprot_human_keyword_kinase.xlsx',engine=\"openpyxl\")\nkinase_uniprot = Data.get_kinase_uniprot()\n\n\nkinase_uniprot.head()\n\n\n\n\n\n\n\n\nEntry\nEntry Name\nProtein names\nGene Names\nuniprot_keyword_kinase\non_tree\nOrganism\nKeywords\nSequence\n\n\n\n\n0\nA2RU49\nHYKK_HUMAN\nHydroxylysine kinase (5-hydroxy-L-lysine kinas...\nHYKK AGPHD1\n1\n0\nHomo sapiens (Human)\nAlternative splicing;Cytoplasm;Kinase;Proteomi...\nMSSGNYQQSEALSKPTFSEEQASALVESVFGLKVSKVRPLPSYDDQ...\n\n\n1\nA4D2B8\nPM2P1_HUMAN\nPutative postmeiotic segregation increased 2-l...\nPMS2P1 PMS2L1 PMS2L13 PMS2L6 PMS2L8 PMS3 PMS8 ...\n1\n0\nHomo sapiens (Human)\nAlternative splicing;Kinase;Reference proteome...\nMVTMCGGHRPENFLHQVLTEFGEELAGEGKSEVGGGAPRSYLQVAS...\n\n\n2\nO00141\nSGK1_HUMAN\nSerine/threonine-protein kinase Sgk1 (EC 2.7.1...\nSGK1 SGK\n1\n1\nHomo sapiens (Human)\n3D-structure;Alternative promoter usage;Altern...\nMTVKTEAAKGTLTYSRMRGMVAILIAFMKQRRMGLNDFIQKIANNS...\n\n\n3\nO00142\nKITM_HUMAN\nThymidine kinase 2, mitochondrial (EC 2.7.1.21...\nTK2\n1\n0\nHomo sapiens (Human)\nAlternative splicing;ATP-binding;Direct protei...\nMLLWPLRGWAARALRCFGPGSRGSPASGPGPRRVQRRAWPPDKEQE...\n\n\n4\nO00238\nBMR1B_HUMAN\nBone morphogenetic protein receptor type-1B (B...\nBMPR1B\n1\n1\nHomo sapiens (Human)\n3D-structure;Alternative splicing;ATP-binding;...\nMLLRSAGKLNVGTKKEDGESTAPTPRPKVLRCKCHHHCPEDSVNNI...",
    "crumbs": [
      "Preprocess kinase-substrate datasets"
    ]
  },
  {
    "objectID": "preprocess_dataset.html#sugiyama-dataset",
    "href": "preprocess_dataset.html#sugiyama-dataset",
    "title": "Preprocess kinase-substrate datasets",
    "section": "Sugiyama dataset",
    "text": "Sugiyama dataset\n\nData\nGo to https://www.nature.com/articles/s41598-019-46385-4#Sec21, download table S2.\nModify the header (2 lines to 1 line) so that it can be read by pandas.\n\ndf = pd.read_csv('raw/Large_scale_S2.csv').iloc[:,:-2]\n\n\ndf.head()\n\n\n\n\n\n\n\n\nType\nKinase\nSubstrate_uniprot\nPosition\n\n\n\n\n0\nTK\nABL1\n1433B_HUMAN\nS212\n\n\n1\nTK\nABL1\n1433B_HUMAN\nY151\n\n\n2\nTK\nABL1\n1433B_HUMAN\nY21\n\n\n3\nTK\nABL1\n1433B_HUMAN\nY50\n\n\n4\nTK\nABL1\n1433E_HUMAN\nY152\n\n\n\n\n\n\n\n\ndf.shape\n\n(198536, 4)\n\n\n\n\nKinase mapping\n\n# pd.DataFrame(df.Kinase.unique())[0].str.split('/').str[0].to_csv('raw/sugiyama_kinase_name.csv')\n\nMap each kinase name with uniprot ID\n\nkinase_id = pd.read_csv('raw/LS_info2.csv').iloc[:,:3]\n\n\ndf = df.merge(kinase_id)\n\n\ndf\n\n\n\n\n\n\n\n\nType\nKinase\nSubstrate_uniprot\nPosition\nkinase_uniprot\nkinase_paper\n\n\n\n\n0\nTK\nABL1\n1433B_HUMAN\nS212\nP00519\nABL1\n\n\n1\nTK\nABL1\n1433B_HUMAN\nY151\nP00519\nABL1\n\n\n2\nTK\nABL1\n1433B_HUMAN\nY21\nP00519\nABL1\n\n\n3\nTK\nABL1\n1433B_HUMAN\nY50\nP00519\nABL1\n\n\n4\nTK\nABL1\n1433E_HUMAN\nY152\nP00519\nABL1\n\n\n...\n...\n...\n...\n...\n...\n...\n\n\n198531\nLK\nSPHK2\nTICN3_HUMAN\nT118\nQ9NRA0\nNaN\n\n\n198532\nLK\nSPHK2\nTPM4_HUMAN\nT241\nQ9NRA0\nNaN\n\n\n198533\nLK\nSPHK2\nULK3_HUMAN\nS305\nQ9NRA0\nNaN\n\n\n198534\nLK\nSPHK2\nZRAB2_HUMAN\nS165\nQ9NRA0\nNaN\n\n\n198535\nLK\nSPHK2\nZRAB2_HUMAN\nS181\nQ9NRA0\nNaN\n\n\n\n\n198536 rows × 6 columns\n\n\n\n\n\nSubstrate mapping\n\n# pd.DataFrame(df.Substrate_uniprot.unique()).to_csv('raw/sugiyama_uniprot_id.csv')\n\nID mapping of Substrate_uniprot to uniprot ID in https://www.uniprot.org/id-mapping\n3,753 IDs were mapped to 3,753 results\n375 ID were not mapped\n\ndf = map_substrate('raw/idmapping_2025_03_02.xlsx',df,'Substrate_uniprot')\n\n/home/sky1ove/miniconda3/lib/python3.13/site-packages/logomaker/../openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default\n  warn(\"Workbook contains no default style, apply openpyxl's default\")\n\n\nShape before processing (198536, 6)\nSpecies counts: substrate_species\nHomo sapiens (Human)    187129\nName: count, dtype: int64\nRemoving non-human substrates\nShape after processing (187129, 9)\n\n\n\n# lipid kinase\ndf[df.Type=='LK'].Kinase.unique()\n\narray(['PIK3C3', 'PIK3CB/PIK3R1', 'PIK3CD/PIK3R1', 'PIK3CG/PIK3R5',\n       'PIK3CG', 'PIK4CA', 'PIP4K2B', 'PIP5K1C', 'SPHK1', 'SPHK2'],\n      dtype=object)\n\n\n\ndf.isna().sum()\n\nType                      0\nKinase                    0\nPosition                  0\nkinase_uniprot        16591\nkinase_paper          18891\nsubstrate_uniprot         0\nsubstrate_genes          11\nsubstrate_sequence        0\nsubstrate_species         0\ndtype: int64\n\n\n\ndf.head()\n\n\n\n\n\n\n\n\nType\nKinase\nPosition\nkinase_uniprot\nkinase_paper\nsubstrate_uniprot\nsubstrate_genes\nsubstrate_sequence\nsubstrate_species\n\n\n\n\n0\nTK\nABL1\nS212\nP00519\nABL1\nP31946\nYWHAB\nMTMDKSELVQKAKLAEQAERYDDMAAAMKAVTEQGHELSNEERNLL...\nHomo sapiens (Human)\n\n\n1\nTK\nABL1\nY151\nP00519\nABL1\nP31946\nYWHAB\nMTMDKSELVQKAKLAEQAERYDDMAAAMKAVTEQGHELSNEERNLL...\nHomo sapiens (Human)\n\n\n2\nTK\nABL1\nY21\nP00519\nABL1\nP31946\nYWHAB\nMTMDKSELVQKAKLAEQAERYDDMAAAMKAVTEQGHELSNEERNLL...\nHomo sapiens (Human)\n\n\n3\nTK\nABL1\nY50\nP00519\nABL1\nP31946\nYWHAB\nMTMDKSELVQKAKLAEQAERYDDMAAAMKAVTEQGHELSNEERNLL...\nHomo sapiens (Human)\n\n\n4\nTK\nABL1\nY152\nP00519\nABL1\nP62258\nYWHAE\nMDDREDLVYQAKLAEQAERYDEMVESMKKVAGMDVELTVEERNLLS...\nHomo sapiens (Human)\n\n\n\n\n\n\n\n\ndf = df.rename(columns = {'Position':'site'})\n\n\ndf.shape\n\n(187129, 9)\n\n\n\n\nValidate site\n\ndf['site_match'] =validate_site_df(df,'site','substrate_sequence')\n\n\ndf.site_match.value_counts()\n\nsite_match\n1    184948\n0      2181\nName: count, dtype: int64\n\n\n\ndf=df[df.site_match==1]\n\n\ndf.shape\n\n(184948, 10)\n\n\n\n\nSave\n\ndf['source']='Sugiyama'\n\n\n# df.to_excel('raw/sugiyama.xlsx',index=False)",
    "crumbs": [
      "Preprocess kinase-substrate datasets"
    ]
  },
  {
    "objectID": "preprocess_dataset.html#phosphositeplus-psp",
    "href": "preprocess_dataset.html#phosphositeplus-psp",
    "title": "Preprocess kinase-substrate datasets",
    "section": "PhosphoSitePlus (PSP)",
    "text": "PhosphoSitePlus (PSP)\n\nData\nPSP paper: https://academic.oup.com/nar/article/43/D1/D512/2439467\nGo to https://www.phosphosite.org/staticDownloads, download Kinase_Substrate_Dataset.txt\n\nimport pandas as pd\n\n\npsp = pd.read_csv('raw/Kinase_Substrate_Dataset_final.csv')\n\n\npsp.head()\n\n\n\n\n\n\n\n\nGENE\nKinase\nKIN_ACC_ID\nKIN_ORGANISM\nSUBSTRATE\nSUB_GENE_ID\nSUB_ACC_ID\nSUB_GENE\nSUB_ORGANISM\nSUB_MOD_RSD\nSITE_GRP_ID\nsubstrate\nDOMAIN\nIN_VIVO_RXN\nIN_VITRO_RXN\nCST_CAT#\nkinase_uniprot\nkinase_paper\n\n\n\n\n0\nDyrk2\nDYRK2\nQ5U4C9\nmouse\nNDEL1\n83431.0\nQ9ERR1\nNdel1\nmouse\nS336\n1869686801\nLGSsRPSsAPGMLPL\nNaN\n\nX\nNaN\nQ92630\nDYRK2\n\n\n1\nDYRK2\nDYRK2\nQ92630\nhuman\nGLI2\n14633.0\nQ0VGT2\nGli2\nmouse\nS385\n3339001\nAEGLRPAsPLGLTQE\nNaN\n\nX\nNaN\nQ92630\nDYRK2\n\n\n2\nDYRK2\nDYRK2\nQ92630\nhuman\nSIAH2\n6478.0\nO43255\nSIAH2\nhuman\nS68\n5393502\nGGGAGPVsPQHHELT\nNaN\nX\n\nNaN\nQ92630\nDYRK2\n\n\n3\nDYRK2\nDYRK2\nQ92630\nhuman\nCARHSP1\n23589.0\nQ9Y2V2\nCARHSP1\nhuman\nS41\n455702\nLRGNVVPsPLPtRRt\nNaN\n\nX\nNaN\nQ92630\nDYRK2\n\n\n4\nDYRK2\nDYRK2\nQ92630\nhuman\nDoublecortin iso2\n1641.0\nO43602-2\nDCX\nhuman\nS306\n454122\nGPMRRSKsPADSANG\nNaN\nX\n\nNaN\nQ92630\nDYRK2\n\n\n\n\n\n\n\n\npsp =psp[psp.KIN_ORGANISM=='human'].reset_index(drop=True) \n\npsp =psp[psp.SUB_ORGANISM=='human'].reset_index(drop=True)\n\n\npsp.shape\n\n(14081, 18)\n\n\n\npsp = psp[['KIN_ACC_ID','kinase_paper','GENE','SUB_ACC_ID','SUB_GENE','SUB_MOD_RSD','substrate']]\n\n\npsp.head()\n\n\n\n\n\n\n\n\nKIN_ACC_ID\nkinase_paper\nGENE\nSUB_ACC_ID\nSUB_GENE\nSUB_MOD_RSD\nsubstrate\n\n\n\n\n0\nQ92630\nDYRK2\nDYRK2\nO43255\nSIAH2\nS68\nGGGAGPVsPQHHELT\n\n\n1\nQ92630\nDYRK2\nDYRK2\nQ9Y2V2\nCARHSP1\nS41\nLRGNVVPsPLPtRRt\n\n\n2\nQ92630\nDYRK2\nDYRK2\nO43602-2\nDCX\nS306\nGPMRRSKsPADSANG\n\n\n3\nQ92630\nDYRK2\nDYRK2\nP30304\nCDC25A\nS283\nPErsQEEsPPGSTKr\n\n\n4\nQ92630\nDYRK2\nDYRK2\nO43255\nSIAH2\nT119\nPTCRGALtPSIRNLA\n\n\n\n\n\n\n\n\n\nSubstrate mapping\n\n# psp.SUB_ACC_ID.drop_duplicates().to_csv('raw/psp_substrate_id.csv')\n\n4,441 IDs were mapped to 4,446 results\n19 ID were not mapped: NP_001184222 NP_001100737 AAA40678 HSBO22 NP_776683 NP_579829 P18433-2 NP_001076191 NP_001099740 NP_001005762 NP_001178533 XP_008773743 NP_001104263 ABR15760 AAB24204 AAB24205 BAA34185.2 NP_001103022 AAC50053\nIDs with multiple results: P62991, P62988\n\npsp = map_substrate('raw/idmapping_2025_03_02_psp.xlsx',psp,'SUB_ACC_ID')\n\n/home/sky1ove/miniconda3/lib/python3.13/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default\n  warn(\"Workbook contains no default style, apply openpyxl's default\")\n\n\nShape before processing (14081, 7)\nSpecies counts: substrate_species\nHomo sapiens (Human)    14069\nName: count, dtype: int64\nRemoving non-human substrates\nShape after processing (14069, 10)\n\n\n\npsp.head()\n\n\n\n\n\n\n\n\nKIN_ACC_ID\nkinase_paper\nGENE\nSUB_GENE\nSUB_MOD_RSD\nsubstrate\nsubstrate_uniprot\nsubstrate_genes\nsubstrate_sequence\nsubstrate_species\n\n\n\n\n0\nQ92630\nDYRK2\nDYRK2\nSIAH2\nS68\nGGGAGPVsPQHHELT\nO43255\nSIAH2\nMSRPSSTGPSANKPCSKQPPPQPQHTPSPAAPPAAATISAAGPGSS...\nHomo sapiens (Human)\n\n\n1\nQ92630\nDYRK2\nDYRK2\nCARHSP1\nS41\nLRGNVVPsPLPtRRt\nQ9Y2V2\nCARHSP1\nMSSEPPPPPQPPTHQASVGLLDTPRSRERSPSPLRGNVVPSPLPTR...\nHomo sapiens (Human)\n\n\n2\nQ92630\nDYRK2\nDYRK2\nDCX\nS306\nGPMRRSKsPADSANG\nO43602\nDCX DBCN LISX\nMELDFGHFDERDKTSRNMRGSRMNGLPSPTHSAHCSFYRTRTLQAL...\nHomo sapiens (Human)\n\n\n3\nQ92630\nDYRK2\nDYRK2\nCDC25A\nS283\nPErsQEEsPPGSTKr\nP30304\nCDC25A\nMELGPEPPHRRRLLFACSPPPASQPVVKALFGASAAGGLSPVTNLT...\nHomo sapiens (Human)\n\n\n4\nQ92630\nDYRK2\nDYRK2\nSIAH2\nT119\nPTCRGALtPSIRNLA\nO43255\nSIAH2\nMSRPSSTGPSANKPCSKQPPPQPQHTPSPAAPPAAATISAAGPGSS...\nHomo sapiens (Human)\n\n\n\n\n\n\n\n\npsp.shape\n\n(14069, 10)\n\n\n\n\nKinase mapping\n\n# psp.KIN_ACC_ID.drop_duplicates().to_csv('raw/psp_kin_id.csv')\n\nMapp KIN_ACC_ID to uniprot id\n440 IDs were mapped to 440 results\n1 ID was not mapped:\nAAA58698\n\nkinase_id = pd.read_excel('raw/idmapping_2025_03_02_psp_kinase.xlsx')[['From','Entry','Gene Names']]\n\n/home/sky1ove/miniconda3/lib/python3.13/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default\n  warn(\"Workbook contains no default style, apply openpyxl's default\")\n\n\n\nkinase_id.columns = ['KIN_ACC_ID','kinase_uniprot','kinase_genes']\n\n\nkinase_id[kinase_id.KIN_ACC_ID==\"A9UF07\"]\n\n\n\n\n\n\n\n\nKIN_ACC_ID\nkinase_uniprot\nkinase_genes\n\n\n\n\n124\nA9UF07\nA9UF07\nBCR/ABL fusion\n\n\n\n\n\n\n\n\npsp['KIN_ACC_ID'] = psp['KIN_ACC_ID'].replace('A9UF07','P00519')\n\n\npsp = psp.merge(kinase_id)\n\n\npsp = psp.rename(columns={'SUB_MOD_RSD':'site'})\n\n\npsp = psp[['kinase_uniprot','kinase_genes','kinase_paper','substrate_uniprot','substrate_genes','site','substrate_sequence','substrate','substrate_species']]\n\n\npsp.isna().sum()\n\nkinase_uniprot          0\nkinase_genes            0\nkinase_paper          134\nsubstrate_uniprot       0\nsubstrate_genes         0\nsite                    0\nsubstrate_sequence      0\nsubstrate               0\nsubstrate_species       0\ndtype: int64\n\n\n\npsp = psp.dropna(subset='substrate_sequence').reset_index(drop=True)\n\n\n\nCheck if kinase-uniprot belongs to kinase class\nNot mapped:\n\nfrom katlas.data import *\n\n\nkinase_uniprot=Data.get_kinase_uniprot()\n\n\npsp[~psp.kinase_uniprot.isin(kinase_uniprot.Entry)].kinase_genes.value_counts()\n\nkinase_genes\nCSNK2B CK2N G5A                13\nPRKAG2                          9\nPRKAB1 AMPK                     9\nGTF2F1 RAP74                    4\nBLVRA BLVR BVR                  3\nTGM2                            2\nRET/PTC2                        2\nPHKA1 PHKA                      1\nHSPA5 GRP78                     1\nENPP3 PDNP3                     1\nPIK3R1 GRB1                     1\nCERT1 CERT COL4A3BP STARD11     1\nJMJD6 KIAA0585 PSR PTDSR        1\nName: count, dtype: int64\n\n\nCSNK2B belongs to CK2, PRKAB1, PRKAG2 belongs to AMPK subunit; as their count is not many, we can simply ignore them\n\npsp = psp[psp.kinase_uniprot.isin(kinase_uniprot.Entry)].copy()\n\n\npsp.shape\n\n(14016, 9)\n\n\n\n\nValidate site\n\nfrom katlas.utils import *\n\nCheck if it match with substrate sequence\n\npsp['site_seq']=extract_site_seq(psp,seq_col='substrate_sequence',site_col='site',n=7)\n\n100%|███████████████████████████████████████████████████████████████████████| 14016/14016 [00:00&lt;00:00, 26427.27it/s]\n\n\n\n(psp['site_seq']==psp['substrate'].str.upper()).value_counts()\n\nTrue     13156\nFalse      860\nName: count, dtype: int64\n\n\n\nunmatch = psp[~(psp['site_seq']==psp['substrate'].str.upper())]\n\n\nunmatch.kinase_genes.value_counts().head(10)\n\nkinase_genes\nPRKACA PKACA                                  40\nMAPK1 ERK2 PRKM1 PRKM2                        40\nSRC SRC1                                      39\nCDK1 CDC2 CDC28A CDKN1 P34CDC2                38\nGSK3B                                         37\nMAPK3 ERK1 PRKM3                              35\nAURKB AIK2 AIM1 AIRK2 ARK2 STK1 STK12 STK5    33\nPRKCA PKCA PRKACA                             33\nPRKCB PKCB PRKCB1                             25\nCDK5 CDKN5 PSSALRE                            25\nName: count, dtype: int64\n\n\nWe’ll drop the rows with unmatch substrate sequence\n\npsp = psp[psp['site_seq']==psp['substrate'].str.upper()]\n\nDrop sites with center aa not in S,T or Y\n\npsp['site_seq'].str[7].value_counts()\n\nsite_seq\nS    8303\nT    2812\nY    2029\nH       6\nK       4\nR       2\nName: count, dtype: int64\n\n\n\npsp = psp[psp['site_seq'].str[7].str.upper().isin(list('STY'))]\n\nDrop site with unmatched residue and position\n\npsp['site_match'] =validate_site_df(psp,'site','substrate_sequence')\n\n\npsp['site_match'].value_counts()\n\nsite_match\n1    13144\nName: count, dtype: int64\n\n\n\npsp.shape\n\n(13144, 11)\n\n\n\n\nSave\n\npsp['source']='PSP'\n\n\npsp.head()\n\n\n\n\n\n\n\n\nkinase_uniprot\nkinase_genes\nkinase_paper\nsubstrate_uniprot\nsubstrate_genes\nsite\nsubstrate_sequence\nsubstrate\nsubstrate_species\nsite_seq\nsite_match\nsource\n\n\n\n\n0\nQ92630\nDYRK2\nDYRK2\nO43255\nSIAH2\nS68\nMSRPSSTGPSANKPCSKQPPPQPQHTPSPAAPPAAATISAAGPGSS...\nGGGAGPVsPQHHELT\nHomo sapiens (Human)\nGGGAGPVSPQHHELT\n1\nPSP\n\n\n1\nQ92630\nDYRK2\nDYRK2\nQ9Y2V2\nCARHSP1\nS41\nMSSEPPPPPQPPTHQASVGLLDTPRSRERSPSPLRGNVVPSPLPTR...\nLRGNVVPsPLPtRRt\nHomo sapiens (Human)\nLRGNVVPSPLPTRRT\n1\nPSP\n\n\n3\nQ92630\nDYRK2\nDYRK2\nP30304\nCDC25A\nS283\nMELGPEPPHRRRLLFACSPPPASQPVVKALFGASAAGGLSPVTNLT...\nPErsQEEsPPGSTKr\nHomo sapiens (Human)\nPERSQEESPPGSTKR\n1\nPSP\n\n\n4\nQ92630\nDYRK2\nDYRK2\nO43255\nSIAH2\nT119\nMSRPSSTGPSANKPCSKQPPPQPQHTPSPAAPPAAATISAAGPGSS...\nPTCRGALtPSIRNLA\nHomo sapiens (Human)\nPTCRGALTPSIRNLA\n1\nPSP\n\n\n5\nQ92630\nDYRK2\nDYRK2\nO75449\nKATNA1\nS42\nMSLLMISENVKLAREYALLGNYDSAMVYYQGVLDQMNKYLYSVKDT...\nQMNKYLYsVkDTYLQ\nHomo sapiens (Human)\nQMNKYLYSVKDTYLQ\n1\nPSP\n\n\n\n\n\n\n\n\n# psp.to_excel('raw/psp_human.xlsx',index=False)",
    "crumbs": [
      "Preprocess kinase-substrate datasets"
    ]
  },
  {
    "objectID": "preprocess_dataset.html#kinet-espd-iptmnet",
    "href": "preprocess_dataset.html#kinet-espd-iptmnet",
    "title": "Preprocess kinase-substrate datasets",
    "section": "KiNET (ESPD + iPTMNet)",
    "text": "KiNET (ESPD + iPTMNet)\n\nan integration of PSP, iPTMNet, EPSD\n\n\nData\nKiNET paper: https://www.nature.com/articles/s41540-024-00442-5\nKiNET web: https://kinet.kinametrix.com/\niPTMnet paper: https://pmc.ncbi.nlm.nih.gov/articles/PMC5753337/;\niPTMnet web: https://research.bioinformatics.udel.edu/iptmnet/ ; can’t directly download through Download\nEPSD paper: https://academic.oup.com/bib/article/22/1/298/5686325?login=false\nEPSD web: https://epsd.biocuckoo.cn/Download.php\nGo to https://kinet.kinametrix.com/, and click Download the full KiNet interaction dataset\n\ndf = pd.read_csv('raw/ksi_source_full_dataset.csv')\n\n\ndf = df.dropna(subset='Kinase')\n\n\ndf['Source Database'].value_counts()\n\nSource Database\nPhosphoSitePlus    13135\nEPSD               10442\niPTMNet             3846\nName: count, dtype: int64\n\n\nAs we already included PSP, we will drop it\n\ndf = df[df['Source Database']!='PhosphoSitePlus']\n\n\ndf.shape\n\n(14288, 8)\n\n\n\n\nKinase mapping\n\ndf.Kinase.isin(kinase_uniprot.Entry).value_counts()\n\nKinase\nTrue     14283\nFalse        5\nName: count, dtype: int64\n\n\n\ndf = df[df.Kinase.isin(kinase_uniprot.Entry)]\n\n\n\nSubstrate mapping\n\n# df.Substrate.drop_duplicates().to_csv('raw/KiNet_substrate_id.csv')\n\nMap the id to uniprot seq\n\ndf = map_substrate('raw/idmapping_2025_03_02_KiNET_substrate.xlsx',df,'Substrate')\n\n/home/sky1ove/miniconda3/lib/python3.13/site-packages/logomaker/../openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default\n  warn(\"Workbook contains no default style, apply openpyxl's default\")\n\n\nShape before processing (14283, 8)\nSpecies counts: substrate_species\nHomo sapiens (Human)    14283\nName: count, dtype: int64\nRemoving non-human substrates\nShape after processing (14283, 11)\n\n\n\n# substrate_id = pd.read_excel('raw/idmapping_2025_03_02_KiNET_substrate.xlsx')[['From','Entry','Gene Names','Sequence']]\n\n# substrate_id.columns = ['Substrate','substrate_uniprot','substrate_genes','substrate_sequence']\n\n# df = df.merge(substrate_id)\n\n\ndf = df[['Kinase','Kinase Name','substrate_uniprot','substrate_genes','Site','Source Database','Evidence','substrate_sequence']]\n\n\ndf.columns\n\nIndex(['Kinase', 'Kinase Name', 'substrate_uniprot', 'substrate_genes', 'Site',\n       'Source Database', 'Evidence', 'substrate_sequence'],\n      dtype='object')\n\n\n\ndf.columns = ['kinase_uniprot', 'Kinase Name', 'substrate_uniprot', 'substrate_genes', 'site',\n\n       'source', 'evidence', 'substrate_sequence']\n\n\ndf.shape\n\n(14283, 8)\n\n\n\n\nValidate site\nWe drop site with site residue info unmatch with its site position info in the protein sequence\n\ndf['site_match'] =validate_site_df(df,'site','substrate_sequence')\n\n\ndf.site_match.value_counts()\n\nsite_match\n1    13786\n0      497\nName: count, dtype: int64\n\n\n\ndf[df.site_match==0].source.value_counts()\n\nsource\niPTMNet    368\nEPSD       129\nName: count, dtype: int64\n\n\n\ndf[df.site_match==1].source.value_counts()\n\nsource\nEPSD       10308\niPTMNet     3478\nName: count, dtype: int64\n\n\n\ndf=df[df.site_match==1]\n\n\ndf.shape\n\n(13786, 9)\n\n\n\n\nSave\n\ndf.head()\n\n\n\n\n\n\n\n\nkinase_uniprot\nKinase Name\nsubstrate_uniprot\nsubstrate_genes\nsite\nsource\nevidence\nsubstrate_sequence\nsite_match\n\n\n\n\n0\nO00141\nSGK1\nO00213\nAPBB1 FE65 RIR\nS610\nEPSD\nUnspecified experimental method\nMSVPSSLSQSAINANSHGGPALSLPLPLHAAHNQLLNAKLQATAVG...\n1\n\n\n1\nO00141\nSGK1\nO14920\nIKBKB IKKB\nS181\nEPSD\nUnspecified experimental method\nMSWSPSLTTQTCGAWEMKERLGTGGFGNVIRWHNQETGEQIAIKQC...\n1\n\n\n2\nO00141\nSGK1\nO15111\nCHUK IKKA TCF16\nS180\nEPSD\nUnspecified experimental method\nMERPPGLRPGAGGPWEMRERLGTGGFGNVCLYQHRELDLKIAIKSC...\n1\n\n\n3\nO00141\nSGK1\nO43524\nFOXO3 FKHRL1 FOXO3A\nT32\nEPSD\nUnspecified experimental method\nMAEAPASPAPLSPLEVELDPEFEPQSRPRSCTWPLQRPELQASPAK...\n1\n\n\n4\nO00141\nSGK1\nO43524\nFOXO3 FKHRL1 FOXO3A\nT32\niPTMNet\nText mining\nMAEAPASPAPLSPLEVELDPEFEPQSRPRSCTWPLQRPELQASPAK...\n1\n\n\n\n\n\n\n\n\n# df.to_excel('raw/KiNet.xlsx',index=False)\n\n# df[df['source'] =='EPSD'].to_excel('raw/EPSD.xlsx',index=False)\n\n# df[df['source'] =='iPTMNet'].to_excel('raw/iPTMNet.xlsx',index=False)",
    "crumbs": [
      "Preprocess kinase-substrate datasets"
    ]
  },
  {
    "objectID": "preprocess_dataset.html#phospho.elm",
    "href": "preprocess_dataset.html#phospho.elm",
    "title": "Preprocess kinase-substrate datasets",
    "section": "Phospho.ELM",
    "text": "Phospho.ELM\n\nData\npaper: https://pmc.ncbi.nlm.nih.gov/articles/PMC3013696/\nGo to http://phospho.elm.eu.org/dataset.html, fill info–&gt;accept, then download the dataset\nOpen dump in excel, filter human and non-blank from kinases\n\nelm=pd.read_csv('raw/phosphoELM.csv')\n\n\nelm.shape\n\n(3599, 6)\n\n\n\nelm.head()\n\n\n\n\n\n\n\n\nsubstrate_uniprot\nposition\nacceptor\nkinase\nLTP_HTP\nspecies\n\n\n\n\n0\nO14543\n204\nY\nLck\nLTP\nHomo sapiens\n\n\n1\nO14543\n221\nY\nLck\nLTP\nHomo sapiens\n\n\n2\nO14746\n824\nS\nPKB_group\nLTP\nHomo sapiens\n\n\n3\nO14746\n227\nS\nPKB_group\nLTP\nHomo sapiens\n\n\n4\nO14746\n707\nY\nSRC\nLTP\nHomo sapiens\n\n\n\n\n\n\n\n\nelm.kinase = elm.kinase.str.upper()\n\n\n\nKinase mapping\n\n# kinase_id = pd.read_excel('raw/uniprot_human_keyword_kinase.xlsx')\nkinase_id = Data.get_kinase_uniprot()\n\nkinase_id['Gene Names'] = kinase_id['Gene Names'].str.split(' ')\n\nkinase_id = kinase_id.explode('Gene Names')\n\n\ngene2uniprot = kinase_id.set_index('Gene Names')['Entry'].to_dict()\n\n\ndup_name = set(kinase_id[kinase_id['Gene Names'].duplicated(keep=False)]['Gene Names'])\n\n\ndup_name.remove('PAK1')\n\ndup_name.remove('PASK')\n\n\ngene2uniprot['PAK1'] = 'Q13153'\n\ngene2uniprot['PASK']='Q96RG2'\n\n\nelm = elm[~elm.kinase.isin(dup_name)].copy()\n\n\nelm[~elm.kinase.isin(gene2uniprot.keys())].kinase.unique()\n\narray(['PKB_GROUP', 'IKK_GROUP', 'AURORA B', 'PDK-1', 'PKC_THETA',\n       'SGK_GROUP', 'IKK_BETA', 'CDK_GROUP', 'CAM-KII_ALPHA', 'PKC_GROUP',\n       'PKC_ALPHA', 'CK2_GROUP', 'CK2_ALPHA', 'GSK-3_GROUP',\n       'GSK-3_ALPHA', 'GSK-3_BETA', 'PKA_GROUP', 'RSK_GROUP', 'PKB_BETA',\n       'MAPK_GROUP', 'PAK_GROUP', 'DNA-PK', 'JNK_GROUP', 'CK1_GROUP',\n       'AURORA A', 'P70S6KB', 'PKG/CGK_GROUP', 'PKC_DELTA', 'PDGFR_BETA',\n       'CAM-KII_GROUP', 'GRK-2', 'GRK-5', 'GRK_GROUP', 'CK1_ALPHA',\n       'PKC_EPSILON', 'ROCK_GROUP', 'PKG1/CGK-I', 'PDGFR_GROUP',\n       'P70S6K_GROUP', 'P70S6K', 'PHK_GROUP', 'PKC_BETA', 'DMPK_GROUP',\n       'CK1_DELTA', 'CK2_BETA', 'RSK-3', 'RSK-2', 'CAM-KIV', 'RSK-1',\n       'IKK_ALPHA', 'CK1_EPSILON', 'MAP2K_GROUP', 'PIM-1', 'EG3 KINASE',\n       'GRK-4', 'PKC_ZETA', 'PDKC', 'AMPK_GROUP', 'FGFR_GROUP',\n       'JAK_GROUP', 'MAP3K_GROUP', 'RSK-5', 'IKK_EPSILON', 'CAM-KI_GROUP',\n       'SRC_GROUP', 'PKA_ALPHA', 'PKC_ETA', 'PDK-2', 'GRK-6',\n       'TITIN KINASE', 'CAM-KI_ALPHA', 'GRK-1', 'PDGFR_ALPHA', 'CCDPK',\n       'MARK_GROUP', 'P38_GROUP', 'GRK-3', 'DAPK_GROUP', 'MRCKA',\n       'PKG2/CGK-II', 'PKC_GAMMA', 'PKC_IOTA', 'CAM-KK_ALPHA'],\n      dtype=object)\n\n\nmap them to genes\n\nids = pd.read_csv('raw/elm_kinase_id.csv')\n\n\nids = ids.set_index('kinase')['kinase_gene'].to_dict()\n\n\nelm['kinase_genes'] = elm.kinase.map(ids).fillna(elm.kinase)\n\n\n# for kinase group, we only consider the first two items\n\nelm['kinase_genes'] = elm.kinase_genes.str.split(' ').str[:2]\n\n\nelm = elm.explode('kinase_genes')\n\n\nelm[elm.kinase_genes.isin(dup_name)].kinase_genes.unique()\n\narray(['PRKACA'], dtype=object)\n\n\n\ndup_name.remove('PRKACA')\n\ngene2uniprot['PRKACA']= 'P17612'\n\n\nelm[elm.kinase_genes.isin(dup_name)]\n\n\n\n\n\n\n\n\nsubstrate_uniprot\nposition\nacceptor\nkinase\nLTP_HTP\nspecies\nkinase_genes\n\n\n\n\n\n\n\n\n\nunmapped:\n\nelm[elm.kinase_genes.map(gene2uniprot).isna()].kinase_genes.unique()\n\narray(['PHKA1', 'PHKA2', 'CSNK2B', 'CDPK1', 'CDPK2'], dtype=object)\n\n\n\nelm['kinase_uniprot'] = elm.kinase_genes.map(gene2uniprot)\n\n\nelm = elm.dropna(subset='kinase_uniprot')\n\n\n\nSubstrate mapping\n\n# elm.substrate_uniprot.drop_duplicates().to_csv('raw/elm_substrate_id.csv')\n\n916 IDs were mapped to 919 results\n10 ID were not mapped: ENSP00000328213 ENSP00000343690 ENSP00000352232 ENSP00000347528 ENSP00000357298 ENSP00000248996 ENSP00000357225 ENSP00000261937 ENSP00000248419 ENSP00000267569\nFound two of the unmapped are kinases:\n\nensp = {'ENSP00000328213':'P06239','ENSP00000261937':'P35916'}\n\n\nelm.substrate_uniprot = elm.substrate_uniprot.map(ensp).fillna(elm.substrate_uniprot)\n\n\nelm = map_substrate('raw/idmapping_2025_03_12_elm.xlsx',elm,'substrate_uniprot')\n\nShape before processing (4699, 8)\nSpecies counts: substrate_species\nHomo sapiens (Human)    4675\nName: count, dtype: int64\nRemoving non-human substrates\nShape after processing (4675, 11)\n\n\n/home/sky1ove/miniconda3/lib/python3.13/site-packages/logomaker/../openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default\n  warn(\"Workbook contains no default style, apply openpyxl's default\")\n\n\n\nelm.shape\n\n(4675, 11)\n\n\n\n\nValidate site\n\nelm.acceptor.value_counts()\n\nacceptor\nS    3018\nT     908\nY     749\nName: count, dtype: int64\n\n\n\nelm['site']=elm['acceptor']+elm['position'].astype(str)\n\n\nelm['site_match'] =validate_site_df(elm,'site','substrate_sequence')\n\n\nelm.site_match.value_counts()\n\nsite_match\n1    4519\n0     156\nName: count, dtype: int64\n\n\n\nelm = elm[elm.site_match==1]\n\n\nelm.shape\n\n(4519, 13)\n\n\n\n\nSave\n\nelm.columns\n\nIndex(['position', 'acceptor', 'kinase', 'LTP_HTP', 'species', 'kinase_genes',\n       'kinase_uniprot', 'substrate_uniprot', 'substrate_genes',\n       'substrate_sequence', 'substrate_species', 'site', 'site_match'],\n      dtype='object')\n\n\n\ncol = ['kinase','kinase_uniprot', 'kinase_genes',\n\n       'substrate_uniprot', 'substrate_genes','site','LTP_HTP', 'species', \n\n       'substrate_sequence',]\n\n\nelm = elm[col]\n\n\nelm['source']='ELM'\n\n\n# elm.to_excel('raw/ELM.xlsx',index=False)",
    "crumbs": [
      "Preprocess kinase-substrate datasets"
    ]
  },
  {
    "objectID": "preprocess_dataset.html#signor",
    "href": "preprocess_dataset.html#signor",
    "title": "Preprocess kinase-substrate datasets",
    "section": "Signor",
    "text": "Signor\n\nData\npaper: https://academic.oup.com/nar/article/51/D1/D631/6761728\nweb: https://signor.uniroma2.it/\nGo to web link, Downloads –&gt; Latest Release download (Jan 2025)\nOpen in excel, filter mechanism to be phosphorylation\n\nimport pandas as pd\nfrom katlas.data import *\n\n\nsig = pd.read_excel('raw/signor_phosphorylation.xlsx')\n\n\nsig.shape\n\n(12973, 27)\n\n\n\n\nKinase mapping\nTYPEA column contains complex proteins, we need to filter out the kinase name\n\ncomp = sig[sig.TYPEA=='complex'].copy()\n\n\n# comp.ENTITYA.drop_duplicates().to_csv('raw/sig_complex.csv')\n\n\ncomp_id = pd.read_csv('raw/sig_complex_label.csv')\n\n\ncomp_id = comp_id.set_index('ENTITYA')['kinase_gene']\n\n\ncomp['kinase_gene'] = comp.ENTITYA.map(comp_id)\n\n\ncomp = comp.dropna(subset='kinase_gene')\n\n\ncomp.shape\n\n(742, 28)\n\n\nFusion proteins\n\nfus_id = {'BCR-ABL':'ABL1','EML4-ALK':'ALK'}\n\n\nfus = sig[sig.TYPEA=='fusion protein'].copy()\n\n\nfus['kinase_gene'] = fus.ENTITYA.map(fus_id)\n\nFor Protein family, we’ll make it apply to first two family members\n\nfam = sig[sig.TYPEA=='proteinfamily'].copy()\n\n\n# fam.ENTITYA.drop_duplicates().to_csv('raw/sig_fam.csv')\n\n\nfam_id = pd.read_csv('raw/sig_fam_label.csv')\n\n\nfam_id.head()\n\n\n\n\n\n\n\n\nENTITYA\nkinase_gene\n\n\n\n\n0\nERK1/2\nMAPK3 MAPK1\n\n\n1\nAKT\nAKT1 AKT2 AKT3\n\n\n2\nRPS6K\nRPS6KB1 RPS6KB2\n\n\n3\np38\nMAPK14 MAPK11 MAPK12 MAPK13\n\n\n4\nJNK\nMAPK8 MAPK9 MAPK10\n\n\n\n\n\n\n\n\nfam_id = fam_id.set_index('ENTITYA')['kinase_gene']\n\n\nfam['kinase_gene'] = fam.ENTITYA.map(fam_id)\n\nfam = fam.dropna(subset='kinase_gene')\n\n\nfam['kinase_gene'] = fam.kinase_gene.str.split(' ').str[:2]\n\n\nfam = fam.explode('kinase_gene')\n\nProtein:\n\npro = sig[sig.TYPEA=='protein'].copy()\n\nfor consistency:\n\npro['kinase_gene'] = pro['ENTITYA']\n\ncombine:\n\ndf = pd.concat([pro,comp,fus,fam])\n\nMapping:\n\n# kinase_id = pd.read_excel('raw/uniprot_human_keyword_kinase.xlsx')\nkinase_id =Data.get_kinase_uniprot()\n\n\nkinase_id['Gene Names'] = kinase_id['Gene Names'].str.split(' ')\n\n\nkinase_id = kinase_id.explode('Gene Names')\n\nSome kinases share same gene names:\n\n# kinase_id[kinase_id['Gene Names'].duplicated(keep=False)].sort_values('Gene Names').head()\n\nWe’ll drop them to prevent confusion.\n\ndup_name = set(kinase_id[kinase_id['Gene Names'].duplicated(keep=False)]['Gene Names'])\n\n\ndf.kinase_gene.isin(dup_name).sum()\n\nnp.int64(674)\n\n\n\ndf = df[~df.kinase_gene.isin(dup_name)].copy()\n\n\ngene2uniprot = kinase_id.set_index('Gene Names')['Entry'].to_dict()\n\n\ndf.shape\n\n(13013, 28)\n\n\nunmapped:\n\ndf[df.kinase_gene.str.upper().map(gene2uniprot).isna()].kinase_gene.unique()\n\narray(['HRAS', 'IL4R', 'CSNK2B', 'TLR4', 'IL6R', 'THAP12', 'PRKAR2A',\n       'RHOA', 'AREG', 'RET/PTC2', 'PCSK7', 'CCNC', 'TGM2', 'SLC12A1',\n       'RALA', 'IL6ST', 'CRK', 'SMAD9', 'PLCG1', 'ELOC', 'PPP2CA', 'CCR5',\n       'GHR', 'CAD', 'SMO', 'FRS2', 'LEPR', 'BLVRA', 'TAB1', 'PRKAB1',\n       'PIAS4', 'IFNAR1', 'HSP90AA1', 'PTPRJ', 'PRKAG2', 'CSN1S1',\n       'GTF2F1', 'VASP', 'KRAS', 'SLC12A3', 'PRPF4B', 'CDKN2A', 'IL1R1',\n       'PRKAR2B', 'IL15RA', 'KRT1', 'SMAD1', 'GTF2H1', 'CCR2', 'IL5RA',\n       'PLCG2', 'SLC12A2', 'GTF2H2', 'TMIGD2', 'IKBKG', 'BORA', 'MNAT1',\n       'PHKA1', 'BGLF4', 'RIN1', 'DLG1', 'CDK5RAP2', 'CCR1', 'IL10RA',\n       'SMAD5', 'CCN4'], dtype=object)\n\n\n\ndf['kinase_uniprot'] = df.kinase_gene.str.upper().map(gene2uniprot)\n\n\ndf = df.dropna(subset='kinase_uniprot')\n\n\n\nSubstrate mapping\n\ndf = df.dropna(subset='IDB')\n\nWe can’t trace the specific whole protein sequence based on SIGNOR ID, so we filter them out\n\ndf = df[~df.IDB.str.contains('SIGNOR')]\n\n\n# df.IDB.drop_duplicates().to_csv('raw/sig_substrate_id.csv')\n\n2,298 IDs were mapped to 2,298 results\n1 ID was not mapped: CHEBI:15721\nSequences are all from human\n\ndf = map_substrate('raw/idmapping_2025_03_12_signor.xlsx',df,'IDB')\n\n/home/sky1ove/miniconda3/lib/python3.13/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default\n  warn(\"Workbook contains no default style, apply openpyxl's default\")\n\n\nShape before processing (12354, 29)\nSpecies counts: substrate_species\nHomo sapiens (Human)    12353\nName: count, dtype: int64\nRemoving non-human substrates\nShape after processing (12353, 32)\n\n\n\ndf.shape\n\n(12353, 32)\n\n\n\n\nValidate site\n\ndf.RESIDUE = df.RESIDUE.str.split(';')\n\n\ndf = df.explode('RESIDUE')\n\n\ndf['acceptor'] = df['RESIDUE'].str[:3]\n\n\ndf.acceptor = df.acceptor.map({'Ser':'S','Thr':'T','Tyr':'Y'})\n\n\ndf['position'] = df['RESIDUE'].str[3:]\n\n\ndf['site']=df['acceptor']+df['position']\n\n\ndf = df.dropna(subset='site')\n\n\nfrom katlas.utils import *\n\n\ndf['site_match'] =validate_site_df(df,'site','substrate_sequence')\n\n\ndf.site_match.value_counts()\n\nsite_match\n1    11212\n0      118\nName: count, dtype: int64\n\n\n\ndf = df[df.site_match==1]\n\n\ndf.shape\n\n(11212, 36)\n\n\n\n\nSave\n\ndf.columns\n\nIndex(['ENTITYA', 'TYPEA', 'IDA', 'DATABASEA', 'ENTITYB', 'TYPEB', 'DATABASEB',\n       'EFFECT', 'MECHANISM', 'RESIDUE', 'SEQUENCE', 'TAX_ID', 'CELL_DATA',\n       'TISSUE_DATA', 'MODULATOR_COMPLEX', 'TARGET_COMPLEX', 'MODIFICATIONA',\n       'MODASEQ', 'MODIFICATIONB', 'MODBSEQ', 'PMID', 'DIRECT', 'NOTES',\n       'ANNOTATOR', 'SENTENCE', 'SIGNOR_ID', 'kinase_gene', 'kinase_uniprot',\n       'substrate_uniprot', 'substrate_genes', 'substrate_sequence',\n       'substrate_species', 'acceptor', 'position', 'site', 'site_match'],\n      dtype='object')\n\n\n\ncol = ['kinase_uniprot', 'kinase_gene', 'ENTITYA', 'TYPEA', \n\n       'substrate_uniprot', 'substrate_genes','site', 'substrate_sequence']\n\n\ndf = df[col].copy()\n\n\ndf.head()\n\n\n\n\n\n\n\n\nkinase_uniprot\nkinase_gene\nENTITYA\nTYPEA\nsubstrate_uniprot\nsubstrate_genes\nsite\nsubstrate_sequence\n\n\n\n\n0\nP68400\nCSNK2A1\nCSNK2A1\nprotein\nP05455\nSSB\nS366\nMAENGDNEKMAALEAKICHQIEYYFGDFNLPRDKFLKEQIKLDEGW...\n\n\n1\nP28482\nMAPK1\nMAPK1\nprotein\nP43354\nNR4A2 NOT NURR1 TINUR\nS126\nMPCVQAQYGSSPQGASPASQSYSYHSSGEYSSDFLTPEFVKFSMDL...\n\n\n2\nP11362\nFGFR1\nFGFR1\nprotein\nP56945\nBCAR1 CAS CASS1 CRKAS\nY128\nMNHLNVLAKALYDNVAESPDELSFRKGDIMTVLEQDTQGLDGWWLC...\n\n\n3\nP27361\nMAPK3\nMAPK3\nprotein\nP41182\nBCL6 BCL5 LAZ3 ZBTB27 ZNF51\nS343\nMASPADSCIQFTRHASDVLLNLNRLRSRDILTDVVIVVSREQFRAH...\n\n\n4\nQ16539\nMAPK14\nMAPK14\nprotein\nQ02078\nMEF2A MEF2\nS408\nMGRKKIQITRIMDERNRQVTFTKRKFGLMKKAYELSVLCDCEIALI...\n\n\n\n\n\n\n\n\ndf.shape\n\n(11212, 8)\n\n\n\ndf['source']=\"SIGNOR\"\n\n\n# df.to_excel('raw/signor.xlsx',index=False)",
    "crumbs": [
      "Preprocess kinase-substrate datasets"
    ]
  },
  {
    "objectID": "preprocess_dataset.html#gps-6.0",
    "href": "preprocess_dataset.html#gps-6.0",
    "title": "Preprocess kinase-substrate datasets",
    "section": "GPS 6.0",
    "text": "GPS 6.0\n\nData\npaper: https://academic.oup.com/nar/article/51/W1/W243/7157529#409532969\nweb: https://gps.biocuckoo.cn/index.php\nGo to paper link, download supplementary data - zip file, get Table S5\n\nimport pandas as pd\n\n\ngps = pd.read_csv('raw/GPS6_tableS5.csv')\n\n\ngps = gps[gps.source!=\"PhosphositePlus\"]\n\n\ngps = gps[gps.species==\"Homo sapiens\"]\n\n\ngps.shape\n\n(6087, 6)\n\n\n\ngps = gps[~gps.gene.str.contains('family')]\n\n\n\nKinase mapping\n\nfrom katlas.data import *\n\n\n# kinase_id = pd.read_excel('raw/uniprot_human_keyword_kinase.xlsx')\nkinase_id = Data.get_kinase_uniprot()\n\n\nkinase_id['Gene Names'] = kinase_id['Gene Names'].str.split(' ')\n\n\nkinase_id = kinase_id.explode('Gene Names')\n\nSome kinases share same gene names:\n\nkinase_id[kinase_id['Gene Names'].duplicated(keep=False)].sort_values('Gene Names').head()\n\n\n\n\n\n\n\n\nEntry\nEntry Name\nProtein names\nGene Names\nuniprot_keyword_kinase\non_tree\nOrganism\nKeywords\nSequence\n\n\n\n\n586\nQ9UIJ7\nKAD3_HUMAN\nGTP:AMP phosphotransferase AK3, mitochondrial ...\nAK3\n1\n0\nHomo sapiens (Human)\n3D-structure;Acetylation;Alternative splicing;...\nMGASARLLRAVIMGAPGSGKGTVSSRITTHFELKHLSSGDLLRDNM...\n\n\n152\nP27144\nKAD4_HUMAN\nAdenylate kinase 4, mitochondrial (EC 2.7.4.4)...\nAK3\n1\n0\nHomo sapiens (Human)\n3D-structure;Acetylation;ATP-binding;GTP-bindi...\nMASKLLRAVILGPPGSGKGTVCQRIAQNFGLQHLSSGHFLRENIKA...\n\n\n586\nQ9UIJ7\nKAD3_HUMAN\nGTP:AMP phosphotransferase AK3, mitochondrial ...\nAK3L1\n1\n0\nHomo sapiens (Human)\n3D-structure;Acetylation;Alternative splicing;...\nMGASARLLRAVIMGAPGSGKGTVSSRITTHFELKHLSSGDLLRDNM...\n\n\n152\nP27144\nKAD4_HUMAN\nAdenylate kinase 4, mitochondrial (EC 2.7.4.4)...\nAK3L1\n1\n0\nHomo sapiens (Human)\n3D-structure;Acetylation;ATP-binding;GTP-bindi...\nMASKLLRAVILGPPGSGKGTVCQRIAQNFGLQHLSSGHFLRENIKA...\n\n\n609\nQ9Y3D8\nKAD6_HUMAN\nAdenylate kinase isoenzyme 6 (AK6) (EC 2.7.4.3...\nAK6\n1\n0\nHomo sapiens (Human)\n3D-structure;Alternative splicing;ATP-binding;...\nMLLPNILLTGTPGVGKTTLGKELASKSGLKYINVGDLAREEQLYDG...\n\n\n\n\n\n\n\nWe’ll drop them to prevent confusion.\n\ndup_name = set(kinase_id[kinase_id['Gene Names'].duplicated(keep=False)]['Gene Names'])\n\n\ngps.gene.isin(dup_name).sum()\n\nnp.int64(76)\n\n\n\ngps.shape\n\n(4260, 6)\n\n\n\ngps = gps[~gps.gene.isin(dup_name)].copy()\n\n\ngene2uniprot = kinase_id.set_index('Gene Names')['Entry'].to_dict()\n\n\ngps.shape\n\n(4184, 6)\n\n\nunmapped:\n\ngps[gps.gene.str.upper().map(gene2uniprot).isna()].gene.unique()\n\narray(['DMPK1', 'MRCKa', 'YPKA', 'PKACb', 'PKCt', 'PKCh', 'PKCi', 'PKCz',\n       'PKG1', 'PKG2', 'PRKG1 Isoform Alpha', 'p70S6K', 'p70S6Kb',\n       'CCDPK', 'AMPKa1', 'PKD3', 'CK1d', 'CK1e', 'CK1g1', 'CSNK2B',\n       'p38b', 'p38d', 'p38g', 'AurB', 'AurC', 'TP53RK ', 'STLK3',\n       'PAK3 Isoform 2', 'TAO1', 'ACK'], dtype=object)\n\n\n\ngps['kinase_uniprot'] = gps.gene.str.upper().map(gene2uniprot)\n\n\ngps = gps.dropna(subset='kinase_uniprot')\n\n\n\nSubstrate mapping\n\n# gps.uniprot.drop_duplicates().to_csv('raw/GPS_substrate_id.csv')\n\n1,203 IDs were mapped to 1,208 results\n1,202 active entries and 1 obsolete entry are found\n\ngps.shape\n\n(3750, 7)\n\n\n\ngps = map_substrate('raw/idmapping_2025_03_12_GPS.xlsx',gps,'uniprot')\n\nShape before processing (3750, 7)\nSpecies counts: substrate_species\nHomo sapiens (Human)                                                                 3614\nRattus norvegicus (Rat)                                                                30\nMus musculus (Mouse)                                                                   19\nPongo abelii (Sumatran orangutan) (Pongo pygmaeus abelii)                              10\nPan troglodytes (Chimpanzee)                                                            6\nSus scrofa (Pig)                                                                        6\nBos taurus (Bovine)                                                                     5\nOryctolagus cuniculus (Rabbit)                                                          4\nMacaca fascicularis (Crab-eating macaque) (Cynomolgus monkey)                           4\nMesocricetus auratus (Golden hamster)                                                   4\nTupaia belangeri (Common tree shrew) (Tupaia glis belangeri)                            2\nCanis lupus familiaris (Dog) (Canis familiaris)                                         2\nPhodopus roborovskii (Roborovski's desert hamster) (Cricetulus roborovskii)             2\nMacaca mulatta (Rhesus macaque)                                                         2\nXenopus tropicalis (Western clawed frog) (Silurana tropicalis)                          2\nHylobates lar (Lar gibbon) (White-handed gibbon)                                        1\nCricetulus griseus (Chinese hamster) (Cricetulus barabensis griseus)                    1\nXenopus laevis (African clawed frog)                                                    1\nGaleopterus variegatus (Malayan flying lemur) (Cynocephalus variegatus)                 1\nNannospalax galili (Northern Israeli blind subterranean mole rat) (Spalax galili)       1\nSpermophilus citellus (European suslik) (Citellus citellus)                             1\nMarmota monax (Woodchuck)                                                               1\nPan paniscus (Pygmy chimpanzee) (Bonobo)                                                1\nDanio rerio (Zebrafish) (Brachydanio rerio)                                             1\nHepatitis delta virus genotype II (isolate 7/18/83) (HDV)                               1\nHuman T-cell leukemia virus 1 (strain Japan ATK-1 subtype A) (HTLV-1)                   1\nMacaca fuscata fuscata (Japanese macaque)                                               1\nHuman T-cell leukemia virus 1 (isolate Caribbea HS-35 subtype A) (HTLV-1)               1\nHuman T-cell leukemia virus 1 (isolate Melanesia mel5 subtype C) (HTLV-1)               1\nOvis aries (Sheep)                                                                      1\nHuman immunodeficiency virus type 1 group M subtype B (isolate NY5) (HIV-1)             1\nHuman immunodeficiency virus type 2 subtype A (isolate BEN) (HIV-2)                     1\nHuman immunodeficiency virus type 1 group M subtype B (isolate YU-2) (HIV-1)            1\nHuman immunodeficiency virus type 1 group M subtype B (isolate WMJ22) (HIV-1)           1\nCavia porcellus (Guinea pig)                                                            1\nHuman immunodeficiency virus type 1 group M subtype A (isolate MAL) (HIV-1)             1\nHuman immunodeficiency virus type 1 group M subtype F2 (isolate MP257) (HIV-1)          1\nHuman immunodeficiency virus type 1 group M subtype B (isolate LW123) (HIV-1)           1\nHuman immunodeficiency virus type 1 group M subtype B (isolate JRCSF) (HIV-1)           1\nHuman immunodeficiency virus type 1 group M subtype B (isolate JH32) (HIV-1)            1\nHuman immunodeficiency virus type 1 group M subtype B (isolate HXB2) (HIV-1)            1\nHuman immunodeficiency virus type 1 group M subtype C (isolate ETH2220) (HIV-1)         1\nHuman immunodeficiency virus type 1 group M subtype D (isolate ELI) (HIV-1)             1\nHuman immunodeficiency virus type 1 group M subtype B (isolate CDC-451) (HIV-1)         1\nHuman immunodeficiency virus type 1 group O (isolate ANT70) (HIV-1)                     1\nHuman immunodeficiency virus type 1 group M subtype A (isolate U455) (HIV-1)            1\nHuman immunodeficiency virus type 2 subtype A (isolate KR) (HIV-2)                      1\nPhodopus campbelli (Campbell's dwarf Russian hamster)                                   1\nHuman immunodeficiency virus type 2 subtype A (isolate ROD) (HIV-2)                     1\nHuman immunodeficiency virus type 1 group O (isolate MVP5180) (HIV-1)                   1\nFelis catus (Cat) (Felis silvestris catus)                                              1\nName: count, dtype: int64\nRemoving non-human substrates\nShape after processing (3614, 10)\n\n\n/home/sky1ove/miniconda3/lib/python3.13/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default\n  warn(\"Workbook contains no default style, apply openpyxl's default\")\n\n\n\ngps.shape\n\n(3614, 10)\n\n\n\n\nValidate site\n\nfrom katlas.utils import *\n\n\ngps['site']=gps['code'] + gps['position'].astype(int).astype(str)\n\n\ngps['site_match'] =validate_site_df(gps,'site','substrate_sequence')\n\n\ngps['site_match'].value_counts()\n\nsite_match\n1    3435\n0     179\nName: count, dtype: int64\n\n\n\ngps=gps[gps.site_match==1]\n\n\ngps.shape\n\n(3435, 12)\n\n\n\n\nSave\n\ngps.columns\n\nIndex(['position', 'code', 'gene', 'species', 'source', 'kinase_uniprot',\n       'substrate_uniprot', 'substrate_genes', 'substrate_sequence',\n       'substrate_species', 'site', 'site_match'],\n      dtype='object')\n\n\n\ngps = gps.rename(columns={'source':'GPS_source'})\n\n\ngps['source']='GPS6'\n\n\ncol = ['kinase_uniprot','gene', \n\n       'substrate_uniprot', 'substrate_genes', 'site','substrate_sequence', 'GPS_source','source']\n\n\ngps = gps[col].copy()\n\n\ngps.head()\n\n\n\n\n\n\n\n\nkinase_uniprot\ngene\nsubstrate_uniprot\nsubstrate_genes\nsite\nsubstrate_sequence\nGPS_source\nsource\n\n\n\n\n0\nP31749\nAKT1\nQ9Y261\nFOXA2 HNF3B TCF3B\nT156\nMLGAVKMEGHEPSDWSSYYAEPEGYSSVSNMNAGLGMNGMNTYMSM...\n14500912\nGPS6\n\n\n1\nP31749\nAKT1\nP49760\nCLK2\nT127\nMPHPRRYHSSERGSRGSYREHYRSRKHKRRRSRSWSSSSDRTRRRR...\nUniProt\nGPS6\n\n\n2\nP31749\nAKT1\nP49815\nTSC2 TSC4\nT1462\nMAKPTSKDSGLKEKFKILLGLGTPRPNPRSAEGKQTEFIITAEILR...\n12150915;15342917;12172553;UniProt\nGPS6\n\n\n3\nP31749\nAKT1\nP46527\nCDKN1B KIP1 p27\nT187\nMSNVRVSNGSPSLERMDARQAEHPKPSACRNLFGPVDHEELTRDLE...\n12042314;9192873;9399644;9311993;9388487;17254...\nGPS6\n\n\n4\nP31749\nAKT1\nO15111\nCHUK IKKA TCF16\nT23\nMERPPGLRPGAGGPWEMRERLGTGGFGNVCLYQHRELDLKIAIKSC...\n10485710;UniProt\nGPS6\n\n\n\n\n\n\n\n\n# gps.to_excel('raw/GPS6.xlsx',index=False)",
    "crumbs": [
      "Preprocess kinase-substrate datasets"
    ]
  },
  {
    "objectID": "preprocess_dataset.html#other-datasets",
    "href": "preprocess_dataset.html#other-datasets",
    "title": "Preprocess kinase-substrate datasets",
    "section": "Other datasets",
    "text": "Other datasets\n\nDouglass\nPaper: https://journals.physiology.org/doi/full/10.1152/ajpcell.00166.2012\nData is not available to download, but available upon request to authors\n\n\nRegPhos 2.0\nPaper: https://academic.oup.com/database/article/doi/10.1093/database/bau034/2634150\nGo to the paper link, scroll down to Supplementary data, download the zip file, docx file, table S4 is motif\n\n\nPhosida\nhttp://www.phosida.com/ is not accessible\nPhosida paper: https://pmc.ncbi.nlm.nih.gov/articles/PMC2258193/\n\n\nPhosphoNetwork\n2013 bioinformatics: https://pmc.ncbi.nlm.nih.gov/articles/PMC3866559/#btt627-T1\n2013 Mol Syst Biol.: https://pmc.ncbi.nlm.nih.gov/articles/PMC3658267/\nweb app: https://www.phosphonetworks.org/\nThe web app provides kinase-substrate pairs, but does not provides specific info of phosphorylation site.\nIt provides logo and pssm though in Download –&gt; Motif Matrix, which can be used to compare the PSSM result\n\n\nBioGRID\nGo to : https://downloads.thebiogrid.org/BioGRID, Current-Release–&gt;BIOGRID-PTMS-4.4.242.ptm.zip\nThere are two files in after extraction, however, they don’t contain kinase-substrate relationship.",
    "crumbs": [
      "Preprocess kinase-substrate datasets"
    ]
  },
  {
    "objectID": "preprocess_dataset.html#combine-all",
    "href": "preprocess_dataset.html#combine-all",
    "title": "Preprocess kinase-substrate datasets",
    "section": "Combine all",
    "text": "Combine all\n\nimport pandas as pd\nfrom pathlib import Path\n\n\npaths = [\n    'raw/GPS6.xlsx',\n    'raw/signor.xlsx',\n    'raw/ELM.xlsx',\n    'raw/iPTMNet.xlsx','raw/EPSD.xlsx',# 'raw/KiNet.xlsx',\n    'raw/psp_human.xlsx',\n    'raw/sugiyama.xlsx'\n]\n\n\ndfs = [pd.read_excel(path) for path in paths]\n\n\n[print(df.source.value_counts()) for df in dfs]\n\nsource\nGPS6    3435\nName: count, dtype: int64\nsource\nSIGNOR    11212\nName: count, dtype: int64\nsource\nELM    4519\nName: count, dtype: int64\nsource\niPTMNet    3478\nName: count, dtype: int64\nsource\nEPSD    10308\nName: count, dtype: int64\nsource\nPSP    13144\nName: count, dtype: int64\nsource\nSugiyama    184948\nName: count, dtype: int64\n\n\n[None, None, None, None, None, None, None]\n\n\nFor each df, we need to drop duplicates of kinase(uniprot)-substrate(uniprot)-site\n\ndef get_key(df):\n    df = df.copy()\n    print('original shape:',df.shape)\n    df['kin_sub_site']=df['kinase_uniprot']+'_'+df['substrate_uniprot']+'_'+df['site']\n    df = df.drop_duplicates(subset='kin_sub_site')\n    print('after removing duplicates',df.shape)\n    return df\n\n\ndfs=[get_key(df) for df in dfs]\n\noriginal shape: (3435, 8)\nafter removing duplicates (3326, 9)\noriginal shape: (11212, 9)\nafter removing duplicates (9320, 10)\noriginal shape: (4519, 10)\nafter removing duplicates (3807, 11)\noriginal shape: (3478, 9)\nafter removing duplicates (3478, 10)\noriginal shape: (10308, 9)\nafter removing duplicates (10308, 10)\noriginal shape: (13144, 13)\nafter removing duplicates (13091, 14)\noriginal shape: (184948, 11)\nafter removing duplicates (168342, 12)\n\n\n\nfor path,df in zip(paths,dfs):\n    print(Path(path).stem, df.shape)\n\nGPS6 (3326, 9)\nsignor (9320, 10)\nELM (3807, 11)\niPTMNet (3478, 10)\nEPSD (10308, 10)\npsp_human (13091, 14)\nsugiyama (168342, 12)\n\n\n\ncommon_cols = ['kinase_uniprot','substrate_uniprot','site','kin_sub_site','source','substrate_genes','substrate_sequence']\n\n\ndf_all = pd.concat(dfs,ignore_index=True)\ndf_all = df_all[common_cols].copy()\n\n\ndf_all.source.value_counts()\n\nsource\nSugiyama    168342\nPSP          13091\nEPSD         10308\nSIGNOR        9320\nELM           3807\niPTMNet       3478\nGPS6          3326\nName: count, dtype: int64\n\n\n\n# df_all.to_parquet('raw/combine_source.parquet')\n\n\ndf_grouped = df_all.groupby(\"kin_sub_site\").agg({\n    \"kinase_uniprot\": \"first\",\n    \"substrate_uniprot\": \"first\",\n    \"site\": \"first\",\n    \"source\": '|'.join,  # Concatenate sources with '|'\n    \"substrate_genes\": \"first\",\n    \"substrate_sequence\": \"first\"\n}).reset_index()\n\n\ndf_grouped.shape\n\n(187066, 7)\n\n\n\ndf_grouped.head()\n\n\n\n\n\n\n\n\nkin_sub_site\nkinase_uniprot\nsubstrate_uniprot\nsite\nsource\nsubstrate_genes\nsubstrate_sequence\n\n\n\n\n0\nO00141_A4FU28_S140\nO00141\nA4FU28\nS140\nSugiyama\nCTAGE9\nMEEPGATPQPYLGLVLEELGRVVAALPESMRPDENPYGFPSELVVC...\n\n\n1\nO00141_O00141_S252\nO00141\nO00141\nS252\nSugiyama\nSGK1 SGK\nMTVKTEAAKGTLTYSRMRGMVAILIAFMKQRRMGLNDFIQKIANNS...\n\n\n2\nO00141_O00141_S255\nO00141\nO00141\nS255\nSugiyama\nSGK1 SGK\nMTVKTEAAKGTLTYSRMRGMVAILIAFMKQRRMGLNDFIQKIANNS...\n\n\n3\nO00141_O00141_S397\nO00141\nO00141\nS397\nSugiyama\nSGK1 SGK\nMTVKTEAAKGTLTYSRMRGMVAILIAFMKQRRMGLNDFIQKIANNS...\n\n\n4\nO00141_O00141_S404\nO00141\nO00141\nS404\nSugiyama\nSGK1 SGK\nMTVKTEAAKGTLTYSRMRGMVAILIAFMKQRRMGLNDFIQKIANNS...\n\n\n\n\n\n\n\n\n# df_grouped.to_parquet('raw/combine_source_grouped.parquet')",
    "crumbs": [
      "Preprocess kinase-substrate datasets"
    ]
  },
  {
    "objectID": "preprocess_dataset.html#human-phosphoproteome",
    "href": "preprocess_dataset.html#human-phosphoproteome",
    "title": "Preprocess kinase-substrate datasets",
    "section": "Human phosphoproteome",
    "text": "Human phosphoproteome\n\nfrom katlas.core import *\nimport pandas as pd\n\n\nData\n\nhuman = Data.get_combine_site_psp_ochoa()\n\n\nhuman.shape\n\n(121419, 8)\n\n\n\n\nSubstrate mapping\n\n# human.uniprot.drop_duplicates().to_csv('raw/human_phosphoproteome_uniprot.csv')\n\n11,243 IDs were mapped to 11,241 results\n5 ID were not mapped: AAA58698 P18433-2 AAC50053 AAA60149 NP_001184222\n11,242 active entries and 1 obsolete entry are found\n\nhuman = map_substrate('raw/idmapping_2025_03_20_human_phosphoproteome.xlsx',human,'uniprot')\n\n/home/sky1ove/miniconda3/lib/python3.13/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default\n  warn(\"Workbook contains no default style, apply openpyxl's default\")\n\n\nShape before processing (121419, 8)\nSpecies counts: substrate_species\nHomo sapiens (Human)    121332\nName: count, dtype: int64\nRemoving non-human substrates\nShape after processing (121332, 11)\n\n\n\n\nValidate site\n\nhuman.columns\n\nIndex(['gene', 'site', 'site_seq', 'source', 'AM_pathogenicity', 'CDDM_upper',\n       'CDDM_max_score', 'substrate_uniprot', 'substrate_genes',\n       'substrate_sequence', 'substrate_species'],\n      dtype='object')\n\n\n\nhuman['site_match'] =validate_site_df(human,'site','substrate_sequence')\n\n\nhuman['site_match'].value_counts()\n\nsite_match\n1    120084\n0      1248\nName: count, dtype: int64\n\n\n\nhuman=human[human.site_match==1].copy()\n\n\nhuman.shape\n\n(120084, 12)\n\n\n\n\nRemove duplicates\n\nhuman['sub_site'] = human['substrate_uniprot']+'_'+human['site']\n\n\nhuman = human.drop_duplicates(subset='sub_site')\n\n\nhuman.shape\n\n(119955, 13)\n\n\n\n\nSave\n\nhuman.columns\n\nIndex(['gene', 'site', 'site_seq', 'source', 'AM_pathogenicity', 'CDDM_upper',\n       'CDDM_max_score', 'substrate_uniprot', 'substrate_genes',\n       'substrate_sequence', 'substrate_species', 'site_match', 'sub_site'],\n      dtype='object')\n\n\n\ncols = ['substrate_uniprot', 'substrate_genes',\n\n        'site', 'source', 'AM_pathogenicity', \n\n       'substrate_sequence', 'substrate_species', 'sub_site']\n\n\nhuman = human[cols]\n\n\n# human.to_parquet('raw/human_phosphoproteome.parquet')",
    "crumbs": [
      "Preprocess kinase-substrate datasets"
    ]
  },
  {
    "objectID": "preprocess_dataset.html#phosphorylate-sequence",
    "href": "preprocess_dataset.html#phosphorylate-sequence",
    "title": "Preprocess kinase-substrate datasets",
    "section": "Phosphorylate sequence",
    "text": "Phosphorylate sequence\n\nCombine human phosphoproteome and KS dataset site info\n\nhuman = pd.read_parquet('raw/human_phosphoproteome.parquet')\n\n\ncols = ['substrate_uniprot','site','substrate_sequence']\n\n\ndf_grouped = pd.read_parquet('raw/combine_source_grouped.parquet')\n\n\nhuman = human[cols]\n\ndf_grouped = df_grouped[cols]\n\n\ncomb = pd.concat([human,df_grouped])\n\n\ncomb['sub_site'] = comb['substrate_uniprot']+'_'+comb['site']\n\n\ncomb = comb.drop_duplicates('sub_site')\n\n\n\nPhosphorylate sequence\n\nseq = phosphorylate_seq_df(comb)\n\n\nseq.head()\n\n\n\n\n\n\n\n\nsubstrate_uniprot\nsite\nsubstrate_sequence\nphosphoseq\n\n\n\n\n0\nA0A024R4G9\n[S20]\nMTVLEAVLEIQAITGSRLLSMVPGPARPPGSCWDPTQCTRTWLLSH...\nMTVLEAVLEIQAITGSRLLsMVPGPARPPGSCWDPTQCTRTWLLSH...\n\n\n1\nA0A075B6Q4\n[S24, S35, S57, S68, S71, S72]\nMDIQKSENEDDSEWEDVDDEKGDSNDDYDSAGLLSDEDCMSVPGKT...\nMDIQKSENEDDSEWEDVDDEKGDsNDDYDSAGLLsDEDCMSVPGKT...\n\n\n2\nA0A075B6T3\n[S24, S26]\nXLKRAYRGLEEVQWCLEQLLTSPSPS\nXLKRAYRGLEEVQWCLEQLLTSPsPs\n\n\n3\nA0A075B759\n[T68]\nMVNSVVFFEITRDGKPLGRISIKLFADKIPKTAENFRALSTGEKGF...\nMVNSVVFFEITRDGKPLGRISIKLFADKIPKTAENFRALSTGEKGF...\n\n\n4\nA0A087WTJ2\n[T8, Y14, Y213, T215, S221, S421, S424]\nMGGRKMATDEENVYGLEENAQSRQESTRRLILVGRTGAGKSATGNS...\nMGGRKMAtDEENVyGLEENAQSRQESTRRLILVGRTGAGKSATGNS...\n\n\n\n\n\n\n\n\n# seq.to_csv('raw/phosphoseq_map.csv',index=False)\n\n\n\nMap to df\n\nhuman = pd.read_parquet('raw/human_phosphoproteome.parquet')\n\ndf_grouped = pd.read_parquet('raw/combine_source_grouped.parquet')\n\n\nseq_map = seq.set_index('substrate_uniprot')['phosphoseq']\n\n\nhuman['substrate_phosphoseq'] = human.substrate_uniprot.map(seq_map)\n\ndf_grouped['substrate_phosphoseq'] = df_grouped.substrate_uniprot.map(seq_map)\n\n\nhuman['substrate_phosphoseq'].isna().sum()\n\nnp.int64(0)\n\n\n\ndf_grouped['substrate_phosphoseq'].isna().sum()\n\nnp.int64(0)\n\n\n\n# human.to_parquet('raw/human_phosphoproteome.parquet')\n\n# df_grouped.to_parquet('raw/combine_source_grouped.parquet')",
    "crumbs": [
      "Preprocess kinase-substrate datasets"
    ]
  },
  {
    "objectID": "preprocess_dataset.html#extract-site-sequence",
    "href": "preprocess_dataset.html#extract-site-sequence",
    "title": "Preprocess kinase-substrate datasets",
    "section": "Extract site sequence",
    "text": "Extract site sequence\n\nhuman['position'] = human['site'].str[1:].astype(int)\n\ndf_grouped['position']=df_grouped['site'].str[1:].astype(int)\n\n\nextract_site_seq?\n\n\nSignature:\nextract_site_seq(\n    df: pandas.core.frame.DataFrame,\n    seq_col: str,\n    site_col: str,\n    n=7,\n)\nDocstring: Extract -n to +n site sequence from protein sequence\nFile:      /mnt/f/git/kkatlas/katlas/katlas/utils.py\nType:      function\n\n\n\n\nhuman['site_seq'] = extract_site_seq(human,\n                                  seq_col='substrate_phosphoseq',\n                                  site_col='site',n=20)\n\n100%|█████████████████████████████████████████████████████████████████████| 119955/119955 [00:04&lt;00:00, 25764.66it/s]\n\n\n\ndf_grouped['site_seq'] = extract_site_seq(df_grouped,\n                                  seq_col='substrate_phosphoseq',\n                                  site_col='site',n=20)\n\n100%|█████████████████████████████████████████████████████████████████████| 187066/187066 [00:07&lt;00:00, 25809.29it/s]\n\n\n\ndf_grouped['sub_site'] = df_grouped['substrate_uniprot']+'_'+ df_grouped['site']\n\nhuman['sub_site'] = human['substrate_uniprot']+'_'+ human['site']\n\n\n# human.to_parquet('raw/human_phosphoproteome.parquet')\n\n# df_grouped.to_parquet('raw/combine_source_grouped.parquet')",
    "crumbs": [
      "Preprocess kinase-substrate datasets"
    ]
  },
  {
    "objectID": "preprocess_dataset.html#add-kinase-info",
    "href": "preprocess_dataset.html#add-kinase-info",
    "title": "Preprocess kinase-substrate datasets",
    "section": "Add kinase info",
    "text": "Add kinase info\n\ndf=df_grouped.copy()\n\n\n# Remove pseudokinase duplicates by UniProt ID, keep only one entry per kinase\ninfo = Data.get_kinase_info().sort_values('kinase').drop_duplicates('uniprot')\n\n# Pre-extract UniProt ID without isoform for matching\ndf['uniprot_clean'] = df['kinase_uniprot'].str.split('-').str[0]\n\ninfo_indexed = info.set_index('uniprot')\ngroup_map = info_indexed['group']\nfamily_map = info_indexed['family']\npspa_small_map = info_indexed['pspa_category_small']\npspa_big_map = info_indexed['pspa_category_big']\n\ndf['kinase_on_tree'] = df['uniprot_clean'].isin(info['uniprot']).astype(int)\n\nkinase_gene_map = Data.get_kinase_uniprot().set_index('Entry')['Gene Names']\ndf['kinase_genes'] = df['uniprot_clean'].map(kinase_gene_map)\n\ndf['kinase_group'] = df['uniprot_clean'].map(group_map)\ndf['kinase_family'] = df['uniprot_clean'].map(family_map)\ndf['kinase_pspa_big'] = df['uniprot_clean'].map(pspa_big_map)\ndf['kinase_pspa_small'] = df['uniprot_clean'].map(pspa_small_map)\n\ndf.drop(columns='uniprot_clean', inplace=True)\n\nThe above code has been added into Data class when loading the ks dataset",
    "crumbs": [
      "Preprocess kinase-substrate datasets"
    ]
  },
  {
    "objectID": "reactome_path_plot_pspa.html",
    "href": "reactome_path_plot_pspa.html",
    "title": "Plot reactome pathways: PSPA",
    "section": "",
    "text": "from katlas.pssm import *\nfrom katlas.score import *\nfrom katlas.data import *\nfrom katlas.plot import *\nfrom katlas.pathway import *\nfrom katlas.utils import *\nimport pandas as pd,seaborn as sns\nfrom matplotlib import pyplot as plt\nfrom tqdm import tqdm\nimport time, random",
    "crumbs": [
      "Plot reactome pathways: PSPA"
    ]
  },
  {
    "objectID": "reactome_path_plot_pspa.html#data",
    "href": "reactome_path_plot_pspa.html#data",
    "title": "Plot reactome pathways: PSPA",
    "section": "Data",
    "text": "Data\n\npspa_info=pd.read_parquet('raw/pspa_path_info.parquet')\ndf=pd.read_parquet('raw/pspa_score_df.parquet')\n\n\nthr_cols = ['S_thr','T_thr','Y_thr']\ngene_cols = ['S_genes','T_genes','Y_genes']\ncnt_cols = ['S_cnt','T_cnt','Y_cnt']\nsite_cols = ['S_sites','T_sites','Y_sites']",
    "crumbs": [
      "Plot reactome pathways: PSPA"
    ]
  },
  {
    "objectID": "reactome_path_plot_pspa.html#site-pssms",
    "href": "reactome_path_plot_pspa.html#site-pssms",
    "title": "Plot reactome pathways: PSPA",
    "section": "Site pssms",
    "text": "Site pssms\n\nhuman_site= Data.get_human_site()\nseq_map = human_site.set_index('sub_site')['site_seq']\n\n\nseries=pspa_info.iloc[0]\n\n\ndef get_site_pssm(series):\n    pssm_dict = {}\n    count_dict={}\n    for acceptor, sites in zip(['S','T','Y'],series[site_cols]):\n        sites=list(sites)\n        if sites:\n            pssm = get_prob(seq_map[sites])\n            key = series.name+'_'+acceptor\n            pssm_dict[key] = pd.Series(flatten_pssm(pssm))\n            count_dict[key]=len(sites)\n    return pssm_dict,count_dict\n\n\npssm_out = {}\ncount_out = {}\nfor i,r in pspa_info.iterrows():\n    pssms,counts = get_site_pssm(r)\n    pssm_out.update(pssms)\n    count_out.update(counts)\n    # break\n\n\nsite_pssms = pd.DataFrame(pssm_out).T\n\n\npspa_info.index[314:]\n\nIndex(['MATK', 'DDR1', 'DDR2', 'EGFR', 'EPHA1', 'EPHA2', 'EPHA3', 'EPHA4',\n       'EPHA5', 'EPHA6', 'EPHA7', 'EPHA8', 'EPHB1', 'EPHB2', 'EPHB3', 'EPHB4',\n       'BMX', 'PTK2', 'FER', 'FES', 'FGFR1', 'FGFR2', 'FGFR3', 'FGFR4', 'FGR',\n       'FLT3', 'FRK', 'FYN', 'HCK', 'ERBB2', 'ERBB4', 'IGF1R', 'INSR', 'INSRR',\n       'ITK', 'JAK1', 'JAK2', 'JAK3', 'KIT', 'LCK', 'LIMK1_TYR', 'LIMK2_TYR',\n       'LTK', 'LYN', 'MERTK', 'MET', 'MAP2K4_TYR', 'MAP2K6_TYR', 'MAP2K7_TYR',\n       'MST1R', 'MUSK', 'PKMYT1_TYR', 'NEK10_TYR', 'PDGFRA', 'PDGFRB',\n       'PDHK1_TYR', 'PDHK3_TYR', 'PDHK4_TYR', 'PINK1_TYR', 'PTK2B', 'RET',\n       'ROS1', 'SRC', 'SRMS', 'SYK', 'TEC', 'TESK1_TYR', 'TEK', 'TNK1',\n       'TNNI3K_TYR', 'NTRK1', 'NTRK2', 'NTRK3', 'TXK', 'TYK2', 'TYRO3', 'FLT1',\n       'KDR', 'FLT4', 'WEE1_TYR', 'YES1', 'ZAP70'],\n      dtype='object', name='kinase')\n\n\n\nfor k in tqdm(pspa_info.index,total=len(pspa_info)):\n    k_pssms = site_pssms[site_pssms.index.str.contains(f'{k}_')]\n    plot_logos(k_pssms,count_dict=count_out)\n    path = prepare_path(f'fig/pspa/{k}/path/logo.svg')\n    save_show(path)\n    # break\n\n100%|█████████████████████████████████████████████████████████████| 82/82 [06:25&lt;00:00,  4.70s/it]\n\n\n\nsite_pssms.to_parquet('raw/pspa_site_pssm.parquet')",
    "crumbs": [
      "Plot reactome pathways: PSPA"
    ]
  },
  {
    "objectID": "reactome_path_plot_pspa.html#plot-distribution",
    "href": "reactome_path_plot_pspa.html#plot-distribution",
    "title": "Plot reactome pathways: PSPA",
    "section": "Plot distribution",
    "text": "Plot distribution\n\ndef plot_hist(df,\n              kinase,\n              sty_thr=None, # dict of thresholds per acceptor\n              hue='acceptor'):\n    \n    \"Plot histogram of a column (kinase). \"\n    \n    plt.figure(figsize=(6,2))\n\n    hist_params = {'element':'poly',\n              'edgecolor': None,\n              'alpha':0.5,\n              'bins':100,\n              'kde':True,\n              'palette':sty_color}\n    \n    sns.histplot(data=df,x=kinase,hue=hue,**hist_params)\n    \n    plt.xlabel('')\n    plt.title(f'{kinase} score distribution')\n\n    if sty_thr:\n        for acceptor,thr in sty_thr.items():\n            if thr is not None:\n                plt.axvline(thr,color=sty_color[acceptor])\n\n\nplot_hist(df,'AAK1')\n\n\n\n\n\n\n\n\n\nfor k,r in tqdm(pspa_info.iterrows(),total=len(pspa_info)):\n    sty_thr=r[thr_cols].rename(index={'S_thr':'S','T_thr':'T','Y_thr':'Y'})[lambda x: x!=0].to_dict()\n    plot_hist(df,k,sty_thr=sty_thr)\n    save_show(f'fig/pspa/{k}/path/hist.svg',show_only=False)\n\n100%|███████████████████████████████████████████████████████████| 396/396 [04:01&lt;00:00,  1.64it/s]",
    "crumbs": [
      "Plot reactome pathways: PSPA"
    ]
  },
  {
    "objectID": "reactome_path_plot_pspa.html#plot-reactome-pathway",
    "href": "reactome_path_plot_pspa.html#plot-reactome-pathway",
    "title": "Plot reactome pathways: PSPA",
    "section": "Plot reactome pathway",
    "text": "Plot reactome pathway\n\ninfo = Data.get_kinase_info()\n\n\ninfo = info[info.pseudo=='0']\n\n\ninfo.uniprot.duplicated().sum()\n\nnp.int64(0)\n\n\n\nkinase_map = info.set_index('kinase')['uniprot']\n\n\ndef get_path(series):\n    out = get_reactome(series['genes'],p_type='p')\n    kinase=series.name.split('_')[0] # for those with _TRY, need to remove that\n    uniprot = kinase_map[kinase]\n    out = add_reactome_ref(out,uniprot)\n    exclude=['GTPase','SUMO']\n    out = out[~out.name.str.contains('|'.join(exclude))]\n    return out\n\n\nshow_only=False\n\n\npspa_info.index.get_loc('PKG1')\n\n234\n\n\n\nlen(pspa_info)\n\n396\n\n\n\nfor i,(k,r) in enumerate(pspa_info.iloc[234:].iterrows()):\n    print(i,':',k)\n    save_dir = f'fig/pspa/{k}/path'\n    \n    path_df = get_path(r)\n    path_df.to_parquet(f'{save_dir}/path.parquet')\n\n    plot_path(path_df,p_type='p',ref_col='ref_path',top_n=15,max_label_length=55)\n    plt.title('Reactome pathways of substrates based on scores')\n    save_show(f'{save_dir}/path.svg',show_only=show_only)\n\n    if path_df.ref_path.sum()!=0:\n        accuracy = get_overlap(path_df, ref_col='ref_path',plot=True,p_type='p',figsize=(5,3))\n        plt.title(f'Distribution of –log₁₀(p) for reference pathways')\n        save_show(f'{save_dir}/overlap.svg',show_only=show_only)\n\n    if path_df.ref_path_lowest.sum()!=0:\n        accuracy_lo = get_overlap(path_df, ref_col='ref_path_lowest',plot=True,p_type='p',figsize=(5,3))\n        plt.title(f'Distribution of –log₁₀(p) for reference pathways \\n(lowest-level)')\n        save_show(f'{save_dir}/overlap_lo.svg',show_only=show_only)\n    plt.close('all')\n    # break\n    \n    # ✅ polite delay to avoid API throttling\n    delay = random.uniform(1.5, 4)\n    print(f\"Sleeping {delay:.2f}s before next kinase...\")\n    time.sleep(delay)\n\n0 : PKG1\nRunning pathway anlysis\nDone\nSleeping 1.76s before next kinase...\n1 : PKG2\nRunning pathway anlysis\nDone\nSleeping 3.58s before next kinase...\n2 : PKN1\nRunning pathway anlysis\nDone\nSleeping 3.84s before next kinase...\n3 : PKN2\nRunning pathway anlysis\nDone\nSleeping 1.53s before next kinase...\n4 : PKN3\nRunning pathway anlysis\nDone\nSleeping 3.71s before next kinase...\n5 : PKR\nRunning pathway anlysis\nDone\nSleeping 2.22s before next kinase...\n6 : PLK1\nRunning pathway anlysis\nDone\nSleeping 2.26s before next kinase...\n7 : PLK2\nRunning pathway anlysis\nDone\nSleeping 3.69s before next kinase...\n8 : PLK3\nRunning pathway anlysis\nDone\nSleeping 3.72s before next kinase...\n9 : PLK4\nRunning pathway anlysis\nDone\nSleeping 2.47s before next kinase...\n10 : PRKD1\nRunning pathway anlysis\nDone\nSleeping 3.57s before next kinase...\n11 : PRKD2\nRunning pathway anlysis\nDone\nSleeping 3.49s before next kinase...\n12 : PRKD3\nRunning pathway anlysis\nDone\nSleeping 2.62s before next kinase...\n13 : PRKX\nRunning pathway anlysis\nDone\nSleeping 1.52s before next kinase...\n14 : PRP4\nRunning pathway anlysis\nDone\nSleeping 3.73s before next kinase...\n15 : PRPK\nRunning pathway anlysis\nDone\nSleeping 3.47s before next kinase...\n16 : QIK\nRunning pathway anlysis\nDone\nSleeping 3.01s before next kinase...\n17 : QSK\nRunning pathway anlysis\nDone\nSleeping 3.31s before next kinase...\n18 : RAF1\nRunning pathway anlysis\nDone\nSleeping 3.83s before next kinase...\n19 : RIPK1\nRunning pathway anlysis\nDone\nSleeping 2.40s before next kinase...\n20 : RIPK2\nRunning pathway anlysis\nDone\nSleeping 2.06s before next kinase...\n21 : RIPK3\nRunning pathway anlysis\nDone\nSleeping 2.47s before next kinase...\n22 : ROCK1\nRunning pathway anlysis\nDone\nSleeping 1.61s before next kinase...\n23 : ROCK2\nRunning pathway anlysis\nDone\nSleeping 3.03s before next kinase...\n24 : RSK2\nRunning pathway anlysis\nDone\nSleeping 3.97s before next kinase...\n25 : RSK3\nRunning pathway anlysis\nDone\nSleeping 2.58s before next kinase...\n26 : RSK4\nRunning pathway anlysis\nDone\nSleeping 3.62s before next kinase...\n27 : SBK\nRunning pathway anlysis\nDone\nSleeping 3.00s before next kinase...\n28 : SGK1\nRunning pathway anlysis\nDone\nSleeping 3.17s before next kinase...\n29 : SGK3\nRunning pathway anlysis\nDone\nSleeping 3.48s before next kinase...\n30 : SIK\nRunning pathway anlysis\nDone\nSleeping 1.87s before next kinase...\n31 : SKMLCK\nRunning pathway anlysis\nDone\nSleeping 3.27s before next kinase...\n32 : SLK\nRunning pathway anlysis\nDone\nSleeping 2.15s before next kinase...\n33 : SMG1\nRunning pathway anlysis\nDone\nSleeping 3.51s before next kinase...\n34 : SMMLCK\nRunning pathway anlysis\nDone\nSleeping 3.48s before next kinase...\n35 : SNRK\nRunning pathway anlysis\nDone\nSleeping 3.78s before next kinase...\n36 : SRPK1\nRunning pathway anlysis\nDone\nSleeping 3.51s before next kinase...\n37 : SRPK2\nRunning pathway anlysis\nDone\nSleeping 2.69s before next kinase...\n38 : SRPK3\nRunning pathway anlysis\nDone\nSleeping 2.74s before next kinase...\n39 : SSTK\nRunning pathway anlysis\nDone\nSleeping 3.58s before next kinase...\n40 : STK33\nRunning pathway anlysis\nDone\nSleeping 2.59s before next kinase...\n41 : STLK3\nRunning pathway anlysis\nDone\nSleeping 2.64s before next kinase...\n42 : TAK1\nRunning pathway anlysis\nDone\nSleeping 2.17s before next kinase...\n43 : TAO1\nRunning pathway anlysis\nDone\nSleeping 1.69s before next kinase...\n44 : TAO2\nRunning pathway anlysis\nDone\nSleeping 2.43s before next kinase...\n45 : TAO3\nRunning pathway anlysis\nDone\nSleeping 2.88s before next kinase...\n46 : TBK1\nRunning pathway anlysis\nDone\nSleeping 2.63s before next kinase...\n47 : TGFBR1\nRunning pathway anlysis\nDone\nSleeping 1.83s before next kinase...\n48 : TGFBR2\nRunning pathway anlysis\nDone\nSleeping 2.46s before next kinase...\n49 : TLK1\nRunning pathway anlysis\nDone\nSleeping 3.56s before next kinase...\n50 : TLK2\nRunning pathway anlysis\nDone\nSleeping 3.43s before next kinase...\n51 : TNIK\nRunning pathway anlysis\nDone\nSleeping 3.14s before next kinase...\n52 : TSSK1\nRunning pathway anlysis\nDone\nSleeping 2.08s before next kinase...\n53 : TSSK2\nRunning pathway anlysis\nDone\nSleeping 3.35s before next kinase...\n54 : TTBK1\nRunning pathway anlysis\nDone\nSleeping 1.84s before next kinase...\n55 : TTBK2\nRunning pathway anlysis\nDone\nSleeping 3.96s before next kinase...\n56 : TTK\nRunning pathway anlysis\nDone\nSleeping 1.95s before next kinase...\n57 : ULK1\nRunning pathway anlysis\nDone\nSleeping 1.50s before next kinase...\n58 : ULK2\nRunning pathway anlysis\nDone\nSleeping 3.75s before next kinase...\n59 : VRK1\nRunning pathway anlysis\nDone\nSleeping 1.69s before next kinase...\n60 : VRK2\nRunning pathway anlysis\nDone\nSleeping 2.76s before next kinase...\n61 : WNK1\nRunning pathway anlysis\nDone\nSleeping 2.50s before next kinase...\n62 : WNK3\nRunning pathway anlysis\nDone\nSleeping 2.96s before next kinase...\n63 : WNK4\nRunning pathway anlysis\nDone\nSleeping 2.90s before next kinase...\n64 : YANK2\nRunning pathway anlysis\nDone\nSleeping 2.29s before next kinase...\n65 : YANK3\nRunning pathway anlysis\nDone\nSleeping 3.09s before next kinase...\n66 : YSK1\nRunning pathway anlysis\nDone\nSleeping 2.05s before next kinase...\n67 : YSK4\nRunning pathway anlysis\nDone\nSleeping 3.41s before next kinase...\n68 : ZAK\nRunning pathway anlysis\nDone\nSleeping 2.01s before next kinase...\n69 : ABL1\nRunning pathway anlysis\nDone\nSleeping 2.62s before next kinase...\n70 : TNK2\nRunning pathway anlysis\nDone\nSleeping 1.94s before next kinase...\n71 : ALK\nRunning pathway anlysis\nDone\nSleeping 2.47s before next kinase...\n72 : ABL2\nRunning pathway anlysis\nDone\nSleeping 2.07s before next kinase...\n73 : AXL\nRunning pathway anlysis\nDone\nSleeping 2.26s before next kinase...\n74 : BLK\nRunning pathway anlysis\nDone\nSleeping 3.63s before next kinase...\n75 : BMPR2_TYR\nRunning pathway anlysis\nDone\nSleeping 2.52s before next kinase...\n76 : PTK6\nRunning pathway anlysis\nDone\nSleeping 1.56s before next kinase...\n77 : BTK\nRunning pathway anlysis\nDone\nSleeping 3.41s before next kinase...\n78 : CSF1R\nRunning pathway anlysis\nDone\nSleeping 2.02s before next kinase...\n79 : CSK\nRunning pathway anlysis\nDone\nSleeping 3.02s before next kinase...\n80 : MATK\nRunning pathway anlysis\nDone\nSleeping 2.36s before next kinase...\n81 : DDR1\nRunning pathway anlysis\nDone\nSleeping 3.25s before next kinase...\n82 : DDR2\nRunning pathway anlysis\nDone\nSleeping 3.56s before next kinase...\n83 : EGFR\nRunning pathway anlysis\nDone\nSleeping 3.61s before next kinase...\n84 : EPHA1\nRunning pathway anlysis\nDone\nSleeping 2.18s before next kinase...\n85 : EPHA2\nRunning pathway anlysis\nDone\nSleeping 2.43s before next kinase...\n86 : EPHA3\nRunning pathway anlysis\nDone\nSleeping 2.56s before next kinase...\n87 : EPHA4\nRunning pathway anlysis\nDone\nSleeping 2.86s before next kinase...\n88 : EPHA5\nRunning pathway anlysis\nDone\nSleeping 1.78s before next kinase...\n89 : EPHA6\nRunning pathway anlysis\nDone\nSleeping 3.61s before next kinase...\n90 : EPHA7\nRunning pathway anlysis\nDone\nSleeping 1.55s before next kinase...\n91 : EPHA8\nRunning pathway anlysis\nDone\nSleeping 3.87s before next kinase...\n92 : EPHB1\nRunning pathway anlysis\nDone\nSleeping 3.94s before next kinase...\n93 : EPHB2\nRunning pathway anlysis\nDone\nSleeping 1.95s before next kinase...\n94 : EPHB3\nRunning pathway anlysis\nDone\nSleeping 3.85s before next kinase...\n95 : EPHB4\nRunning pathway anlysis\nDone\nSleeping 3.69s before next kinase...\n96 : BMX\nRunning pathway anlysis\nDone\nSleeping 2.42s before next kinase...\n97 : PTK2\nRunning pathway anlysis\nDone\nSleeping 2.28s before next kinase...\n98 : FER\nRunning pathway anlysis\nDone\nSleeping 3.62s before next kinase...\n99 : FES\nRunning pathway anlysis\nDone\nSleeping 2.71s before next kinase...\n100 : FGFR1\nRunning pathway anlysis\nDone\nSleeping 3.76s before next kinase...\n101 : FGFR2\nRunning pathway anlysis\nDone\nSleeping 3.21s before next kinase...\n102 : FGFR3\nRunning pathway anlysis\nDone\nSleeping 3.76s before next kinase...\n103 : FGFR4\nRunning pathway anlysis\nDone\nSleeping 1.92s before next kinase...\n104 : FGR\nRunning pathway anlysis\nDone\nSleeping 3.07s before next kinase...\n105 : FLT3\nRunning pathway anlysis\nDone\nSleeping 2.74s before next kinase...\n106 : FRK\nRunning pathway anlysis\nDone\nSleeping 2.29s before next kinase...\n107 : FYN\nRunning pathway anlysis\nDone\nSleeping 3.96s before next kinase...\n108 : HCK\nRunning pathway anlysis\nDone\nSleeping 3.79s before next kinase...\n109 : ERBB2\nRunning pathway anlysis\nDone\nSleeping 3.60s before next kinase...\n110 : ERBB4\nRunning pathway anlysis\nDone\nSleeping 2.30s before next kinase...\n111 : IGF1R\nRunning pathway anlysis\nDone\nSleeping 3.69s before next kinase...\n112 : INSR\nRunning pathway anlysis\nDone\nSleeping 1.54s before next kinase...\n113 : INSRR\nRunning pathway anlysis\nDone\nSleeping 2.27s before next kinase...\n114 : ITK\nRunning pathway anlysis\nDone\nSleeping 2.54s before next kinase...\n115 : JAK1\nRunning pathway anlysis\nDone\nSleeping 3.95s before next kinase...\n116 : JAK2\nRunning pathway anlysis\nDone\nSleeping 2.08s before next kinase...\n117 : JAK3\nRunning pathway anlysis\nDone\nSleeping 2.74s before next kinase...\n118 : KIT\nRunning pathway anlysis\nDone\nSleeping 3.46s before next kinase...\n119 : LCK\nRunning pathway anlysis\nDone\nSleeping 3.49s before next kinase...\n120 : LIMK1_TYR\nRunning pathway anlysis\nDone\nSleeping 3.55s before next kinase...\n121 : LIMK2_TYR\nRunning pathway anlysis\nDone\nSleeping 1.64s before next kinase...\n122 : LTK\nRunning pathway anlysis\nDone\nSleeping 3.52s before next kinase...\n123 : LYN\nRunning pathway anlysis\nDone\nSleeping 1.60s before next kinase...\n124 : MERTK\nRunning pathway anlysis\nDone\nSleeping 3.30s before next kinase...\n125 : MET\nRunning pathway anlysis\nDone\nSleeping 2.94s before next kinase...\n126 : MAP2K4_TYR\nRunning pathway anlysis\nDone\nSleeping 3.77s before next kinase...\n127 : MAP2K6_TYR\nRunning pathway anlysis\nDone\nSleeping 3.20s before next kinase...\n128 : MAP2K7_TYR\nRunning pathway anlysis\nDone\nSleeping 3.93s before next kinase...\n129 : MST1R\nRunning pathway anlysis\nDone\nSleeping 2.87s before next kinase...\n130 : MUSK\nRunning pathway anlysis\nDone\nSleeping 1.81s before next kinase...\n131 : PKMYT1_TYR\nRunning pathway anlysis\nDone\nSleeping 1.62s before next kinase...\n132 : NEK10_TYR\nRunning pathway anlysis\nDone\nSleeping 2.77s before next kinase...\n133 : PDGFRA\nRunning pathway anlysis\nDone\nSleeping 2.99s before next kinase...\n134 : PDGFRB\nRunning pathway anlysis\nDone\nSleeping 2.59s before next kinase...\n135 : PDHK1_TYR\nRunning pathway anlysis\nDone\nSleeping 3.13s before next kinase...\n136 : PDHK3_TYR\nRunning pathway anlysis\nDone\nSleeping 1.88s before next kinase...\n137 : PDHK4_TYR\nRunning pathway anlysis\nDone\nSleeping 2.94s before next kinase...\n138 : PINK1_TYR\nRunning pathway anlysis\nDone\nSleeping 1.71s before next kinase...\n139 : PTK2B\nRunning pathway anlysis\nDone\nSleeping 1.73s before next kinase...\n140 : RET\nRunning pathway anlysis\nDone\nSleeping 2.62s before next kinase...\n141 : ROS1\nRunning pathway anlysis\nDone\nSleeping 2.28s before next kinase...\n142 : SRC\nRunning pathway anlysis\nDone\nSleeping 2.51s before next kinase...\n143 : SRMS\nRunning pathway anlysis\nDone\nSleeping 3.57s before next kinase...\n144 : SYK\nRunning pathway anlysis\nDone\nSleeping 1.58s before next kinase...\n145 : TEC\nRunning pathway anlysis\nDone\nSleeping 3.28s before next kinase...\n146 : TESK1_TYR\nRunning pathway anlysis\nDone\nSleeping 1.95s before next kinase...\n147 : TEK\nRunning pathway anlysis\nDone\nSleeping 3.01s before next kinase...\n148 : TNK1\nRunning pathway anlysis\nDone\nSleeping 2.26s before next kinase...\n149 : TNNI3K_TYR\nRunning pathway anlysis\nDone\nSleeping 2.93s before next kinase...\n150 : NTRK1\nRunning pathway anlysis\nDone\nSleeping 1.59s before next kinase...\n151 : NTRK2\nRunning pathway anlysis\nDone\nSleeping 2.25s before next kinase...\n152 : NTRK3\nRunning pathway anlysis\nDone\nSleeping 3.27s before next kinase...\n153 : TXK\nRunning pathway anlysis\nDone\nSleeping 2.32s before next kinase...\n154 : TYK2\nRunning pathway anlysis\nDone\nSleeping 2.02s before next kinase...\n155 : TYRO3\nRunning pathway anlysis\nDone\nSleeping 3.15s before next kinase...\n156 : FLT1\nRunning pathway anlysis\nDone\nSleeping 2.19s before next kinase...\n157 : KDR\nRunning pathway anlysis\nDone\nSleeping 3.82s before next kinase...\n158 : FLT4\nRunning pathway anlysis\nDone\nSleeping 2.05s before next kinase...\n159 : WEE1_TYR\nRunning pathway anlysis\nDone\nSleeping 1.99s before next kinase...\n160 : YES1\nRunning pathway anlysis\nDone\nSleeping 3.00s before next kinase...\n161 : ZAP70\nRunning pathway anlysis\nDone\nSleeping 2.91s before next kinase...",
    "crumbs": [
      "Plot reactome pathways: PSPA"
    ]
  },
  {
    "objectID": "reactome_path_plot_pspa.html#get-accuracy-for-overlap-pathways",
    "href": "reactome_path_plot_pspa.html#get-accuracy-for-overlap-pathways",
    "title": "Plot reactome pathways: PSPA",
    "section": "Get accuracy for overlap pathways",
    "text": "Get accuracy for overlap pathways\n\nacc_dict, num_dict = {}, {}\nacc_lo_dict, num_lo_dict = {}, {}\n\nfor k,r in pspa_info.iterrows():\n    save_dir = f'fig/pspa/{k}/path'\n    \n    path_df=pd.read_parquet(f'{save_dir}/path.parquet')\n\n    if path_df.ref_path.sum()!=0:\n        accuracy = get_overlap(path_df, ref_col='ref_path',plot=False,p_type='p')\n        acc_dict[k] = accuracy\n        num_dict[k] =path_df.ref_path.sum()\n\n    if path_df.ref_path_lowest.sum()!=0:\n        accuracy_lo = get_overlap(path_df, ref_col='ref_path_lowest',plot=False,p_type='p')\n        acc_lo_dict[k] = accuracy_lo\n        num_lo_dict[k] = path_df.ref_path_lowest.sum()\n    # break\n\n\npspa_info['accuracy'] = acc_dict\npspa_info['accuracy_lowest'] = acc_lo_dict\n\npspa_info['path_num'] = num_dict\npspa_info['path_lowest_num'] = num_lo_dict\n\n\npspa_info['path_num'] = pspa_info['path_num'].fillna(0).astype(int)\npspa_info['path_lowest_num'] = pspa_info['path_lowest_num'].fillna(0).astype(int)\n\n\npspa_info.to_parquet('raw/pspa_path_info.parquet')",
    "crumbs": [
      "Plot reactome pathways: PSPA"
    ]
  },
  {
    "objectID": "reactome_path_plot_pspa.html#pathway-hue",
    "href": "reactome_path_plot_pspa.html#pathway-hue",
    "title": "Plot reactome pathways: PSPA",
    "section": "Pathway hue",
    "text": "Pathway hue\n\npspa_info=pd.read_parquet('raw/pspa_path_info.parquet')\n\n\ndef plot_path_hist(df,\n              colname,\n              **kwargs,\n              ):\n    \n    \"Plot histogram of a column (kinase). \"\n    \n    plt.figure(figsize=(6,2))\n\n    hist_params = {'element':'poly',\n              'edgecolor': None,\n              'alpha':0.5,\n              'bins':100,\n              'kde':True,\n              }\n    \n    sns.histplot(data=df,x=colname,**kwargs, **hist_params)\n    \n    plt.xlabel('')\n    plt.title(f'Accuracy score distribution')\n\n\nq75, q50 = pspa_info.path_num[lambda x: x!=0].quantile([0.75,0.5])\nq75, q50\n\n(33.75, 11.0)\n\n\n\ndef categorize_path_num(x):\n    if x &gt;= q75: return f'well known (≥{q75:.0f})'\n    elif x &lt;= q50: return f'less known (≤{q50:.0f})'\n    else: return f'middle ({q50:.0f}–{q75:.0f})'\n\n\npspa_info['category'] = pspa_info['path_num'].apply(categorize_path_num)\n\n\npspa_info['category'].value_counts()\n\ncategory\nless known (≤11)    253\nwell known (≥34)     74\nmiddle (11–34)       69\nName: count, dtype: int64\n\n\n\npspa_info.hist(column='accuracy', by='category', bins=50, figsize=(8,6));\n\n\n\n\n\n\n\n\n\npspa_info[pspa_info.path_num&gt;12].accuracy.hist(bins=50,figsize=(5,3))\nplt.xlabel('Accuracy')\nplt.ylabel('Number of kinases')\nplt.title('PSPA accuracy distribution');\n\n\n\n\n\n\n\n\n\nLowest\n\npspa_info.path_lowest_num[lambda x: x!=0].quantile([0.75])\n\n0.75    10.0\nName: path_lowest_num, dtype: float64\n\n\n\npspa_info[pspa_info.path_lowest_num&gt;10].accuracy.hist(bins=50,figsize=(5,3))\nplt.xlabel('Accuracy')\nplt.ylabel('Number of kinases')\nplt.title('PSPA accuracy distribution (lowest-level)');",
    "crumbs": [
      "Plot reactome pathways: PSPA"
    ]
  },
  {
    "objectID": "scale_pspa.html",
    "href": "scale_pspa.html",
    "title": "PSPA scaled data",
    "section": "",
    "text": "from katlas.core import *\nimport pandas as pd\n\n\npspa = Data.get_pspa_all_norm().dropna(axis=1)\n\n\ndef normalize_pspa_row(r): return flatten_pssm(clean_zero_normalize(recover_pssm(r)))\n\n\npspa_scale = pspa.apply(lambda r: pd.Series(normalize_pspa_row(r)),axis=1)\n\n\n# pspa_scale.to_parquet('~/katlas/dataset/PSPA/pspa_all_scale.parquet')\n\n\nData.get_pspa_all_scale()\n\n\n\n\n\n\n\n\n-5P\n-5G\n-5A\n-5C\n-5S\n-5T\n-5V\n-5I\n-5L\n-5M\n...\n4H\n4K\n4R\n4Q\n4N\n4D\n4E\n4pS\n4pT\n4pY\n\n\nkinase\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nAAK1\n0.05845\n0.01989\n0.02305\n0.03702\n0.03450\n0.03450\n0.07720\n0.12615\n0.08061\n0.07014\n...\n0.04482\n0.06651\n0.07427\n0.05082\n0.04738\n0.03113\n0.03657\n0.02009\n0.02009\n0.02161\n\n\nACVR2A\n0.02971\n0.03443\n0.04180\n0.03500\n0.04137\n0.04137\n0.04281\n0.04474\n0.04266\n0.03729\n...\n0.04202\n0.03865\n0.03601\n0.04517\n0.04077\n0.04693\n0.04693\n0.05155\n0.05155\n0.04319\n\n\nACVR2B\n0.03779\n0.03665\n0.04013\n0.05473\n0.03779\n0.03779\n0.03850\n0.03134\n0.03339\n0.03658\n...\n0.04056\n0.03261\n0.03514\n0.04229\n0.03846\n0.05278\n0.05039\n0.05502\n0.05502\n0.04605\n\n\nAKT1\n0.04669\n0.04599\n0.04274\n0.04684\n0.03995\n0.03995\n0.03306\n0.03368\n0.03592\n0.03910\n...\n0.05299\n0.09151\n0.08648\n0.05874\n0.05187\n0.03541\n0.02494\n0.03141\n0.03141\n0.02102\n\n\nAKT2\n0.04617\n0.04732\n0.04931\n0.04464\n0.04095\n0.04095\n0.03321\n0.03206\n0.03781\n0.03934\n...\n0.05199\n0.08844\n0.07580\n0.04992\n0.04770\n0.02772\n0.02680\n0.04196\n0.04196\n0.03193\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\nKDR\n0.04816\n0.05105\n0.04224\n0.03927\n0.04110\n0.03996\n0.03244\n0.03191\n0.03251\n0.03616\n...\n0.04386\n0.07036\n0.07377\n0.04718\n0.03979\n0.03074\n0.02808\n0.02492\n0.02492\n0.02426\n\n\nFLT4\n0.03554\n0.04129\n0.03795\n0.04300\n0.03982\n0.03663\n0.03360\n0.03881\n0.03686\n0.04122\n...\n0.05899\n0.05158\n0.06051\n0.04823\n0.03842\n0.04042\n0.03962\n0.03548\n0.03548\n0.03986\n\n\nWEE1_TYR\n0.04065\n0.04899\n0.04279\n0.04287\n0.03314\n0.03330\n0.04348\n0.04371\n0.04876\n0.04302\n...\n0.04213\n0.09097\n0.10234\n0.04450\n0.03460\n0.02749\n0.03166\n0.03051\n0.03051\n0.03788\n\n\nYES1\n0.05216\n0.04399\n0.04137\n0.04084\n0.04060\n0.03891\n0.03352\n0.02889\n0.03082\n0.03567\n...\n0.04928\n0.04643\n0.05988\n0.05157\n0.03947\n0.03330\n0.03891\n0.02934\n0.02934\n0.03694\n\n\nZAP70\n0.03902\n0.05704\n0.04038\n0.03215\n0.03053\n0.03332\n0.03014\n0.02463\n0.01990\n0.03410\n...\n0.05540\n0.04640\n0.04599\n0.05879\n0.03352\n0.04929\n0.04607\n0.03633\n0.03633\n0.02626\n\n\n\n\n396 rows × 230 columns",
    "crumbs": [
      "PSPA scaled data"
    ]
  },
  {
    "objectID": "scoring_compare_psp_02.html",
    "href": "scoring_compare_psp_02.html",
    "title": "Scoring evaluation",
    "section": "",
    "text": "from katlas.core import *\nfrom katlas.plot import *\nimport pandas as pd,numpy as np\nfrom matplotlib import pyplot as plt",
    "crumbs": [
      "Scoring evaluation"
    ]
  },
  {
    "objectID": "scoring_compare_psp_02.html#load-pssmlo",
    "href": "scoring_compare_psp_02.html#load-pssmlo",
    "title": "Scoring evaluation",
    "section": "Load PSSM/LO",
    "text": "Load PSSM/LO\n\nLO = pd.read_parquet('out/CDDM_pssms_LO_eval_psp_02.parquet')\n\n\npspa = pd.read_parquet('raw/overlap_pspa.parquet')\n\n\nLO.index = LO.index.str.split('_').str[1]\npspa.index = pspa.index.str.split('_').str[1]\n\n\nLO = LO[LO.index.isin(pspa.index)]\n\n\nLO.shape, pspa.shape\n\n((312, 943), (312, 236))",
    "crumbs": [
      "Scoring evaluation"
    ]
  },
  {
    "objectID": "scoring_compare_psp_02.html#dataset-to-be-scored",
    "href": "scoring_compare_psp_02.html#dataset-to-be-scored",
    "title": "Scoring evaluation",
    "section": "Dataset to be scored",
    "text": "Dataset to be scored\n\ndf =pd.read_parquet('out/CDDM_test_set.parquet')\n\n\ndf['site_seq_upper'] = df.site_seq.str.upper()\n\n\n# only filter those with tested kinase\ndf = df[df.kinase_protein.isin(pspa.index)].copy()\n\n\n---------------------------------------------------------------------------\nNameError                                 Traceback (most recent call last)\nCell In[4], line 2\n      1 # only filter those with tested kinase\n----&gt; 2 df = df[df.kinase_protein.isin(pspa.index)].copy()\n\nNameError: name 'pspa' is not defined\n\n\n\n\ndf.shape\n\n(2484, 24)\n\n\n\ndef split_data(df):\n    df_st = df[df.kinase_group !='TK'].copy().reset_index(drop=True)\n    df_tyr = df[df.kinase_group =='TK'].copy().reset_index(drop=True)\n    \n    df_st = df_st[df_st.site_seq.str[20]!='y'].copy().reset_index(drop=True)\n    df_tyr = df_tyr[df_tyr.site_seq.str[20]=='y'].copy().reset_index(drop=True)\n    return df_st, df_tyr\n\n\ndf_st, df_tyr = split_data(df)",
    "crumbs": [
      "Scoring evaluation"
    ]
  },
  {
    "objectID": "scoring_compare_psp_02.html#scoring",
    "href": "scoring_compare_psp_02.html#scoring",
    "title": "Scoring evaluation",
    "section": "Scoring",
    "text": "Scoring\n\ngroup_map = df[['kinase_protein','kinase_group']].drop_duplicates().set_index('kinase_protein')['kinase_group']\nTK = group_map[group_map=='TK'].index\nST = group_map[group_map!='TK'].index\n\n\ndef split_ref(ref):\n    ref_st = ref[ref.index.isin(ST)].copy()\n    ref_tk = ref[ref.index.isin(TK)].copy()\n    return ref_st,ref_tk\n\n\nref_st,ref_tk = split_ref(LO)\n\n\nref_st.shape, ref_tk.shape\n\n((213, 943), (71, 943))\n\n\n\ndef get_kinase_rank(row_index,df,result):\n    kinase = df.loc[row_index, 'kinase_protein']\n    scores = result.loc[row_index]\n    ranked = scores.sort_values(ascending=False)\n    rank = ranked.index.get_loc(kinase) + 1  # +1 to make rank start from 1\n    return rank\n\n\nhuman =Data.get_human_site()\n\nCPU times: user 176 ms, sys: 224 ms, total: 400 ms\nWall time: 2.86 s\n\n\n\nhuman['site_seq_upper'] = human.site_seq.str.upper()\n\n\nhuman = human.drop_duplicates('site_seq').reset_index()\n\n\ndef score_data(df,ref,seq_col='site_seq',func=sumup,pct_ref=None):\n    df_st, df_tyr = split_data(df)\n    ref_st,ref_tk = split_ref(ref)\n    \n    df_st_result = predict_kinase_df(df_st,seq_col=seq_col,ref=ref_st,func=func)\n    df_tyr_result = predict_kinase_df(df_tyr,seq_col=seq_col,ref=ref_tk,func=func)\n    \n    if pct_ref is not None:\n        df_st_result = get_pct_df(df_st_result,pct_ref)\n        df_tyr_result = get_pct_df(df_tyr_result,pct_ref)\n    \n    df_st['rank'] = df_st_result.index.to_series().apply(lambda idx: get_kinase_rank(idx,df_st,df_st_result))\n    df_tyr['rank'] = df_tyr_result.index.to_series().apply(lambda idx: get_kinase_rank(idx,df_tyr,df_tyr_result))\n    \n    return df_st,df_tyr,df_st_result,df_tyr_result\n\n\ndef get_ref(df, pssm, seq_col='site_seq', func=sumup, n_chunk=5):\n    chunk_size = (len(df) + n_chunk - 1) // n_chunk  # ceiling division\n    pct_refs = []\n    for i in range(n_chunk):\n        start = i * chunk_size\n        end = min((i + 1) * chunk_size, len(df))\n        if start &gt;= end:\n            break\n        print(f\"Processing chunk {i+1}/{n_chunk} → rows {start}:{end}\")\n        sub_df = df.iloc[start:end]\n        pct_ref = predict_kinase_df(\n            sub_df,\n            seq_col=seq_col,\n            ref=pssm,\n            func=func\n        )\n        pct_refs.append(pct_ref)\n    return pd.concat(pct_refs, ignore_index=True)\n\n\n# pct_ref = get_ref(human,LO)\n\n\ndf_st_result = predict_kinase_df(df_st,seq_col='site_seq',ref=ref_st,func=sumup)\n\ninput dataframe has a length 2082\nPreprocessing\nFinish preprocessing\nMerging reference\nFinish merging\n\n\n\ndf_st_result_pct = get_pct_df(df_st_result,pct_ref)\n\n100%|██████████████████████████████████████████████████████████████████████████| 213/213 [00:00&lt;00:00, 642.51it/s]\n\n\n\npct_ref = predict_kinase_df(human.iloc[:len(human)//2],seq_col='site_seq',ref=LO,func=sumup)\n\ninput dataframe has a length 58868\nPreprocessing\nFinish preprocessing\nMerging reference\nFinish merging\n\n\n\ndf_st,df_tyr,df_st_result,df_tyr_result = score_data(df,LO)\n\n\ndf_st['rank'].mean()\n\n41.78866474543708\n\n\n\ndf_tyr['rank'].mean()\n\nnp.float64(22.426315789473684)",
    "crumbs": [
      "Scoring evaluation"
    ]
  },
  {
    "objectID": "scoring_compare_psp_02.html#top-510",
    "href": "scoring_compare_psp_02.html#top-510",
    "title": "Scoring evaluation",
    "section": "Top 5/10",
    "text": "Top 5/10\n\ndef top_k_accuracy(df, result, k):\n    def is_in_top_k(row_index):\n        kinase = df.loc[row_index, 'kinase_protein']\n        scores = result.loc[row_index]\n        top_k = scores.nlargest(k).index\n        return kinase in top_k\n\n    return result.index.to_series().apply(is_in_top_k).mean()\n\n\n# top10_st = top_k_accuracy(df_st, df_st_result, 10)\n# top10_tyr = top_k_accuracy(df_tyr, df_tyr_result, 10)\n\n\n# print(f\"Top-10 ST accuracy: {top10_st:.3f}\")\n# print(f\"Top-10 Tyr accuracy: {top10_tyr:.3f}\")",
    "crumbs": [
      "Scoring evaluation"
    ]
  },
  {
    "objectID": "scoring_compare_psp_02.html#group-topk",
    "href": "scoring_compare_psp_02.html#group-topk",
    "title": "Scoring evaluation",
    "section": "Group topk",
    "text": "Group topk\n\ndef top_k_accuracy_group(group_indices,df,result, k=10):\n    def is_correct(row_index):\n        kinase = df.loc[row_index, 'kinase_protein']\n        scores = result.loc[row_index]\n        top_k = scores.nlargest(k).index\n        return kinase in top_k\n\n    return pd.Series(group_indices).apply(is_correct).mean()\n\n\ndef get_topk(df,result,k=10):\n    grouped = df.groupby('kinase_group').groups\n    \n    topk_scores = {\n        subfam: top_k_accuracy_group(indices,df,result,k=k)\n        for subfam, indices in grouped.items()}\n    \n    topk_df = pd.DataFrame.from_dict(topk_scores, orient='index', columns=['top10_accuracy']).sort_values('top10_accuracy', ascending=False)\n    return topk_df\n\n\ndef get_group_topk(df_st,df_tyr,df_st_result,df_tyr_result):\n\n    topk_st = get_topk(df_st,df_st_result)\n    topk_tyr = get_topk(df_tyr,df_tyr_result)\n    \n    topk = pd.concat([topk_st,topk_tyr]).sort_values('top10_accuracy',ascending=False)\n\n    return topk\n\n\ndef get_results(df_st,df_tyr,df_st_result,df_tyr_result):\n    topk = get_group_topk(df_st,df_tyr,df_st_result,df_tyr_result)\n    aucdf_st = get_AUCDF(df_st,'rank')\n    aucdf_tyr = get_AUCDF(df_tyr,'rank')\n    \n    return topk, aucdf_st,aucdf_tyr\n\n\ntopk,aucdf_st,aucdf_tyr = get_results(df_st,df_tyr,df_st_result,df_tyr_result)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ntopk\n\n\n\n\n\n\n\n\ntop10_accuracy\n\n\n\n\nCMGC\n0.637191\n\n\nAtypical\n0.452055\n\n\nAGC\n0.422397\n\n\nTK\n0.394737\n\n\nCAMK\n0.266289\n\n\nSTE\n0.160494\n\n\nCK1\n0.158730\n\n\nOther\n0.153846\n\n\nNEK\n0.125000\n\n\nTKL\n0.097561\n\n\n\n\n\n\n\npercentile later",
    "crumbs": [
      "Scoring evaluation"
    ]
  },
  {
    "objectID": "scoring_compare_psp_02.html#overall",
    "href": "scoring_compare_psp_02.html#overall",
    "title": "Scoring evaluation",
    "section": "Overall",
    "text": "Overall\npspa\n\npspa = pd.read_parquet('raw/overlap_pspa.parquet')\npspa.index = pspa.index.str.split('_').str[1]\npspa.shape\n\n(312, 236)\n\n\nData to be scored\n\ndf =pd.read_parquet('out/CDDM_test_set.parquet')\n\n\ndf['site_seq_upper'] = df.site_seq.str.upper()\n\n\n# only filter those with tested kinase\ndf = df[df.kinase_protein.isin(pspa.index)].copy()\n\n\ndf.shape\n\n(2484, 24)\n\n\n\ngroup_map = df[['kinase_protein','kinase_group']].drop_duplicates().set_index('kinase_protein')['kinase_group']\nTK = group_map[group_map=='TK'].index\nST = group_map[group_map!='TK'].index\n\n\ndef prepare_ref(path):\n    ref = pd.read_parquet(path)\n    ref.index = ref.index.str.split('_').str[1]\n    ref = ref[ref.index.isin(pspa.index)]\n    print(ref.shape)\n    return ref\n\ncddm:\n\ncddm = prepare_ref('out/CDDM_pssms_eval_psp_02.parquet')\ncddm_upper = prepare_ref('out/CDDM_pssms_eval_upper_psp_02.parquet')\n\ncddm_lo = prepare_ref('out/CDDM_pssms_LO_eval_psp_02.parquet')\ncddm_lo_upper = prepare_ref('out/CDDM_pssms_LO_eval_upper_psp_02.parquet')\n\n(312, 943)\n(312, 943)\n(312, 943)\n(312, 943)\n\n\n\n# ref_dict = {\n#     'PSPA: PSSM + multiply': (pspa,'site_seq',multiply,False),\n#     'CDDM: PSSM + multiply': (cddm, 'site_seq', multiply_23,False),\n#     'CDDM: PSSM upper + multiply': (cddm_upper, 'site_seq_upper', multiply_20,False),\n#     'CDDM: LO + sum': (cddm_lo, 'site_seq',sumup,False),\n#     'CDDM: LO upper + sum': (cddm_lo_upper, 'site_seq_upper',sumup,False),\n# }\n\n# for name,(ref,seq_col,func,_) in ref_dict.items():\n#     print(name)\n#     pct_ref = get_ref(human,pssm=ref,seq_col=seq_col,func=func)\n#     pct_ref.to_parquet(f'raw/{name}.parquet')\n#     print(pct_ref.head())\n#     # break\n\n\nref_dict = {\n    'PSPA: PSSM + multiply': (pspa,'site_seq',multiply,False),\n    'PSPA: PSSM + multiply + pct': (pspa,'site_seq',multiply, True),\n    \n    'CDDM: PSSM + multiply': (cddm, 'site_seq', multiply_23,False),\n    'CDDM: PSSM + multiply + pct': (cddm, 'site_seq', multiply_23, True),\n    \n    'CDDM: PSSM upper + multiply': (cddm_upper, 'site_seq_upper', multiply_20,False),\n    'CDDM: PSSM upper + multiply + pct': (cddm_upper, 'site_seq_upper', multiply_20,True),\n    \n    'CDDM: LO + sum': (cddm_lo, 'site_seq',sumup,False),\n    'CDDM: LO + sum + pct': (cddm_lo, 'site_seq',sumup,True),\n    \n    'CDDM: LO upper + sum': (cddm_lo_upper, 'site_seq_upper',sumup,False),\n    'CDDM: LO upper + sum + pct': (cddm_lo_upper, 'site_seq_upper',sumup,True),\n}\n\n\nset_sns()\n\n\ntopk_dfs = []\naucdf = pd.DataFrame()\nfor name,(ref,seq_col,func,use_pct) in ref_dict.items():\n    print('---------------------------------------------')\n    print(name)\n    pct_ref = pd.read_parquet(f'raw/{name[:-6]}.parquet') if use_pct else None # -6 to remove + pct from parquet name\n    df_st,df_tyr,df_st_result,df_tyr_result = score_data(df,ref,seq_col=seq_col,func=func,pct_ref=pct_ref)\n    topk,aucdf_st,aucdf_tyr = get_results(df_st,df_tyr,df_st_result,df_tyr_result)\n    topk_dfs.append(topk)\n    aucdf.loc[name,'ST'] = aucdf_st\n    aucdf.loc[name,'Tyr'] = aucdf_tyr\n\n---------------------------------------------\nPSPA: PSSM + multiply\ninput dataframe has a length 2082\nPreprocessing\nFinish preprocessing\nMerging reference\nFinish merging\n\n\n100%|██████████████████████████████████████████████████████████████████████████| 213/213 [00:00&lt;00:00, 280.99it/s]\n\n\ninput dataframe has a length 377\nPreprocessing\nFinish preprocessing\nMerging reference\nFinish merging\n\n\n100%|████████████████████████████████████████████████████████████████████████████| 71/71 [00:00&lt;00:00, 556.84it/s]\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n---------------------------------------------\nPSPA: PSSM + multiply + pct\ninput dataframe has a length 2082\nPreprocessing\nFinish preprocessing\nMerging reference\nFinish merging\n\n\n100%|██████████████████████████████████████████████████████████████████████████| 213/213 [00:00&lt;00:00, 289.36it/s]\n\n\ninput dataframe has a length 377\nPreprocessing\nFinish preprocessing\nMerging reference\nFinish merging\n\n\n100%|████████████████████████████████████████████████████████████████████████████| 71/71 [00:00&lt;00:00, 579.53it/s]\n100%|██████████████████████████████████████████████████████████████████████████| 213/213 [00:00&lt;00:00, 676.99it/s]\n100%|████████████████████████████████████████████████████████████████████████████| 71/71 [00:00&lt;00:00, 808.54it/s]\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n---------------------------------------------\nCDDM: PSSM + multiply\ninput dataframe has a length 2082\nPreprocessing\nFinish preprocessing\nMerging reference\nFinish merging\n\n\n100%|██████████████████████████████████████████████████████████████████████████| 213/213 [00:01&lt;00:00, 209.09it/s]\n\n\ninput dataframe has a length 377\nPreprocessing\nFinish preprocessing\nMerging reference\nFinish merging\n\n\n100%|████████████████████████████████████████████████████████████████████████████| 71/71 [00:00&lt;00:00, 475.58it/s]\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n---------------------------------------------\nCDDM: PSSM + multiply + pct\ninput dataframe has a length 2082\nPreprocessing\nFinish preprocessing\nMerging reference\nFinish merging\n\n\n100%|██████████████████████████████████████████████████████████████████████████| 213/213 [00:00&lt;00:00, 214.83it/s]\n\n\ninput dataframe has a length 377\nPreprocessing\nFinish preprocessing\nMerging reference\nFinish merging\n\n\n100%|████████████████████████████████████████████████████████████████████████████| 71/71 [00:00&lt;00:00, 469.76it/s]\n100%|██████████████████████████████████████████████████████████████████████████| 213/213 [00:00&lt;00:00, 687.25it/s]\n100%|████████████████████████████████████████████████████████████████████████████| 71/71 [00:00&lt;00:00, 816.89it/s]\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n---------------------------------------------\nCDDM: PSSM upper + multiply\ninput dataframe has a length 2082\nPreprocessing\nFinish preprocessing\nMerging reference\nFinish merging\n\n\n100%|██████████████████████████████████████████████████████████████████████████| 213/213 [00:01&lt;00:00, 201.05it/s]\n\n\ninput dataframe has a length 377\nPreprocessing\nFinish preprocessing\nMerging reference\nFinish merging\n\n\n100%|████████████████████████████████████████████████████████████████████████████| 71/71 [00:00&lt;00:00, 471.58it/s]\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n---------------------------------------------\nCDDM: PSSM upper + multiply + pct\ninput dataframe has a length 2082\nPreprocessing\nFinish preprocessing\nMerging reference\nFinish merging\n\n\n100%|██████████████████████████████████████████████████████████████████████████| 213/213 [00:01&lt;00:00, 212.42it/s]\n\n\ninput dataframe has a length 377\nPreprocessing\nFinish preprocessing\nMerging reference\nFinish merging\n\n\n100%|████████████████████████████████████████████████████████████████████████████| 71/71 [00:00&lt;00:00, 468.25it/s]\n100%|██████████████████████████████████████████████████████████████████████████| 213/213 [00:00&lt;00:00, 683.89it/s]\n100%|████████████████████████████████████████████████████████████████████████████| 71/71 [00:00&lt;00:00, 839.41it/s]\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n---------------------------------------------\nCDDM: LO + sum\ninput dataframe has a length 2082\nPreprocessing\nFinish preprocessing\nMerging reference\nFinish merging\ninput dataframe has a length 377\nPreprocessing\nFinish preprocessing\nMerging reference\nFinish merging\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n---------------------------------------------\nCDDM: LO + sum + pct\ninput dataframe has a length 2082\nPreprocessing\nFinish preprocessing\nMerging reference\nFinish merging\ninput dataframe has a length 377\nPreprocessing\nFinish preprocessing\nMerging reference\nFinish merging\n\n\n100%|██████████████████████████████████████████████████████████████████████████| 213/213 [00:00&lt;00:00, 678.51it/s]\n100%|████████████████████████████████████████████████████████████████████████████| 71/71 [00:00&lt;00:00, 832.33it/s]\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n---------------------------------------------\nCDDM: LO upper + sum\ninput dataframe has a length 2082\nPreprocessing\nFinish preprocessing\nMerging reference\nFinish merging\ninput dataframe has a length 377\nPreprocessing\nFinish preprocessing\nMerging reference\nFinish merging\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n---------------------------------------------\nCDDM: LO upper + sum + pct\ninput dataframe has a length 2082\nPreprocessing\nFinish preprocessing\nMerging reference\nFinish merging\ninput dataframe has a length 377\nPreprocessing\nFinish preprocessing\nMerging reference\nFinish merging\n\n\n100%|██████████████████████████████████████████████████████████████████████████| 213/213 [00:00&lt;00:00, 679.34it/s]\n100%|████████████████████████████████████████████████████████████████████████████| 71/71 [00:00&lt;00:00, 859.10it/s]\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\naucdf = aucdf.T\n\n\naucdf = aucdf.reset_index(names='group')\n\n\naucdf\n\n\n\n\n\n\n\n\ngroup\nPSPA: PSSM + multiply\nPSPA: PSSM + multiply + pct\nCDDM: PSSM + multiply\nCDDM: PSSM + multiply + pct\nCDDM: PSSM upper + multiply\nCDDM: PSSM upper + multiply + pct\nCDDM: LO + sum\nCDDM: LO + sum + pct\nCDDM: LO upper + sum\nCDDM: LO upper + sum + pct\n\n\n\n\n0\nST\n0.810725\n0.794840\n0.803220\n0.713528\n0.806753\n0.724447\n0.803220\n0.746919\n0.806753\n0.759939\n\n\n1\nTyr\n0.606243\n0.582133\n0.668217\n0.589020\n0.640603\n0.550436\n0.668217\n0.634985\n0.640603\n0.611936\n\n\n\n\n\n\n\n\naucdf.set_index('group').T.sort_values('Tyr')\n\n\n\n\n\n\n\ngroup\nST\nTyr\n\n\n\n\nCDDM: PSSM upper + multiply + pct\n0.724447\n0.550436\n\n\nPSPA: PSSM + multiply + pct\n0.794840\n0.582133\n\n\nCDDM: PSSM + multiply + pct\n0.713528\n0.589020\n\n\nPSPA: PSSM + multiply\n0.810725\n0.606243\n\n\nCDDM: LO upper + sum + pct\n0.759939\n0.611936\n\n\nCDDM: LO + sum + pct\n0.746919\n0.634985\n\n\nCDDM: LO upper + sum\n0.806753\n0.640603\n\n\nCDDM: PSSM upper + multiply\n0.806753\n0.640603\n\n\nCDDM: LO + sum\n0.803220\n0.668217\n\n\nCDDM: PSSM + multiply\n0.803220\n0.668217\n\n\n\n\n\n\n\n\nplot_group_bar(aucdf,value_cols=aucdf.columns[1:],group='group',rotation=0)\nplt.ylabel('AUCDF')\n\nText(0, 0.5, 'AUCDF')\n\n\n\n\n\n\n\n\n\n\nplot_group_bar(aucdf,value_cols=aucdf.columns[1:],group='group',rotation=0)\nplt.ylabel('AUCDF')\n\nText(0, 0.5, 'AUCDF')\n\n\n\n\n\n\n\n\n\n\ntopk_df = pd.concat(topk_dfs,axis=1)\n\n\ntopk_df.columns = ref_dict.keys()\n\n\nidx_ordered = topk_df.mean(1).sort_values(ascending=False).index\n\n\ntopk_df = topk_df.loc[idx_ordered]\n\n\ntopk_df = topk_df.reset_index(names='group')\n\n\nplot_group_bar(topk_df,value_cols=topk_df.columns[1:],group='group')\nplt.ylabel('Top10 accuracy')\n\nText(0, 0.5, 'Top10 accuracy')\n\n\n\n\n\n\n\n\n\n\nplot_group_bar(topk_df,value_cols=topk_df.columns[1:],group='group')\nplt.ylabel('Top10 accuracy')\n\nText(0, 0.5, 'Top10 accuracy')\n\n\n\n\n\n\n\n\n\n\ncol = topk_df.columns[~topk_df.columns.str.contains('pct')][1:]\n\n\ndf.kinase_group.value_counts()\n\nkinase_group\nCMGC        777\nAGC         510\nTK          386\nCAMK        357\nAtypical    147\nOther       104\nSTE          83\nCK1          63\nTKL          41\nNEK          16\nName: count, dtype: int64\n\n\n\nplot_group_bar(topk_df,value_cols=col,group='group')\nplt.ylabel('Top10 accuracy')\n\nText(0, 0.5, 'Top10 accuracy')\n\n\n\n\n\n\n\n\n\n\nplot_group_bar(topk_df,value_cols=col,group='group')\nplt.ylabel('Top10 accuracy')\n\nText(0, 0.5, 'Top10 accuracy')",
    "crumbs": [
      "Scoring evaluation"
    ]
  }
]