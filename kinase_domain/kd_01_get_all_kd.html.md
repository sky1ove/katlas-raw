# Get all kinase domain sequences


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

## Setup

``` python
from katlas.data import *
from katlas.utils import *
import pandas as pd
from fastcore.all import L
import re

pd.set_option('display.max_rows', 20)
pd.set_option('display.max_columns', 100)
```

## Kinase domain info of current human kinome

``` python
df = Data.get_kinase_info()
```

``` python
df.kinasecom_domain.notna().sum()
```

    np.int64(516)

``` python
# df.uniprot.to_csv('kinase_uniprot.csv')
```

Query the uniprot id in ID mapping in uniprot. Add `domain [FT]` and
`region` in the columns

``` python
uniprot=pd.read_excel('raw/idmapping_kinase_info_2025_05_27.xlsx')
```

``` python
uniprot['Domain [FT]'].head()
```

    0    DOMAIN 46..315; /note="Protein kinase"; /evide...
    1    DOMAIN 61..121; /note="SH3"; /evidence="ECO:00...
    2    DOMAIN 107..167; /note="SH3"; /evidence="ECO:0...
    3    DOMAIN 126..385; /note="Protein kinase"; /evid...
    4    DOMAIN 192..485; /note="Protein kinase"; /evid...
    Name: Domain [FT], dtype: object

FAM20C does not have `Domain[FT]` but contains Region to indicate kinase
domain

``` python
uniprot[uniprot['Domain [FT]'].isna()].Region.tolist()
```

    ['REGION 62..81; /note="Disordered"; /evidence="ECO:0000256|SAM:MobiDB-lite"; REGION 94..159; /note="Disordered"; /evidence="ECO:0000256|SAM:MobiDB-lite"; REGION 354..565; /note="Kinase domain"; /evidence="ECO:0000305|PubMed:22582013"']

``` python
uniprot = uniprot.dropna(subset='Domain [FT]')
```

``` python
def extract_kinase_domains1(text):
    """
    Extracts domain or region annotations from text using regex.
    Includes entries where the note contains either 'kinase' or 'PI3K/PI4K catalytic'.
    Returns a list of [note, region, evidence] where evidence is set to 'nan' if not present.
    """
    pattern = r'(?:REGION|DOMAIN) [<>]?(\d+)\.\.[<>]?(\d+); /note="([^"]*?(?:kinase|PI3K/PI4K catalytic)[^"]*?)"(?:; /evidence="([^"]*?)")?'
    matches = re.findall(pattern, text, flags=re.IGNORECASE)
    
    return [[note.strip(), evidence if evidence else 'nan']
            for start, end, note, evidence in matches]
```

``` python
out = uniprot['Domain [FT]'].apply(extract_kinase_domains1)
```

The rest of the kinases have domain info:

``` python
out.explode().value_counts()
```

    Domain [FT]
    [Protein kinase, ECO:0000255|PROSITE-ProRule:PRU00159]                                  454
    [AGC-kinase C-terminal, ECO:0000255|PROSITE-ProRule:PRU00618]                            55
    [Protein kinase 2, ECO:0000255|PROSITE-ProRule:PRU00159]                                 14
    [Protein kinase 1, ECO:0000255|PROSITE-ProRule:PRU00159]                                 14
    [Protein kinase, nan]                                                                     7
    [Alpha-type protein kinase, ECO:0000255|PROSITE-ProRule:PRU00501]                         6
    [PI3K/PI4K catalytic, ECO:0000255|PROSITE-ProRule:PRU00269]                               6
    [Histidine kinase, ECO:0000255|PROSITE-ProRule:PRU00107]                                  4
    [Protein kinase, ECO:0000255|PROSITE-ProRule:PRU00159, ECO:0000305]                       4
    [Guanylate kinase-like, ECO:0000255|PROSITE-ProRule:PRU00100]                             1
    [Protein kinase; inactive, ECO:0000255|PROSITE-ProRule:PRU00159]                          1
    [Protein kinase, ECO:0000255|PROSITE-ProRule:PRU00159, ECO:0000269|PubMed:15194684]       1
    [Protein kinase, ECO:0000255|PROSITE-ProRule:PRU00159, ECO:0000269|PubMed:9092543]        1
    [Protein kinase, ECO:0000250|UniProtKB:Q5VT25, ECO:0000255|PROSITE-ProRule:PRU00159]      1
    [Protein kinase, ECO:0000255|PROSITE-ProRule:PRU00159, ECO:0000312|EMBL:CAA84485.1]       1
    [Protein kinase, ECO:0000305]                                                             1
    Name: count, dtype: int64

We’ll search uniprot across species based on the info above to get all
kinases and their kinase domains.

## Download kinase domain info from Uniprot

Uniprot reviewed –\> search advanced

–\> domain: “Protein kinase”, or “PI3K PI4K catalytic” or “Histidine
kinase”

or –\> region: “Kinase domain”

``` python
kd1=pd.read_excel('raw/uniprotkb_ft_domain_Protein_kinase_AND_2025_05_25.xlsx')
kd2=pd.read_excel('raw/uniprotkb_ft_domain_PI3K_PI4K_catalytic_2025_05_25.xlsx')
kd3=pd.read_excel('raw/uniprotkb_ft_domain_Histidine_kinase_AN_2025_05_25.xlsx')
kd4=pd.read_excel('raw/uniprotkb_ft_region_Kinase_domain_2025_05_26.xlsx')
```

``` python
kd_all = pd.concat([kd1,kd2,kd3,kd4],ignore_index=True)
```

``` python
kd_human = kd_all[kd_all.Organism.str.contains('Homo')]
```

## Check if how it overlap with current kinome

### kinase domain query vs. kinome tree kinases

``` python
kinase_info = Data.get_kinase_info()
```

``` python
a,b = get_diff(kd_human,kinase_info,'Uniprot','uniprot')
```

``` python
b.iloc[:,:5] # special for kinome tree
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&#10;    .dataframe tbody tr th {
        vertical-align: top;
    }
&#10;    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe" data-quarto-postprocess="true" data-border="1">
<thead>
<tr style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">kinase</th>
<th data-quarto-table-cell-role="th">ID_coral</th>
<th data-quarto-table-cell-role="th">uniprot</th>
<th data-quarto-table-cell-role="th">gene</th>
<th data-quarto-table-cell-role="th">modi_group</th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">41</td>
<td>BRD2</td>
<td>BRD2</td>
<td>P25440</td>
<td>BRD2</td>
<td>Atypical</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">42</td>
<td>BRD3</td>
<td>BRD3</td>
<td>Q15059</td>
<td>BRD3</td>
<td>Atypical</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">43</td>
<td>BRD4</td>
<td>BRD4</td>
<td>O60885</td>
<td>BRD4</td>
<td>Atypical</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">44</td>
<td>BRDT</td>
<td>BRDT</td>
<td>Q58F21</td>
<td>BRDT</td>
<td>Atypical</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">486</td>
<td>TRIM24</td>
<td>TIF1a</td>
<td>O15164</td>
<td>TRIM24</td>
<td>Atypical</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">487</td>
<td>TRIM28</td>
<td>TIF1b</td>
<td>Q13263</td>
<td>TRIM28</td>
<td>Atypical</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">488</td>
<td>TRIM33</td>
<td>TIF1g</td>
<td>Q9UPN9</td>
<td>TRIM33</td>
<td>Atypical</td>
</tr>
</tbody>
</table>

</div>

These kinases does not have clear boundary of kinase domain in the
domain\[FT\] column.

``` python
a.iloc[:,:5] # special for kinase domain query
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&#10;    .dataframe tbody tr th {
        vertical-align: top;
    }
&#10;    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe" data-quarto-postprocess="true" data-border="1">
<thead>
<tr style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Uniprot</th>
<th data-quarto-table-cell-role="th">Reviewed</th>
<th data-quarto-table-cell-role="th">Entry Name</th>
<th data-quarto-table-cell-role="th">Protein names</th>
<th data-quarto-table-cell-role="th">Gene Names</th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">895</td>
<td>P21675</td>
<td>reviewed</td>
<td>TAF1_HUMAN</td>
<td>Transcription initiation factor TFIID subunit ...</td>
<td>TAF1 BA2R CCG1 CCGS TAF2A</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">1982</td>
<td>Q496M5</td>
<td>reviewed</td>
<td>PLK5_HUMAN</td>
<td>Inactive serine/threonine-protein kinase PLK5 ...</td>
<td>PLK5 PLK5P FG060302</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">2448</td>
<td>Q6A1A2</td>
<td>reviewed</td>
<td>PDPK2_HUMAN</td>
<td>Putative 3-phosphoinositide-dependent protein ...</td>
<td>PDPK2P PDPK2</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">2894</td>
<td>Q8NEV1</td>
<td>reviewed</td>
<td>CSK23_HUMAN</td>
<td>Casein kinase II subunit alpha 3 (CK II alpha ...</td>
<td>CSNK2A3 CSNK2A1P</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">3624</td>
<td>Q9UQ88</td>
<td>reviewed</td>
<td>CD11A_HUMAN</td>
<td>Cyclin-dependent kinase 11A (EC 2.7.11.22) (Ce...</td>
<td>CDK11A CDC2L2 CDC2L3 PITSLREB</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">4761</td>
<td>Q9UBF8</td>
<td>reviewed</td>
<td>PI4KB_HUMAN</td>
<td>Phosphatidylinositol 4-kinase beta (PI4K-beta)...</td>
<td>PI4KB PIK4CB</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">4790</td>
<td>A4QPH2</td>
<td>reviewed</td>
<td>PI4P2_HUMAN</td>
<td>Putative phosphatidylinositol 4-kinase alpha-l...</td>
<td>PI4KAP2</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">4812</td>
<td>A4D2B8</td>
<td>reviewed</td>
<td>PM2P1_HUMAN</td>
<td>Putative postmeiotic segregation increased 2-l...</td>
<td>PMS2P1 PMS2L1 PMS2L13 PMS2L6 PMS2L8 PMS3 PMS8 ...</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">4878</td>
<td>Q15119</td>
<td>reviewed</td>
<td>PDK2_HUMAN</td>
<td>[Pyruvate dehydrogenase (acetyl-transferring)]...</td>
<td>PDK2 PDHK2</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">5441</td>
<td>Q8N159</td>
<td>reviewed</td>
<td>NAGS_HUMAN</td>
<td>N-acetylglutamate synthase, mitochondrial (EC ...</td>
<td>NAGS</td>
</tr>
</tbody>
</table>

<p>21 rows × 5 columns</p>
</div>

Kinase keyword query contains a lot of non-serine/thronine/tyrosine
kinases.

### kinase domain query vs. kinase keyword query

``` python
all_kinase = pd.read_excel('raw/uniprot_human_keyword_kinase.xlsx').rename(columns={'Entry':'Uniprot'})
```

``` python
a,b = get_diff(kd_human,all_kinase,'Uniprot')
```

``` python
a.iloc[:,:5] # special for kd domain query
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&#10;    .dataframe tbody tr th {
        vertical-align: top;
    }
&#10;    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe" data-quarto-postprocess="true" data-border="1">
<thead>
<tr style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Uniprot</th>
<th data-quarto-table-cell-role="th">Reviewed</th>
<th data-quarto-table-cell-role="th">Entry Name</th>
<th data-quarto-table-cell-role="th">Protein names</th>
<th data-quarto-table-cell-role="th">Gene Names</th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">1982</td>
<td>Q496M5</td>
<td>reviewed</td>
<td>PLK5_HUMAN</td>
<td>Inactive serine/threonine-protein kinase PLK5 ...</td>
<td>PLK5 PLK5P FG060302</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">5441</td>
<td>Q8N159</td>
<td>reviewed</td>
<td>NAGS_HUMAN</td>
<td>N-acetylglutamate synthase, mitochondrial (EC ...</td>
<td>NAGS</td>
</tr>
</tbody>
</table>

</div>

kd domain query also include inactive kinase (PLK5), which is not marked
with ‘kinase’ in the keywords.

Another one is NAGS, which contains Amino-acid kinase domain (AAK), and
not marked with ‘kinase’ in the keywords.

``` python
b.iloc[:,:5] # special for kinase keyword query
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&#10;    .dataframe tbody tr th {
        vertical-align: top;
    }
&#10;    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe" data-quarto-postprocess="true" data-border="1">
<thead>
<tr style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Uniprot</th>
<th data-quarto-table-cell-role="th">Entry Name</th>
<th data-quarto-table-cell-role="th">Protein names</th>
<th data-quarto-table-cell-role="th">Gene Names</th>
<th data-quarto-table-cell-role="th">uniprot_keyword_kinase</th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">0</td>
<td>A2RU49</td>
<td>HYKK_HUMAN</td>
<td>Hydroxylysine kinase (5-hydroxy-L-lysine kinas...</td>
<td>HYKK AGPHD1</td>
<td>1</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">3</td>
<td>O00142</td>
<td>KITM_HUMAN</td>
<td>Thymidine kinase 2, mitochondrial (EC 2.7.1.21...</td>
<td>TK2</td>
<td>1</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">11</td>
<td>O00746</td>
<td>NDKM_HUMAN</td>
<td>Nucleoside diphosphate kinase, mitochondrial (...</td>
<td>NME4 NM23D</td>
<td>1</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">13</td>
<td>O00764</td>
<td>PDXK_HUMAN</td>
<td>Pyridoxal kinase (EC 2.7.1.35) (Pyridoxine kin...</td>
<td>PDXK C21orf124 C21orf97 PKH PNK PRED79</td>
<td>1</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">23</td>
<td>O14986</td>
<td>PI51B_HUMAN</td>
<td>Phosphatidylinositol 4-phosphate 5-kinase type...</td>
<td>PIP5K1B STM7</td>
<td>1</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">638</td>
<td>O60885</td>
<td>BRD4_HUMAN</td>
<td>Bromodomain-containing protein 4 (Protein HUNK1)</td>
<td>BRD4 HUNK1</td>
<td>0</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">639</td>
<td>Q58F21</td>
<td>BRDT_HUMAN</td>
<td>Bromodomain testis-specific protein (Cancer/te...</td>
<td>BRDT</td>
<td>0</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">663</td>
<td>O15164</td>
<td>TIF1A_HUMAN</td>
<td>Transcription intermediary factor 1-alpha (TIF...</td>
<td>TRIM24 RNF82 TIF1 TIF1A</td>
<td>0</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">664</td>
<td>Q13263</td>
<td>TIF1B_HUMAN</td>
<td>Transcription intermediary factor 1-beta (TIF1...</td>
<td>TRIM28 KAP1 RNF96 TIF1B</td>
<td>0</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">665</td>
<td>Q9UPN9</td>
<td>TRI33_HUMAN</td>
<td>E3 ubiquitin-protein ligase TRIM33 (EC 2.3.2.2...</td>
<td>TRIM33 KIAA1113 RFG7 TIF1G</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>151 rows × 5 columns</p>
</div>

Kinase keyword query contains a lot of non-serine/thronine/tyrosine
kinases.

## Extract kinase domain info

Get residue start, end, and evidence info.

``` python
def extract_kinase_domains(text):
    """
    Extracts domain or region annotations from text using regex.
    Includes entries where the note contains either 'kinase' or 'PI3K/PI4K catalytic'.
    Returns a list of [note, region, evidence] where evidence is set to 'nan' if not present.
    """
    pattern = r'(?:REGION|DOMAIN) [<>]?(\d+)\.\.[<>]?(\d+); /note="([^"]*?(?:kinase|PI3K/PI4K catalytic)[^"]*?)"(?:; /evidence="([^"]*?)")?'
    matches = re.findall(pattern, text, flags=re.IGNORECASE)
    
    return [[note.strip(),int(start),int(end), evidence if evidence else 'nan']
            for start, end, note, evidence in matches]
```

### Region column

Specific for kd4, without domain info but with region info

``` python
kd4['kd_info'] = kd4['Region'].apply(extract_kinase_domains)
```

``` python
kd4['kd_info']
```

    0     [[Amino-acid kinase domain (AAK), 40, 361, ECO...
    1     [[Kinase domain, 349, 560, ECO:0000250|UniProt...
    2     [[Kinase domain, 354, 565, ECO:0000305|PubMed:...
    3      [[Amino-acid kinase domain (AAK), 19, 376, nan]]
    4     [[Amino-acid kinase domain (AAK), 19, 369, ECO...
    5        [[HWE histidine kinase domain, 160, 236, nan]]
    6        [[HWE histidine kinase domain, 285, 367, nan]]
    7        [[HWE histidine kinase domain, 260, 303, nan]]
    8        [[HWE histidine kinase domain, 259, 341, nan]]
    9        [[HWE histidine kinase domain, 259, 341, nan]]
    10       [[HWE histidine kinase domain, 286, 368, nan]]
    11       [[HWE histidine kinase domain, 285, 367, nan]]
    12       [[HWE histidine kinase domain, 285, 367, nan]]
    13       [[HWE histidine kinase domain, 285, 367, nan]]
    14       [[HWE histidine kinase domain, 254, 336, nan]]
    15       [[HWE histidine kinase domain, 259, 341, nan]]
    Name: kd_info, dtype: object

### Domain

Most kinases contain domain info for kinase domain.

``` python
kd = pd.concat([kd1,kd2,kd3])
```

``` python
kd = kd.drop_duplicates('Uniprot').reset_index(drop=True)
```

``` python
kd['kd_info'] = kd['Domain [FT]'].apply(extract_kinase_domains)
```

``` python
kd['kd_info'].str.len().value_counts() # check non-zero
```

    kd_info
    1    5015
    2     397
    3      22
    Name: count, dtype: int64

Some kinase contain 3 kinase domains

``` python
kd[kd['kd_info'].str.len()==3]['Domain [FT]'].tolist()[0]
```

    'DOMAIN 49..318; /note="Protein kinase 1"; /evidence="ECO:0000255|PROSITE-ProRule:PRU00159"; DOMAIN 319..387; /note="AGC-kinase C-terminal"; /evidence="ECO:0000255|PROSITE-ProRule:PRU00618"; DOMAIN 426..687; /note="Protein kinase 2"; /evidence="ECO:0000255|PROSITE-ProRule:PRU00159"'

After check, it seems it includes C-terminal domain. We will later
remove them

``` python
kd_final = pd.concat([kd,kd4])
```

``` python
df = kd_final.explode('kd_info', ignore_index=True)
```

``` python
df[['domain_note', 'domain_start','domain_end', 'domain_evidence']] = df.kd_info.apply(pd.Series)
```

``` python
df = df.drop(columns=['kd_info'])
```

Remove non kinase domains:

``` python
df.columns
```

    Index(['Uniprot', 'Reviewed', 'Entry Name', 'Protein names', 'Gene Names',
           'Gene Names (primary)', 'Organism', 'Length', 'Domain [FT]',
           'Domain [CC]', 'Motif', 'Protein families', 'Reactome', 'ComplexPortal',
           'Subcellular location [CC]', 'Gene Ontology (biological process)',
           'Tissue specificity', 'Interacts with', 'Subunit structure',
           'Function [CC]', 'Activity regulation', 'Mass', 'Sequence', 'Region',
           'domain_note', 'domain_start', 'domain_end', 'domain_evidence'],
          dtype='object')

``` python
df = df[df.domain_note!='AGC-kinase C-terminal'].reset_index(drop=True)
```

``` python
df.domain_note.value_counts()
```

    domain_note
    Protein kinase                    4530
    Histidine kinase                   625
    PI3K/PI4K catalytic                168
    Protein kinase 2                    73
    Protein kinase 1                    73
    Alpha-type protein kinase           22
    Protein kinase; inactive            13
    HWE histidine kinase domain         11
    Guanylate kinase-like                5
    Histidine kinase 2                   4
    Histidine kinase 1                   4
    Amino-acid kinase domain (AAK)       3
    Kinase domain                        2
    Protein kinase; truncated            1
    Histidine kinase; first part         1
    Histidine kinase; second part        1
    Name: count, dtype: int64

## Download uniprot sequence

The big TITIN proteins (A2ASS6 for mouse, and Q8WZ42 for human) is
truncated when downloaded online.

``` python
from tqdm.contrib.concurrent import thread_map
from kdock.core.protein import get_uniprot_seq
```

``` python
df = df.rename(columns={'Sequence':'full_protein_seq'})
```

``` python
full_seq = thread_map(get_uniprot_seq,df.Uniprot, max_workers=5)
```

``` python
df['full_seq']=full_seq
```

``` python
df[df['full_seq']!=df['full_protein_seq']]
```

Seems the uniprot online download have limits length in downloading.

``` python
df['full_seq'] = df['full_protein_seq']
```

## Get domain sequence

``` python
def get_region(seq,start,end): return seq[start-1:end]
```

``` python
df['domain_seq'] = df.apply(lambda r: get_region(r['full_seq'],r['domain_start'],r['domain_end']),axis=1)
```

``` python
df['domain_seq']
```

    0       AGFHEILGAGASGVVYKGQLEDELKTNIAVKTIHKLQPETEKEFMV...
    1       YMLGDEIGKGAYGRVYIGLDLENGDFVAIKQVSLENIVQEDLNTIM...
    2       YKVIAELGHGLWSRDVLAEHRFIKKRYILKILPSELSSSENFMRVF...
    3       TLSDCQIGHGATATVFKMDIKIKKELQNGRMGEAVGDQMKAALKRF...
    4       FDSGNVIGVGGSGATVYEGVLPSGSRVAVKRFQAIGSCTKAFDSEL...
                                  ...                        
    5531    EIAHRFKNSMAMVQSIANQTLRNTYDPEQANRLFSERLRALSQAHD...
    5532    EIAHRFKNSMAMVQSIANQTLRNTYDPEQANRLFSERLRALSQAHD...
    5533    EIAHRFKNSMAMVQSIVNQTLRNTYDPEQANRLFSERLRALSQAHD...
    5534    ALTGENPLVLGIVQDVTERKKAEANKALVSREIAHRFKNSMAMVQS...
    5535    NPLVLGIVQDVTERKKAEANKALVSREIAHRFKNSMAMVQSIANQT...
    Name: domain_seq, Length: 5536, dtype: object

``` python
df['domain_seq'].isna().sum()
```

    np.int64(0)

## Arrange columns & save

``` python
df = df.sort_values(['Uniprot','domain_start']).reset_index(drop=True)
```

``` python
df['KD_ID']=df['Uniprot']+'_'+df['Entry Name']+'_KD'+(df.Uniprot.duplicated().astype(int)+1).astype(str)
```

``` python
col = ['KD_ID','Uniprot',  'Entry Name', 'Protein names', 'Gene Names','Gene Names (primary)',
     'Organism', 'domain_note','domain_evidence', 'domain_start', 'domain_end','domain_seq' , 'Domain [FT]',
       'Domain [CC]', 'Region', 'Motif', 'Protein families', 'Reactome', 'ComplexPortal',
       'Subcellular location [CC]', 'Gene Ontology (biological process)',
       'Tissue specificity', 'Interacts with', 'Subunit structure',
       'Function [CC]', 'Activity regulation',  'full_seq', 
       ]
```

``` python
df = df[col]
```

``` python
# df[df.KD_ID.str.contains('JAK1')] # check JAK1 to see if KD1 and KD2 is assigned correctly
```

``` python
new_colname=['kd_ID','Uniprot',  'Entry Name', 'Protein names', 'Gene Names','Gene Names (primary)',
     'Organism', 'kd_note','kd_evidence', 'kd_start', 'kd_end','kd_seq' , 'Domain [FT]',
       'Domain [CC]', 'Region', 'Motif', 'Protein families', 'Reactome', 'ComplexPortal',
       'Subcellular location [CC]', 'Gene Ontology (biological process)',
       'Tissue specificity', 'Interacts with', 'Subunit structure',
       'Function [CC]', 'Activity regulation',  'full_seq', 
       ]
```

``` python
df.columns=new_colname
```

``` python
# df.to_excel('out/uniprot_kd.xlsx',index=False)
```

``` python
df.shape
```

    (5536, 27)

It can be acquired through `Data.get_kd_uniprot()`

``` python
from katlas.data import *
df = Data.get_kd_uniprot()
```

## Kinases with 1-2 kinase domains

``` python
df.columns
```

    Index(['kd_ID', 'Uniprot', 'Entry Name', 'Protein names', 'Gene Names',
           'Gene Names (primary)', 'Organism', 'kd_note', 'kd_evidence',
           'kd_start', 'kd_end', 'kd_seq', 'Domain [FT]', 'Domain [CC]', 'Region',
           'Motif', 'Protein families', 'Reactome', 'ComplexPortal',
           'Subcellular location [CC]', 'Gene Ontology (biological process)',
           'Tissue specificity', 'Interacts with', 'Subunit structure',
           'Function [CC]', 'Activity regulation', 'full_seq'],
          dtype='object')

``` python
out = df.groupby('Uniprot').agg({'kd_note':list})
```

``` python
out.kd_note.value_counts()
```

    kd_note
    [Protein kinase]                            4521
    [Histidine kinase]                           621
    [PI3K/PI4K catalytic]                        168
    [Protein kinase 1, Protein kinase 2]          73
    [Alpha-type protein kinase]                   22
    [Protein kinase; inactive]                    13
    [HWE histidine kinase domain]                 11
    [Protein kinase, Guanylate kinase-like]        5
    [Histidine kinase 1, Histidine kinase 2]       4
    [Protein kinase, Histidine kinase]             4
    [Amino-acid kinase domain (AAK)]               3
    [Kinase domain]                                2
    [Histidine kinase; first part]                 1
    [Histidine kinase; second part]                1
    [Protein kinase; truncated]                    1
    Name: count, dtype: int64

Some kinases contain two kinase domains. Some are both protein kinase
domains, while some have the first to be protein kinase and the second
to be histidine kinase.

## Duplicates among kinase domains

Across species

``` python
def get_dup(df):
    dup = df[df.kd_seq.duplicated(keep=False)].sort_values('kd_seq')
    return dup.groupby('kd_seq').agg({'kd_ID':lambda x: ','.join(x)}).reset_index()
```

``` python
dup_unique = get_dup(df)
```

``` python
dup_unique[dup_unique.kd_ID.str.contains("HUMAN")]
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&#10;    .dataframe tbody tr th {
        vertical-align: top;
    }
&#10;    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe" data-quarto-postprocess="true" data-border="1">
<thead>
<tr style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">kd_seq</th>
<th data-quarto-table-cell-role="th">kd_ID</th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">26</td>
<td>EPWQEKVRRIREGSPYGHLPNWRLLSVIVKCGDDLRQELLAFQVLK...</td>
<td>B4UT09_PI4KB_OTOGA_KD1,A9X1A0_PI4KB_PAPAN_KD1,...</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">30</td>
<td>EYEGCKVGRGTYGHVYKARRKDGKDEKEYALKQIEGTGISMSACRE...</td>
<td>Q8BWD8_CDK19_MOUSE_KD1,Q9BWU1_CDK19_HUMAN_KD1</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">31</td>
<td>FDFLKVIGKGSFGKVLLAKRKLDGKFYAVKVLQKKIVLNRKEQKHI...</td>
<td>Q96BR1_SGK3_HUMAN_KD1,Q5R7A7_SGK3_PONAB_KD1</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">33</td>
<td>FDIIGIIGEGTYGQVYKARDKDTGEMVALKKVRLDNEKEGFPITAI...</td>
<td>E1BB52_CDK13_BOVIN_KD1,Q14004_CDK13_HUMAN_KD1,...</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">34</td>
<td>FDLIRVIGRGSYAKVLLVRLKKNDQIYAMKVVKKELVHDDEDIDWV...</td>
<td>P09217_KPCZ_RAT_KD1,Q05513_KPCZ_HUMAN_KD1,Q029...</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">271</td>
<td>YTLKDEIGKGSYGVVKLAYNENDNTYYAMKVLSKKKLIRQAGFPRR...</td>
<td>Q96RR4_KKCC2_HUMAN_KD1,O88831_KKCC2_RAT_KD1</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">274</td>
<td>YTNLSYIGEGAYGMVCSAYDNVNKVRVAIKKISPFEHQTYCQRTLR...</td>
<td>P46196_MK01_BOVIN_KD1,P28482_MK01_HUMAN_KD1</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">276</td>
<td>YTRFEKIGQGASGTVYTALDIATGQEVAIKQMNLQQQPKKELIINE...</td>
<td>Q7YQL4_PAK3_PANTR_KD1,Q7YQL3_PAK3_PONPY_KD1,O7...</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">277</td>
<td>YTRFEKIGQGASGTVYTAMDVATGQEVAIKQMNLQQQPKKELIINE...</td>
<td>Q13153_PAK1_HUMAN_KD1,P35465_PAK1_RAT_KD1,Q08E...</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">278</td>
<td>YTRYEKIGQGASGTVFTATDVALGQEVAIKQINLQKQPKKELIINE...</td>
<td>Q13177_PAK2_HUMAN_KD1,Q8CIN4_PAK2_MOUSE_KD1</td>
</tr>
</tbody>
</table>

<p>90 rows × 2 columns</p>
</div>

Duplicates within human

``` python
human=df[df.Organism=='Homo sapiens (Human)']

dup_human = get_dup(human)
```

``` python
dup_human
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&#10;    .dataframe tbody tr th {
        vertical-align: top;
    }
&#10;    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe" data-quarto-postprocess="true" data-border="1">
<thead>
<tr style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">kd_seq</th>
<th data-quarto-table-cell-role="th">kd_ID</th>
</tr>
</thead>
<tbody>
</tbody>
</table>

</div>

Check duplicates within other species

``` python
species = df.Organism.value_counts().head().index
```

``` python
for s in species:
    df_species=df[df.Organism==s]
    print(s)
    print(get_dup(df_species))
```

    Arabidopsis thaliana (Mouse-ear cress)
    Empty DataFrame
    Columns: [kd_seq, kd_ID]
    Index: []
    Mus musculus (Mouse)
                                                  kd_seq  \
    0  YVMLETIGHGGCATVKLAQHRLTGTHVAVKTIRKREYWCNRVISEV...   

                                               kd_ID  
    0  C0HKC8_SMK3A_MOUSE_KD1,C0HKC9_SMK3B_MOUSE_KD1  
    Homo sapiens (Human)
    Empty DataFrame
    Columns: [kd_seq, kd_ID]
    Index: []
    Dictyostelium discoideum (Social amoeba)
    Empty DataFrame
    Columns: [kd_seq, kd_ID]
    Index: []
    Rattus norvegicus (Rat)
    Empty DataFrame
    Columns: [kd_seq, kd_ID]
    Index: []

only mouse SMK3A/3B duplicates in the top 5 species
