# Extract KD features


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

``` python
import pandas as pd
from katlas.core import *
from katlas.feature import *
from katlas.plot import *
```

``` python
df = Data.get_kd_uniprot()
```

``` python
# filter active kinase domain
df = df[df.active_D1_D2.astype(bool)].reset_index(drop=True)
```

``` python
df.columns
```

    Index(['kd_ID', 'Uniprot', 'Entry Name', 'Protein names', 'Gene Names',
           'Gene Names (primary)', 'Organism', 'kd_note', 'kd_evidence',
           'kd_start', 'kd_end', 'kd_seq', 'Domain [FT]', 'Domain [CC]', 'Region',
           'Motif', 'Protein families', 'Reactome', 'ComplexPortal',
           'Subcellular location [CC]', 'Gene Ontology (biological process)',
           'Tissue specificity', 'Interacts with', 'Subunit structure',
           'Function [CC]', 'Activity regulation', 'full_seq', 'D1', 'D2', 'D3',
           'N1', 'active_D1_D2'],
          dtype='object')

``` python
df.shape
```

    (4209, 32)

## Onehot of sequence alignment

``` python
align = pd.read_parquet('raw/uniprot_kd_align.parquet')
```

``` python
align.columns = align.columns.astype(int)
```

``` python
active=(align[1525]=='D')& (align[1724]=='D')
align = align[active]
```

``` python
align.shape
```

    (4209, 3434)

``` python
counts_df = align.apply(lambda col: col.value_counts(), axis=0).fillna(0)
freq_df = counts_df.div(counts_df.sum(axis=0), axis=1)
```

``` python
# remove '-' first line
max_series=freq_df.iloc[1:,:]
```

``` python
freq_max = pd.concat([max_series.idxmax(),max_series.max()],axis=1)
freq_max.columns = ['aa','max_value']
freq_max = freq_max.sort_values('max_value',ascending=False).reset_index(names='position')
```

``` python
freq_max
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&#10;    .dataframe tbody tr th {
        vertical-align: top;
    }
&#10;    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe" data-quarto-postprocess="true" data-border="1">
<thead>
<tr style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">position</th>
<th data-quarto-table-cell-role="th">aa</th>
<th data-quarto-table-cell-role="th">max_value</th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">0</td>
<td>1724</td>
<td>D</td>
<td>1.000000</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">1</td>
<td>1525</td>
<td>D</td>
<td>1.000000</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">2</td>
<td>1549</td>
<td>N</td>
<td>0.988121</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">3</td>
<td>1730</td>
<td>G</td>
<td>0.959135</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">4</td>
<td>2618</td>
<td>D</td>
<td>0.948919</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">3429</td>
<td>337</td>
<td>A</td>
<td>0.000000</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">3430</td>
<td>338</td>
<td>A</td>
<td>0.000000</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">3431</td>
<td>339</td>
<td>A</td>
<td>0.000000</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">3432</td>
<td>1899</td>
<td>A</td>
<td>0.000000</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">3433</td>
<td>1900</td>
<td>A</td>
<td>0.000000</td>
</tr>
</tbody>
</table>

<p>3434 rows × 3 columns</p>
</div>

``` python
onehot_col = freq_max[freq_max.max_value>0.05].position.sort_values().tolist()
```

``` python
len(onehot_col)
```

    358

``` python
align = align[onehot_col]
```

``` python
from sklearn.preprocessing import OneHotEncoder

def get_onehot(df):
    df=df.copy()
    encoded_df = pd.DataFrame(index=df.index)
    
    encoder = OneHotEncoder(sparse_output=False, dtype=int, handle_unknown='ignore')
    
    for col in df.columns:
        reshaped = df[[col]]  # keep as DataFrame
        encoded = encoder.fit_transform(reshaped)
        aa_labels = encoder.categories_[0]
        new_col_names = [f"{col}_{aa}" for aa in aa_labels]
        encoded_subdf = pd.DataFrame(encoded,index=df.index)
        encoded_subdf.columns=new_col_names
        encoded_df = pd.concat([encoded_df, encoded_subdf], axis=1)
    return encoded_df
```

``` python
onehot=get_onehot(align)
```

``` python
onehot.head()
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&#10;    .dataframe tbody tr th {
        vertical-align: top;
    }
&#10;    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe" data-quarto-postprocess="true" data-border="1">
<thead>
<tr style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">65_-</th>
<th data-quarto-table-cell-role="th">65_A</th>
<th data-quarto-table-cell-role="th">65_C</th>
<th data-quarto-table-cell-role="th">65_D</th>
<th data-quarto-table-cell-role="th">65_E</th>
<th data-quarto-table-cell-role="th">65_F</th>
<th data-quarto-table-cell-role="th">65_G</th>
<th data-quarto-table-cell-role="th">65_H</th>
<th data-quarto-table-cell-role="th">65_I</th>
<th data-quarto-table-cell-role="th">65_K</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">3192_M</th>
<th data-quarto-table-cell-role="th">3192_N</th>
<th data-quarto-table-cell-role="th">3192_P</th>
<th data-quarto-table-cell-role="th">3192_Q</th>
<th data-quarto-table-cell-role="th">3192_R</th>
<th data-quarto-table-cell-role="th">3192_S</th>
<th data-quarto-table-cell-role="th">3192_T</th>
<th data-quarto-table-cell-role="th">3192_V</th>
<th data-quarto-table-cell-role="th">3192_W</th>
<th data-quarto-table-cell-role="th">3192_Y</th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">A0A075F7E9_LERK1_ORYSI_KD1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">A0A078CGE6_M3KE1_BRANA_KD1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">A0A0K3AV08_MLK1_CAEEL_KD1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">A0A0P0VIP0_LRSK7_ORYSJ_KD1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">A0A0P0XII1_CERK1_ORYSJ_KD1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>5 rows × 6849 columns</p>
</div>

``` python
onehot.shape
```

    (4209, 6849)

It contains the active kd_ID

``` python
onehot.to_parquet('raw/onehot_kd.parquet')
```

## Onehot + PCA

Since onehot gives 6849 columns, we can PCA reduce the column number.

We chose 1000 as t5 and esm have a range of 1000 features.

``` python
onehot_pca = reduce_feature(onehot,n=1000)
```

``` python
onehot_pca.to_parquet('raw/onehot_pca_kd.parquet')
```

## T5 embeddings

``` python
feat_t5 = get_t5(df,'kd_seq')
```

    You are using the default legacy behaviour of the <class 'transformers.models.t5.tokenization_t5.T5Tokenizer'>. This is expected, and simply means that the `legacy` (previous) behavior will be used so nothing changes for you. If you want to use the new behaviour, set `legacy=False`. This should only be set if you understand what it means, and thoroughly read the reason why this was added as explained in https://github.com/huggingface/transformers/pull/24565

    model.safetensors:   0%|          | 0.00/2.42G [00:00<?, ?B/s]

      0%|          | 0/4209 [00:00<?, ?it/s]

``` python
feat_t5.index=df.kd_ID
```

``` python
feat_t5.head()
```

    /home/sky1ove/git/KATLAS/katlas/.venv/lib/python3.12/site-packages/pandas/io/formats/format.py:1458: RuntimeWarning: overflow encountered in cast
      has_large_values = (abs_vals > 1e6).any()
    /home/sky1ove/git/KATLAS/katlas/.venv/lib/python3.12/site-packages/pandas/io/formats/format.py:1458: RuntimeWarning: overflow encountered in cast
      has_large_values = (abs_vals > 1e6).any()

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&#10;    .dataframe tbody tr th {
        vertical-align: top;
    }
&#10;    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe" data-quarto-postprocess="true" data-border="1">
<thead>
<tr style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">T5_0</th>
<th data-quarto-table-cell-role="th">T5_1</th>
<th data-quarto-table-cell-role="th">T5_2</th>
<th data-quarto-table-cell-role="th">T5_3</th>
<th data-quarto-table-cell-role="th">T5_4</th>
<th data-quarto-table-cell-role="th">T5_5</th>
<th data-quarto-table-cell-role="th">T5_6</th>
<th data-quarto-table-cell-role="th">T5_7</th>
<th data-quarto-table-cell-role="th">T5_8</th>
<th data-quarto-table-cell-role="th">T5_9</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">T5_1014</th>
<th data-quarto-table-cell-role="th">T5_1015</th>
<th data-quarto-table-cell-role="th">T5_1016</th>
<th data-quarto-table-cell-role="th">T5_1017</th>
<th data-quarto-table-cell-role="th">T5_1018</th>
<th data-quarto-table-cell-role="th">T5_1019</th>
<th data-quarto-table-cell-role="th">T5_1020</th>
<th data-quarto-table-cell-role="th">T5_1021</th>
<th data-quarto-table-cell-role="th">T5_1022</th>
<th data-quarto-table-cell-role="th">T5_1023</th>
</tr>
<tr>
<th data-quarto-table-cell-role="th">kd_ID</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">A0A075F7E9_LERK1_ORYSI_KD1</td>
<td>0.014122</td>
<td>0.068848</td>
<td>0.016113</td>
<td>-0.001555</td>
<td>-0.001301</td>
<td>0.021393</td>
<td>0.030304</td>
<td>-0.062408</td>
<td>0.028427</td>
<td>-0.017532</td>
<td>...</td>
<td>-0.029297</td>
<td>0.014900</td>
<td>-0.006233</td>
<td>-0.069824</td>
<td>0.044067</td>
<td>-0.009636</td>
<td>-0.007458</td>
<td>0.021240</td>
<td>0.005264</td>
<td>-0.034637</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">A0A078CGE6_M3KE1_BRANA_KD1</td>
<td>0.054565</td>
<td>0.093811</td>
<td>-0.007420</td>
<td>0.018890</td>
<td>-0.042236</td>
<td>-0.005402</td>
<td>-0.004921</td>
<td>-0.046844</td>
<td>-0.013443</td>
<td>-0.019501</td>
<td>...</td>
<td>-0.016037</td>
<td>0.000758</td>
<td>-0.038391</td>
<td>-0.041321</td>
<td>0.069580</td>
<td>-0.022415</td>
<td>-0.026306</td>
<td>-0.001375</td>
<td>0.006599</td>
<td>-0.034485</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">A0A0K3AV08_MLK1_CAEEL_KD1</td>
<td>0.014870</td>
<td>-0.008934</td>
<td>0.000822</td>
<td>0.001986</td>
<td>-0.035767</td>
<td>0.023880</td>
<td>-0.012856</td>
<td>-0.056274</td>
<td>-0.004978</td>
<td>-0.001923</td>
<td>...</td>
<td>-0.032349</td>
<td>-0.057129</td>
<td>-0.005463</td>
<td>-0.107910</td>
<td>0.020889</td>
<td>-0.009666</td>
<td>-0.022614</td>
<td>-0.019882</td>
<td>0.040466</td>
<td>-0.021912</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">A0A0P0VIP0_LRSK7_ORYSJ_KD1</td>
<td>-0.008522</td>
<td>0.062134</td>
<td>-0.014053</td>
<td>-0.027054</td>
<td>-0.025665</td>
<td>0.014648</td>
<td>0.015022</td>
<td>-0.045959</td>
<td>0.023544</td>
<td>-0.036133</td>
<td>...</td>
<td>0.037994</td>
<td>-0.022903</td>
<td>0.046082</td>
<td>-0.082703</td>
<td>0.000940</td>
<td>-0.009811</td>
<td>0.008896</td>
<td>0.014931</td>
<td>0.028061</td>
<td>-0.037994</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">A0A0P0XII1_CERK1_ORYSJ_KD1</td>
<td>0.029053</td>
<td>0.076050</td>
<td>0.014656</td>
<td>0.015732</td>
<td>-0.006050</td>
<td>0.019882</td>
<td>-0.003336</td>
<td>-0.041016</td>
<td>0.060211</td>
<td>-0.014572</td>
<td>...</td>
<td>0.014740</td>
<td>0.019989</td>
<td>0.011230</td>
<td>-0.040222</td>
<td>0.044403</td>
<td>-0.001749</td>
<td>-0.013168</td>
<td>0.018524</td>
<td>-0.018280</td>
<td>-0.034912</td>
</tr>
</tbody>
</table>

<p>5 rows × 1024 columns</p>
</div>

``` python
# feat_t5.to_parquet('raw/t5_kd.parquet')
```

## ESM2 embeddings

``` python
get_esm
```

``` python
feat_esm = get_esm(df,'kd_seq')
```

    repr_layers number for model esm2_t33_650M_UR50D is 33.
    You can also choose other esm2 models: 
    esm2_t48_15B_UR50D
    esm2_t36_3B_UR50D
    esm2_t33_650M_UR50D
    esm2_t30_150M_UR50D
    esm2_t12_35M_UR50D
    esm2_t6_8M_UR50D

      0%|          | 0/4209 [00:00<?, ?it/s]

    /home/sky1ove/git/KATLAS/katlas/.venv/lib/python3.12/site-packages/logomaker/../fairscale/nn/data_parallel/fully_sharded_data_parallel.py:2562: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
      if data.storage().size() > 0:

``` python
feat_esm.index=df.kd_ID
```

``` python
feat_esm.to_parquet('raw/esm_kd.parquet')
```

``` python
feat_esm.head()
```

    /home/sky1ove/git/KATLAS/katlas/.venv/lib/python3.12/site-packages/pandas/io/formats/format.py:1458: RuntimeWarning: overflow encountered in cast
      has_large_values = (abs_vals > 1e6).any()
    /home/sky1ove/git/KATLAS/katlas/.venv/lib/python3.12/site-packages/pandas/io/formats/format.py:1458: RuntimeWarning: overflow encountered in cast
      has_large_values = (abs_vals > 1e6).any()

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&#10;    .dataframe tbody tr th {
        vertical-align: top;
    }
&#10;    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe" data-quarto-postprocess="true" data-border="1">
<thead>
<tr style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">esm_0</th>
<th data-quarto-table-cell-role="th">esm_1</th>
<th data-quarto-table-cell-role="th">esm_2</th>
<th data-quarto-table-cell-role="th">esm_3</th>
<th data-quarto-table-cell-role="th">esm_4</th>
<th data-quarto-table-cell-role="th">esm_5</th>
<th data-quarto-table-cell-role="th">esm_6</th>
<th data-quarto-table-cell-role="th">esm_7</th>
<th data-quarto-table-cell-role="th">esm_8</th>
<th data-quarto-table-cell-role="th">esm_9</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">esm_1270</th>
<th data-quarto-table-cell-role="th">esm_1271</th>
<th data-quarto-table-cell-role="th">esm_1272</th>
<th data-quarto-table-cell-role="th">esm_1273</th>
<th data-quarto-table-cell-role="th">esm_1274</th>
<th data-quarto-table-cell-role="th">esm_1275</th>
<th data-quarto-table-cell-role="th">esm_1276</th>
<th data-quarto-table-cell-role="th">esm_1277</th>
<th data-quarto-table-cell-role="th">esm_1278</th>
<th data-quarto-table-cell-role="th">esm_1279</th>
</tr>
<tr>
<th data-quarto-table-cell-role="th">kd_ID</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">A0A075F7E9_LERK1_ORYSI_KD1</td>
<td>-0.014076</td>
<td>-0.047668</td>
<td>-0.030716</td>
<td>-0.045868</td>
<td>-0.062622</td>
<td>-0.116272</td>
<td>-0.007904</td>
<td>0.056915</td>
<td>0.010590</td>
<td>0.020737</td>
<td>...</td>
<td>0.020691</td>
<td>-0.012749</td>
<td>-0.077209</td>
<td>0.087402</td>
<td>0.007301</td>
<td>-0.010765</td>
<td>0.094604</td>
<td>-0.053802</td>
<td>0.049164</td>
<td>0.014648</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">A0A078CGE6_M3KE1_BRANA_KD1</td>
<td>0.012405</td>
<td>-0.039764</td>
<td>-0.004433</td>
<td>-0.019089</td>
<td>-0.064331</td>
<td>-0.048035</td>
<td>0.120789</td>
<td>-0.026199</td>
<td>-0.058777</td>
<td>0.143188</td>
<td>...</td>
<td>0.082520</td>
<td>-0.046143</td>
<td>-0.080872</td>
<td>0.077515</td>
<td>0.004078</td>
<td>-0.046143</td>
<td>0.029099</td>
<td>-0.214355</td>
<td>0.070923</td>
<td>0.146851</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">A0A0K3AV08_MLK1_CAEEL_KD1</td>
<td>0.047180</td>
<td>-0.048553</td>
<td>0.022888</td>
<td>0.006191</td>
<td>-0.028015</td>
<td>-0.094177</td>
<td>0.104492</td>
<td>-0.006901</td>
<td>0.016891</td>
<td>0.066223</td>
<td>...</td>
<td>0.023575</td>
<td>-0.010071</td>
<td>-0.090149</td>
<td>0.075684</td>
<td>0.022385</td>
<td>-0.044006</td>
<td>0.071838</td>
<td>-0.078369</td>
<td>0.013710</td>
<td>0.071838</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">A0A0P0VIP0_LRSK7_ORYSJ_KD1</td>
<td>-0.086121</td>
<td>-0.039001</td>
<td>-0.012978</td>
<td>-0.087524</td>
<td>-0.117981</td>
<td>-0.046600</td>
<td>-0.037628</td>
<td>0.059875</td>
<td>0.037323</td>
<td>0.087708</td>
<td>...</td>
<td>-0.061615</td>
<td>-0.025787</td>
<td>-0.085449</td>
<td>0.133667</td>
<td>0.016953</td>
<td>-0.106079</td>
<td>0.025635</td>
<td>-0.045868</td>
<td>0.080750</td>
<td>0.021927</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">A0A0P0XII1_CERK1_ORYSJ_KD1</td>
<td>0.004047</td>
<td>-0.067383</td>
<td>-0.022156</td>
<td>-0.011215</td>
<td>-0.110840</td>
<td>-0.077637</td>
<td>0.012314</td>
<td>0.012299</td>
<td>-0.011688</td>
<td>0.047485</td>
<td>...</td>
<td>0.056519</td>
<td>-0.023270</td>
<td>-0.094849</td>
<td>0.101746</td>
<td>-0.033417</td>
<td>-0.050415</td>
<td>0.054749</td>
<td>-0.071594</td>
<td>0.046631</td>
<td>0.021667</td>
</tr>
</tbody>
</table>

<p>5 rows × 1280 columns</p>
</div>

``` python
feat_esm.shape
```

    (4209, 1280)
