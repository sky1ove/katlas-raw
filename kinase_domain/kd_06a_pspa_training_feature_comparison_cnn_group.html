<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>DL training: Feature comparison on CNN model – katlas-raw</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-000f0825b9c55ed21d14970d810c14a9.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../styles.css">
<meta property="og:title" content="DL training: Feature comparison on CNN model – katlas-raw">
<meta property="og:image" content="https://sky1ove.github.io/katlas-raw/kinase_domain/kd_06a_pspa_training_feature_comparison_CNN_group_files/figure-html/cell-49-output-1.png">
<meta property="og:site_name" content="katlas-raw">
<meta property="og:image:height" content="1500">
<meta property="og:image:width" content="4080">
<meta name="twitter:title" content="DL training: Feature comparison on CNN model – katlas-raw">
<meta name="twitter:image" content="https://sky1ove.github.io/katlas-raw/kinase_domain/kd_06a_pspa_training_feature_comparison_CNN_group_files/figure-html/cell-49-output-1.png">
<meta name="twitter:image-height" content="1500">
<meta name="twitter:image-width" content="4080">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">katlas-raw</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../kinase_domain/kd_01_get_all_kd.html">kinase_domain</a></li><li class="breadcrumb-item"><a href="../kinase_domain/kd_06a_pspa_training_feature_comparison_cnn_group.html">DL training: Feature comparison on CNN model</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      </a>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">katlas-raw</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../nb.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 1</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">kinase_domain</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../kinase_domain/kd_01_get_all_kd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Get all kinase domain sequences</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../kinase_domain/kd_02_pseudo_alignment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Alignment</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../kinase_domain/kd_03_feature_extract.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Extract KD features</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../kinase_domain/kd_04_prepare_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prepare data for training</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../kinase_domain/kd_05_pspa_training_model_comparison_all.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DL training: Model comparison on T5 feature</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../kinase_domain/kd_06a_pspa_training_feature_comparison_cnn_group.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">DL training: Feature comparison on CNN model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../kinase_domain/kd_06b_pspa_training_feature_comparison_cnn_subfamily.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DL training: Feature comparison on CNN model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../kinase_domain/kd_06c_pspa_training_feature_comparison_mlp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DL training: Feature comparison on MLP model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../kinase_domain/kd_07a_cddm_training_subfamily.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DL training</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../kinase_domain/kd_07b_pspa_training_subfamily.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DL training</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../kinase_domain/kd_08a_similarity_relationship.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">KD similarity &amp; PSSM similarity</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../kinase_domain/kd_08b_similarity_relationship_cddm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">KD similarity &amp; PSSM similarity</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../kinase_domain/kd_09a_predict_pspa.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Predict</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../kinase_domain/kd_09b_predict_cddm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Predict</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../kinase_domain/kd_10_plot_umap_known_unk.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Plot UMAP of known &amp; unknown KD</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../kinase_domain/kd_11_plot_pspa_kd_t5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">kd_11_plot_pspa_kd_t5.html</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../kinase_domain/kd_12_compare_pred_psp_known.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Comopare the two</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#setup" id="toc-setup" class="nav-link active" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a></li>
  <li><a href="#split" id="toc-split" class="nav-link" data-scroll-target="#split">Split</a></li>
  <li><a href="#dataset" id="toc-dataset" class="nav-link" data-scroll-target="#dataset">Dataset</a></li>
  <li><a href="#model" id="toc-model" class="nav-link" data-scroll-target="#model">Model</a></li>
  <li><a href="#loss" id="toc-loss" class="nav-link" data-scroll-target="#loss">Loss</a></li>
  <li><a href="#metrics" id="toc-metrics" class="nav-link" data-scroll-target="#metrics">Metrics</a></li>
  <li><a href="#cv-train" id="toc-cv-train" class="nav-link" data-scroll-target="#cv-train">CV train</a></li>
  <li><a href="#score" id="toc-score" class="nav-link" data-scroll-target="#score">Score</a>
  <ul class="collapse">
  <li><a href="#for-js-similarity-less-differentiated" id="toc-for-js-similarity-less-differentiated" class="nav-link" data-scroll-target="#for-js-similarity-less-differentiated">For JS similarity (less differentiated)</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/sky1ove/katlas-raw/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div><div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="kd_06a_pspa_training_feature_comparison_cnn_group.html.md"><i class="bi bi-file-code"></i>CommonMark</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../kinase_domain/kd_01_get_all_kd.html">kinase_domain</a></li><li class="breadcrumb-item"><a href="../kinase_domain/kd_06a_pspa_training_feature_comparison_cnn_group.html">DL training: Feature comparison on CNN model</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">DL training: Feature comparison on CNN model</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<section id="setup" class="level2">
<h2 class="anchored" data-anchor-id="setup">Setup</h2>
<div id="a0725fd0-3315-4517-8282-9348ab47d247" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np, pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os, random</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> katlas.data <span class="im">import</span> <span class="op">*</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> katlas.train <span class="im">import</span> <span class="op">*</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fastai.vision.<span class="bu">all</span> <span class="im">import</span> <span class="op">*</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> katlas.dnn <span class="im">import</span> <span class="op">*</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cf93dc91-7e32-4b82-862e-bdb6cbebb831" class="cell" data-execution_count="2">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>seed_everything()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="7e79e142-f843-4c7c-8281-b3ccb763b1ea" class="cell" data-execution_count="3">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>def_device</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>'cuda'</code></pre>
</div>
</div>
</section>
<section id="data" class="level2">
<h2 class="anchored" data-anchor-id="data">Data</h2>
<div id="85370b32-32c2-4f49-96bf-5a03285521f4" class="cell" data-execution_count="4">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>df_t5<span class="op">=</span>pd.read_parquet(<span class="st">'train/pspa_t5.parquet'</span>).reset_index()</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>df_esm<span class="op">=</span>pd.read_parquet(<span class="st">'train/pspa_esm.parquet'</span>).reset_index()</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>df_onehot <span class="op">=</span> pd.read_parquet(<span class="st">'train/pspa_onehot.parquet'</span>).reset_index()</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>df_onehot_pca <span class="op">=</span> pd.read_parquet(<span class="st">'train/pspa_onehot_pca.parquet'</span>).reset_index()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="75e51dc4-3dad-43f5-b809-14815857108e" class="cell" data-execution_count="5">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>(df_onehot[<span class="st">'index'</span>] <span class="op">==</span> df_esm[<span class="st">'index'</span>]).value_counts()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>index
True    368
Name: count, dtype: int64</code></pre>
</div>
</div>
<div id="85213aec-a091-4294-950f-a386ef8ae22f" class="cell" data-execution_count="6">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>(df_t5[<span class="st">'index'</span>] <span class="op">==</span> df_esm[<span class="st">'index'</span>]).value_counts()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>index
True    368
Name: count, dtype: int64</code></pre>
</div>
</div>
<div id="f210f636-0917-4c8a-80f8-0af8c0508273" class="cell" data-execution_count="7">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>t5_col <span class="op">=</span> df_t5.columns[df_t5.columns.<span class="bu">str</span>.startswith(<span class="st">'T5_'</span>)]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="eb91df23-4a55-41a8-bf7f-e89e26c4bd9a" class="cell" data-execution_count="8">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>t5_col</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>Index(['T5_0', 'T5_1', 'T5_2', 'T5_3', 'T5_4', 'T5_5', 'T5_6', 'T5_7', 'T5_8',
       'T5_9',
       ...
       'T5_1014', 'T5_1015', 'T5_1016', 'T5_1017', 'T5_1018', 'T5_1019',
       'T5_1020', 'T5_1021', 'T5_1022', 'T5_1023'],
      dtype='object', length=1024)</code></pre>
</div>
</div>
<div id="5b7c4f07-82f1-4a1e-86ca-3e5306390ea0" class="cell" data-execution_count="9">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>esm_col <span class="op">=</span> df_esm.columns[df_esm.columns.<span class="bu">str</span>.startswith(<span class="st">'esm_'</span>)]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="23a36e9a-a8ff-42c8-916c-23886da82f4c" class="cell" data-execution_count="10">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>esm_col</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>Index(['esm_0', 'esm_1', 'esm_2', 'esm_3', 'esm_4', 'esm_5', 'esm_6', 'esm_7',
       'esm_8', 'esm_9',
       ...
       'esm_1270', 'esm_1271', 'esm_1272', 'esm_1273', 'esm_1274', 'esm_1275',
       'esm_1276', 'esm_1277', 'esm_1278', 'esm_1279'],
      dtype='object', length=1280)</code></pre>
</div>
</div>
<div id="3821aa21-d4e9-499b-962b-9fd52efab15b" class="cell" data-execution_count="11">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>target_col <span class="op">=</span> df_t5.columns[<span class="op">~</span>df_t5.columns.isin(t5_col)][<span class="dv">1</span>:]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="51ca1192-33c1-4205-9f8e-328405612a39" class="cell" data-execution_count="12">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>target_col</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>Index(['-5P', '-4P', '-3P', '-2P', '-1P', '0P', '1P', '2P', '3P', '4P',
       ...
       '-5pY', '-4pY', '-3pY', '-2pY', '-1pY', '0pY', '1pY', '2pY', '3pY',
       '4pY'],
      dtype='object', length=230)</code></pre>
</div>
</div>
<div id="9b3ce410-ae61-4c79-b0d0-b58d1960415f" class="cell" data-execution_count="13">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>onehot_col <span class="op">=</span> df_onehot.columns[<span class="op">~</span>df_onehot.columns.isin(target_col)][<span class="dv">1</span>:]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="d52a5e01-dc50-4c52-8fe4-3134f179b641" class="cell" data-execution_count="14">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>onehot_col</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>Index(['65_-', '65_A', '65_C', '65_D', '65_E', '65_F', '65_G', '65_H', '65_I',
       '65_K',
       ...
       '3192_M', '3192_N', '3192_P', '3192_Q', '3192_R', '3192_S', '3192_T',
       '3192_V', '3192_W', '3192_Y'],
      dtype='object', length=6849)</code></pre>
</div>
</div>
<div id="c383818f-0e38-4ca5-ac1e-040f37df1426" class="cell" data-execution_count="15">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>onehot_pca_col <span class="op">=</span> df_onehot_pca.columns[df_onehot_pca.columns.<span class="bu">str</span>.startswith(<span class="st">'PCA'</span>)]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="17269a17-4845-43d0-8535-64d0dd4aa811" class="cell" data-execution_count="16">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>onehot_pca_col</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>Index(['PCA1', 'PCA2', 'PCA3', 'PCA4', 'PCA5', 'PCA6', 'PCA7', 'PCA8', 'PCA9',
       'PCA10',
       ...
       'PCA991', 'PCA992', 'PCA993', 'PCA994', 'PCA995', 'PCA996', 'PCA997',
       'PCA998', 'PCA999', 'PCA1000'],
      dtype='object', length=1000)</code></pre>
</div>
</div>
<div id="63ad71cf-01ed-4606-b867-7114564eb7b5" class="cell" data-execution_count="17">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>info<span class="op">=</span>Data.get_kinase_info()</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>info <span class="op">=</span> info[info.pseudo<span class="op">==</span><span class="st">'0'</span>]</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>info <span class="op">=</span> info[info.kd_ID.notna()]</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>subfamily_map <span class="op">=</span> info[[<span class="st">'kd_ID'</span>,<span class="st">'subfamily'</span>]].drop_duplicates().set_index(<span class="st">'kd_ID'</span>)[<span class="st">'subfamily'</span>]</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>family_map <span class="op">=</span> info[[<span class="st">'kd_ID'</span>,<span class="st">'family'</span>]].drop_duplicates().set_index(<span class="st">'kd_ID'</span>)[<span class="st">'family'</span>]</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>group_map <span class="op">=</span> info[[<span class="st">'kd_ID'</span>,<span class="st">'group'</span>]].drop_duplicates().set_index(<span class="st">'kd_ID'</span>)[<span class="st">'group'</span>]</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>pspa_info <span class="op">=</span> pd.DataFrame(df_t5[<span class="st">'index'</span>].tolist(),columns<span class="op">=</span>[<span class="st">'kinase'</span>])</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>pspa_info[<span class="st">'subfamily'</span>] <span class="op">=</span> pspa_info.kinase.<span class="bu">map</span>(subfamily_map)</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>pspa_info[<span class="st">'family'</span>] <span class="op">=</span> pspa_info.kinase.<span class="bu">map</span>(family_map)</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>pspa_info[<span class="st">'group'</span>] <span class="op">=</span> pspa_info.kinase.<span class="bu">map</span>(group_map)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="split" class="level2">
<h2 class="anchored" data-anchor-id="split">Split</h2>
<div id="865d0b45-1019-4590-b773-8f85484c5291" class="cell" data-execution_count="18">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>splits <span class="op">=</span> get_splits(pspa_info, group<span class="op">=</span><span class="st">'group'</span>,nfold<span class="op">=</span><span class="dv">9</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>split0 <span class="op">=</span> splits[<span class="dv">0</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>GroupKFold(n_splits=9, random_state=None, shuffle=False)
# group in train set: 8
# group in test set: 1</code></pre>
</div>
</div>
</section>
<section id="dataset" class="level2">
<h2 class="anchored" data-anchor-id="dataset">Dataset</h2>
<div id="bf151735-36f5-409f-a3ba-a05067ebcf32" class="cell" data-execution_count="19">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dataset</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>ds_t5 <span class="op">=</span> GeneralDataset(df_t5,t5_col,target_col)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>ds_esm <span class="op">=</span> GeneralDataset(df_esm,esm_col,target_col)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>ds_onehot <span class="op">=</span> GeneralDataset(df_onehot,onehot_col,target_col)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>ds_onehot_pca <span class="op">=</span> GeneralDataset(df_onehot_pca,onehot_pca_col,target_col)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="dcc92b9d-bd8e-4b48-b693-cfe6777f81fc" class="cell" data-execution_count="20">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(ds_t5)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>368</code></pre>
</div>
</div>
<div id="2e8ab264-59a0-42b0-aa7e-70c5c3b5166d" class="cell" data-execution_count="21">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>dl_t5 <span class="op">=</span> DataLoader(ds_t5, batch_size<span class="op">=</span><span class="dv">64</span>, shuffle<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>dl_esm <span class="op">=</span> DataLoader(ds_esm, batch_size<span class="op">=</span><span class="dv">64</span>, shuffle<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>dl_onehot <span class="op">=</span> DataLoader(ds_onehot, batch_size<span class="op">=</span><span class="dv">64</span>, shuffle<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>dl_onehot_pca <span class="op">=</span> DataLoader(ds_onehot_pca, batch_size<span class="op">=</span><span class="dv">64</span>, shuffle<span class="op">=</span><span class="va">True</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="32f548b0-0771-4eae-a850-d407559917f0" class="cell" data-execution_count="22">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>xb,yb <span class="op">=</span> <span class="bu">next</span>(<span class="bu">iter</span>(dl_t5))</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>xb.shape,yb.shape</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>(torch.Size([64, 1024]), torch.Size([64, 23, 10]))</code></pre>
</div>
</div>
</section>
<section id="model" class="level2">
<h2 class="anchored" data-anchor-id="model">Model</h2>
<div id="61d51f40-d98d-4c3a-9721-f7a4084a2cdf" class="cell" data-execution_count="23">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>n_t5 <span class="op">=</span> <span class="bu">len</span>(t5_col)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>n_esm <span class="op">=</span> <span class="bu">len</span>(esm_col)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>n_onehot <span class="op">=</span> <span class="bu">len</span>(onehot_col)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>n_onehot_pca <span class="op">=</span> <span class="bu">len</span>(onehot_pca_col)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>n_target <span class="op">=</span> <span class="bu">len</span>(target_col)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="2b5b27cd-1712-4368-9171-dc6fcf207522" class="cell" data-execution_count="24">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>n_t5,n_esm,n_onehot,n_onehot_pca</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>(1024, 1280, 6849, 1000)</code></pre>
</div>
</div>
<div id="1e4917ae-79be-4bfc-8f9e-02598b164cbb" class="cell" data-execution_count="25">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># def get_cnn(): return PSSM_model(n_feature,n_target,model='CNN')</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_cnn_t5(): <span class="cf">return</span> PSSM_model(n_t5,n_target,model<span class="op">=</span><span class="st">'CNN'</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_cnn_esm(): <span class="cf">return</span> PSSM_model(n_esm,n_target,model<span class="op">=</span><span class="st">'CNN'</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_cnn_onehot(): <span class="cf">return</span> PSSM_model(n_onehot,n_target,model<span class="op">=</span><span class="st">'CNN'</span>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_cnn_onehot_pca(): <span class="cf">return</span> PSSM_model(n_onehot_pca,n_target,model<span class="op">=</span><span class="st">'CNN'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="18bf4378-55b6-489f-8f50-40f38ee9d864" class="cell" data-execution_count="26">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> get_cnn_t5()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="6df6e66a-51ce-4e2c-a1e5-9e4af12bf271" class="cell" data-execution_count="27">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>logits<span class="op">=</span> model(xb)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="e9c53f7d-f568-431c-8410-f28c544c97d3" class="cell" data-execution_count="28">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>logits.shape</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>torch.Size([64, 23, 10])</code></pre>
</div>
</div>
</section>
<section id="loss" class="level2">
<h2 class="anchored" data-anchor-id="loss">Loss</h2>
<div id="cf2130dd-853f-49e3-a5e9-89ad20ebba16" class="cell" data-execution_count="29">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>CE(logits,yb)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>tensor(3.3157, grad_fn=&lt;MeanBackward0&gt;)</code></pre>
</div>
</div>
</section>
<section id="metrics" class="level2">
<h2 class="anchored" data-anchor-id="metrics">Metrics</h2>
<div id="010ad9b4-2a38-42c1-b382-72997019c4d8" class="cell" data-execution_count="30">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>KLD(logits,yb)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>tensor(0.5744, grad_fn=&lt;MeanBackward0&gt;)</code></pre>
</div>
</div>
<div id="6f6f0885-3f25-48e4-ae07-8b2a93caa44e" class="cell" data-execution_count="31">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>JSD(logits,yb)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>tensor(0.1175, grad_fn=&lt;MeanBackward0&gt;)</code></pre>
</div>
</div>
</section>
<section id="cv-train" class="level2">
<h2 class="anchored" data-anchor-id="cv-train">CV train</h2>
<blockquote class="blockquote">
<p>cross-validation</p>
</blockquote>
<div id="f5564200-844a-46e5-aa91-1fd85d3c5d11" class="cell" data-execution_count="32">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>oof_t5 <span class="op">=</span> train_dl_cv(df_t5,t5_col,target_col,</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>                  splits <span class="op">=</span> splits,</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>                  model_func <span class="op">=</span> get_cnn_t5,</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>                  n_epoch<span class="op">=</span><span class="dv">20</span>,lr<span class="op">=</span><span class="fl">3e-3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>------fold0------
lr in training is 0.003</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">KLD</th>
<th data-quarto-table-cell-role="th">JSD</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>3.265647</td>
<td>3.142609</td>
<td>0.404048</td>
<td>0.081247</td>
<td>00:01</td>
</tr>
<tr class="even">
<td>1</td>
<td>3.223042</td>
<td>3.159432</td>
<td>0.420871</td>
<td>0.084551</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>2</td>
<td>3.185979</td>
<td>3.188326</td>
<td>0.449765</td>
<td>0.093861</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>3</td>
<td>3.161986</td>
<td>3.216524</td>
<td>0.477963</td>
<td>0.093619</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>4</td>
<td>3.139796</td>
<td>3.263382</td>
<td>0.524821</td>
<td>0.094843</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>5</td>
<td>3.121998</td>
<td>3.365554</td>
<td>0.626993</td>
<td>0.100610</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>6</td>
<td>3.081605</td>
<td>3.490378</td>
<td>0.751817</td>
<td>0.110248</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>7</td>
<td>3.036093</td>
<td>3.435781</td>
<td>0.697220</td>
<td>0.096045</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>8</td>
<td>2.995330</td>
<td>3.547961</td>
<td>0.809401</td>
<td>0.095060</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>9</td>
<td>2.961592</td>
<td>3.593616</td>
<td>0.855055</td>
<td>0.096466</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>10</td>
<td>2.933471</td>
<td>3.600523</td>
<td>0.861963</td>
<td>0.094996</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>11</td>
<td>2.909601</td>
<td>3.590640</td>
<td>0.852079</td>
<td>0.094011</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>12</td>
<td>2.890588</td>
<td>3.624627</td>
<td>0.886067</td>
<td>0.095667</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>13</td>
<td>2.874250</td>
<td>3.621842</td>
<td>0.883281</td>
<td>0.093074</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>14</td>
<td>2.860559</td>
<td>3.642438</td>
<td>0.903877</td>
<td>0.094680</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>15</td>
<td>2.849265</td>
<td>3.640604</td>
<td>0.902043</td>
<td>0.093936</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>16</td>
<td>2.839526</td>
<td>3.647106</td>
<td>0.908545</td>
<td>0.094358</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>17</td>
<td>2.830861</td>
<td>3.654265</td>
<td>0.915704</td>
<td>0.094701</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>18</td>
<td>2.823612</td>
<td>3.653282</td>
<td>0.914721</td>
<td>0.094696</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>19</td>
<td>2.817443</td>
<td>3.651935</td>
<td>0.913374</td>
<td>0.094722</td>
<td>00:00</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-stdout">
<pre><code>------fold1------
lr in training is 0.003</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">KLD</th>
<th data-quarto-table-cell-role="th">JSD</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>3.202563</td>
<td>3.126681</td>
<td>0.367288</td>
<td>0.080953</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>1</td>
<td>3.096495</td>
<td>2.987177</td>
<td>0.227784</td>
<td>0.058128</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>2</td>
<td>3.020704</td>
<td>2.896720</td>
<td>0.137328</td>
<td>0.032520</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>3</td>
<td>2.977764</td>
<td>2.916249</td>
<td>0.156856</td>
<td>0.036941</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>4</td>
<td>2.950588</td>
<td>2.900061</td>
<td>0.140669</td>
<td>0.032257</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>5</td>
<td>2.930088</td>
<td>2.912244</td>
<td>0.152851</td>
<td>0.035243</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>6</td>
<td>2.911221</td>
<td>2.882244</td>
<td>0.122852</td>
<td>0.028578</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>7</td>
<td>2.896883</td>
<td>2.888497</td>
<td>0.129105</td>
<td>0.029880</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>8</td>
<td>2.883235</td>
<td>2.879527</td>
<td>0.120135</td>
<td>0.028295</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>9</td>
<td>2.869442</td>
<td>2.870536</td>
<td>0.111143</td>
<td>0.025767</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>10</td>
<td>2.856844</td>
<td>2.872699</td>
<td>0.113306</td>
<td>0.026387</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>11</td>
<td>2.845950</td>
<td>2.875445</td>
<td>0.116052</td>
<td>0.026841</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>12</td>
<td>2.838449</td>
<td>2.868856</td>
<td>0.109463</td>
<td>0.025458</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>13</td>
<td>2.831044</td>
<td>2.868054</td>
<td>0.108661</td>
<td>0.025295</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>14</td>
<td>2.823496</td>
<td>2.874786</td>
<td>0.115393</td>
<td>0.026861</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>15</td>
<td>2.816517</td>
<td>2.870229</td>
<td>0.110837</td>
<td>0.025839</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>16</td>
<td>2.810994</td>
<td>2.868846</td>
<td>0.109454</td>
<td>0.025484</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>17</td>
<td>2.805729</td>
<td>2.868922</td>
<td>0.109530</td>
<td>0.025440</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>18</td>
<td>2.801781</td>
<td>2.868556</td>
<td>0.109163</td>
<td>0.025403</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>19</td>
<td>2.798228</td>
<td>2.867560</td>
<td>0.108168</td>
<td>0.025145</td>
<td>00:00</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-stdout">
<pre><code>------fold2------
lr in training is 0.003</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">KLD</th>
<th data-quarto-table-cell-role="th">JSD</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>3.193643</td>
<td>3.129775</td>
<td>0.413172</td>
<td>0.088697</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>1</td>
<td>3.091510</td>
<td>2.970952</td>
<td>0.254349</td>
<td>0.061493</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>2</td>
<td>3.019390</td>
<td>2.939329</td>
<td>0.222726</td>
<td>0.047996</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>3</td>
<td>2.979136</td>
<td>2.997280</td>
<td>0.280677</td>
<td>0.057836</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>4</td>
<td>2.955849</td>
<td>2.856279</td>
<td>0.139675</td>
<td>0.032778</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>5</td>
<td>2.937262</td>
<td>2.881608</td>
<td>0.165005</td>
<td>0.037116</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>6</td>
<td>2.919667</td>
<td>2.847731</td>
<td>0.131128</td>
<td>0.030217</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>7</td>
<td>2.905293</td>
<td>2.839630</td>
<td>0.123026</td>
<td>0.028822</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>8</td>
<td>2.891868</td>
<td>2.834224</td>
<td>0.117620</td>
<td>0.027419</td>
<td>-1:59:59</td>
</tr>
<tr class="even">
<td>9</td>
<td>2.879336</td>
<td>2.883239</td>
<td>0.166636</td>
<td>0.039591</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>10</td>
<td>2.866813</td>
<td>2.858723</td>
<td>0.142120</td>
<td>0.032910</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>11</td>
<td>2.855484</td>
<td>2.848410</td>
<td>0.131807</td>
<td>0.030241</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>12</td>
<td>2.845427</td>
<td>2.873513</td>
<td>0.156910</td>
<td>0.036242</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>13</td>
<td>2.836359</td>
<td>2.847939</td>
<td>0.131335</td>
<td>0.030619</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>14</td>
<td>2.828688</td>
<td>2.843345</td>
<td>0.126741</td>
<td>0.029227</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>15</td>
<td>2.822182</td>
<td>2.849235</td>
<td>0.132632</td>
<td>0.030728</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>16</td>
<td>2.816315</td>
<td>2.848452</td>
<td>0.131849</td>
<td>0.030454</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>17</td>
<td>2.811537</td>
<td>2.849880</td>
<td>0.133277</td>
<td>0.030673</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>18</td>
<td>2.807543</td>
<td>2.854661</td>
<td>0.138057</td>
<td>0.031727</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>19</td>
<td>2.803862</td>
<td>2.853885</td>
<td>0.137282</td>
<td>0.031627</td>
<td>00:00</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-stdout">
<pre><code>------fold3------
lr in training is 0.003</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">KLD</th>
<th data-quarto-table-cell-role="th">JSD</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>3.207944</td>
<td>3.141091</td>
<td>0.449947</td>
<td>0.093460</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>1</td>
<td>3.110341</td>
<td>3.029324</td>
<td>0.338180</td>
<td>0.076213</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>2</td>
<td>3.034141</td>
<td>2.932320</td>
<td>0.241176</td>
<td>0.049031</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>3</td>
<td>2.993638</td>
<td>2.946054</td>
<td>0.254910</td>
<td>0.050688</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>4</td>
<td>2.968643</td>
<td>2.946317</td>
<td>0.255174</td>
<td>0.049163</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>5</td>
<td>2.946927</td>
<td>2.940749</td>
<td>0.249605</td>
<td>0.046374</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>6</td>
<td>2.926885</td>
<td>2.924870</td>
<td>0.233727</td>
<td>0.044772</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>7</td>
<td>2.909749</td>
<td>2.939194</td>
<td>0.248050</td>
<td>0.045244</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>8</td>
<td>2.893957</td>
<td>2.910057</td>
<td>0.218914</td>
<td>0.042975</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>9</td>
<td>2.879583</td>
<td>2.939824</td>
<td>0.248680</td>
<td>0.046253</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>10</td>
<td>2.866916</td>
<td>2.941156</td>
<td>0.250012</td>
<td>0.047198</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>11</td>
<td>2.856293</td>
<td>2.933166</td>
<td>0.242022</td>
<td>0.045542</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>12</td>
<td>2.847124</td>
<td>2.937057</td>
<td>0.245913</td>
<td>0.046275</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>13</td>
<td>2.838420</td>
<td>2.938343</td>
<td>0.247199</td>
<td>0.046922</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>14</td>
<td>2.831244</td>
<td>2.940233</td>
<td>0.249089</td>
<td>0.047545</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>15</td>
<td>2.825087</td>
<td>2.944092</td>
<td>0.252948</td>
<td>0.047802</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>16</td>
<td>2.819351</td>
<td>2.945658</td>
<td>0.254514</td>
<td>0.047995</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>17</td>
<td>2.814262</td>
<td>2.940202</td>
<td>0.249058</td>
<td>0.046777</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>18</td>
<td>2.810476</td>
<td>2.940670</td>
<td>0.249527</td>
<td>0.046865</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>19</td>
<td>2.806732</td>
<td>2.938628</td>
<td>0.247484</td>
<td>0.046366</td>
<td>00:00</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-stdout">
<pre><code>------fold4------
lr in training is 0.003</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">KLD</th>
<th data-quarto-table-cell-role="th">JSD</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>3.193083</td>
<td>3.121557</td>
<td>0.332112</td>
<td>0.073863</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>1</td>
<td>3.084162</td>
<td>2.954197</td>
<td>0.164753</td>
<td>0.042711</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>2</td>
<td>3.010259</td>
<td>2.942940</td>
<td>0.153495</td>
<td>0.035771</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>3</td>
<td>2.970550</td>
<td>2.977695</td>
<td>0.188250</td>
<td>0.042826</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>4</td>
<td>2.945946</td>
<td>2.932550</td>
<td>0.143106</td>
<td>0.032621</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>5</td>
<td>2.929771</td>
<td>2.907203</td>
<td>0.117758</td>
<td>0.027932</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>6</td>
<td>2.910526</td>
<td>2.899911</td>
<td>0.110467</td>
<td>0.025754</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>7</td>
<td>2.892773</td>
<td>2.916562</td>
<td>0.127117</td>
<td>0.028903</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>8</td>
<td>2.879743</td>
<td>2.905592</td>
<td>0.116148</td>
<td>0.026998</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>9</td>
<td>2.866278</td>
<td>2.908514</td>
<td>0.119069</td>
<td>0.027786</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>10</td>
<td>2.854042</td>
<td>2.905393</td>
<td>0.115948</td>
<td>0.026859</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>11</td>
<td>2.843414</td>
<td>2.904994</td>
<td>0.115549</td>
<td>0.026965</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>12</td>
<td>2.833833</td>
<td>2.897970</td>
<td>0.108525</td>
<td>0.025182</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>13</td>
<td>2.825915</td>
<td>2.899413</td>
<td>0.109969</td>
<td>0.025357</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>14</td>
<td>2.818082</td>
<td>2.897056</td>
<td>0.107612</td>
<td>0.024913</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>15</td>
<td>2.811066</td>
<td>2.897897</td>
<td>0.108452</td>
<td>0.025036</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>16</td>
<td>2.805139</td>
<td>2.896160</td>
<td>0.106715</td>
<td>0.024646</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>17</td>
<td>2.800325</td>
<td>2.896326</td>
<td>0.106882</td>
<td>0.024691</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>18</td>
<td>2.795776</td>
<td>2.896716</td>
<td>0.107271</td>
<td>0.024781</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>19</td>
<td>2.792595</td>
<td>2.896498</td>
<td>0.107053</td>
<td>0.024761</td>
<td>00:00</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-stdout">
<pre><code>------fold5------
lr in training is 0.003</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">KLD</th>
<th data-quarto-table-cell-role="th">JSD</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>3.191223</td>
<td>3.125971</td>
<td>0.337161</td>
<td>0.074101</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>1</td>
<td>3.084095</td>
<td>2.968137</td>
<td>0.179327</td>
<td>0.046755</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>2</td>
<td>3.009351</td>
<td>2.993795</td>
<td>0.204984</td>
<td>0.046834</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>3</td>
<td>2.975441</td>
<td>2.935275</td>
<td>0.146464</td>
<td>0.035559</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>4</td>
<td>2.952728</td>
<td>2.906648</td>
<td>0.117838</td>
<td>0.029097</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>5</td>
<td>2.933139</td>
<td>2.887461</td>
<td>0.098650</td>
<td>0.024654</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>6</td>
<td>2.914009</td>
<td>2.891163</td>
<td>0.102352</td>
<td>0.025090</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>7</td>
<td>2.896947</td>
<td>2.894362</td>
<td>0.105552</td>
<td>0.025792</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>8</td>
<td>2.880326</td>
<td>2.898649</td>
<td>0.109838</td>
<td>0.026552</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>9</td>
<td>2.865264</td>
<td>2.895405</td>
<td>0.106595</td>
<td>0.026206</td>
<td>-1:59:59</td>
</tr>
<tr class="odd">
<td>10</td>
<td>2.852518</td>
<td>2.892293</td>
<td>0.103482</td>
<td>0.025411</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>11</td>
<td>2.840988</td>
<td>2.883369</td>
<td>0.094558</td>
<td>0.023256</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>12</td>
<td>2.830953</td>
<td>2.888999</td>
<td>0.100188</td>
<td>0.024492</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>13</td>
<td>2.822403</td>
<td>2.888226</td>
<td>0.099416</td>
<td>0.024353</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>14</td>
<td>2.814830</td>
<td>2.888407</td>
<td>0.099596</td>
<td>0.024432</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>15</td>
<td>2.808502</td>
<td>2.886997</td>
<td>0.098186</td>
<td>0.024032</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>16</td>
<td>2.802773</td>
<td>2.887533</td>
<td>0.098723</td>
<td>0.024249</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>17</td>
<td>2.797982</td>
<td>2.883697</td>
<td>0.094887</td>
<td>0.023295</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>18</td>
<td>2.793947</td>
<td>2.884220</td>
<td>0.095410</td>
<td>0.023388</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>19</td>
<td>2.790855</td>
<td>2.883040</td>
<td>0.094230</td>
<td>0.023095</td>
<td>00:00</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-stdout">
<pre><code>------fold6------
lr in training is 0.003</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">KLD</th>
<th data-quarto-table-cell-role="th">JSD</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>3.203619</td>
<td>3.121918</td>
<td>0.306652</td>
<td>0.069884</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>1</td>
<td>3.089997</td>
<td>2.956834</td>
<td>0.141568</td>
<td>0.037513</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>2</td>
<td>3.015747</td>
<td>2.923789</td>
<td>0.108523</td>
<td>0.025009</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>3</td>
<td>2.973150</td>
<td>2.941699</td>
<td>0.126433</td>
<td>0.029847</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>4</td>
<td>2.948111</td>
<td>2.920527</td>
<td>0.105260</td>
<td>0.024720</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>5</td>
<td>2.928955</td>
<td>2.909259</td>
<td>0.093993</td>
<td>0.021972</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>6</td>
<td>2.909893</td>
<td>2.905155</td>
<td>0.089889</td>
<td>0.021540</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>7</td>
<td>2.892313</td>
<td>2.922608</td>
<td>0.107342</td>
<td>0.024919</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>8</td>
<td>2.876400</td>
<td>2.927285</td>
<td>0.112019</td>
<td>0.026551</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>9</td>
<td>2.861295</td>
<td>2.911070</td>
<td>0.095804</td>
<td>0.022932</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>10</td>
<td>2.848656</td>
<td>2.917730</td>
<td>0.102464</td>
<td>0.024213</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>11</td>
<td>2.838045</td>
<td>2.910637</td>
<td>0.095371</td>
<td>0.022812</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>12</td>
<td>2.828543</td>
<td>2.917434</td>
<td>0.102168</td>
<td>0.024414</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>13</td>
<td>2.820406</td>
<td>2.916175</td>
<td>0.100909</td>
<td>0.023967</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>14</td>
<td>2.813365</td>
<td>2.916811</td>
<td>0.101544</td>
<td>0.024145</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>15</td>
<td>2.806840</td>
<td>2.910940</td>
<td>0.095674</td>
<td>0.022752</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>16</td>
<td>2.801304</td>
<td>2.911899</td>
<td>0.096632</td>
<td>0.022935</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>17</td>
<td>2.796986</td>
<td>2.920983</td>
<td>0.105716</td>
<td>0.024482</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>18</td>
<td>2.793097</td>
<td>2.911241</td>
<td>0.095975</td>
<td>0.022843</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>19</td>
<td>2.789752</td>
<td>2.909681</td>
<td>0.094414</td>
<td>0.022465</td>
<td>00:00</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-stdout">
<pre><code>------fold7------
lr in training is 0.003</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">KLD</th>
<th data-quarto-table-cell-role="th">JSD</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>3.199715</td>
<td>3.125819</td>
<td>0.463774</td>
<td>0.099700</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>1</td>
<td>3.084667</td>
<td>2.961773</td>
<td>0.299728</td>
<td>0.067936</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>2</td>
<td>3.013755</td>
<td>2.959561</td>
<td>0.297516</td>
<td>0.064850</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>3</td>
<td>2.980244</td>
<td>3.010867</td>
<td>0.348822</td>
<td>0.071755</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>4</td>
<td>2.960497</td>
<td>3.011438</td>
<td>0.349393</td>
<td>0.073356</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>5</td>
<td>2.937192</td>
<td>3.053991</td>
<td>0.391946</td>
<td>0.081665</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>6</td>
<td>2.913795</td>
<td>2.971227</td>
<td>0.309182</td>
<td>0.067685</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>7</td>
<td>2.894401</td>
<td>2.922726</td>
<td>0.260681</td>
<td>0.059278</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>8</td>
<td>2.877291</td>
<td>2.889860</td>
<td>0.227814</td>
<td>0.052599</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>9</td>
<td>2.863354</td>
<td>2.906056</td>
<td>0.244011</td>
<td>0.056762</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>10</td>
<td>2.851456</td>
<td>2.948015</td>
<td>0.285970</td>
<td>0.063813</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>11</td>
<td>2.840680</td>
<td>2.919197</td>
<td>0.257152</td>
<td>0.059050</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>12</td>
<td>2.831073</td>
<td>2.924233</td>
<td>0.262188</td>
<td>0.059024</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>13</td>
<td>2.822868</td>
<td>2.914097</td>
<td>0.252052</td>
<td>0.057968</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>14</td>
<td>2.816051</td>
<td>2.924426</td>
<td>0.262381</td>
<td>0.059423</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>15</td>
<td>2.809698</td>
<td>2.926474</td>
<td>0.264429</td>
<td>0.060345</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>16</td>
<td>2.804873</td>
<td>2.925350</td>
<td>0.263305</td>
<td>0.059481</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>17</td>
<td>2.800674</td>
<td>2.930919</td>
<td>0.268874</td>
<td>0.060678</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>18</td>
<td>2.797033</td>
<td>2.928454</td>
<td>0.266409</td>
<td>0.060319</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>19</td>
<td>2.794031</td>
<td>2.929961</td>
<td>0.267916</td>
<td>0.060498</td>
<td>00:00</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-stdout">
<pre><code>------fold8------
lr in training is 0.003</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">KLD</th>
<th data-quarto-table-cell-role="th">JSD</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>3.204548</td>
<td>3.130516</td>
<td>0.332384</td>
<td>0.072145</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>1</td>
<td>3.086863</td>
<td>2.963805</td>
<td>0.165674</td>
<td>0.039414</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>2</td>
<td>3.013082</td>
<td>2.931495</td>
<td>0.133363</td>
<td>0.028549</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>3</td>
<td>2.972725</td>
<td>2.921883</td>
<td>0.123751</td>
<td>0.026929</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>4</td>
<td>2.949337</td>
<td>2.924575</td>
<td>0.126443</td>
<td>0.027342</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>5</td>
<td>2.929606</td>
<td>2.938754</td>
<td>0.140622</td>
<td>0.029565</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>6</td>
<td>2.907469</td>
<td>2.928634</td>
<td>0.130502</td>
<td>0.028092</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>7</td>
<td>2.891385</td>
<td>2.991267</td>
<td>0.193135</td>
<td>0.042524</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>8</td>
<td>2.875030</td>
<td>2.937675</td>
<td>0.139543</td>
<td>0.031085</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>9</td>
<td>2.861556</td>
<td>3.244176</td>
<td>0.446044</td>
<td>0.061041</td>
<td>-1:59:59</td>
</tr>
<tr class="odd">
<td>10</td>
<td>2.849376</td>
<td>3.033440</td>
<td>0.235308</td>
<td>0.041062</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>11</td>
<td>2.839188</td>
<td>3.015007</td>
<td>0.216875</td>
<td>0.037495</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>12</td>
<td>2.829741</td>
<td>3.001976</td>
<td>0.203844</td>
<td>0.037402</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>13</td>
<td>2.821286</td>
<td>2.993891</td>
<td>0.195759</td>
<td>0.036398</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>14</td>
<td>2.815274</td>
<td>3.024797</td>
<td>0.226665</td>
<td>0.037667</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>15</td>
<td>2.809055</td>
<td>3.031073</td>
<td>0.232941</td>
<td>0.037450</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>16</td>
<td>2.803440</td>
<td>3.011022</td>
<td>0.212890</td>
<td>0.036360</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>17</td>
<td>2.798656</td>
<td>3.007020</td>
<td>0.208888</td>
<td>0.036344</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>18</td>
<td>2.795232</td>
<td>3.034969</td>
<td>0.236837</td>
<td>0.037165</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>19</td>
<td>2.791856</td>
<td>3.020481</td>
<td>0.222349</td>
<td>0.036640</td>
<td>00:00</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
</div>
<div id="64dd02b9-5d3a-477f-a3c5-f7c5c8a9d3b2" class="cell" data-execution_count="33">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>oof_esm <span class="op">=</span> train_dl_cv(df_esm,esm_col,target_col,</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>                  splits <span class="op">=</span> splits,</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>                  model_func <span class="op">=</span> get_cnn_esm,</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>                  n_epoch<span class="op">=</span><span class="dv">20</span>,lr<span class="op">=</span><span class="fl">3e-3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>------fold0------
lr in training is 0.003</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">KLD</th>
<th data-quarto-table-cell-role="th">JSD</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>3.264869</td>
<td>3.136897</td>
<td>0.398337</td>
<td>0.080906</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>1</td>
<td>3.217183</td>
<td>3.158689</td>
<td>0.420129</td>
<td>0.083298</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>2</td>
<td>3.185448</td>
<td>3.175242</td>
<td>0.436681</td>
<td>0.091017</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>3</td>
<td>3.167979</td>
<td>3.221153</td>
<td>0.482592</td>
<td>0.094919</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>4</td>
<td>3.154100</td>
<td>3.221832</td>
<td>0.483271</td>
<td>0.091278</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>5</td>
<td>3.117338</td>
<td>3.316915</td>
<td>0.578354</td>
<td>0.099876</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>6</td>
<td>3.072603</td>
<td>3.407976</td>
<td>0.669415</td>
<td>0.101000</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>7</td>
<td>3.027419</td>
<td>3.488302</td>
<td>0.749741</td>
<td>0.101484</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>8</td>
<td>2.988770</td>
<td>3.563498</td>
<td>0.824937</td>
<td>0.102865</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>9</td>
<td>2.956225</td>
<td>3.565761</td>
<td>0.827200</td>
<td>0.100375</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>10</td>
<td>2.929342</td>
<td>3.583453</td>
<td>0.844892</td>
<td>0.099281</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>11</td>
<td>2.907108</td>
<td>3.606526</td>
<td>0.867965</td>
<td>0.102185</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>12</td>
<td>2.888310</td>
<td>3.608578</td>
<td>0.870016</td>
<td>0.100652</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>13</td>
<td>2.872570</td>
<td>3.615547</td>
<td>0.876986</td>
<td>0.099283</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>14</td>
<td>2.859529</td>
<td>3.621958</td>
<td>0.883397</td>
<td>0.099150</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>15</td>
<td>2.847852</td>
<td>3.625345</td>
<td>0.886784</td>
<td>0.099454</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>16</td>
<td>2.837972</td>
<td>3.625224</td>
<td>0.886664</td>
<td>0.099652</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>17</td>
<td>2.829673</td>
<td>3.625283</td>
<td>0.886722</td>
<td>0.099333</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>18</td>
<td>2.822563</td>
<td>3.627709</td>
<td>0.889148</td>
<td>0.099345</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>19</td>
<td>2.816700</td>
<td>3.625107</td>
<td>0.886546</td>
<td>0.099251</td>
<td>00:00</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-stdout">
<pre><code>------fold1------
lr in training is 0.003</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">KLD</th>
<th data-quarto-table-cell-role="th">JSD</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>3.193581</td>
<td>3.120010</td>
<td>0.360617</td>
<td>0.080228</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>1</td>
<td>3.084519</td>
<td>2.978762</td>
<td>0.219370</td>
<td>0.055952</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>2</td>
<td>3.013452</td>
<td>2.900385</td>
<td>0.140992</td>
<td>0.033519</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>3</td>
<td>2.977241</td>
<td>2.921838</td>
<td>0.162445</td>
<td>0.038445</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>4</td>
<td>2.955385</td>
<td>2.901993</td>
<td>0.142601</td>
<td>0.033416</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>5</td>
<td>2.934080</td>
<td>2.874330</td>
<td>0.114937</td>
<td>0.027168</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>6</td>
<td>2.914432</td>
<td>2.875653</td>
<td>0.116260</td>
<td>0.027577</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>7</td>
<td>2.898649</td>
<td>2.873714</td>
<td>0.114322</td>
<td>0.026822</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>8</td>
<td>2.884012</td>
<td>2.866899</td>
<td>0.107507</td>
<td>0.025204</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>9</td>
<td>2.872340</td>
<td>2.869269</td>
<td>0.109877</td>
<td>0.025642</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>10</td>
<td>2.859931</td>
<td>2.878062</td>
<td>0.118670</td>
<td>0.027873</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>11</td>
<td>2.849241</td>
<td>2.868064</td>
<td>0.108672</td>
<td>0.025247</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>12</td>
<td>2.839279</td>
<td>2.862002</td>
<td>0.102609</td>
<td>0.024077</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>13</td>
<td>2.830748</td>
<td>2.858560</td>
<td>0.099167</td>
<td>0.023196</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>14</td>
<td>2.824155</td>
<td>2.868220</td>
<td>0.108827</td>
<td>0.025510</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>15</td>
<td>2.817403</td>
<td>2.866775</td>
<td>0.107382</td>
<td>0.025029</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>16</td>
<td>2.811302</td>
<td>2.861741</td>
<td>0.102348</td>
<td>0.023998</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>17</td>
<td>2.806031</td>
<td>2.860055</td>
<td>0.100662</td>
<td>0.023584</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>18</td>
<td>2.802316</td>
<td>2.859905</td>
<td>0.100513</td>
<td>0.023591</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>19</td>
<td>2.798471</td>
<td>2.860417</td>
<td>0.101025</td>
<td>0.023671</td>
<td>00:00</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-stdout">
<pre><code>------fold2------
lr in training is 0.003</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">KLD</th>
<th data-quarto-table-cell-role="th">JSD</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>3.202004</td>
<td>3.115519</td>
<td>0.398916</td>
<td>0.087196</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>1</td>
<td>3.087065</td>
<td>2.949936</td>
<td>0.233333</td>
<td>0.057611</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>2</td>
<td>3.018293</td>
<td>2.917029</td>
<td>0.200425</td>
<td>0.044855</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>3</td>
<td>2.982141</td>
<td>2.866996</td>
<td>0.150393</td>
<td>0.034669</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>4</td>
<td>2.967630</td>
<td>2.867355</td>
<td>0.150751</td>
<td>0.034402</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>5</td>
<td>2.947072</td>
<td>2.836027</td>
<td>0.119424</td>
<td>0.027516</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>6</td>
<td>2.927675</td>
<td>2.837569</td>
<td>0.120966</td>
<td>0.027518</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>7</td>
<td>2.910500</td>
<td>2.843097</td>
<td>0.126494</td>
<td>0.028759</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>8</td>
<td>2.894355</td>
<td>2.836293</td>
<td>0.119690</td>
<td>0.027306</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>9</td>
<td>2.880376</td>
<td>2.854691</td>
<td>0.138088</td>
<td>0.030649</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>10</td>
<td>2.867968</td>
<td>2.848921</td>
<td>0.132318</td>
<td>0.029835</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>11</td>
<td>2.857406</td>
<td>2.853977</td>
<td>0.137374</td>
<td>0.030709</td>
<td>-1:59:59</td>
</tr>
<tr class="odd">
<td>12</td>
<td>2.847581</td>
<td>2.839761</td>
<td>0.123158</td>
<td>0.027789</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>13</td>
<td>2.839229</td>
<td>2.837915</td>
<td>0.121312</td>
<td>0.026970</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>14</td>
<td>2.832961</td>
<td>2.846002</td>
<td>0.129399</td>
<td>0.028907</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>15</td>
<td>2.826205</td>
<td>2.841858</td>
<td>0.125255</td>
<td>0.027834</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>16</td>
<td>2.820190</td>
<td>2.847916</td>
<td>0.131313</td>
<td>0.029319</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>17</td>
<td>2.814878</td>
<td>2.847655</td>
<td>0.131052</td>
<td>0.029191</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>18</td>
<td>2.810926</td>
<td>2.846968</td>
<td>0.130365</td>
<td>0.029018</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>19</td>
<td>2.807157</td>
<td>2.847460</td>
<td>0.130857</td>
<td>0.029080</td>
<td>00:00</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-stdout">
<pre><code>------fold3------
lr in training is 0.003</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">KLD</th>
<th data-quarto-table-cell-role="th">JSD</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>3.202962</td>
<td>3.118910</td>
<td>0.427766</td>
<td>0.090941</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>1</td>
<td>3.089748</td>
<td>2.952767</td>
<td>0.261623</td>
<td>0.059470</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>2</td>
<td>3.022268</td>
<td>2.934290</td>
<td>0.243146</td>
<td>0.048406</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>3</td>
<td>2.988155</td>
<td>2.941152</td>
<td>0.250008</td>
<td>0.050903</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>4</td>
<td>2.967207</td>
<td>2.961673</td>
<td>0.270530</td>
<td>0.051580</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>5</td>
<td>2.951866</td>
<td>2.943200</td>
<td>0.252056</td>
<td>0.047716</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>6</td>
<td>2.932044</td>
<td>2.940075</td>
<td>0.248931</td>
<td>0.046150</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>7</td>
<td>2.913869</td>
<td>2.947825</td>
<td>0.256681</td>
<td>0.047069</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>8</td>
<td>2.898216</td>
<td>2.935129</td>
<td>0.243985</td>
<td>0.044736</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>9</td>
<td>2.884012</td>
<td>2.921401</td>
<td>0.230257</td>
<td>0.044297</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>10</td>
<td>2.873033</td>
<td>2.932486</td>
<td>0.241342</td>
<td>0.044664</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>11</td>
<td>2.862779</td>
<td>2.934337</td>
<td>0.243193</td>
<td>0.042859</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>12</td>
<td>2.855475</td>
<td>2.928978</td>
<td>0.237835</td>
<td>0.043229</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>13</td>
<td>2.846623</td>
<td>2.926791</td>
<td>0.235647</td>
<td>0.043191</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>14</td>
<td>2.838845</td>
<td>2.932529</td>
<td>0.241386</td>
<td>0.043511</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>15</td>
<td>2.831529</td>
<td>2.926085</td>
<td>0.234941</td>
<td>0.042803</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>16</td>
<td>2.825729</td>
<td>2.924322</td>
<td>0.233178</td>
<td>0.042513</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>17</td>
<td>2.820391</td>
<td>2.927167</td>
<td>0.236023</td>
<td>0.042804</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>18</td>
<td>2.816059</td>
<td>2.926176</td>
<td>0.235032</td>
<td>0.042715</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>19</td>
<td>2.812433</td>
<td>2.925177</td>
<td>0.234033</td>
<td>0.042523</td>
<td>00:00</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-stdout">
<pre><code>------fold4------
lr in training is 0.003</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">KLD</th>
<th data-quarto-table-cell-role="th">JSD</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>3.206472</td>
<td>3.133298</td>
<td>0.343854</td>
<td>0.075123</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>1</td>
<td>3.087475</td>
<td>2.981167</td>
<td>0.191722</td>
<td>0.049670</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>2</td>
<td>3.015009</td>
<td>2.916325</td>
<td>0.126880</td>
<td>0.029111</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>3</td>
<td>2.975545</td>
<td>2.920883</td>
<td>0.131439</td>
<td>0.031650</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>4</td>
<td>2.957316</td>
<td>2.924036</td>
<td>0.134591</td>
<td>0.031509</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>5</td>
<td>2.939080</td>
<td>2.909500</td>
<td>0.120055</td>
<td>0.028545</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>6</td>
<td>2.919973</td>
<td>2.902207</td>
<td>0.112762</td>
<td>0.026220</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>7</td>
<td>2.901022</td>
<td>2.903212</td>
<td>0.113767</td>
<td>0.026729</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>8</td>
<td>2.884898</td>
<td>2.912332</td>
<td>0.122887</td>
<td>0.028784</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>9</td>
<td>2.869776</td>
<td>2.908447</td>
<td>0.119002</td>
<td>0.027865</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>10</td>
<td>2.857329</td>
<td>2.902042</td>
<td>0.112598</td>
<td>0.026547</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>11</td>
<td>2.845674</td>
<td>2.895880</td>
<td>0.106435</td>
<td>0.024948</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>12</td>
<td>2.835716</td>
<td>2.890357</td>
<td>0.100912</td>
<td>0.023719</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>13</td>
<td>2.827060</td>
<td>2.893576</td>
<td>0.104131</td>
<td>0.024594</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>14</td>
<td>2.819177</td>
<td>2.892577</td>
<td>0.103132</td>
<td>0.024245</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>15</td>
<td>2.812434</td>
<td>2.892262</td>
<td>0.102817</td>
<td>0.024129</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>16</td>
<td>2.806125</td>
<td>2.891998</td>
<td>0.102553</td>
<td>0.023941</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>17</td>
<td>2.800571</td>
<td>2.890348</td>
<td>0.100904</td>
<td>0.023638</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>18</td>
<td>2.796558</td>
<td>2.890913</td>
<td>0.101468</td>
<td>0.023817</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>19</td>
<td>2.793637</td>
<td>2.890676</td>
<td>0.101231</td>
<td>0.023790</td>
<td>00:00</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-stdout">
<pre><code>------fold5------
lr in training is 0.003</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">KLD</th>
<th data-quarto-table-cell-role="th">JSD</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>3.187245</td>
<td>3.128074</td>
<td>0.339263</td>
<td>0.073991</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>1</td>
<td>3.071628</td>
<td>2.986283</td>
<td>0.197472</td>
<td>0.051019</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>2</td>
<td>3.001887</td>
<td>2.903810</td>
<td>0.114999</td>
<td>0.027137</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>3</td>
<td>2.964702</td>
<td>2.911484</td>
<td>0.122673</td>
<td>0.029126</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>4</td>
<td>2.946854</td>
<td>2.900443</td>
<td>0.111632</td>
<td>0.027561</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>5</td>
<td>2.930545</td>
<td>2.896069</td>
<td>0.107258</td>
<td>0.026062</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>6</td>
<td>2.911004</td>
<td>2.905382</td>
<td>0.116571</td>
<td>0.028297</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>7</td>
<td>2.894996</td>
<td>2.917508</td>
<td>0.128697</td>
<td>0.030506</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>8</td>
<td>2.880330</td>
<td>2.887178</td>
<td>0.098368</td>
<td>0.024039</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>9</td>
<td>2.869907</td>
<td>2.887413</td>
<td>0.098603</td>
<td>0.023499</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>10</td>
<td>2.860607</td>
<td>2.886769</td>
<td>0.097958</td>
<td>0.024129</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>11</td>
<td>2.851118</td>
<td>2.878669</td>
<td>0.089859</td>
<td>0.022112</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>12</td>
<td>2.841549</td>
<td>2.873977</td>
<td>0.085166</td>
<td>0.020676</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>13</td>
<td>2.832706</td>
<td>2.876251</td>
<td>0.087440</td>
<td>0.021426</td>
<td>-1:59:59</td>
</tr>
<tr class="odd">
<td>14</td>
<td>2.824652</td>
<td>2.870506</td>
<td>0.081696</td>
<td>0.019807</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>15</td>
<td>2.818056</td>
<td>2.870589</td>
<td>0.081778</td>
<td>0.019995</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>16</td>
<td>2.811975</td>
<td>2.870715</td>
<td>0.081905</td>
<td>0.020023</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>17</td>
<td>2.806576</td>
<td>2.869968</td>
<td>0.081157</td>
<td>0.019824</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>18</td>
<td>2.802316</td>
<td>2.869475</td>
<td>0.080664</td>
<td>0.019710</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>19</td>
<td>2.798843</td>
<td>2.869548</td>
<td>0.080738</td>
<td>0.019745</td>
<td>00:00</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-stdout">
<pre><code>------fold6------
lr in training is 0.003</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">KLD</th>
<th data-quarto-table-cell-role="th">JSD</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>3.188190</td>
<td>3.114348</td>
<td>0.299082</td>
<td>0.069039</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>1</td>
<td>3.063660</td>
<td>2.943110</td>
<td>0.127844</td>
<td>0.033852</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>2</td>
<td>2.997336</td>
<td>2.917790</td>
<td>0.102524</td>
<td>0.024700</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>3</td>
<td>2.964889</td>
<td>2.925680</td>
<td>0.110414</td>
<td>0.026368</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>4</td>
<td>2.947123</td>
<td>3.018301</td>
<td>0.203035</td>
<td>0.039962</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>5</td>
<td>2.928940</td>
<td>2.961387</td>
<td>0.146121</td>
<td>0.031864</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>6</td>
<td>2.911475</td>
<td>2.932888</td>
<td>0.117622</td>
<td>0.027504</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>7</td>
<td>2.892783</td>
<td>2.941010</td>
<td>0.125743</td>
<td>0.028919</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>8</td>
<td>2.877175</td>
<td>2.932807</td>
<td>0.117541</td>
<td>0.027764</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>9</td>
<td>2.863183</td>
<td>2.920175</td>
<td>0.104909</td>
<td>0.024967</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>10</td>
<td>2.850916</td>
<td>2.919358</td>
<td>0.104092</td>
<td>0.025017</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>11</td>
<td>2.840048</td>
<td>2.917005</td>
<td>0.101738</td>
<td>0.024471</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>12</td>
<td>2.830450</td>
<td>2.918196</td>
<td>0.102930</td>
<td>0.024451</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>13</td>
<td>2.822036</td>
<td>2.934537</td>
<td>0.119270</td>
<td>0.028025</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>14</td>
<td>2.814883</td>
<td>2.968319</td>
<td>0.153053</td>
<td>0.034001</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>15</td>
<td>2.808351</td>
<td>2.918659</td>
<td>0.103393</td>
<td>0.024519</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>16</td>
<td>2.802855</td>
<td>2.918992</td>
<td>0.103726</td>
<td>0.024673</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>17</td>
<td>2.797942</td>
<td>2.933373</td>
<td>0.118107</td>
<td>0.027699</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>18</td>
<td>2.793902</td>
<td>2.963440</td>
<td>0.148174</td>
<td>0.033079</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>19</td>
<td>2.790388</td>
<td>3.046306</td>
<td>0.231040</td>
<td>0.043707</td>
<td>00:00</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-stdout">
<pre><code>------fold7------
lr in training is 0.003</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">KLD</th>
<th data-quarto-table-cell-role="th">JSD</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>3.187940</td>
<td>3.132055</td>
<td>0.470010</td>
<td>0.100920</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>1</td>
<td>3.072927</td>
<td>2.944816</td>
<td>0.282771</td>
<td>0.063020</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>2</td>
<td>3.001055</td>
<td>2.929518</td>
<td>0.267473</td>
<td>0.059566</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>3</td>
<td>2.969772</td>
<td>2.948422</td>
<td>0.286377</td>
<td>0.063104</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>4</td>
<td>2.948040</td>
<td>2.926207</td>
<td>0.264161</td>
<td>0.057537</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>5</td>
<td>2.931400</td>
<td>2.963588</td>
<td>0.301542</td>
<td>0.064320</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>6</td>
<td>2.909764</td>
<td>2.960949</td>
<td>0.298904</td>
<td>0.064112</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>7</td>
<td>2.895195</td>
<td>3.003662</td>
<td>0.341618</td>
<td>0.070389</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>8</td>
<td>2.879205</td>
<td>3.000879</td>
<td>0.338834</td>
<td>0.070586</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>9</td>
<td>2.865099</td>
<td>3.004148</td>
<td>0.342102</td>
<td>0.070332</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>10</td>
<td>2.852739</td>
<td>2.982781</td>
<td>0.320736</td>
<td>0.066774</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>11</td>
<td>2.842682</td>
<td>3.000234</td>
<td>0.338189</td>
<td>0.069315</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>12</td>
<td>2.833195</td>
<td>3.006765</td>
<td>0.344720</td>
<td>0.070025</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>13</td>
<td>2.825611</td>
<td>2.998246</td>
<td>0.336202</td>
<td>0.068579</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>14</td>
<td>2.818143</td>
<td>3.008426</td>
<td>0.346380</td>
<td>0.071066</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>15</td>
<td>2.811678</td>
<td>3.001043</td>
<td>0.338998</td>
<td>0.069956</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>16</td>
<td>2.806150</td>
<td>3.001681</td>
<td>0.339636</td>
<td>0.070011</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>17</td>
<td>2.801808</td>
<td>3.003881</td>
<td>0.341836</td>
<td>0.070656</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>18</td>
<td>2.798122</td>
<td>3.011680</td>
<td>0.349635</td>
<td>0.072094</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>19</td>
<td>2.794909</td>
<td>3.004551</td>
<td>0.342506</td>
<td>0.070596</td>
<td>00:00</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-stdout">
<pre><code>------fold8------
lr in training is 0.003</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">KLD</th>
<th data-quarto-table-cell-role="th">JSD</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>3.191767</td>
<td>3.127610</td>
<td>0.329479</td>
<td>0.072123</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>1</td>
<td>3.075926</td>
<td>2.944713</td>
<td>0.146582</td>
<td>0.036049</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>2</td>
<td>3.003580</td>
<td>2.945038</td>
<td>0.146907</td>
<td>0.032734</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>3</td>
<td>2.966146</td>
<td>2.948486</td>
<td>0.150355</td>
<td>0.031666</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>4</td>
<td>2.945253</td>
<td>2.926992</td>
<td>0.128860</td>
<td>0.028842</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>5</td>
<td>2.926334</td>
<td>2.911107</td>
<td>0.112976</td>
<td>0.024992</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>6</td>
<td>2.906564</td>
<td>2.908641</td>
<td>0.110509</td>
<td>0.024338</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>7</td>
<td>2.889611</td>
<td>2.914251</td>
<td>0.116119</td>
<td>0.025042</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>8</td>
<td>2.875487</td>
<td>2.905566</td>
<td>0.107434</td>
<td>0.023223</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>9</td>
<td>2.862854</td>
<td>2.904928</td>
<td>0.106797</td>
<td>0.023156</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>10</td>
<td>2.850500</td>
<td>2.917810</td>
<td>0.119679</td>
<td>0.026055</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>11</td>
<td>2.840436</td>
<td>2.902700</td>
<td>0.104568</td>
<td>0.023097</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>12</td>
<td>2.831009</td>
<td>2.902440</td>
<td>0.104309</td>
<td>0.022983</td>
<td>-1:59:59</td>
</tr>
<tr class="even">
<td>13</td>
<td>2.822627</td>
<td>2.904006</td>
<td>0.105875</td>
<td>0.023260</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>14</td>
<td>2.815531</td>
<td>2.908263</td>
<td>0.110131</td>
<td>0.023731</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>15</td>
<td>2.809269</td>
<td>2.905061</td>
<td>0.106929</td>
<td>0.023299</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>16</td>
<td>2.804316</td>
<td>2.906749</td>
<td>0.108617</td>
<td>0.023572</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>17</td>
<td>2.799786</td>
<td>2.906028</td>
<td>0.107896</td>
<td>0.023450</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>18</td>
<td>2.796355</td>
<td>2.905400</td>
<td>0.107269</td>
<td>0.023268</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>19</td>
<td>2.793621</td>
<td>2.904385</td>
<td>0.106253</td>
<td>0.023061</td>
<td>00:00</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
</div>
<div id="07bff075-df59-4ad0-a62d-fe2eebf91fca" class="cell" data-execution_count="34">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>oof_onehot <span class="op">=</span> train_dl_cv(df_onehot,onehot_col,target_col,</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>                  splits <span class="op">=</span> splits,</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>                  model_func <span class="op">=</span> get_cnn_onehot,</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>                  n_epoch<span class="op">=</span><span class="dv">20</span>,lr<span class="op">=</span><span class="fl">3e-3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>------fold0------
lr in training is 0.003</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">KLD</th>
<th data-quarto-table-cell-role="th">JSD</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>3.277120</td>
<td>3.133921</td>
<td>0.395361</td>
<td>0.080811</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>1</td>
<td>3.220052</td>
<td>3.143938</td>
<td>0.405378</td>
<td>0.082488</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>2</td>
<td>3.172967</td>
<td>3.197285</td>
<td>0.458724</td>
<td>0.086042</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>3</td>
<td>3.142990</td>
<td>3.197540</td>
<td>0.458979</td>
<td>0.088806</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>4</td>
<td>3.120064</td>
<td>3.194893</td>
<td>0.456332</td>
<td>0.089937</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>5</td>
<td>3.082074</td>
<td>3.265694</td>
<td>0.527133</td>
<td>0.094442</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>6</td>
<td>3.037489</td>
<td>3.350454</td>
<td>0.611893</td>
<td>0.096622</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>7</td>
<td>2.994622</td>
<td>3.459473</td>
<td>0.720912</td>
<td>0.097649</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>8</td>
<td>2.958157</td>
<td>3.513486</td>
<td>0.774925</td>
<td>0.095750</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>9</td>
<td>2.927430</td>
<td>3.566482</td>
<td>0.827921</td>
<td>0.097972</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>10</td>
<td>2.902424</td>
<td>3.635440</td>
<td>0.896879</td>
<td>0.101687</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>11</td>
<td>2.881415</td>
<td>3.707916</td>
<td>0.969355</td>
<td>0.106543</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>12</td>
<td>2.864123</td>
<td>3.819097</td>
<td>1.080537</td>
<td>0.124386</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>13</td>
<td>2.849641</td>
<td>3.935453</td>
<td>1.196892</td>
<td>0.135377</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>14</td>
<td>2.837691</td>
<td>3.968906</td>
<td>1.230345</td>
<td>0.146021</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>15</td>
<td>2.827890</td>
<td>4.076715</td>
<td>1.338154</td>
<td>0.155096</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>16</td>
<td>2.819179</td>
<td>4.027257</td>
<td>1.288697</td>
<td>0.148987</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>17</td>
<td>2.811810</td>
<td>4.020642</td>
<td>1.282081</td>
<td>0.148653</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>18</td>
<td>2.805801</td>
<td>3.952586</td>
<td>1.214025</td>
<td>0.138949</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>19</td>
<td>2.800838</td>
<td>3.988277</td>
<td>1.249717</td>
<td>0.146054</td>
<td>00:00</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-stdout">
<pre><code>------fold1------
lr in training is 0.003</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">KLD</th>
<th data-quarto-table-cell-role="th">JSD</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>3.210148</td>
<td>3.139912</td>
<td>0.380520</td>
<td>0.082572</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>1</td>
<td>3.076796</td>
<td>3.013317</td>
<td>0.253924</td>
<td>0.063400</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>2</td>
<td>3.000978</td>
<td>2.891074</td>
<td>0.131682</td>
<td>0.031530</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>3</td>
<td>2.960962</td>
<td>2.920046</td>
<td>0.160653</td>
<td>0.037774</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>4</td>
<td>2.935330</td>
<td>2.882944</td>
<td>0.123551</td>
<td>0.028969</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>5</td>
<td>2.912577</td>
<td>2.878306</td>
<td>0.118913</td>
<td>0.027573</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>6</td>
<td>2.891449</td>
<td>2.862408</td>
<td>0.103015</td>
<td>0.024382</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>7</td>
<td>2.874047</td>
<td>2.857084</td>
<td>0.097691</td>
<td>0.023248</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>8</td>
<td>2.859166</td>
<td>2.862403</td>
<td>0.103011</td>
<td>0.024601</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>9</td>
<td>2.845874</td>
<td>2.874232</td>
<td>0.114840</td>
<td>0.027831</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>10</td>
<td>2.834624</td>
<td>2.888659</td>
<td>0.129267</td>
<td>0.031689</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>11</td>
<td>2.825206</td>
<td>2.899465</td>
<td>0.140072</td>
<td>0.034201</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>12</td>
<td>2.817001</td>
<td>2.916462</td>
<td>0.157069</td>
<td>0.038561</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>13</td>
<td>2.809952</td>
<td>2.905925</td>
<td>0.146533</td>
<td>0.035555</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>14</td>
<td>2.803583</td>
<td>2.906608</td>
<td>0.147216</td>
<td>0.035711</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>15</td>
<td>2.798075</td>
<td>2.908471</td>
<td>0.149078</td>
<td>0.036318</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>16</td>
<td>2.793313</td>
<td>2.905267</td>
<td>0.145874</td>
<td>0.035303</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>17</td>
<td>2.789165</td>
<td>2.905819</td>
<td>0.146426</td>
<td>0.035438</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>18</td>
<td>2.785420</td>
<td>2.905159</td>
<td>0.145767</td>
<td>0.035352</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>19</td>
<td>2.782227</td>
<td>2.905472</td>
<td>0.146079</td>
<td>0.035462</td>
<td>00:00</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-stdout">
<pre><code>------fold2------
lr in training is 0.003</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">KLD</th>
<th data-quarto-table-cell-role="th">JSD</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>3.203027</td>
<td>3.133307</td>
<td>0.416704</td>
<td>0.088837</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>1</td>
<td>3.081909</td>
<td>2.938727</td>
<td>0.222124</td>
<td>0.055139</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>2</td>
<td>3.011248</td>
<td>2.851364</td>
<td>0.134761</td>
<td>0.030517</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>3</td>
<td>2.967336</td>
<td>2.879799</td>
<td>0.163196</td>
<td>0.037787</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>4</td>
<td>2.942564</td>
<td>2.865221</td>
<td>0.148617</td>
<td>0.033606</td>
<td>-1:59:59</td>
</tr>
<tr class="even">
<td>5</td>
<td>2.921736</td>
<td>2.856464</td>
<td>0.139861</td>
<td>0.031637</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>6</td>
<td>2.902239</td>
<td>2.856883</td>
<td>0.140280</td>
<td>0.031034</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>7</td>
<td>2.883385</td>
<td>2.848513</td>
<td>0.131910</td>
<td>0.029322</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>8</td>
<td>2.867899</td>
<td>2.851038</td>
<td>0.134435</td>
<td>0.030472</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>9</td>
<td>2.854214</td>
<td>2.868535</td>
<td>0.151931</td>
<td>0.034805</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>10</td>
<td>2.841882</td>
<td>2.876914</td>
<td>0.160311</td>
<td>0.036888</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>11</td>
<td>2.831786</td>
<td>2.883744</td>
<td>0.167141</td>
<td>0.038587</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>12</td>
<td>2.823037</td>
<td>2.896835</td>
<td>0.180232</td>
<td>0.042036</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>13</td>
<td>2.815647</td>
<td>2.907049</td>
<td>0.190445</td>
<td>0.044805</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>14</td>
<td>2.809287</td>
<td>2.923750</td>
<td>0.207147</td>
<td>0.048721</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>15</td>
<td>2.804163</td>
<td>2.922053</td>
<td>0.205449</td>
<td>0.048186</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>16</td>
<td>2.799402</td>
<td>2.926703</td>
<td>0.210099</td>
<td>0.049234</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>17</td>
<td>2.795474</td>
<td>2.927454</td>
<td>0.210851</td>
<td>0.049211</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>18</td>
<td>2.791993</td>
<td>2.922887</td>
<td>0.206284</td>
<td>0.048067</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>19</td>
<td>2.788906</td>
<td>2.934660</td>
<td>0.218057</td>
<td>0.050382</td>
<td>00:00</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-stdout">
<pre><code>------fold3------
lr in training is 0.003</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">KLD</th>
<th data-quarto-table-cell-role="th">JSD</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>3.217360</td>
<td>3.135256</td>
<td>0.444112</td>
<td>0.093500</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>1</td>
<td>3.089197</td>
<td>3.000559</td>
<td>0.309415</td>
<td>0.071229</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>2</td>
<td>3.013406</td>
<td>2.909544</td>
<td>0.218400</td>
<td>0.043400</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>3</td>
<td>2.973763</td>
<td>3.000403</td>
<td>0.309258</td>
<td>0.058953</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>4</td>
<td>2.950085</td>
<td>2.952441</td>
<td>0.261297</td>
<td>0.050864</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>5</td>
<td>2.926956</td>
<td>2.932818</td>
<td>0.241674</td>
<td>0.046230</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>6</td>
<td>2.905373</td>
<td>2.913712</td>
<td>0.222568</td>
<td>0.043278</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>7</td>
<td>2.886523</td>
<td>2.899899</td>
<td>0.208755</td>
<td>0.041040</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>8</td>
<td>2.871984</td>
<td>2.899730</td>
<td>0.208587</td>
<td>0.040406</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>9</td>
<td>2.859025</td>
<td>2.895478</td>
<td>0.204334</td>
<td>0.040991</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>10</td>
<td>2.847441</td>
<td>2.900883</td>
<td>0.209739</td>
<td>0.041914</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>11</td>
<td>2.837836</td>
<td>2.938530</td>
<td>0.247386</td>
<td>0.050021</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>12</td>
<td>2.829586</td>
<td>3.007871</td>
<td>0.316727</td>
<td>0.066030</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>13</td>
<td>2.821911</td>
<td>3.130609</td>
<td>0.439465</td>
<td>0.090029</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>14</td>
<td>2.815553</td>
<td>3.205676</td>
<td>0.514532</td>
<td>0.097538</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>15</td>
<td>2.809974</td>
<td>3.894821</td>
<td>1.203677</td>
<td>0.142054</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>16</td>
<td>2.804972</td>
<td>4.875163</td>
<td>2.184019</td>
<td>0.172196</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>17</td>
<td>2.800660</td>
<td>4.489316</td>
<td>1.798172</td>
<td>0.166581</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>18</td>
<td>2.797134</td>
<td>3.734024</td>
<td>1.042881</td>
<td>0.139437</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>19</td>
<td>2.794170</td>
<td>3.943503</td>
<td>1.252359</td>
<td>0.143880</td>
<td>00:00</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-stdout">
<pre><code>------fold4------
lr in training is 0.003</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">KLD</th>
<th data-quarto-table-cell-role="th">JSD</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>3.221777</td>
<td>3.120676</td>
<td>0.331231</td>
<td>0.073846</td>
<td>00:01</td>
</tr>
<tr class="even">
<td>1</td>
<td>3.079224</td>
<td>2.961355</td>
<td>0.171910</td>
<td>0.044981</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>2</td>
<td>3.000947</td>
<td>2.920985</td>
<td>0.131540</td>
<td>0.031555</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>3</td>
<td>2.962647</td>
<td>2.964863</td>
<td>0.175418</td>
<td>0.040005</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>4</td>
<td>2.940489</td>
<td>2.948510</td>
<td>0.159065</td>
<td>0.037153</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>5</td>
<td>2.917177</td>
<td>2.914334</td>
<td>0.124890</td>
<td>0.029468</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>6</td>
<td>2.894965</td>
<td>2.901642</td>
<td>0.112197</td>
<td>0.026065</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>7</td>
<td>2.875778</td>
<td>2.897019</td>
<td>0.107574</td>
<td>0.025436</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>8</td>
<td>2.859513</td>
<td>2.893893</td>
<td>0.104448</td>
<td>0.024652</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>9</td>
<td>2.845501</td>
<td>2.900487</td>
<td>0.111043</td>
<td>0.026683</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>10</td>
<td>2.833211</td>
<td>2.911707</td>
<td>0.122262</td>
<td>0.029087</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>11</td>
<td>2.823061</td>
<td>2.918646</td>
<td>0.129201</td>
<td>0.030911</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>12</td>
<td>2.814080</td>
<td>2.962426</td>
<td>0.172982</td>
<td>0.039040</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>13</td>
<td>2.806450</td>
<td>3.012691</td>
<td>0.223246</td>
<td>0.045578</td>
<td>-1:59:59</td>
</tr>
<tr class="odd">
<td>14</td>
<td>2.799661</td>
<td>3.095942</td>
<td>0.306497</td>
<td>0.056741</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>15</td>
<td>2.794147</td>
<td>3.186306</td>
<td>0.396861</td>
<td>0.066668</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>16</td>
<td>2.789003</td>
<td>3.146222</td>
<td>0.356777</td>
<td>0.061604</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>17</td>
<td>2.784820</td>
<td>3.192040</td>
<td>0.402595</td>
<td>0.064867</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>18</td>
<td>2.781168</td>
<td>3.251970</td>
<td>0.462525</td>
<td>0.068339</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>19</td>
<td>2.778569</td>
<td>3.470715</td>
<td>0.681270</td>
<td>0.079629</td>
<td>00:00</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-stdout">
<pre><code>------fold5------
lr in training is 0.003</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">KLD</th>
<th data-quarto-table-cell-role="th">JSD</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>3.199647</td>
<td>3.140137</td>
<td>0.351326</td>
<td>0.075517</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>1</td>
<td>3.064764</td>
<td>2.972414</td>
<td>0.183604</td>
<td>0.047527</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>2</td>
<td>2.991076</td>
<td>2.917917</td>
<td>0.129106</td>
<td>0.031017</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>3</td>
<td>2.949582</td>
<td>2.947464</td>
<td>0.158653</td>
<td>0.038191</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>4</td>
<td>2.925140</td>
<td>2.909489</td>
<td>0.120679</td>
<td>0.028941</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>5</td>
<td>2.902952</td>
<td>2.904005</td>
<td>0.115195</td>
<td>0.027851</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>6</td>
<td>2.882324</td>
<td>2.890948</td>
<td>0.102137</td>
<td>0.024815</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>7</td>
<td>2.863699</td>
<td>2.894485</td>
<td>0.105674</td>
<td>0.025504</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>8</td>
<td>2.848049</td>
<td>2.904008</td>
<td>0.115198</td>
<td>0.028467</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>9</td>
<td>2.834757</td>
<td>2.911851</td>
<td>0.123041</td>
<td>0.030428</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>10</td>
<td>2.823938</td>
<td>2.918086</td>
<td>0.129275</td>
<td>0.032054</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>11</td>
<td>2.814502</td>
<td>2.924456</td>
<td>0.135646</td>
<td>0.033397</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>12</td>
<td>2.806381</td>
<td>2.936222</td>
<td>0.147411</td>
<td>0.035624</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>13</td>
<td>2.799514</td>
<td>2.932553</td>
<td>0.143742</td>
<td>0.035170</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>14</td>
<td>2.793619</td>
<td>2.931933</td>
<td>0.143122</td>
<td>0.035091</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>15</td>
<td>2.788580</td>
<td>2.929070</td>
<td>0.140260</td>
<td>0.034507</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>16</td>
<td>2.784421</td>
<td>2.931773</td>
<td>0.142962</td>
<td>0.035119</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>17</td>
<td>2.780766</td>
<td>2.931452</td>
<td>0.142641</td>
<td>0.035091</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>18</td>
<td>2.777678</td>
<td>2.929527</td>
<td>0.140717</td>
<td>0.034653</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>19</td>
<td>2.775166</td>
<td>2.930931</td>
<td>0.142120</td>
<td>0.034841</td>
<td>00:00</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-stdout">
<pre><code>------fold6------
lr in training is 0.003</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">KLD</th>
<th data-quarto-table-cell-role="th">JSD</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>3.211345</td>
<td>3.139642</td>
<td>0.324376</td>
<td>0.071962</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>1</td>
<td>3.079162</td>
<td>2.969423</td>
<td>0.154157</td>
<td>0.040900</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>2</td>
<td>3.002954</td>
<td>2.927417</td>
<td>0.112150</td>
<td>0.026776</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>3</td>
<td>2.957990</td>
<td>2.980102</td>
<td>0.164836</td>
<td>0.037336</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>4</td>
<td>2.934710</td>
<td>2.942456</td>
<td>0.127189</td>
<td>0.029204</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>5</td>
<td>2.913644</td>
<td>2.923435</td>
<td>0.108169</td>
<td>0.025080</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>6</td>
<td>2.891332</td>
<td>2.929808</td>
<td>0.114542</td>
<td>0.025729</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>7</td>
<td>2.871521</td>
<td>2.914588</td>
<td>0.099322</td>
<td>0.023127</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>8</td>
<td>2.854944</td>
<td>2.909274</td>
<td>0.094008</td>
<td>0.022614</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>9</td>
<td>2.840556</td>
<td>2.923026</td>
<td>0.107760</td>
<td>0.026119</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>10</td>
<td>2.828343</td>
<td>2.958011</td>
<td>0.142744</td>
<td>0.033875</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>11</td>
<td>2.818299</td>
<td>3.014986</td>
<td>0.199720</td>
<td>0.046344</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>12</td>
<td>2.809941</td>
<td>3.028631</td>
<td>0.213364</td>
<td>0.049657</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>13</td>
<td>2.802525</td>
<td>3.000083</td>
<td>0.184817</td>
<td>0.043963</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>14</td>
<td>2.796725</td>
<td>2.989132</td>
<td>0.173866</td>
<td>0.041270</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>15</td>
<td>2.791409</td>
<td>2.996987</td>
<td>0.181720</td>
<td>0.042921</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>16</td>
<td>2.786753</td>
<td>3.003397</td>
<td>0.188131</td>
<td>0.044358</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>17</td>
<td>2.782986</td>
<td>3.002526</td>
<td>0.187259</td>
<td>0.044141</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>18</td>
<td>2.779207</td>
<td>2.997455</td>
<td>0.182189</td>
<td>0.042945</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>19</td>
<td>2.776644</td>
<td>2.999060</td>
<td>0.183793</td>
<td>0.043442</td>
<td>00:00</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-stdout">
<pre><code>------fold7------
lr in training is 0.003</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">KLD</th>
<th data-quarto-table-cell-role="th">JSD</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>3.207157</td>
<td>3.116577</td>
<td>0.454532</td>
<td>0.098201</td>
<td>00:21</td>
</tr>
<tr class="even">
<td>1</td>
<td>3.068383</td>
<td>2.942939</td>
<td>0.280893</td>
<td>0.065497</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>2</td>
<td>2.993331</td>
<td>2.967219</td>
<td>0.305173</td>
<td>0.066856</td>
<td>00:02</td>
</tr>
<tr class="even">
<td>3</td>
<td>2.952425</td>
<td>2.931577</td>
<td>0.269531</td>
<td>0.058940</td>
<td>07:28</td>
</tr>
<tr class="odd">
<td>4</td>
<td>2.924765</td>
<td>2.894598</td>
<td>0.232553</td>
<td>0.052688</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>5</td>
<td>2.902512</td>
<td>2.898267</td>
<td>0.236222</td>
<td>0.051465</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>6</td>
<td>2.884839</td>
<td>2.890331</td>
<td>0.228286</td>
<td>0.050490</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>7</td>
<td>2.869885</td>
<td>2.894372</td>
<td>0.232327</td>
<td>0.051913</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>8</td>
<td>2.855418</td>
<td>2.942313</td>
<td>0.280268</td>
<td>0.060312</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>9</td>
<td>2.841797</td>
<td>3.203032</td>
<td>0.540987</td>
<td>0.111459</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>10</td>
<td>2.830229</td>
<td>3.292855</td>
<td>0.630810</td>
<td>0.123641</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>11</td>
<td>2.820735</td>
<td>3.266531</td>
<td>0.604486</td>
<td>0.119290</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>12</td>
<td>2.812273</td>
<td>3.308702</td>
<td>0.646657</td>
<td>0.129931</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>13</td>
<td>2.805096</td>
<td>3.256686</td>
<td>0.594641</td>
<td>0.118864</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>14</td>
<td>2.799061</td>
<td>3.193116</td>
<td>0.531071</td>
<td>0.108449</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>15</td>
<td>2.793950</td>
<td>3.204517</td>
<td>0.542472</td>
<td>0.109433</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>16</td>
<td>2.789811</td>
<td>3.160384</td>
<td>0.498339</td>
<td>0.103601</td>
<td>00:01</td>
</tr>
<tr class="even">
<td>17</td>
<td>2.786062</td>
<td>3.193079</td>
<td>0.531034</td>
<td>0.109163</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>18</td>
<td>2.782929</td>
<td>3.141123</td>
<td>0.479077</td>
<td>0.098941</td>
<td>00:01</td>
</tr>
<tr class="even">
<td>19</td>
<td>2.780393</td>
<td>3.178627</td>
<td>0.516582</td>
<td>0.106204</td>
<td>00:01</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-stdout">
<pre><code>------fold8------
lr in training is 0.003</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">KLD</th>
<th data-quarto-table-cell-role="th">JSD</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>3.218322</td>
<td>3.154627</td>
<td>0.356495</td>
<td>0.075715</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>1</td>
<td>3.082187</td>
<td>2.948062</td>
<td>0.149931</td>
<td>0.037856</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>2</td>
<td>3.001617</td>
<td>3.049119</td>
<td>0.250988</td>
<td>0.055764</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>3</td>
<td>2.959477</td>
<td>3.161151</td>
<td>0.363019</td>
<td>0.079681</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>4</td>
<td>2.930529</td>
<td>3.053700</td>
<td>0.255568</td>
<td>0.054616</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>5</td>
<td>2.905670</td>
<td>2.989527</td>
<td>0.191395</td>
<td>0.042046</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>6</td>
<td>2.883381</td>
<td>2.934242</td>
<td>0.136111</td>
<td>0.030624</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>7</td>
<td>2.864315</td>
<td>2.923664</td>
<td>0.125532</td>
<td>0.027720</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>8</td>
<td>2.848774</td>
<td>2.965591</td>
<td>0.167460</td>
<td>0.039490</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>9</td>
<td>2.835498</td>
<td>3.717572</td>
<td>0.919440</td>
<td>0.118789</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>10</td>
<td>2.824239</td>
<td>4.831798</td>
<td>2.033666</td>
<td>0.155769</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>11</td>
<td>2.814907</td>
<td>5.116006</td>
<td>2.317875</td>
<td>0.170461</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>12</td>
<td>2.806855</td>
<td>5.010515</td>
<td>2.212383</td>
<td>0.169534</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>13</td>
<td>2.800228</td>
<td>5.589930</td>
<td>2.791799</td>
<td>0.186263</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>14</td>
<td>2.794528</td>
<td>5.756356</td>
<td>2.958225</td>
<td>0.184530</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>15</td>
<td>2.789591</td>
<td>5.471392</td>
<td>2.673260</td>
<td>0.172984</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>16</td>
<td>2.785285</td>
<td>5.211399</td>
<td>2.413267</td>
<td>0.165043</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>17</td>
<td>2.781870</td>
<td>5.124030</td>
<td>2.325897</td>
<td>0.165491</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>18</td>
<td>2.779195</td>
<td>5.127772</td>
<td>2.329640</td>
<td>0.169457</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>19</td>
<td>2.777070</td>
<td>5.340095</td>
<td>2.541963</td>
<td>0.172145</td>
<td>00:00</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
</div>
<div id="ad863fd2-8963-4612-a865-d87100abaa0e" class="cell" data-execution_count="35">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>oof_onehot_pca <span class="op">=</span> train_dl_cv(df_onehot_pca,onehot_pca_col,target_col,</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>                  splits <span class="op">=</span> splits,</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>                  model_func <span class="op">=</span> get_cnn_onehot_pca,</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>                  n_epoch<span class="op">=</span><span class="dv">20</span>,lr<span class="op">=</span><span class="fl">3e-3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>------fold0------
lr in training is 0.003</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">KLD</th>
<th data-quarto-table-cell-role="th">JSD</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>3.294691</td>
<td>3.137259</td>
<td>0.398698</td>
<td>0.080640</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>1</td>
<td>3.263470</td>
<td>3.141515</td>
<td>0.402954</td>
<td>0.082747</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>2</td>
<td>3.223175</td>
<td>3.177219</td>
<td>0.438658</td>
<td>0.089337</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>3</td>
<td>3.183045</td>
<td>3.227620</td>
<td>0.489059</td>
<td>0.093476</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>4</td>
<td>3.142418</td>
<td>3.287463</td>
<td>0.548902</td>
<td>0.100686</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>5</td>
<td>3.100256</td>
<td>3.341402</td>
<td>0.602841</td>
<td>0.100119</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>6</td>
<td>3.054611</td>
<td>3.505619</td>
<td>0.767058</td>
<td>0.101345</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>7</td>
<td>3.011055</td>
<td>3.471998</td>
<td>0.733437</td>
<td>0.097002</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>8</td>
<td>2.974147</td>
<td>3.588242</td>
<td>0.849681</td>
<td>0.097573</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>9</td>
<td>2.943142</td>
<td>3.605361</td>
<td>0.866801</td>
<td>0.097618</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>10</td>
<td>2.917536</td>
<td>3.611651</td>
<td>0.873091</td>
<td>0.095335</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>11</td>
<td>2.895584</td>
<td>3.629502</td>
<td>0.890941</td>
<td>0.094714</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>12</td>
<td>2.876624</td>
<td>3.649335</td>
<td>0.910774</td>
<td>0.096127</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>13</td>
<td>2.860609</td>
<td>3.660701</td>
<td>0.922140</td>
<td>0.097082</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>14</td>
<td>2.847290</td>
<td>3.664461</td>
<td>0.925900</td>
<td>0.096590</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>15</td>
<td>2.836029</td>
<td>3.668696</td>
<td>0.930135</td>
<td>0.096939</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>16</td>
<td>2.826384</td>
<td>3.669010</td>
<td>0.930449</td>
<td>0.096871</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>17</td>
<td>2.818100</td>
<td>3.676537</td>
<td>0.937977</td>
<td>0.096779</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>18</td>
<td>2.811651</td>
<td>3.676708</td>
<td>0.938147</td>
<td>0.096693</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>19</td>
<td>2.805929</td>
<td>3.677161</td>
<td>0.938600</td>
<td>0.096341</td>
<td>00:00</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-stdout">
<pre><code>------fold1------
lr in training is 0.003</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">KLD</th>
<th data-quarto-table-cell-role="th">JSD</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>3.301871</td>
<td>3.113387</td>
<td>0.353994</td>
<td>0.080182</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>1</td>
<td>3.251986</td>
<td>3.055797</td>
<td>0.296404</td>
<td>0.072427</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>2</td>
<td>3.180077</td>
<td>2.946853</td>
<td>0.187460</td>
<td>0.049313</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>3</td>
<td>3.106059</td>
<td>3.159497</td>
<td>0.400104</td>
<td>0.067071</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>4</td>
<td>3.053151</td>
<td>3.082665</td>
<td>0.323272</td>
<td>0.055897</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>5</td>
<td>3.016690</td>
<td>2.961791</td>
<td>0.202398</td>
<td>0.045059</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>6</td>
<td>2.985151</td>
<td>2.949506</td>
<td>0.190114</td>
<td>0.043004</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>7</td>
<td>2.956095</td>
<td>2.933504</td>
<td>0.174111</td>
<td>0.039649</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>8</td>
<td>2.929397</td>
<td>2.934963</td>
<td>0.175571</td>
<td>0.040043</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>9</td>
<td>2.907381</td>
<td>2.915690</td>
<td>0.156297</td>
<td>0.036116</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>10</td>
<td>2.887776</td>
<td>2.903538</td>
<td>0.144146</td>
<td>0.033489</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>11</td>
<td>2.870944</td>
<td>2.926418</td>
<td>0.167025</td>
<td>0.037351</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>12</td>
<td>2.856064</td>
<td>2.917785</td>
<td>0.158392</td>
<td>0.035572</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>13</td>
<td>2.843407</td>
<td>2.906300</td>
<td>0.146907</td>
<td>0.033587</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>14</td>
<td>2.832056</td>
<td>2.907512</td>
<td>0.148120</td>
<td>0.033845</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>15</td>
<td>2.822417</td>
<td>2.906131</td>
<td>0.146738</td>
<td>0.033671</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>16</td>
<td>2.814583</td>
<td>2.909864</td>
<td>0.150471</td>
<td>0.034348</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>17</td>
<td>2.807935</td>
<td>2.911995</td>
<td>0.152602</td>
<td>0.034596</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>18</td>
<td>2.802130</td>
<td>2.910291</td>
<td>0.150898</td>
<td>0.034142</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>19</td>
<td>2.797422</td>
<td>2.898971</td>
<td>0.139578</td>
<td>0.032354</td>
<td>00:00</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-stdout">
<pre><code>------fold2------
lr in training is 0.003</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">KLD</th>
<th data-quarto-table-cell-role="th">JSD</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>3.302217</td>
<td>3.133570</td>
<td>0.416967</td>
<td>0.090089</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>1</td>
<td>3.256617</td>
<td>3.091846</td>
<td>0.375242</td>
<td>0.085063</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>2</td>
<td>3.185585</td>
<td>3.058449</td>
<td>0.341846</td>
<td>0.079717</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>3</td>
<td>3.108964</td>
<td>3.085640</td>
<td>0.369037</td>
<td>0.067483</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>4</td>
<td>3.053280</td>
<td>3.206532</td>
<td>0.489929</td>
<td>0.074658</td>
<td>-1:59:59</td>
</tr>
<tr class="even">
<td>5</td>
<td>3.018560</td>
<td>2.920109</td>
<td>0.203505</td>
<td>0.045472</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>6</td>
<td>2.989412</td>
<td>2.938208</td>
<td>0.221605</td>
<td>0.049293</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>7</td>
<td>2.959617</td>
<td>2.946715</td>
<td>0.230112</td>
<td>0.051988</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>8</td>
<td>2.932363</td>
<td>2.911540</td>
<td>0.194936</td>
<td>0.044599</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>9</td>
<td>2.910704</td>
<td>2.981530</td>
<td>0.264927</td>
<td>0.059324</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>10</td>
<td>2.891130</td>
<td>2.962162</td>
<td>0.245558</td>
<td>0.055606</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>11</td>
<td>2.874626</td>
<td>2.913973</td>
<td>0.197370</td>
<td>0.045975</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>12</td>
<td>2.860034</td>
<td>2.902319</td>
<td>0.185716</td>
<td>0.042663</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>13</td>
<td>2.847568</td>
<td>2.893028</td>
<td>0.176425</td>
<td>0.039844</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>14</td>
<td>2.836598</td>
<td>2.884434</td>
<td>0.167830</td>
<td>0.038216</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>15</td>
<td>2.827027</td>
<td>2.886871</td>
<td>0.170268</td>
<td>0.038664</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>16</td>
<td>2.819156</td>
<td>2.886121</td>
<td>0.169518</td>
<td>0.038627</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>17</td>
<td>2.812171</td>
<td>2.888980</td>
<td>0.172377</td>
<td>0.039150</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>18</td>
<td>2.806926</td>
<td>2.890533</td>
<td>0.173930</td>
<td>0.039448</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>19</td>
<td>2.802097</td>
<td>2.891819</td>
<td>0.175215</td>
<td>0.039755</td>
<td>00:00</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-stdout">
<pre><code>------fold3------
lr in training is 0.003</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">KLD</th>
<th data-quarto-table-cell-role="th">JSD</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>3.299308</td>
<td>3.112815</td>
<td>0.421671</td>
<td>0.090712</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>1</td>
<td>3.251778</td>
<td>3.073382</td>
<td>0.382238</td>
<td>0.085915</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>2</td>
<td>3.179465</td>
<td>3.053364</td>
<td>0.362220</td>
<td>0.081255</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>3</td>
<td>3.106511</td>
<td>3.319328</td>
<td>0.628184</td>
<td>0.080552</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>4</td>
<td>3.065808</td>
<td>3.112725</td>
<td>0.421581</td>
<td>0.075182</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>5</td>
<td>3.036750</td>
<td>2.988638</td>
<td>0.297494</td>
<td>0.060457</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>6</td>
<td>3.005094</td>
<td>3.020451</td>
<td>0.329307</td>
<td>0.067131</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>7</td>
<td>2.974625</td>
<td>3.095387</td>
<td>0.404244</td>
<td>0.073515</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>8</td>
<td>2.946579</td>
<td>3.052358</td>
<td>0.361214</td>
<td>0.066235</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>9</td>
<td>2.923277</td>
<td>2.994418</td>
<td>0.303274</td>
<td>0.058904</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>10</td>
<td>2.901995</td>
<td>2.960744</td>
<td>0.269600</td>
<td>0.052277</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>11</td>
<td>2.885334</td>
<td>2.939471</td>
<td>0.248327</td>
<td>0.047824</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>12</td>
<td>2.869542</td>
<td>2.938663</td>
<td>0.247519</td>
<td>0.048670</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>13</td>
<td>2.856085</td>
<td>2.969018</td>
<td>0.277874</td>
<td>0.053620</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>14</td>
<td>2.845040</td>
<td>2.986923</td>
<td>0.295779</td>
<td>0.055922</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>15</td>
<td>2.835549</td>
<td>2.976436</td>
<td>0.285293</td>
<td>0.054313</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>16</td>
<td>2.827210</td>
<td>2.959410</td>
<td>0.268266</td>
<td>0.051559</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>17</td>
<td>2.820472</td>
<td>2.949389</td>
<td>0.258245</td>
<td>0.049625</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>18</td>
<td>2.815124</td>
<td>2.947890</td>
<td>0.256747</td>
<td>0.049296</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>19</td>
<td>2.810766</td>
<td>2.956153</td>
<td>0.265009</td>
<td>0.050701</td>
<td>00:00</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-stdout">
<pre><code>------fold4------
lr in training is 0.003</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">KLD</th>
<th data-quarto-table-cell-role="th">JSD</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>3.299725</td>
<td>3.117021</td>
<td>0.327577</td>
<td>0.073398</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>1</td>
<td>3.250774</td>
<td>3.064939</td>
<td>0.275494</td>
<td>0.066268</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>2</td>
<td>3.174958</td>
<td>2.958110</td>
<td>0.168665</td>
<td>0.043510</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>3</td>
<td>3.099215</td>
<td>2.961793</td>
<td>0.172348</td>
<td>0.040971</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>4</td>
<td>3.051188</td>
<td>2.934969</td>
<td>0.145524</td>
<td>0.034921</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>5</td>
<td>3.018962</td>
<td>2.951272</td>
<td>0.161827</td>
<td>0.039013</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>6</td>
<td>2.988851</td>
<td>2.930847</td>
<td>0.141403</td>
<td>0.034108</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>7</td>
<td>2.959735</td>
<td>2.912599</td>
<td>0.123154</td>
<td>0.029397</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>8</td>
<td>2.932398</td>
<td>2.916482</td>
<td>0.127037</td>
<td>0.030873</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>9</td>
<td>2.908323</td>
<td>2.909319</td>
<td>0.119874</td>
<td>0.029153</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>10</td>
<td>2.887608</td>
<td>2.903954</td>
<td>0.114509</td>
<td>0.027146</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>11</td>
<td>2.870060</td>
<td>2.906731</td>
<td>0.117286</td>
<td>0.027781</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>12</td>
<td>2.854917</td>
<td>2.909138</td>
<td>0.119693</td>
<td>0.028750</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>13</td>
<td>2.842772</td>
<td>2.904670</td>
<td>0.115226</td>
<td>0.027538</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>14</td>
<td>2.831243</td>
<td>2.906233</td>
<td>0.116789</td>
<td>0.028013</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>15</td>
<td>2.821458</td>
<td>2.905252</td>
<td>0.115808</td>
<td>0.027734</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>16</td>
<td>2.813246</td>
<td>2.905241</td>
<td>0.115796</td>
<td>0.027731</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>17</td>
<td>2.805741</td>
<td>2.905666</td>
<td>0.116221</td>
<td>0.027847</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>18</td>
<td>2.799681</td>
<td>2.908188</td>
<td>0.118743</td>
<td>0.028527</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>19</td>
<td>2.794784</td>
<td>2.903374</td>
<td>0.113929</td>
<td>0.027207</td>
<td>00:00</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-stdout">
<pre><code>------fold5------
lr in training is 0.003</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">KLD</th>
<th data-quarto-table-cell-role="th">JSD</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>3.294465</td>
<td>3.135190</td>
<td>0.346380</td>
<td>0.075028</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>1</td>
<td>3.248152</td>
<td>3.124927</td>
<td>0.336117</td>
<td>0.073005</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>2</td>
<td>3.168731</td>
<td>3.020002</td>
<td>0.231191</td>
<td>0.056880</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>3</td>
<td>3.091349</td>
<td>3.233966</td>
<td>0.445156</td>
<td>0.074591</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>4</td>
<td>3.042989</td>
<td>2.996500</td>
<td>0.207690</td>
<td>0.044531</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>5</td>
<td>3.000945</td>
<td>2.983008</td>
<td>0.194198</td>
<td>0.045271</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>6</td>
<td>2.966819</td>
<td>2.952210</td>
<td>0.163400</td>
<td>0.038246</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>7</td>
<td>2.936022</td>
<td>2.951103</td>
<td>0.162293</td>
<td>0.035806</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>8</td>
<td>2.910291</td>
<td>2.929545</td>
<td>0.140735</td>
<td>0.031989</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>9</td>
<td>2.887657</td>
<td>2.920960</td>
<td>0.132150</td>
<td>0.031165</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>10</td>
<td>2.868363</td>
<td>2.915508</td>
<td>0.126698</td>
<td>0.030763</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>11</td>
<td>2.853660</td>
<td>2.912930</td>
<td>0.124119</td>
<td>0.030236</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>12</td>
<td>2.841366</td>
<td>2.928237</td>
<td>0.139426</td>
<td>0.033478</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>13</td>
<td>2.830123</td>
<td>2.908879</td>
<td>0.120069</td>
<td>0.029083</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>14</td>
<td>2.819822</td>
<td>2.919453</td>
<td>0.130642</td>
<td>0.031378</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>15</td>
<td>2.811538</td>
<td>2.906948</td>
<td>0.118138</td>
<td>0.028666</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>16</td>
<td>2.804413</td>
<td>2.911311</td>
<td>0.122500</td>
<td>0.029665</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>17</td>
<td>2.798424</td>
<td>2.909667</td>
<td>0.120857</td>
<td>0.029286</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>18</td>
<td>2.793306</td>
<td>2.913197</td>
<td>0.124386</td>
<td>0.030075</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>19</td>
<td>2.788728</td>
<td>2.912609</td>
<td>0.123799</td>
<td>0.029961</td>
<td>00:00</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-stdout">
<pre><code>------fold6------
lr in training is 0.003</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">KLD</th>
<th data-quarto-table-cell-role="th">JSD</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>3.297189</td>
<td>3.136102</td>
<td>0.320835</td>
<td>0.071463</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>1</td>
<td>3.249536</td>
<td>3.097304</td>
<td>0.282038</td>
<td>0.066755</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>2</td>
<td>3.176144</td>
<td>2.978935</td>
<td>0.163668</td>
<td>0.041619</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>3</td>
<td>3.096929</td>
<td>3.038055</td>
<td>0.222788</td>
<td>0.047839</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>4</td>
<td>3.042613</td>
<td>2.930212</td>
<td>0.114946</td>
<td>0.027027</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>5</td>
<td>3.009720</td>
<td>2.961850</td>
<td>0.146584</td>
<td>0.036113</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>6</td>
<td>2.980234</td>
<td>2.934232</td>
<td>0.118966</td>
<td>0.028464</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>7</td>
<td>2.950530</td>
<td>2.916851</td>
<td>0.101585</td>
<td>0.024648</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>8</td>
<td>2.923650</td>
<td>2.914764</td>
<td>0.099498</td>
<td>0.023798</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>9</td>
<td>2.900300</td>
<td>2.905350</td>
<td>0.090084</td>
<td>0.021675</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>10</td>
<td>2.879807</td>
<td>2.909664</td>
<td>0.094397</td>
<td>0.022672</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>11</td>
<td>2.862369</td>
<td>2.905931</td>
<td>0.090665</td>
<td>0.021678</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>12</td>
<td>2.847067</td>
<td>2.908035</td>
<td>0.092769</td>
<td>0.022000</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>13</td>
<td>2.834576</td>
<td>2.909927</td>
<td>0.094661</td>
<td>0.022350</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>14</td>
<td>2.824375</td>
<td>2.908078</td>
<td>0.092811</td>
<td>0.022187</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>15</td>
<td>2.815225</td>
<td>2.909920</td>
<td>0.094654</td>
<td>0.022545</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>16</td>
<td>2.807965</td>
<td>2.908288</td>
<td>0.093022</td>
<td>0.022114</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>17</td>
<td>2.801108</td>
<td>2.906668</td>
<td>0.091402</td>
<td>0.021692</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>18</td>
<td>2.795465</td>
<td>2.906262</td>
<td>0.090996</td>
<td>0.021677</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>19</td>
<td>2.791303</td>
<td>2.905522</td>
<td>0.090256</td>
<td>0.021500</td>
<td>00:00</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-stdout">
<pre><code>------fold7------
lr in training is 0.003</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">KLD</th>
<th data-quarto-table-cell-role="th">JSD</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>3.299562</td>
<td>3.121898</td>
<td>0.459853</td>
<td>0.099220</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>1</td>
<td>3.243594</td>
<td>3.062286</td>
<td>0.400241</td>
<td>0.091881</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>2</td>
<td>3.159332</td>
<td>2.971716</td>
<td>0.309671</td>
<td>0.068669</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>3</td>
<td>3.089763</td>
<td>3.351497</td>
<td>0.689452</td>
<td>0.103349</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>4</td>
<td>3.045304</td>
<td>2.918247</td>
<td>0.256202</td>
<td>0.056467</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>5</td>
<td>3.008193</td>
<td>2.911331</td>
<td>0.249286</td>
<td>0.055545</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>6</td>
<td>2.972661</td>
<td>2.913930</td>
<td>0.251885</td>
<td>0.056160</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>7</td>
<td>2.941783</td>
<td>2.896349</td>
<td>0.234304</td>
<td>0.051629</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>8</td>
<td>2.915963</td>
<td>2.914812</td>
<td>0.252767</td>
<td>0.053871</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>9</td>
<td>2.893497</td>
<td>2.888577</td>
<td>0.226532</td>
<td>0.049996</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>10</td>
<td>2.875000</td>
<td>2.886438</td>
<td>0.224393</td>
<td>0.049796</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>11</td>
<td>2.858765</td>
<td>2.898579</td>
<td>0.236534</td>
<td>0.051343</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>12</td>
<td>2.844424</td>
<td>2.893336</td>
<td>0.231291</td>
<td>0.050411</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>13</td>
<td>2.832489</td>
<td>2.895736</td>
<td>0.233691</td>
<td>0.050632</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>14</td>
<td>2.822521</td>
<td>2.893903</td>
<td>0.231857</td>
<td>0.050457</td>
<td>-1:59:59</td>
</tr>
<tr class="even">
<td>15</td>
<td>2.814178</td>
<td>2.891891</td>
<td>0.229846</td>
<td>0.050070</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>16</td>
<td>2.807404</td>
<td>2.898021</td>
<td>0.235976</td>
<td>0.051179</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>17</td>
<td>2.801465</td>
<td>2.896371</td>
<td>0.234326</td>
<td>0.050828</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>18</td>
<td>2.796492</td>
<td>2.893707</td>
<td>0.231662</td>
<td>0.050206</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>19</td>
<td>2.792389</td>
<td>2.893404</td>
<td>0.231358</td>
<td>0.050177</td>
<td>00:00</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-stdout">
<pre><code>------fold8------
lr in training is 0.003</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">KLD</th>
<th data-quarto-table-cell-role="th">JSD</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>3.291689</td>
<td>3.126647</td>
<td>0.328515</td>
<td>0.072071</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>1</td>
<td>3.247692</td>
<td>3.070245</td>
<td>0.272114</td>
<td>0.064862</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>2</td>
<td>3.171447</td>
<td>3.193789</td>
<td>0.395657</td>
<td>0.082534</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>3</td>
<td>3.087097</td>
<td>3.136495</td>
<td>0.338363</td>
<td>0.060231</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>4</td>
<td>3.034902</td>
<td>3.407114</td>
<td>0.608982</td>
<td>0.063098</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>5</td>
<td>2.998126</td>
<td>2.938519</td>
<td>0.140387</td>
<td>0.032685</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>6</td>
<td>2.965282</td>
<td>2.934006</td>
<td>0.135874</td>
<td>0.031751</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>7</td>
<td>2.936001</td>
<td>2.920478</td>
<td>0.122346</td>
<td>0.028373</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>8</td>
<td>2.909675</td>
<td>2.920455</td>
<td>0.122323</td>
<td>0.028210</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>9</td>
<td>2.887431</td>
<td>2.947639</td>
<td>0.149508</td>
<td>0.034510</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>10</td>
<td>2.868375</td>
<td>2.975793</td>
<td>0.177661</td>
<td>0.038532</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>11</td>
<td>2.851671</td>
<td>2.975747</td>
<td>0.177615</td>
<td>0.039114</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>12</td>
<td>2.838888</td>
<td>2.943917</td>
<td>0.145786</td>
<td>0.032903</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>13</td>
<td>2.827868</td>
<td>2.999522</td>
<td>0.201391</td>
<td>0.037109</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>14</td>
<td>2.817961</td>
<td>3.014208</td>
<td>0.216076</td>
<td>0.037690</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>15</td>
<td>2.810466</td>
<td>3.005015</td>
<td>0.206883</td>
<td>0.036385</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>16</td>
<td>2.803423</td>
<td>3.015611</td>
<td>0.217480</td>
<td>0.037107</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>17</td>
<td>2.797695</td>
<td>3.024181</td>
<td>0.226050</td>
<td>0.037952</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>18</td>
<td>2.792915</td>
<td>3.014269</td>
<td>0.216138</td>
<td>0.037182</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>19</td>
<td>2.789497</td>
<td>3.015017</td>
<td>0.216886</td>
<td>0.037778</td>
<td>00:00</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
</div>
</section>
<section id="score" class="level2">
<h2 class="anchored" data-anchor-id="score">Score</h2>
<div id="33525bfa-668a-4d3c-bacc-e14f7ec9b604" class="cell" data-execution_count="36">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> katlas.pssm <span class="im">import</span> <span class="op">*</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> functools <span class="im">import</span> partial</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="6e783921-fb25-41ca-bfb8-1dd198dd8d96" class="cell" data-execution_count="37">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> score_df(target,pred,func):</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>    distance <span class="op">=</span> [func(target.loc[i],pred.loc[i,target.columns]) <span class="cf">for</span> i <span class="kw">in</span> target.index]</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.Series(distance,index<span class="op">=</span>target.index)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="ab4ac472-f218-46ea-9f4a-fd2ccaa62a9e" class="cell" data-execution_count="38">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>jsd_df <span class="op">=</span> partial(score_df,func<span class="op">=</span>js_divergence_flat)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>jss_df <span class="op">=</span> partial(score_df,func<span class="op">=</span>js_similarity_flat)</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>kld_df <span class="op">=</span> partial(score_df,func<span class="op">=</span>kl_divergence_flat)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="f33fa0e8-ad65-4143-800e-6b78625ca8c7" class="cell" data-execution_count="39">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>target<span class="op">=</span>df_t5[target_col].copy()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="8c487354-b562-4353-9ad2-af40b3fa0b7f" class="cell" data-execution_count="40">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>(oof_t5.nfold <span class="op">==</span> oof_esm.nfold).value_counts()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<pre><code>nfold
True    368
Name: count, dtype: int64</code></pre>
</div>
</div>
<div id="3cc15e9e-024b-437d-b458-697f2d94db8f" class="cell" data-execution_count="41">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>pspa_info[<span class="st">'split'</span>] <span class="op">=</span> oof_t5.nfold</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="17af9921-60fa-46da-ae28-5341324c8ce2" class="cell" data-execution_count="42">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>pspa_info[<span class="st">'t5'</span>] <span class="op">=</span>jsd_df(target,oof_t5)</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>pspa_info[<span class="st">'esm'</span>] <span class="op">=</span>jsd_df(target,oof_esm)</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>pspa_info[<span class="st">'onehot'</span>] <span class="op">=</span>jsd_df(target,oof_onehot)</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>pspa_info[<span class="st">'onehot_pca'</span>] <span class="op">=</span>jsd_df(target,oof_onehot_pca)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="c6a4fb2b-4ac7-45ea-b4a8-0016b5cb5b08" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> katlas.plot <span class="im">import</span> <span class="op">*</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot <span class="im">as</span> plt</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="30d8190a-f4ff-43bf-9da1-fefcae250cd4" class="cell" data-execution_count="2">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>set_sns()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="6fbecb49-7552-4b0f-86b2-26980e04e3c7" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pspa_info.to_parquet('raw/CNN_feature_compare_group.parquet')</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="65dca17e-7c36-4a4f-840f-8d31c1b6bc2c" class="cell" data-execution_count="15">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>pspa_info<span class="op">=</span>pd.read_parquet(<span class="st">'raw/CNN_feature_compare_group.parquet'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="a5257f20-1a8f-4cad-b775-b283424fd640" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>pspa_info <span class="op">=</span> pspa_info.rename(columns<span class="op">=</span>{<span class="st">'t5'</span>:<span class="st">'T5(n=1,024)'</span>,<span class="st">'esm'</span>:<span class="st">'ESM2(n=1,280)'</span>,<span class="st">'onehot'</span>:<span class="st">'OneHot(n=6,849)'</span>,<span class="st">'onehot_pca'</span>:<span class="st">'OneHot+PCA(n=1,000)'</span>})</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>cols<span class="op">=</span>[<span class="st">'OneHot(n=6,849)'</span>,</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>      <span class="st">'OneHot+PCA(n=1,000)'</span>,</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>      <span class="st">'ESM2(n=1,280)'</span>,</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>      <span class="st">'T5(n=1,024)'</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="766b23a2-909d-4206-bad7-26e9b7078a41" class="cell" data-execution_count="18">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>plot_group_bar(pspa_info,cols,group<span class="op">=</span><span class="st">'group'</span>)</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'JS divergence'</span>)</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>save_svg(<span class="st">'fig/CNN_feature_comparison_group.svg'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="kd_06a_pspa_training_feature_comparison_CNN_group_files/figure-html/cell-49-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<section id="for-js-similarity-less-differentiated" class="level3">
<h3 class="anchored" data-anchor-id="for-js-similarity-less-differentiated">For JS similarity (less differentiated)</h3>
<div id="29201057-c903-4f2e-a4d9-a879ce6a40f2" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>pspa_info[<span class="st">'t5'</span>] <span class="op">=</span>jss_df(target,oof_t5)</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>pspa_info[<span class="st">'esm'</span>] <span class="op">=</span>jss_df(target,oof_esm)</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>pspa_info[<span class="st">'onehot'</span>] <span class="op">=</span>jss_df(target,oof_onehot)</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>pspa_info[<span class="st">'onehot_pca'</span>] <span class="op">=</span>jss_df(target,oof_onehot_pca)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="de85d556-2002-4aaf-b098-6d966d86aafd" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>plot_group_bar(pspa_info,[<span class="st">'t5'</span>,<span class="st">'esm'</span>,<span class="st">'onehot'</span>,<span class="st">'onehot_pca'</span>],group<span class="op">=</span><span class="st">'group'</span>)</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'JS divergence'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/sky1ove\.github\.io\/katlas-raw");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/sky1ove/katlas-raw/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>