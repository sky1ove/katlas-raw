# Motif plot


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

``` python
import pandas as pd
```

``` python
pssms = pd.read_parquet('out/all_site_pssms_filter.parquet')
```

``` python
df = pd.read_parquet('raw/kmeans_site_long_cluster_new.parquet')
```

``` python
pssms.shape
```

    (1169, 943)

``` python
df.shape
```

    (843252, 6)

``` python
df.columns
```

    Index(['sub_site', 'site_seq', 'cluster_info', 'cluster', 'cluster_id',
           'cluster_new'],
          dtype='object')

``` python
cols=['sub_site','cluster_new']
```

``` python
df = df[cols]
```

``` python
info=pd.read_parquet('raw/kmeans_site.parquet')
```

``` python
info = info[['substrate_uniprot', 'substrate_genes', 'site', 'source','sub_site','site_seq']]
```

``` python
df = df.merge(info,on='sub_site')
```

``` python
df.columns
```

    Index(['sub_site', 'cluster_new', 'substrate_uniprot', 'substrate_genes',
           'site', 'source', 'site_seq'],
          dtype='object')

``` python
new_colname = ['sub_site', 'cluster', 'uniprot', 'genes',
       'site', 'source', 'site_seq']
```

``` python
df.columns = new_colname
```

``` python
df = df[df.cluster.isin(pssms.index)]
```

``` python
df.shape
```

    (751513, 7)

``` python
df = df.reset_index(drop=True)
```

``` python
df.to_parquet('out/web_motif_df.parquet')
```

``` python
df = pd.read_parquet('out/web_motif_df.parquet')
```

## Hierarchical clustering of merged pssms

``` python
from katlas.clustering import *
```

``` python
Z = get_Z(pssms)
```

      0%|          | 0/682696 [00:00<?, ?it/s]

``` python
count_map = df.cluster.value_counts()
```

``` python
labels= get_pssm_seq_labels(pssms,count_map = count_map , thr=0.3)
```

``` python
labels[:4]
```

    ['29 (n=8,243): ....................s*P...................',
     '369 (n=6,453): ....................s*.s..................',
     '1054 (n=6,368): ....................t*P...................',
     '338 (n=6,182): .................R..s*....................']

``` python
from katlas.plot import *
from matplotlib import pyplot as plt
from scipy.cluster.hierarchy import dendrogram
```

``` python
def plot_dendrogram(Z,
                    color_thr=0.07,
                    dense=7, # the higher the more dense for each row
                    line_width=1,
                    # title='Hierarchical Clustering Dendrogram',
                    scale=1,
                    **kwargs):
    length = (len(Z) + 1) // dense
    
    plt.figure(figsize=(5*scale,length*scale))
    with plt.rc_context({'lines.linewidth': line_width}):
        dendrogram(
            Z,
            orientation='left',
            leaf_font_size=18, #7
            color_threshold=color_thr,
            **kwargs
        )

    ax = plt.gca()
    for spine in ['top', 'right', 'left', 'bottom']:
        ax.spines[spine].set_visible(False)
```

``` python
plot_dendrogram(Z,labels=labels,color_thr=0.07,scale=2.5)
# save_pdf('out/dendrogram.pdf')
save_svg('out/human_motif_dendrogram.svg')
plt.close()
```

## All motif

``` python
import pandas as pd
from katlas.plot import *
from katlas.pssm import *
from katlas.utils import *
from tqdm import tqdm
import gc
from matplotlib import pyplot as plt
```

``` python
pssms = pd.read_parquet('out/all_site_pssms_filter.parquet')
```

``` python
df = pd.read_parquet('out/web_motif_df.parquet')
```

``` python
cnt = df.cluster.value_counts()
```

``` python
# cnt.index.get_loc(1198)
```

    1146

``` python
def save_show(path=None, # image path, e.g., img.svg, if not None, will save, else plt.show()
              show_only=False,
             ):
    "Show plot or save path"
    if show_only: plt.show()
    elif path is not None: plt.savefig(path, bbox_inches='tight', pad_inches=0.05,transparent=True)
    else: plt.show()
    plt.close('all')
```

``` python
for idx,row in tqdm(pssms.iterrows(),total=len(pssms)):
    plot_logo_heatmap(recover_pssm(row),title=f'Motif #{idx} (n={cnt[idx]})')
    path=prepare_path(f'fig/motif/{idx}/pssm.svg')
    save_show(path,show_only=False)
```

      2%|█▊                                                                                          | 23/1169 [01:07<56:28,  2.96s/it]

## Pathway for each motif

``` python
from katlas.pathway import *
from katlas.utils import *
```

``` python
cnt = df.cluster.value_counts()
```

``` python
# for idx in [545,
#             1058,
#             913,
#             597,
#             1231]:
#     df_motif = df[df.cluster==idx].copy()
#     gene_list = df_motif.genes.str.split(' ').str[0].dropna().drop_duplicates().tolist()
#     try:
#         df_path = get_reactome(gene_list,p_type='p')
#         df_path = df_path[~df_path.name.str.contains('GTPase|SUMO',case=False,na=False)].copy()
#         path = prepare_path(f'fig/motif/{idx}/path.parquet')
#         df_path.to_parquet(path)
#     except Exception as e:
#         print(f"Failed for {idx}: {e}")
```

    Running pathway anlysis
    Done
    Failed for 1231: "None of [Index(['name', 'stId', 'entities.pValue'], dtype='object')] are in the [columns]"

``` python
for idx in cnt.index:
    df_motif = df[df.cluster==idx].copy()
    gene_list = df_motif.genes.str.split(' ').str[0].dropna().drop_duplicates().tolist()
    try:
        df_path = get_reactome(gene_list,p_type='p')
        df_path = df_path[~df_path.name.str.contains('GTPase|SUMO',case=False,na=False)].copy()
        path = prepare_path(f'fig/motif/{idx}/path.parquet')
        df_path.to_parquet(path)
    except Exception as e:
        print(f"Failed for {idx}: {e}")
    # break
```

    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    ('Connection aborted.', ConnectionResetError(104, 'Connection reset by peer'))
    Failed for 545: cannot access local variable 'response' where it is not associated with a value
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    ('Connection aborted.', ConnectionResetError(104, 'Connection reset by peer'))
    Failed for 1058: cannot access local variable 'response' where it is not associated with a value
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Failed for 913: ('Connection broken: IncompleteRead(6474 bytes read, 1718 more expected)', IncompleteRead(6474 bytes read, 1718 more expected))
    Running pathway anlysis
    ('Connection aborted.', ConnectionResetError(104, 'Connection reset by peer'))
    Failed for 597: cannot access local variable 'response' where it is not associated with a value
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Failed for 1231: "None of [Index(['name', 'stId', 'entities.pValue'], dtype='object')] are in the [columns]"
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done
    Running pathway anlysis
    Done

``` python
pssms
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&#10;    .dataframe tbody tr th {
        vertical-align: top;
    }
&#10;    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe" data-quarto-postprocess="true" data-border="1">
<thead>
<tr style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">-20P</th>
<th data-quarto-table-cell-role="th">-20G</th>
<th data-quarto-table-cell-role="th">-20A</th>
<th data-quarto-table-cell-role="th">-20C</th>
<th data-quarto-table-cell-role="th">-20S</th>
<th data-quarto-table-cell-role="th">-20T</th>
<th data-quarto-table-cell-role="th">-20V</th>
<th data-quarto-table-cell-role="th">-20I</th>
<th data-quarto-table-cell-role="th">-20L</th>
<th data-quarto-table-cell-role="th">-20M</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">20H</th>
<th data-quarto-table-cell-role="th">20K</th>
<th data-quarto-table-cell-role="th">20R</th>
<th data-quarto-table-cell-role="th">20Q</th>
<th data-quarto-table-cell-role="th">20N</th>
<th data-quarto-table-cell-role="th">20D</th>
<th data-quarto-table-cell-role="th">20E</th>
<th data-quarto-table-cell-role="th">20pS</th>
<th data-quarto-table-cell-role="th">20pT</th>
<th data-quarto-table-cell-role="th">20pY</th>
</tr>
<tr>
<th data-quarto-table-cell-role="th">cluster_new</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">29</td>
<td>0.068293</td>
<td>0.056220</td>
<td>0.061707</td>
<td>0.018293</td>
<td>0.064512</td>
<td>0.043171</td>
<td>0.049878</td>
<td>0.039756</td>
<td>0.092317</td>
<td>0.021463</td>
<td>...</td>
<td>0.025225</td>
<td>0.067633</td>
<td>0.054838</td>
<td>0.047161</td>
<td>0.038874</td>
<td>0.058250</td>
<td>0.083841</td>
<td>0.028516</td>
<td>0.007677</td>
<td>0.002315</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">369</td>
<td>0.077786</td>
<td>0.067810</td>
<td>0.065004</td>
<td>0.012783</td>
<td>0.071551</td>
<td>0.039439</td>
<td>0.046610</td>
<td>0.033359</td>
<td>0.083087</td>
<td>0.015900</td>
<td>...</td>
<td>0.026542</td>
<td>0.064012</td>
<td>0.069945</td>
<td>0.046214</td>
<td>0.036222</td>
<td>0.049180</td>
<td>0.084309</td>
<td>0.052771</td>
<td>0.017018</td>
<td>0.002342</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">1054</td>
<td>0.088742</td>
<td>0.063003</td>
<td>0.074057</td>
<td>0.011843</td>
<td>0.064424</td>
<td>0.045476</td>
<td>0.055582</td>
<td>0.033633</td>
<td>0.075162</td>
<td>0.021159</td>
<td>...</td>
<td>0.022461</td>
<td>0.074185</td>
<td>0.059633</td>
<td>0.050775</td>
<td>0.027365</td>
<td>0.051882</td>
<td>0.071813</td>
<td>0.043499</td>
<td>0.017083</td>
<td>0.004587</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">338</td>
<td>0.076785</td>
<td>0.070604</td>
<td>0.071254</td>
<td>0.012201</td>
<td>0.072718</td>
<td>0.043273</td>
<td>0.052546</td>
<td>0.035627</td>
<td>0.088661</td>
<td>0.019847</td>
<td>...</td>
<td>0.022975</td>
<td>0.062082</td>
<td>0.069741</td>
<td>0.047091</td>
<td>0.034382</td>
<td>0.040574</td>
<td>0.074466</td>
<td>0.042529</td>
<td>0.010754</td>
<td>0.002933</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">427</td>
<td>0.076803</td>
<td>0.062933</td>
<td>0.069868</td>
<td>0.010749</td>
<td>0.071255</td>
<td>0.046637</td>
<td>0.047330</td>
<td>0.033807</td>
<td>0.076456</td>
<td>0.019071</td>
<td>...</td>
<td>0.023582</td>
<td>0.060864</td>
<td>0.063465</td>
<td>0.050460</td>
<td>0.035200</td>
<td>0.055141</td>
<td>0.081498</td>
<td>0.052540</td>
<td>0.013005</td>
<td>0.003468</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">539</td>
<td>0.022727</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.068182</td>
<td>0.000000</td>
<td>0.068182</td>
<td>0.295455</td>
<td>0.090909</td>
<td>0.022727</td>
<td>...</td>
<td>0.022727</td>
<td>0.090909</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.045455</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">131</td>
<td>0.000000</td>
<td>0.136364</td>
<td>0.045455</td>
<td>0.068182</td>
<td>0.022727</td>
<td>0.045455</td>
<td>0.022727</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>...</td>
<td>0.000000</td>
<td>0.068182</td>
<td>0.090909</td>
<td>0.000000</td>
<td>0.022727</td>
<td>0.272727</td>
<td>0.045455</td>
<td>0.045455</td>
<td>0.022727</td>
<td>0.000000</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">538</td>
<td>0.071429</td>
<td>0.000000</td>
<td>0.023810</td>
<td>0.000000</td>
<td>0.023810</td>
<td>0.047619</td>
<td>0.047619</td>
<td>0.023810</td>
<td>0.476190</td>
<td>0.000000</td>
<td>...</td>
<td>0.000000</td>
<td>0.071429</td>
<td>0.119048</td>
<td>0.095238</td>
<td>0.214286</td>
<td>0.023810</td>
<td>0.119048</td>
<td>0.047619</td>
<td>0.000000</td>
<td>0.023810</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">1207</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.047619</td>
<td>0.119048</td>
<td>0.000000</td>
<td>0.047619</td>
<td>0.071429</td>
<td>0.047619</td>
<td>0.000000</td>
<td>0.023810</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">1224</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>...</td>
<td>0.023810</td>
<td>0.023810</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.023810</td>
<td>0.047619</td>
<td>0.166667</td>
<td>0.023810</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
</tbody>
</table>

<p>1169 rows × 943 columns</p>
</div>

## Special motifs

### Customized

``` python
from katlas.pssm import *
```

``` python
plot_logos_idx(pssms,412)
```

![](21_motif_plot_files/figure-commonmark/cell-46-output-1.png)

### Most common

``` python
cluster_cnt = df.cluster.value_counts()
```

``` python
plot_logos(pssms.head(10),count_dict=cluster_cnt)
```

![](21_motif_plot_files/figure-commonmark/cell-48-output-1.png)

### Most common y

``` python
pssms_y = pssms[pssms['0pY']>0.3].copy()
```

``` python
idxs_y = pssms_y.index
```

``` python
len(idxs_y)
```

    19

``` python
plot_logos(pssms.loc[idxs_y],count_dict=cluster_cnt)
```

![](21_motif_plot_files/figure-commonmark/cell-52-output-1.png)

### Highest IC sum

``` python
ICs = pssms.apply(lambda r: sum(get_IC_flat(r)) ,axis=1)
```

``` python
idxs=ICs.sort_values(ascending=False).head(20).index
```

The first one is mostly Zinc finger protein

``` python
plot_logos(pssms.loc[idxs],count_dict=cluster_cnt)
```

![](21_motif_plot_files/figure-commonmark/cell-55-output-1.png)

### C-terminal motifs

``` python
zeros_right = pssms.apply(lambda r: (recover_pssm(r).loc[:,1:].sum()==0).sum() , axis=1)
```

``` python
zeros_right_idxs = zeros_right[zeros_right>0].index
```

``` python
zeros_right_idxs
```

    Index([1150, 1164, 1160, 1134, 1161, 1137, 1140, 1159, 1163, 1155, 1141, 1158,
           1136, 1165],
          dtype='int64', name='cluster_new')

``` python
plot_logos(pssms.loc[zeros_right_idxs],count_dict=cluster_cnt)
```

![](21_motif_plot_files/figure-commonmark/cell-59-output-1.png)

### N-Terminal motifs:

``` python
zeros_left = pssms.apply(lambda r: (recover_pssm(r).loc[:,:0].sum()==0).sum() , axis=1)
```

``` python
zeros_left_idxs = zeros_left[zeros_left>0].index
```

``` python
idxs = zeros_left_idxs[:10]
```

``` python
# zeros = pssms.apply(lambda r: (recover_pssm(r).sum()==0).sum() , axis=1)

# idxs = zeros.sort_values(ascending=False).head(10).index
```

``` python
plot_logos(pssms.loc[idxs],count_dict=cluster_cnt)
```

![](21_motif_plot_files/figure-commonmark/cell-64-output-1.png)
